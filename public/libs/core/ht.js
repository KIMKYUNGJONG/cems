!function(j,i,c){"use strict";function b(E,m){if("function"!=typeof m&&null!==m)throw new TypeError("Super expression must either be null or a function");E.prototype=i.create(m&&m.prototype,{constructor:{value:E,writable:!0,configurable:!0}}),m&&Am(E,m)}function B(j){var v=i.prototype.toString.call(j);return"Array]"===v.substring(v.length-6)}function e(d,E,T,Y,g,J){E=E||[],T=T||[],Y=Y||[];try{E.push(d);var m=Function.apply(0,E);return T[T.length]="return "+m,Function.apply(0,T).apply(0,Y)}catch(D){return J&&J(D),g}}function m(S){var l={};return{get:function(z){if(l[z]!==c)return l[z];var a;switch(z){case"WEBGL_depth_texture":a=S.getExtension("WEBGL_depth_texture")||S.getExtension("MOZ_WEBGL_depth_texture")||S.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":a=S.getExtension("EXT_texture_filter_anisotropic")||S.getExtension("MOZ_EXT_texture_filter_anisotropic")||S.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":a=S.getExtension("WEBGL_compressed_texture_s3tc")||S.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":a=S.getExtension("WEBGL_compressed_texture_pvrtc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":a=S.getExtension("WEBGL_compressed_texture_etc1");break;default:a=S.getExtension(z)}return l[z]=a,a}}}function E(Q,f,b){function i(){if(S!==c)return S;var d=f.get("EXT_texture_filter_anisotropic");return S=null!==d?Q.getParameter(d.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function U(C){if("highp"===C){if(Q.getShaderPrecisionFormat(Q.VERTEX_SHADER,Q.HIGH_FLOAT).precision>0&&Q.getShaderPrecisionFormat(Q.FRAGMENT_SHADER,Q.HIGH_FLOAT).precision>0)return"highp";C="mediump"}return"mediump"===C&&Q.getShaderPrecisionFormat(Q.VERTEX_SHADER,Q.MEDIUM_FLOAT).precision>0&&Q.getShaderPrecisionFormat(Q.FRAGMENT_SHADER,Q.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var S;b=b||{};var P="undefined"!=typeof WebGL2RenderingContext&&Q instanceof WebGL2RenderingContext,J=b.precision!==c?b.precision:"highp",V=U(J);V!==J&&(console.warn("WebGL:",J,"not supported, using",V,"instead."),J=V);var N=b.logarithmicDepthBuffer===!0,G=Q.getParameter(Q.MAX_TEXTURE_IMAGE_UNITS),K=Q.getParameter(Q.MAX_VERTEX_TEXTURE_IMAGE_UNITS),E=Q.getParameter(Q.MAX_TEXTURE_SIZE),h=Q.getParameter(Q.MAX_CUBE_MAP_TEXTURE_SIZE),d=Q.getParameter(Q.MAX_VERTEX_ATTRIBS),I=Q.getParameter(Q.MAX_VERTEX_UNIFORM_VECTORS),u=Q.getParameter(Q.MAX_VARYING_VECTORS),g=Q.getParameter(Q.MAX_FRAGMENT_UNIFORM_VECTORS),O=K>0,_=P||!!f.get("OES_texture_float"),v=(P||!!f.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,R=O&&_,k=P?Q.getParameter(Q.MAX_SAMPLES):0;return{getMaxAnisotropy:i,getMaxPrecision:U,precision:J,logarithmicDepthBuffer:N,maxTextures:G,maxVertexTextures:K,maxTextureSize:E,maxCubemapSize:h,maxAttributes:d,maxVertexUniforms:I,maxVaryings:u,maxFragmentUniforms:g,vertexTextures:O,floatFragmentTextures:_,elementTypeUint:v,floatVertexTextures:R,maxSamples:k}}function O(t,M){return t.z!==M.z?M.z-t.z:t.id-M.id}var R="ht";if(!j[R]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),j.performance&&j.performance.now||function(){var H=Date.now();j.performance||(j.performance={}),j.performance.now=function(){return Date.now()-H}}();for(var I=Date.now(),H=16,o=["ms","moz","webkit","o"],K=0;K<o.length&&!j.requestAnimationFrame;++K)j.requestAnimationFrame=j[o[K]+"RequestAnimationFrame"],j.cancelAnimationFrame=j[o[K]+"CancelAnimationFrame"]||j[o[K]+"CancelRequestAnimationFrame"];j.requestAnimationFrame||(j.requestAnimationFrame=function(t){var l=Date.now(),i=H+I-l;return 0>i&&(i=0),I=l,j.setTimeout(function(){I=Date.now(),t(performance.now())},i)}),j.cancelAnimationFrame||(j.cancelAnimationFrame=function(G){return j.clearTimeout(G)}),i.assign===c&&(i.assign=function(N){if(N===c||null===N)throw new TypeError("Cannot convert undefined or null to object");for(var b=i(N),C=1;C<arguments.length;C++){var w=arguments[C];if(w!==c&&null!==w)for(var _ in w)i.prototype.hasOwnProperty.call(w,_)&&(b[_]=w[_])}return b}),j.btoa===c&&(j.btoa=function(Q){for(var j,Z,P=String(Q),D=0,G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";P.charAt(0|D)||(G="=",D%1);c+=G.charAt(63&j>>8-8*(D%1))){if(Z=P.charCodeAt(D+=.75),Z>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");j=j<<8|Z}return c})}();var w,P,k,q,g=j.location,t=g&&j.document,Z=null,_=c,T=j[R]={},J=j[R+"config"],L=T.Default=J&&J.Default||{},X=T.Style=J&&J.Style||{},A=T.Attr=J&&J.Attr||{},a=function(){return!0},p=function(){return!1},U=function(f){return f},I=function(b){return!b},x=T.Color=J&&J.Color||{},h=T.IsGetter=J&&J.IsGetter||{};!function(){var t=!1;try{var d=i.defineProperty({},"passive",{get:function(){return t=!0,c}});g&&(k=w=g)&&j.addEventListener("test",d,d),g&&(q=P=g)&&j.removeEventListener("test",d,d)}catch($){t=!1}L.passiveSupported=t}();var H,r,o,W,Q=L.passiveSupported,D=L.eventListenerOptionsFalse=Q?{passive:!1,capture:!1}:!1,u=L.eventListenerOptionsTrue=Q?{passive:!1,capture:!0}:!0,n=function(Y,_,w,L){Y.addEventListener(_,w,L?u:D)},M=function(F,C,U,w){F.removeEventListener(C,U,w?u:D)},Y=Math,y=Y.round,G=Y.floor,N=Y.ceil,V=Y.sqrt,$=Y.max,S=Y.min,C=Y.abs,K=Y.cos,l=Y.acos,z=Y.sin,F=Y.pow,f=Y.asin,d=Y.exp,v=Y.PI,s=2*v,So=v/2,Lp=Y.tan,Nh=Y.atan2,Rr=Y.random,Yi=Y.log,Qp=F(2,1),bl=!1,te=j.parseInt||global.parseInt,Jo="2021-9-15",bs=g&&(j.navigator?j.navigator.platform.indexOf("Win")>-1:!1),Lm=function(y){return y*y},vc=g&&j.setTimeout,ki=g&&j.clearTimeout,Tk=g&&(j.navigator?j.navigator.userAgent.toLowerCase():""),aq=function(T){return T.test(Tk)},zi=aq(/msie/),wk=aq(/msie/)||aq(/trident/),Xb=aq(/msie 10/),yb=aq(/edge/),Rm=aq(/firefox/),Wb=aq(/mac/),jj=aq(/mscAndroid/),Km=L.isTouchable===c?bs?!1:t?"ontouchend"in t:!1:L.isTouchable,Yb="default",Ih="single",Kc="multiple",qn="front",Kf="back",Cl="left",ij="right",Vl="top",mf="bottom",Wj="center",Kg="eye",fi="middle",Jn="east",Dl="west",Wk="north",tm="none",sj="px",tg="absolute",Ro="border",hl="triangle",ug="rect",cn="circle",hm="cylinder",Gd="shape",Ch="items",bd="normal",Ri="remove",cr="clear",zp="width",Sn="height",wg="ingroup",Sm="check",md="uncheck",Fm="radio",Df="radioOn",hq="radioOff",Eb="points",jl="values",Cd="series",Jh="body",Tp="label",Mj="label2",Bl="note",re="note2",mi="icons",Mr="labelFont",Sg="labelColor",Rg="labelSelectColor",eq="note.expanded",Xq="note2.expanded",Bh="edge.expanded",xi="edge.points",Qe="edge.type",mp="rotation",de="hidden",mb="visible",Ur="tuv",Br="no",Yh="draw",Gq="select",dr="currentSubGraph",qq="selectBackground",lk="autoMakeVisible",$o="autoHideScrollBar",Gp="scrollBarColor",id="scrollBarSize",Ao="indent",Jk="rowHeight",Bs="columnLineColor",cb="rowLineColor",Tn="columnLineVisible",fq="rowLineVisible",Jg="visibleFunc",Uf="expandIcon",ud="collapseIcon",wc="checkMode",Yq="sortFunc",ss="editable",gj="batchEditable",Nk="tristate",fd="asc",ve="desc",yg="position",el="__",bc="elevation",Xf="children",jm="translateX",uf="translateY",vi="dataModel",vg="maxSize",Ed="enc",om="state",hs=Ed+"o"+"de",lg="shape3d",wo="shape3d.resolution",Tl="shape3d.visible",$g="shape3d.from.visible",Jf="shape3d.to.visible",sh="shape3d.top.visible",lj="shape3d.bottom.visible",Dp="repeat.uv.length",Jj="serializeValue",Gf="deserializeValue",En="centerUniform",ap="uniform",Gg="rgba(255,255,255,0)",dp="style",im="attr",Fq="field",Rc="string",Hp="boolean",Ei="color",Bn="int",Mh="number",Vm="ew-resize",Ik="ns-resize",fl="pointer",un="auto",Wq="mousedown",Cn="mousemove",fr="mouseup",oo="mouseout",_d="touchstart",ad="touchmove",Ah="touchend",Ok="keydown",Vq="keyup",vs=["DOMMouseScroll","mousewheel"],ni=Rm?vs[0]:vs[1],vq=el+R+el+hs,$f=[_d,ad,Ah],kh=[Wq,Cn,fr,oo,ni,"wheel","mouseenter","mouseleave","mouseover"],Xj=[Ok,Vq,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],dn=Km?$f.concat(Xj):kh.concat(Xj),rs=Z,jd=Z,Xk=Z,Xd=Z,og=!1,nl=fr.length,sb=function(){Xk&&(ki(Xk.timeout),Xk=Z)},On=function(){Xk&&Qh(Xk.e,Xk.info)};j.addEventListener&&(_=g)&&(Km||(n(j,oo,function(){sb()}),n(j,ni,function(){Te()})),n(j,Vq,function(b){91===b.keyCode?Pm={}:delete Pm[b.keyCode]},!0),n(j,Ok,function(O){Pm[O.keyCode]=!0},!0),n(j,"blur",function(){Pm={}}));var ii,vj,bi,Sq=0,ff=Z,qi=function(B,S){var i=vc(function(){delete ff[i],_j(ff)&&(ff=Z),B()},S);return i},Mn=Z,rm=Z,rg={},pe={},Xn={},vf={},sk={},Pm={},Ef={},Kp={},sl={},Lo={},xe=/.json$/,xk=/\.(json|bin)$/,gr=/^data:image\/svg\+xml/,Zn={},ym=[],je={},kq=Z,Bq=Z,Ng=function(){},qk=function(){throw"Oops!"},nj=[0,0,0],Cp={x:0,y:0,width:0,height:0},hd=Z,dq=Z,zn=Z,ek=function(x,C){pe[x]=C,C&&C.comps&&!C.uuid&&(C.uuid=T.Math.generateUUID()),rh[x]&&(C.cacheRule=rh[x],delete rh[x])},Pl=function(Y){dq&&!Y._72O&&(zn||(zn={}),zn[Y._72O=Se()]=Y),ii!=Z?Bc()<.05&&W&&!vj&&(cd=sb):cd=Xe},gm=function(s,R,O,p){dq||(dq={});var T=dq[s];if(T){if(T.url===R)return;T.image?(T.image.onload=Ng,T.image.onerror=Ng):T.request&&(T.request.onload=Ng,T.request.onerror=Ng)}if(xe.test(R)){var J=new Hl;if(dq[s]={request:J,url:R},R=L.beforeLoadURL(R,s),R.data){var U=L.parse(R.data);gd(s,U),L.handleImageLoaded(s,U)}else{J.onload=function(){if(200===this.status||0===this.status){var W=L.parse(J.getResponseText());gd(s,W),L.handleImageLoaded(s,W)}else gd(s,L.handleUnfoundImage(s,R)||Z)},J.onerror=function(){gd(s,L.handleUnfoundImage(s,R)||Z)};var z={};z.url=encodeURI(R),z.sync=!1,J.send(z)}}else{var U=new Image;dq[s]={image:U,url:R},/^data:image/.test(R)||(R=L.beforeLoadURL(R,s),R=L.appendTimeStamp(R),R=encodeURI(R),U.crossOrigin=L.crossOrigin),L.convertImageSrc(R,function(k){wk&&(R.toLowerCase().indexOf(".svg")>0||gr.test(R))?(t.body.appendChild(U),U.style.visibility="hidden",U.onload=function(){vc(function(){if(O&&(U.width=O),p&&(U.height=p),!U.width||!U.height){var X=U.width||U.clientWidth,e=U.height||U.clientHeight;U.width=X,U.height=e}L.handleImageLoaded(s,U),gd(s,U),t.body.removeChild(U),U.style.visibility=""},180)},U.onerror=function(){gd(s,L.handleUnfoundImage(s,R)||Z),t.body.removeChild(U),U.style.visibility=""}):(U.onload=function(){O&&(U.width=O),p&&(U.height=p),L.handleImageLoaded(s,U),gd(s,U)},U.onerror=function(){gd(s,L.handleUnfoundImage(s,R)||Z)}),U.src=k})}},gd=function(g,J){if(ek(g,J),delete dq[g],_j(dq)&&(dq=Z,zn)){for(var u in zn){var z=zn[u];z._2O&&z._2O[g]&&(z.deleteTexture(g),delete z._2O[g]),z.invalidateAll&&z.invalidateAll(c,"imageLoaded",g),z.redraw&&z.redraw(),z.iv(),J&&J.layoutAttach&&ik(z.dm)&&z.dm().updateLayoutAttach(g),delete z._72O}zn=Z}if(J&&zn)for(var u in zn){var z=zn[u];z.invalidateAll&&z.invalidateAll(c,"imageLoading",g),z.redraw&&z.redraw(),z.iv(),J.layoutAttach&&ik(z.dm)&&z.dm().updateLayoutAttach(g)}},Ug=function(){return Yi=Y&&Date,function(){return j.performance&&j.performance.now?j.performance.now():Date.now()}}(),ks=function(r,A,J){return{width:r,height:A,comps:tj(J)?J:[J]}},Yj=function(J,O){return{type:cn,rect:[J,O,1.6,1.6],borderWidth:1,borderColor:Xg,gradient:Cj,gradientColor:mg,background:Xg}},hb=function(q,m){return ks(16,16,{type:hl,rect:[4,4,10,8],background:q,rotation:m?1.57:3.14})},Nr=function(t,l){return ks(16,16,{type:hl,rect:[4,4,8,7],background:t,rotation:l?3.14:0})},Vn=function(V){var h=V._orientation;return"horizontal"===h||"h"===h},vm=function(N,i){var a=Z||4,Q=Z||1,G=Z||1;0>a?a=0:a>.25&&(a=.25);var P,F,p,w,h,W,t,Y=.5,A=[],d=[],n=[],l=s/G,g=s/Q,V=Y-a;for(F=0;Q>=F;F++)for(w=-v+F*g,W=K(w),h=z(w),P=0;G>=P;P++)p=P*l,t=V+a*W,A.push(K(p)*t,h*a,-z(p)*t),(r=[N,i])&&d.push(P/G,1-F/Q);for(F=0;Q>F;F++){var B=F*(G+1),y=(F+1)*(G+1);for(P=0;G>P;P++)n.push(B+P,y+P+1,y+P,B+P,B+P+1,y+P+1),Uk.z=Bk.z=[N,i]}},Wf=function(r){var X=2,j=0;for(var Z in r)Z.length===X&&te(Z,32)===Gi&&(kq=Bq=r[Z]),j++;return j},fn=function(I,C,_,x){return _||(_=Km?5:3,_/=x||1),{x:I-_,y:C-_,width:2*_,height:2*_}},kb=function(_,b,J,C){var k=this;b||(b=Km?5:3,J=20,C=20);var q={x:_,y:b,width:J,height:C};if(J)for(var d=0;J>d;d++)if(3===J)C=20;else for(var z=0;C>z;z++)k=j?j:J;var B={x:v,y:2*v};if(Gb(q,B)){var M=Sn[0]+Vl[0]+cr[1]+fd.length,X=de[0]+Nk[0]+cr[1]+Jh.length;fo[Kg]=[k[M],k[X]],k[M]=ag[Kg],k[X]=ag[lg]}},Hq=function(Q){return(/ble$/.test(Q)||/ed$/.test(Q)||h[Q]?"is":"get")+Q.charAt(0).toUpperCase()+Q.slice(1)},ag=function(L){return"set"+L.charAt(0).toUpperCase()+L.slice(1)},em=function(n){return typeof n===Rc||n instanceof String},km=function(s){return typeof s===Mh},Xe=function(I){return typeof I===Hp},Ue=function(_){return _&&"object"==typeof _},ik=function(o){return"function"==typeof o},tj=function(Y){return Y instanceof Array},Nn=function(L){return L instanceof Dd},Vj=function(A){return tj(A)?new Dd(A):A},lm=function(X){return X instanceof Eq},El=function(A){return A instanceof os},rj=function(I){return I instanceof $h},lq=function(w,k){if(!(w instanceof T.Group))return!1;if(!k)return w.isExpanded();var I=k.getDataUI(w);return I&&I._88I?!0:!1},mm=function(e){return e instanceof Tb},Ld=function(v){return v&&"IFRAME"===v.tagName},Hn=function(f){return f==Z||L.numberDigits==Z?f:parseFloat(f.toFixed(L.numberDigits))},Ff=function(G,r,v){var z,D=r.length;if(v)for(var I=0;v>I;I++)if(3===D)G.push(r[0]),G.push(r[1]),G.push(r[2]);else for(z=0;D>z;z++)G.push(r[z]);else if(3===D)G.push(r[0]),G.push(r[1]),G.push(r[2]);else for(z=0;D>z;z++)G.push(r[z])},Ej=function(X){return X?Ue(X)?X:{}:!1},kp=function($,M,W){var h,A=Ue($)?$:$.prototype;for(h in M)W&&h in A?A[h]===c&&console.warn("class",A,"has own undefined property",h,", keep exist!"):A[h]=M[h];return $},ng=function(X,B){if(!("wheelDelta"in B)){var h=B.deltaMode;B.wheelDelta=h===B.DOM_DELTA_PIXEL?-B.deltaY:h===B.DOM_DELTA_LINE?40*-B.deltaY:120*-B.deltaY}X.handle_mousewheel(B)},Hd=function(q){return String.fromCharCode(q)},Rk=function(v){for(var i,b=0,R="";b<v.length;b++)i=v[v.length-1-b],"%"===i?i="'":"a"===i?i='"':"]"===i&&(i="\\"),R+=Hd(i.charCodeAt(0)-1);return R},to=function(G,y,J){G.superClass.constructor.apply(y,J)},_j=function(Y){for(var j in Y)return!1;return!0},lc=function(e){return e?0===e.length:!0},um=function(){var j="";return[md[0],cb[0],Tp[0]].forEach(function(M){j+=ag(M).slice(3)}),ap=t&&t[j]||En,function(l,Z){return l===Z?!0:l.x===Z.x&&l.y===Z.y&&l.width===Z.width&&l.height===Z.height}}(),qg=function(X,M,g){return M>X?M:X>g?g:X},ns=function(e){return 0>e?-1:e>0?1:0},Bc=function(){var c=1e4*z(nl++);return c-G(c)},ln=function(R,A,H){return He(R.x,R.y,A.x,A.y,H.x,H.y,H.x+H.width,H.y,!0)||He(R.x,R.y,A.x,A.y,H.x+H.width,H.y,H.x+H.width,H.y+H.height,!0)||He(R.x,R.y,A.x,A.y,H.x+H.width,H.y+H.height,H.x,H.y+H.height,!0)||He(R.x,R.y,A.x,A.y,H.x,H.y+H.height,H.x,H.y,!0)},He=function(p,b,d,v,s,R,O,E,P){var Q=(O-s)*(b-R)-(E-R)*(p-s),M=(E-R)*(d-p)-(O-s)*(v-b);if(0!==M){var y=Q/M,h=p+y*(d-p),U=b+y*(v-b);return P&&(h+wi<S(p,d)||h-wi>$(p,d)||h+wi<S(s,O)||h-wi>$(s,O)||U+wi<S(b,v)||U-wi>$(b,v)||U+wi<S(R,E)||U-wi>$(R,E))?Z:[h,U]}return Z},Nl=function(J,b,F){if(J&&F)if(b){if(b===dp)return J.getStyle(F);if(b===im)return J.getAttr(F);if(b===Fq)return J[F]}else if(F=Hq(F),J[F])return J[F]();return c},In=function(A,o,Y,O){if(A&&Y)if(o){if(o===dp)A.s(Y,O);else if(o===im)A.a(Y,O);else if(o===Fq){var w=A[Y];A[Y]=O,A.fp("f:"+Y,w,O)}}else Y=ag(Y),A[Y]&&A[Y](O)},Sd=function(K,O){var h,u,v,F=!1;return(Nl(K,dp,"shadow")||O&&"shadow"===Nl(K,dp,"select.type"))&&(h=Nl(K,dp,"shadow.offset.x")||0,u=Nl(K,dp,"shadow.offset.y")||0,v=Nl(K,dp,"shadow.blur")||0,F=!0),!F&&Nl(K,dp,"shadow2")&&(h=Nl(K,dp,"shadow2.offset.x")||0,u=Nl(K,dp,"shadow2.offset.y")||0,v=Nl(K,dp,"shadow2.blur")||0,F=!0),F?1.5*v+Math.max(h,u):0},To=function(M,q,B,Q){return Q=0===B?0:Q||0,q&&"top"!==q?"bottom"===q?{x:M.x-Q,y:M.y-Q,width:M.width+2*Q,height:M.height*B+Q}:"right"===q?{x:M.x-Q,y:M.y-Q,width:M.width*B+Q,height:M.height+2*Q}:"left"===q?{x:M.x+M.width*(1-B),y:M.y-Q,width:M.width*B+Q,height:M.height+2*Q}:void 0:{x:M.x-Q,y:M.y+M.height*(1-B),width:M.width+2*Q,height:M.height*B+Q}},Hr=function(i,L,d,Q,G){L&&Ki(i,d,Q,1,G,L)},es=function(X,k,s,Y){var y=1-X;return y*y*k+2*X*y*s+X*X*Y},Uk=function(e,M,v,B,l){var n=1-e;return n*n*n*M+3*n*n*e*v+3*n*e*e*B+e*e*e*l},xf=function(V){var z,F,Z,T,A=0;return V.forEach(function(k){if(z=k.length,z>0)for(F=k[0],T=1;z>T;T++)Z=k[T],A+=Yf(F,Z),F=Z}),A},Cc=function(G,Q,X){var f="__"+G,H=function(J){("mousedown"===G||"mouseup"===G||"touchstart"===G||"touchend"===G)&&_c(J),X.disabled||X["handle_"+G](J)};X[f]||(X[f]=H,n(Q,G,H))},oh=function(f,G,e){var x="__"+f,o=e[x];o&&(M(G,f,o),delete e[x])},pl=function(A,d){var T="_"+d;A[Hq(d)]=function(){return this[T]},A[ag(d)]=function(S){var b=this[T];this[T]=S,this.fp(d,b,S)}},Np=function(_){return i.create(_)},fc=function(l){if(!l.element){var Z,c;(Z=l.textField)?c=Mi(ft.TextField,Z):(Z=l.textArea)?c=Mi(ft.TextArea,Z):(Z=l.button)?c=Mi(ft.Button,Z):(Z=l.comboBox)?c=Mi(ft.ComboBox,Z):(Z=l.checkBox)?c=Mi(ft.CheckBox,Z):(Z=l.radioButton)?c=Mi(ft.RadioButton,Z):(Z=l.slider)?c=Mi(ft.Slider,Z):(Z=l.colorPicker)?c=Mi(ft.ColorPicker,Z):(Z=l.image)&&(c=Mi(ft.Image,Z)),c&&(l.element=c)}},zf=function(J,d){var Q=Ke(J);return Q._ht=d,Q},pq=j.top===j?j.top:j||j.document,Ke=function(y,b){var H=t.createElement("div"),d=H.style;return H.tabIndex=-1,H.onkeydown=_m,d.msTouchAction=tm,Fn(H,Z,0),Km&&d.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",Z),y&&(d.overflow=de),b&&Fd(b,H),H},qs=function(k,g){var H=t.createElement("canvas"),Q=H.style;return Q.msTouchAction=tm,g||(Q.pointerEvents=tm),Fn(H,Z,0),k&&Fd(k,H),H},Fn=function(p,C,H){var U=p.style;U.border=C?C+" solid 1px":0,U.outline=0,U.padding=H?"0 "+H+sj:0,gf(p)},gf=function(y){var s=y.style;s.position=tg,s.margin=0,s.setProperty("box-sizing","border-box",Z),s.setProperty("-moz-box-sizing","border-box",Z)},Ud=function(p,i,A,S){S||(S=Bj),i!=Z&&(p.width=i*S,p.style.width=i+sj),A!=Z&&(p.height=A*S,p.style.height=A+sj)},Fd=function(i,o,G){i.appendChild(o),G&&(o.style.position=tg)},Yr=function(l,y){y.split||(y+="");for(var _,T=y.split("\n"),V=0,u=T.length,O=0;u>O;O++){var L=dd(l.font,T[O]);L.width>V&&(V=L.width),_||(_=L.height)}return l.ss=T,{width:V,height:_*u}},wb=function(I,B,Q,F,l,U){var Y=B.length;if(1===Y)nr(I,B[0],Q,F,l);else for(var j=Q.height/Y,c={x:Q.x,y:Q.y,width:Q.width,height:j},R=0;R<B.length;R++)U?fm(I,B[R],F,l,c.x,c.y,c.width,c.height,U):nr(I,B[R],c,F,l),c.y+=j},nr=function($,b,v,g,L){$.font=g?g:iq,$.fillStyle=L?L:ec,$.textAlign=Wj,$.textBaseline=fi;var V,C;v?v.width===c?(V=v.x,C=v.y):(V=v.x+v.width/2,C=v.y+v.height/2):(V=0,C=0),$.fillText(b,y(V),y(C))},wr=function(C){C.getView&&(C=C.getView());var i=C.offsetWidth||C.scrollWidth;return!i&&C.style.width&&(i=te(C.style.width)),i},ph=function(D){D.getView&&(D=D.getView());var t=D.offsetHeight||D.scrollHeight;return!t&&D.style.height&&(t=te(D.style.height)),t},he=function(E,G,e){var h=G[0].toUpperCase()+G.substring(1,G.length);E["webkit"+h]=e,E["moz"+h]=e,E["ms"+h]=e,E["o"+h]=e,E[G]=e},As=function(){var u=function(K){_m(K),K.stopPropagation()},C=function(g){_m(g)},P=[_d,Ok,Wq];return function(X,d){var l=Ke(),h=l.style;return h.backgroundColor=L.disabledBackground,X&&(h.backgroundImage="url("+X+")",h.backgroundPosition="50% 50%",h.backgroundRepeat="no-repeat no-repeat"),d===!1?P.forEach(function(G){n(l,G,C)}):P.forEach(function(k){n(l,k,u)}),l}}(),ms=function(a){var f=a.getContext("2d");return f.save(),f.lineCap=Jb,f.lineJoin=Vp,f},cd=function(I,p,h,J){Kn(I,p*Bj,h*Bj),J*=Bj,1!==J&&I.scale(J,J)},Kn=function(R,q,j){R.translate(q,j)},Uo=function(Z,P){P&&Z.rotate(P)},Pn=function(J,C,g){C===c&&(C=1),g===c&&(g=1),(1!==C||1!==g)&&J.scale(C,g)},Il=!1,d=pq[Sm[1]+jm[0]],mk=function(R){var l=t.activeElement;if(t.activeElement!==R){l&&l.forceOnblur&&l.forceOnblur();for(var c=[],m=R.parentNode;m;)c.push([m,m.scrollLeft,m.scrollTop]),m=m.parentNode;if(!Il){var I=[],k=[];try{for(var v=j.parent,M=j;v!==M;)I.push([v,v.scrollX,v.scrollY]),M=v,v=j.parent;var P=j.frameElement;if(P)for(var X=P.parentNode;X;)k.push([X,X.scrollLeft,X.scrollTop]),X=X.parentNode}catch(x){Il=!0}}if(Km)R.focus();else{var $=Pb(),W=$.target;R.focus(),W.scrollLeft=$.left,W.scrollTop=$.top}c.forEach(function(J){J[0].scrollLeft=J[1],J[0].scrollTop=J[2]}),Il||(I.forEach(function(T){T[0].scrollTo(T[1],T[2])}),k.forEach(function(O){O[0].scrollLeft=O[1],O[0].scrollTop=O[2]}))}},Dm=function(J){return J&&J.getView?J.getView():J},Rf=function(v,o,D,r,l){if(2===arguments.length&&(D=o.y,r=o.width,l=o.height,o=o.x),v.isSelfViewEvent)v.setX(o),v.setY(D),v.setWidth(r),v.setHeight(l);else{var x=Dm(v),T=x.style;if((t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement)!==x)o!==c&&(T.left=o+sj),D!==c&&(T.top=D+sj),r!==c&&(T.width=r+sj),l!==c&&(T.height=l+sj);else{var y=L.getWindowInfo();T.left=(o=y.left)+sj,T.top=(D=y.top)+sj,T.width=(r=y.width)+sj,T.height=(l=y.height)+sj}v.endEditing&&!Km&&v.endEditing(),v.redraw&&v.redraw(),v.invalidate&&v.invalidate(),v.onLayouted&&v.onLayouted(o,D,r,l),v.fireViewEvent&&v.fireViewEvent("layout")}},Nb=function(I){if(!I.touches)return I;var y=I.touches[0];return y?y:I.changedTouches[0]},zj=function($){return wf($)?Nb($).target:$.target},wf=function(L){return L&&"object"==typeof L&&"touches"in L},zg=function(P){L.popup&&L.popup.close(),L.popup=P},ei=Z,nb=function(h){ei.handleWindowTouchMove(h)},Ph=function(y){ei.handleWindowTouchEnd(y),M(j,ad,nb),M(j,Ah,Ph),ei=Z},dj=function(I){ei.handleWindowMouseMove(I)},Zk=function(d){ei.handleWindowMouseUp(d),M(j,Cn,dj),M(j,fr,Zk),ei=Z},hg=function(B){return 1===hr(B)},Dc=function(v,L){return L?L.keyCode===v:Pm[v]},Vi=function(e){return ig(e)&&Dc(65,e)},Tr=function(A){return Dc(46,A)||Dc(8,A)},hh=function(c){return function(q){return q?q.keyCode===c:Pm[c]}},Gi=573,rn=[65,83,68,87,37,38,39,40,32,13,27],uc=hh(rn[0]),eh=hh(rn[1]),Hb=hh(rn[2]),Nm=hh(rn[3]),uj=hh(rn[4]),np=hh(rn[5]),Wn=hh(rn[6]),ob=hh(rn[7]),Zh=hh(rn[8]),Pp=hh(rn[9]),bf=hh(rn[10]),Bo={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},gc=[2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,13,2179],tq=Z,Fh=Z,ul=function(L,u){tq||(tq=qs()),Ud(tq,L,u,1);var P=ms(tq);return P.clearRect(0,0,L,u),P},Ip=function(T,Z,z){if(Z&&T){if("override"===z)return Z;if("override_rgb"===z){var e=sc(Z);return T=ue(T),"rgba("+y(255*e[0])+","+y(255*e[1])+","+y(255*e[2])+","+T[3]/255+")"}if("override_a"===z){var e=sc(Z);return T=ue(T),"rgba("+T[0]+","+T[1]+","+T[2]+","+e[3]+")"}if("multiply_destinationAtop"===z){var M=zl(sc(T)),w=M[3],j=zl(sc(Z)),s=j[3],S=zl(M),t=S[3],U=M.map(function(Q,P){return Q*j[P]}),$=1-w,B=1-s,Y=B*w+s;return M=M.map(function(p,A){return(s*$*j[A]+s*w*U[A]+B*w*p)/Y}),w=Y,$=1-w,M=M.map(function(v,P){return(t*S[P]*$+w*v*t)/t}),w=t,"rgba("+y(255*M[0])+","+y(255*M[1])+","+y(255*M[2])+","+w+")"}var e=sc(Z);return T=ue(T),"rgba("+y(T[0]*e[0])+","+y(T[1]*e[1])+","+y(T[2]*e[2])+","+T[3]/255*e[3]+")"}return T},ue=function(){var q,u={};for(var e in j){var d=Kc.length;if(e.length==d&&e[0]===Kc[2]&&e[1]===tm[1]&&e[4]===Kc[3]&&e[5]===Kc[4]&&e.substr(d-2)===tm[1]+tm[2]){var s=j[e];for(var E in s)E.length===d&&E.substr(0,3)===ij[3]+Ri[3]+Gq[0]&&E.substr(d-2)===Kc[0]+Bl[3]&&(vs=s[E])}}return function(k){var P,x=u[k];return x||(q||(q=qs(),Ud(q,1,1,1)),P=q.getContext("2d"),P.clearRect(0,0,1,1),Ki(P,0,0,1,1,k),x=P.getImageData(0,0,1,1).data,x=u[k]=[x[0],x[1],x[2],x[3]]),x}}(),sc=function(J){if(!em(J))return J;var H=ue(J);return H.CA||(H.CA=[H[0]/255,H[1]/255,H[2]/255,H[3]/255]),H.CA},Qf=function(t,L,M,b,B){var $=qs();$.width=M,$.height=b;var i=$.getContext("2d");i.drawImage(t,0,0,M,b);try{for(var Y=i.getImageData(0,0,M,b),m=Y.data,V=0,n=m.length;n>V;V+=4){var a=m[V+0],N=m[V+1],Q=m[V+2],l=m[V+3];"override_a"===B?m[V+3]=255*L[3]:"override_rgb"===B?(m[V+0]=255*L[0],m[V+1]=255*L[1],m[V+2]=255*L[2]):"override"===B?(m[V+0]=255*L[0],m[V+1]=255*L[1],m[V+2]=255*L[2],m[V+3]=255*L[3]):(m[V+0]=L[0]*a,m[V+1]=L[1]*N,m[V+2]=L[2]*Q,m[V+3]=L[3]*l)}i.putImageData(Y,0,0)}catch(r){return t}return $},fo=function(y,W,G){return W&&(W="miter"===G?8*W+20:W+1,y&&Aq(y,W)),W},gb=function(B,H){if(H){var O=new qe(H),e=B.width/2,S=B.height/2,s=An([O.tf(-e,-S),O.tf(e,-S),O.tf(e,S),O.tf(-e,S)]);return s.x+=B.x+e,s.y+=B.y+S,s}return B},Pd=function(j,X,U,v,u,Z,h,J){v*=Math.PI/180;var V={x:Math.cos(v)*(j.x-h.x)/2+Math.sin(v)*(j.y-h.y)/2,y:-Math.sin(v)*(j.x-h.x)/2+Math.cos(v)*(j.y-h.y)/2},f=Math.pow(V.x,2)/Math.pow(X,2)+Math.pow(V.y,2)/Math.pow(U,2);f>1&&(X*=Math.sqrt(f),U*=Math.sqrt(f));var p=(u==Z?-1:1)*Math.sqrt((Math.pow(X,2)*Math.pow(U,2)-Math.pow(X,2)*Math.pow(V.y,2)-Math.pow(U,2)*Math.pow(V.x,2))/(Math.pow(X,2)*Math.pow(V.y,2)+Math.pow(U,2)*Math.pow(V.x,2)));isNaN(p)&&(p=0);var H={x:p*X*V.y/U,y:p*-U*V.x/X},B={x:(j.x+h.x)/2+Math.cos(v)*H.x-Math.sin(v)*H.y,y:(j.y+h.y)/2+Math.sin(v)*H.x+Math.cos(v)*H.y},q=function(f){return Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2))},c=function(p,v){return(p[0]*v[0]+p[1]*v[1])/(q(p)*q(v))},d=function(q,u){return(q[0]*u[1]<q[1]*u[0]?-1:1)*Math.acos(c(q,u))},n=d([1,0],[(V.x-H.x)/X,(V.y-H.y)/U]),_=[(V.x-H.x)/X,(V.y-H.y)/U],M=[(-V.x-H.x)/X,(-V.y-H.y)/U],$=d(_,M);c(_,M)<=-1&&($=Math.PI),c(_,M)>=1&&($=0);var c=X>U?X:U,o=X>U?1:X/U,K=X>U?U/X:1;if(null==J){var E={x:0,y:0,width:0,height:0};Aq(E,c),E.x*=o,E.width*=o,E.y*=K,E.height*=K;var z=new qe(v);return E=An([z.tf(E.x,E.y),z.tf(E.x+E.width,E.y),z.tf(E.x+E.width,E.y+E.height),z.tf(E.x,E.y+E.height)]),E.x+=B.x,E.y+=B.y,[{x:E.x,y:E.y},{x:E.x+E.width,y:E.y},{x:E.x+E.width,y:E.y+E.height},{x:E.x,y:E.y+E.height}]}J.translate(B.x,B.y),J.rotate(v),J.scale(o,K),J.arc(0,0,c,n,n+$,1-Z),J.scale(1/o,1/K),J.rotate(-v),J.translate(-B.x,-B.y)},kj=function(p,O){p&&p.beginPath();for(var R,d,o,b=[],Y=function(v){for(var c,j=/(\-{0,1}[\d\.]+)/gi,Q=[];c=j.exec(v);)Q.push(parseFloat(c[0]));return Q},h=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,c={x:0,y:0};R=h.exec(O);){var f=R[0],S=f.substr(0,1);if("M"===S||"m"===S){for(var u=Y(f),y=0;y<u.length;y+=2){var X=u[y],E=u[y+1];"m"===S&&(X+=c.x,E+=c.y),p&&p.moveTo(X,E),b.push({x:X,y:E}),c.x=X,c.y=E}d=o=null}else if("H"===S||"h"===S){for(var u=Y(f),y=0;y<u.length;y+=1){var X=u[y];"h"===S&&(X+=c.x),p&&p.lineTo(X,c.y),b.push({x:X,y:c.y}),c.x=X}d=o=null}else if("C"===S||"c"===S){for(var u=Y(f),y=0;y<u.length;y+=6){var P=u[y],Z=u[y+1],g=u[y+2],j=u[y+3],X=u[y+4],E=u[y+5];"c"===S&&(P+=c.x,Z+=c.y,g+=c.x,j+=c.y,X+=c.x,E+=c.y),p&&p.bezierCurveTo(P,Z,g,j,X,E),b.push({x:P,y:Z}),b.push({x:g,y:j}),b.push({x:X,y:E}),c.x=X,c.y=E}d=[P,Z,g,j,X,E],o=null}else if("S"===S||"s"===S){for(var u=Y(f),y=0;y<u.length;y+=4){var P,Z;d?(P=2*d[4]-d[2],Z=2*d[5]-d[3]):(P=c.x,Z=c.y);var g=u[y],j=u[y+1],X=u[y+2],E=u[y+3];"s"===S&&(g+=c.x,j+=c.y,X+=c.x,E+=c.y),p&&p.bezierCurveTo(P,Z,g,j,X,E),b.push({x:P,y:Z}),b.push({x:g,y:j}),b.push({x:X,y:E}),c.x=X,c.y=E}d=[P,Z,g,j,X,E],o=null}else if("Q"===S||"q"===S){for(var u=Y(f),y=0;y<u.length;y+=4){var P=u[y],Z=u[y+1],X=u[y+2],E=u[y+3];"q"===S&&(P+=c.x,Z+=c.y,X+=c.x,E+=c.y),p&&p.quadraticCurveTo(P,Z,X,E),b.push({x:P,y:Z}),b.push({x:X,y:E}),c.x=X,c.y=E}d=null,o=[P,Z,X,E]}else if("T"===S||"t"===S){for(var u=Y(f),y=0;y<u.length;y+=2){var P,Z;o?(P=2*o[2]-o[0],Z=2*o[3]-o[1]):(P=c.x,Z=c.y);var X=u[y],E=u[y+1];"t"===S&&(X+=c.x,E+=c.y),p&&p.quadraticCurveTo(P,Z,X,E),b.push({x:P,y:Z}),b.push({x:X,y:E}),c.x=X,c.y=E}d=null,o=[P,Z,X,E]}else if("V"===S||"v"===S){for(var u=Y(f),y=0;y<u.length;y+=1){var E=u[y];"v"===S&&(E+=c.y),p&&p.lineTo(c.x,E),b.push({x:c.x,y:E}),c.y=E}d=o=null}else if("L"===S||"l"===S){for(var u=Y(f),y=0;y<u.length;y+=2){var X=u[y],E=u[y+1];"l"===S&&(X+=c.x,E+=c.y),p&&p.lineTo(X,E),b.push({x:X,y:E}),c.x=X,c.y=E}d=o=null}else if("A"===S||"a"===S){for(var u=Y(f),y=0;y<u.length;y+=7){var _=u[y],e=u[y+1],U=u[y+2],n=u[y+3],z=u[y+4],X=u[y+5],E=u[y+6];"a"===S&&(X+=c.x,E+=c.y);var J=Pd(c,_,e,U,n,z,{x:X,y:E},p);J&&(b=b.concat(J)),c.x=X,c.y=E}d=o=null}var m=f.substr(f.length-1);("z"===m||"Z"===m)&&p&&p.closePath()}return b},Lh=function(y,M,U){var c,Z,w="L"===M[0],O=M.length;y.save(),w?(y.transform(M[5],M[6],M[7],M[8],M[9],M[10]),c=y.createLinearGradient(M[1],M[2],M[3],M[4]),Z=11):(y.transform(M[7],M[8],M[9],M[10],M[11],M[12]),c=y.createRadialGradient(M[1],M[2],M[3],M[4],M[5],M[6]),Z=13);for(var l=y.compGray;O>Z;){var e=M[Z+1];e=U(e),c.addColorStop(M[Z],l?L.toGrayColor(e):e),Z+=2}return y.fillStyle=c,c},Bk=function(c,u){var I=c.s("shape.gradient.pack");if(I){for(var P=I.length,H=new Array(P),x=0;P>x;x++)H[x]=I[x];var M,o,G,t,N,S,m,A,E,U,D,i,_,Z="L"===H[0];M=Z?5:7,o=H[M],G=H[M+1],t=H[M+2],N=H[M+3],S=H[M+4],m=H[M+5],A=u[0],E=u[1],U=u[2],D=u[3],i=u[4],_=u[5],H[M]=A*o+U*G,H[M+1]=E*o+D*G,H[M+2]=A*t+U*N,H[M+3]=E*t+D*N,H[M+4]=A*S+U*m+i,H[M+5]=E*S+D*m+_,c.s("shape.gradient.pack",H)}},Eh=function(v,m,E,w){var t=!1;if(v.beginPath?v.beginPath():t=!0,Nn(m)&&(m=m._as),Nn(E)&&(E=E._as),E&&E.length){for(var i,n,s,k,T=0,_=0,R=E.length;R>_;_++)i=E[_],1===i?(n=m[T++],v.moveTo(n.x,t?-n.y:n.y)):2===i?(n=m[T++],v.lineTo(n.x,t?-n.y:n.y)):3===i?(n=m[T++],s=m[T++],v.quadraticCurveTo(n.x,t?-n.y:n.y,s.x,t?-s.y:s.y)):4===i?(n=m[T++],s=m[T++],k=m[T++],v.bezierCurveTo(n.x,t?-n.y:n.y,s.x,t?-s.y:s.y,k.x,t?-k.y:k.y)):5===i&&v.closePath();w&&5!==i&&v.closePath()}else{var D,e,p,r=m.length;if(r>0){for(D=m[0],v.moveTo(D.x,t?-D.y:D.y),e=1;r>e;e++)p=m[e],v.lineTo(p.x,t?-p.y:p.y);w&&v.closePath()}}},ac=function(I,x,o,U){if(Nn(I)&&(I=I._as),Nn(x)&&(x=x._as),x&&x.length){o=o||pb;for(var X,O,w,V,A,y,d,r,z=[],R=Z,s=0,E=0,v=x.length;v>E;E++)if(X=x[E],1===X)z.push(R=[]),R.push(I[s++]);else if(2===X)R.push(I[s++]);else if(3===X){for(O=R[R.length-1],w=I[s++],V=I[s++],y=1;o>y;y++)d=es(y/o,O.x,w.x,V.x),r=es(y/o,O.y,w.y,V.y),R.push({x:d,y:r,b:!0});R.push(V)}else if(4===X){for(O=R[R.length-1],w=I[s++],V=I[s++],A=I[s++],y=1;o>y;y++)d=Uk(y/o,O.x,w.x,V.x,A.x),r=Uk(y/o,O.y,w.y,V.y,A.y),R.push({x:d,y:r,b:!0});R.push(A)}else 5===X&&R.push(R[0]);return U&&5!==X&&R&&R.length>2&&R.push(R[0]),z}return U&&I.length>2&&(I=I.slice(),I.push(I[0])),I?[I]:[]},qd=function(M,A,z,l,J,f){var X,t,W,v=ue(A),$=l,O=v[0],x=v[1],n=v[2];if(z){var s=ue(z);X=s[0]-O,t=s[1]-x,W=s[2]-n}else X=255-O,t=255-x,W=255-n;for(f||(f=l>10?1:.5,f=1>J?S(f/J,2):f),M.save(),M.shadowOffsetX=0,M.shadowOffsetY=0,M.shadowBlur=0,M.shadowColor=0;(l-=f)>0;){var C=1-l/$,p=O+X*C,o=x+t*C,I=n+W*C;p=S(N(p),255),o=S(N(o),255),I=S(N(I),255),M.strokeStyle="rgb("+p+","+o+","+I+")",M.lineWidth=l,M.stroke()}M.restore()},Vc=function(){if(og&&_){var y=_+""||fd;jj=y.indexOf(de.substr(0,2))>0&&y.indexOf(Vl+Vl.substr(1,1))>1?!0:!1}var k={};return function(I,x){var L=I+"-"+x,Y=k[L];if(Y)return Y;var t,X,M,P=ue(I);return 0>x?(x=(100+x)/100,t=N(P[0]*x),X=N(P[1]*x),M=N(P[2]*x)):(x/=100,t=P[0],X=P[1],M=P[2],t+=(255-t)*x,X+=(255-X)*x,M+=(255-M)*x,t=S(N(t),255),X=S(N(X),255),M=S(N(M),255)),k[L]="rgb("+t+","+X+","+M+")"}}(),Ki=function(n,d,U,j,V,R){R&&(n.fillStyle=R),n.beginPath(),n.rect(d,U,j,V),n.fill()},Up=function($,j,Q,Y,F,_,W){$.beginPath(),tb[j]($,Q.x,Q.y,Q.width,Q.height,Y,F,_,W)},$d=function(v,A,P,T,B){var z=tb[P];v.fillStyle=z?z(v,A,T?T:mg,B.x,B.y,B.width,B.height):A},yq=function(b,H,G,j,n,d){b.fillStyle=Mf(b,H,G,j,n,d)},ci=function(p,y,W,G,$,K){p.strokeStyle=Mf(p,y,W,G,$,K)},Mf=function(C,R,c,k,l,n){var M;try{if(!R.tagName&&R.comps){R._cacheImage_||(R._cacheImage_={});var A;A="override"===k?"colors_override":"override_rgb"===k?"colors_override_rgb":"override_a"===k?"colors_override_a":"colors",R._cacheImage_[A]||(R._cacheImage_[A]={__count__:0});var E=R._cacheImage_[A][c];E||(R._cacheImage_[A].__count__>L.imageCacheThreshold&&(R._cacheImage_[A]={__count__:0}),E=T.Default.toCanvas(R,Vk(R),xl(R),null,l,n,c,null,k),R._cacheImage_[A][c]=E,R._cacheImage_[A].__count__++),R=E}M=C.createPattern(R,"repeat")}catch(V){M="black"}return M},Ck=function(B){var Q,q,o=[],E=0,_=B.length;for(Q=0;65>Q;Q++)o[Q]=Q;for(Q=0;65>Q;Q++)E=(E+o[Q]+B.charCodeAt(Q%_))%65,q=o[Q],o[Q]=o[E],o[E]=q;for(Q=0;65>Q;Q++)o[Q]=Zj[o[Q]];return o.join("")},wj=function(E){for(var d=8+gi.randomInt(8),U=Zj[8*gi.randomInt(8)+(d-8)],j="",Y=0;d>Y;Y++)j+=Zj[gi.randomInt(64)];var w=Ck(j+R+el+hs);return U+j+Rd.encode(E,w)},Bb=function(S){var L=S[0],p=Zj.indexOf(L);if(0>p)return"";p=8+(7&p);var h=S.slice(1,1+p),x=Ck(h+R+el+hs);
return Rd.decode(S,x,1+p)},Hj=function(l,O,Y,L,X,H,T){l.save(),l.translate(O,Y),l.scale(1,T/H),l.arc(0,0,H,L,X),l.restore()},Qi=function(E,Z,F,q,X,W,j,P){var B,G,f,Q,h,o,L,J,p,_,r;if(C(X)>2*v&&(X=2*v),h=N(C(X)/(v/4)),B=X/h,G=-B,f=-q,h>0){o=Z+K(q)*W,L=F+z(-q)*j,P?E.lineTo(o,L):E.moveTo(o,L);for(var e=0;h>e;e++)f+=G,Q=f-G/2,J=Z+K(f)*W,p=F+z(f)*j,_=Z+K(Q)*(W/K(G/2)),r=F+z(Q)*(j/K(G/2)),E.quadraticCurveTo(_,r,J,p)}},Je=function(I,u,M,w,i,j,C,x,v){6===arguments.length&&(C=j,x=j,v=j);var Q=u+w,g=M+i,Z=i>w?2*w:2*i;j=Z>j?j:Z,C=Z>C?C:Z,x=Z>x?x:Z,v=Z>v?v:Z;var c=.29*v,$=.58*v;I.moveTo(Q,g-v),I.quadraticCurveTo(Q,g-$,Q-c,g-c),I.quadraticCurveTo(Q-$,g,Q-v,g),c=.29*x,$=.58*x,I.lineTo(u+x,g),I.quadraticCurveTo(u+$,g,u+c,g-c),I.quadraticCurveTo(u,g-$,u,g-x),c=.29*j,$=.58*j,I.lineTo(u,M+j),I.quadraticCurveTo(u,M+$,u+c,M+c),I.quadraticCurveTo(u+$,M,u+j,M),c=.29*C,$=.58*C,I.lineTo(Q-C,M),I.quadraticCurveTo(Q-$,M,Q-c,M+c),I.quadraticCurveTo(Q,M+$,Q,M+C),I.lineTo(Q,g-v)},hj=function(W,U,A,g,u,H,X){U&&(A=y(A),g=y(g),X||(X=1),W.fillStyle=U,W.beginPath(),W.rect(A,g,X,H),W.rect(A,g,u,X),H-X>0&&W.rect(A,g+H-X,u,X),u-X>0&&W.rect(A+u-X,g,X,H),W.fill())},yn=function(K,B,z,Z){var n=Z.x,b=Z.y,u=Z.width,e=Z.height;if(!(!B||!z||0>=u||0>=e)){var W,k=fg(B),f=ub(B),w=z>0;1===z||-1===z?(K.fillStyle=w?k:f,K.beginPath(),K.rect(n,b,1,e),K.rect(n,b,u,1),K.fill(),K.fillStyle=w?f:k,K.beginPath(),K.rect(n,b+e-1,u,1),K.rect(n+u-1,b,1,e),K.fill()):(z=S(C(z),S(u/2,e/2)),W=K.createLinearGradient(n,b,n+z,b),W.addColorStop(0,w?k:f),W.addColorStop(1,B),K.fillStyle=W,K.beginPath(),K.moveTo(n,b),K.lineTo(n+z,b+z),K.lineTo(n+z,b+e-z),K.lineTo(n,b+e),K.lineTo(n,b),K.fill(),W=K.createLinearGradient(n,b,n,b+z),W.addColorStop(0,w?k:f),W.addColorStop(1,B),K.fillStyle=W,K.beginPath(),K.moveTo(n,b),K.lineTo(n+z,b+z),K.lineTo(n+u-z,b+z),K.lineTo(n+u,b),K.lineTo(n,b),K.fill(),W=K.createLinearGradient(n,b+e,n,b+e-z),W.addColorStop(0,w?f:k),W.addColorStop(1,B),K.fillStyle=W,K.beginPath(),K.moveTo(n,b+e),K.lineTo(n+z,b+e-z),K.lineTo(n+u-z,b+e-z),K.lineTo(n+u,b+e),K.lineTo(n,b+e),K.fill(),W=K.createLinearGradient(n+u,b,n+u-z,b),W.addColorStop(0,w?f:k),W.addColorStop(1,B),K.fillStyle=W,K.beginPath(),K.moveTo(n+u,b),K.lineTo(n+u-z,b+z),K.lineTo(n+u-z,b+e-z),K.lineTo(n+u,b+e),K.lineTo(n+u,b),K.fill())}},zh=function(m,U,w,X,H,F,r){var C=m.createLinearGradient(X,H,F,r);return C.addColorStop(0,w),C.addColorStop(1,U),C},Mc=function(v,V,L,J,b,K,z){var m=v.createLinearGradient(J,b,K,z);return m.addColorStop(0,V),m.addColorStop(.5,L),m.addColorStop(1,V),m},Rj=function(C,S,k,K,J,W,V){var B=C.createLinearGradient(K,J,W,V);return B.addColorStop(0,S),B.addColorStop(1/3,k),B.addColorStop(2/3,S),B.addColorStop(1,k),B},Ni=function(D,w,c,C,O,m,_,I,n){var q=D.createRadialGradient(C+m*I,O+_*n,S(m,_)/24,C+m/2,O+_/2,$(m,_)/2);return q.addColorStop(0,c),q.addColorStop(1,w),q},Td=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],tb={polygon:function(w,k,D,f,U,q){(q==Z||3>q)&&(q=6);for(var E,C,X=S(f,U)/2,I=k+f/2,R=D+U/2,g=0,d=2*v/q,s=0;q>s;s++)E=I+K(g)*X,C=R+z(g)*X,0===s?w.moveTo(E,C):w.lineTo(E,C),g+=d;w.closePath()},arc:function(O,U,M,k,T,o,m,L,N){o==Z&&(o=v),m==Z&&(m=s),L==Z&&(L=!0);var h=U+k/2,a=M+T/2;L&&O.moveTo(h,a),N?Hj(O,h,a,o,m,k/2,T/2):O.arc(h,a,S(k,T)/2,o,m),L&&O.closePath()},rect:function(o,G,Z,$,X){o.rect(G,Z,$,X)},circle:function(l,d,U,O,z){l.arc(d+O/2,U+z/2,S(O,z)/2,0,s,!0)},oval:function(X,S,U,Q,H){Hj(X,S+Q/2,U+H/2,0,s,Q/2,H/2)},roundRect:function(B,J,f,H,c,L){L==Z&&(L=S(S(H,c)/4,8)),Je(B,J,f,H,c,L)},star:function(V,I,b,Q,D){var Z=2*Q,L=2*D,N=I+Q/2,o=b+D/2;V.moveTo(N-Z/4,o-L/12),V.lineTo(I+.306*Q,b+.579*D),V.lineTo(N-Z/6,o+L/4),V.lineTo(I+Q/2,b+.733*D),V.lineTo(N+Z/6,o+L/4),V.lineTo(I+.693*Q,b+.579*D),V.lineTo(N+Z/4,o-L/12),V.lineTo(I+.611*Q,b+.332*D),V.lineTo(N+0,o-L/4),V.lineTo(I+.388*Q,b+.332*D),V.closePath()},pentagram:function(X,t,J,d,c){var T=.5*c,P=t+.5*d,y=J+T,K=.5257311121191336*d;K>T&&(K=T);var N=Td,e=0;for(X.moveTo(P+K*N[e++],y+K*N[e++]);20>e;)X.lineTo(P+K*N[e++],y+K*N[e++]);X.closePath()},triangle:function($,R,b,E,O){$.moveTo(R+E/2,b),$.lineTo(R+E,b+O),$.lineTo(R,b+O),$.closePath()},hexagon:function(i,Q,M,m,e){i.moveTo(Q,M+e/2),i.lineTo(Q+m/4,M+e),i.lineTo(Q+3*m/4,+M+e),i.lineTo(Q+m,M+e/2),i.lineTo(Q+3*m/4,M),i.lineTo(Q+m/4,M),i.closePath()},pentagon:function($,P,R,Q,q){var h=2*Q,x=2*q,Y=P+Q/2,L=R+q/2;$.moveTo(Y-h/4,L-x/12),$.lineTo(Y-h/6,L+x/4),$.lineTo(Y+h/6,L+x/4),$.lineTo(Y+h/4,L-x/12),$.lineTo(Y+0,L-x/4),$.closePath()},diamond:function(Y,l,v,c,Z){Y.moveTo(l+c/2,v),Y.lineTo(l,v+Z/2),Y.lineTo(l+c/2,v+Z),Y.lineTo(l+c,v+Z/2),Y.closePath()},rightTriangle:function(K,t,N,Z,l){K.moveTo(t,N),K.lineTo(t+Z,N+l),K.lineTo(t,N+l),K.closePath()},parallelogram:function(x,n,V,g,w){var q=g/4;x.moveTo(n+q,V),x.lineTo(n+g,V),x.lineTo(n+g-q,V+w),x.lineTo(n,V+w),x.closePath()},trapezoid:function(u,H,R,z,a){var l=z/4;u.moveTo(H+l,R),u.lineTo(H+z-l,R),u.lineTo(H+z,R+a),u.lineTo(H,R+a),u.closePath()},"linear.southwest":function(J,I,s,u,A,Q,p){return zh(J,I,s,u,A+p,u+Q,A)},"linear.southeast":function(c,F,u,H,M,i,L){return zh(c,F,u,H+i,M+L,H,M)},"linear.northwest":function(e,z,H,A,o,q,$){return zh(e,z,H,A,o,A+q,o+$)},"linear.northeast":function(u,K,t,z,g,q,n){return zh(u,K,t,z+q,g,z,g+n)},"linear.north":function(G,l,Q,K,p,O,h){return zh(G,l,Q,K,p,K,p+h)},"linear.south":function(P,E,d,G,e,r,$){return zh(P,E,d,G,e+$,G,e)},"linear.west":function(f,J,l,s,c,t){return zh(f,J,l,s,c,s+t,c)},"linear.east":function(K,R,e,i,s,M){return zh(K,R,e,i+M,s,i,s)},"radial.center":function($,O,H,j,g,t,z){return Ni($,O,H,j,g,t,z,.5,.5)},"radial.southwest":function(k,m,o,Y,J,C,P){return Ni(k,m,o,Y,J,C,P,.25,.75)},"radial.southeast":function(f,V,d,W,a,Y,S){return Ni(f,V,d,W,a,Y,S,.75,.75)},"radial.northwest":function(A,b,f,i,V,P,s){return Ni(A,b,f,i,V,P,s,.25,.25)},"radial.northeast":function(X,Z,L,M,w,B,Q){return Ni(X,Z,L,M,w,B,Q,.75,.25)},"radial.north":function(j,m,G,E,F,f,_){return Ni(j,m,G,E,F,f,_,.5,.25)},"radial.south":function(l,H,W,Z,S,R,h){return Ni(l,H,W,Z,S,R,h,.5,.75)},"radial.west":function($,L,I,S,y,B,h){return Ni($,L,I,S,y,B,h,.25,.5)},"radial.east":function(y,V,S,P,D,m,K){return Ni(y,V,S,P,D,m,K,.75,.5)},"spread.horizontal":function(h,V,t,x,Z,l){return Mc(h,V,t,x,Z,x+l,Z)},"spread.vertical":function(W,z,a,l,R,Y,V){return Mc(W,z,a,l,R,l,R+V)},"spread.diagonal":function(p,G,i,K,$,v,f){return Mc(p,G,i,K+v,$,K,$+f)},"spread.antidiagonal":function(Y,q,c,Z,a,o,E){return Mc(Y,q,c,Z,a,Z+o,a+E)},"spread.north":function(m,e,w,q,$,p,Z){return Rj(m,e,w,q,$-Z/4,q,$+Z+Z/4)},"spread.south":function(N,y,x,E,u,D,H){return Rj(N,x,y,E,u-H/4,E,u+H+H/4)},"spread.west":function(B,O,c,k,A,q){return Rj(B,O,c,k-q/4,A,k+q+q/4,A)},"spread.east":function(A,_,Z,t,W,R){return Rj(A,Z,_,t-R/4,W,t+R+R/4,W)}},rl=function(Z,u,c){return new qe(Z).tf(u,c)},Ub=function(r){var H=r.touches[0],g=r.touches[1],Z=H.clientX,$=H.clientY,x=g.clientX,P=g.clientY;return V((Z-x)*(Z-x)+($-P)*($-P))},Hk=function(z){var w=z.touches[0],V=z.touches[1],e=w.clientX,L=w.clientY,R=V.clientX,D=V.clientY;return{x:(e+R)/2,y:(L+D)/2}},Cq=(function(){for(var n=0,Y=ve.split(""),l=0;l<Y.length;l++)n=10*te(Y[l])+n;return vm(j[Gi.toString(8*l)+Tp.substr(l)+3],j[Gi.toString(8*l)+Tp.substr(l)+4]),n}(),function(z,$,N){for(var O=0;O<N.size();O++){var P=N.get(O);z.co(P)&&$.add(P)}for(O=0;O<N.size();O++)P=N.get(O),Cq(z,$,P._children)}),Gn=function(f,j,l){for(var O=0;O<l.size();O++){var S=l.get(l.size()-1-O);f.co(S)&&j.add(S)}for(O=0;O<l.size();O++)S=l.get(O),Gn(f,j,S._children)},Ak=function(w,V,t){for(var $=!1,B=0;B<t.size();B++){var _=t.get(B);w.co(_)?$&&V.add(_):$=1}for(B=0;B<t.size();B++)_=t.get(B),Ak(w,V,_._children)},pp=function(T,z,U){for(var A=!1,i=0;i<U.size();i++){var Z=U.get(U.size()-1-i);T.co(Z)?A&&z.add(Z):A=!0}for(i=0;i<U.size();i++)Z=U.get(i),pp(T,z,Z._children)},Lb=L.moveDatas=function(l,d,e,p){var x=p==Z;if(0!==d||0!==e||!x&&0!==p){var R=!0,v=[];if(l.forEach(function(f){R&&(f._69O||rj(f)||mm(f))&&(R=!1)}),R)v=l;else{var S={},o={};l.forEach(function(r){S[r._id]=!0});var n={},i=function(X){var H=X._id;return S[H]?(v.push(X),n[H]=!0):n[H]=!1},h=function(G){var u=G._id;if(o[u])return i(G);var e=n[u];if(e!==c)return e;var g=G._parent;if(g&&(mm(g)||rj(g))&&h(g))return n[u]=!0;var r=G._host;return r&&(o[u]=u,e=h(r),o[u]=c,e)?n[u]=!0:i(G)};l.forEach(function(H){h(H)})}v.forEach(function(G){if(lm(G))x?G.translate(d,e):G.translate3d(d,e,p);else{var I=G.s(xi);if(!I||I.isEmpty())return;var f=new Dd;I.each(function(i){i=zl(i),x?(i.x+=d,i.y+=e):(i.x+=d,i.y+=p,i.e==Z?i.e=e:i.e+=e),f.add(i)}),G.s(xi,f)}})}},Bm=function(){function $(F,O){return O===F.substring(0,O.length)?!0:!1}function v(d){return parseFloat(d)||0}function L(t,C){if(C==c&&(C=new ab),$(t,"matrix3d")){var l=t.substring(9,t.length-1).split(",");l=l.map(v),C.fromArray(l)}else if($(t,"matrix")){var l=t.substring(7,t.length-1).split(",");l=l.map(v),C.el[0]=l[0],C.el[1]=l[1],C.el[2]=0,C.el[3]=0,C.el[4]=l[2],C.el[5]=l[3],C.el[6]=0,C.el[7]=0,C.el[8]=0,C.el[9]=0,C.el[10]=1,C.el[11]=0,C.el[12]=l[4],C.el[13]=l[5],C.el[14]=0,C.el[15]=1}return C}function f(D,s){s==c&&(s=new Xc);var Y=D.split(/\s+/);return Y=Y.map(v),s.set(Y[0]||0,Y[1]||0,Y[2]||0),s}var U,W,r,J,Y,V=function(m,x){U||(U=new ab,W=new Xc,r=new ab,J=new ab,Y=new ab),x==c&&(x=new ab);var N=getComputedStyle(m);N.transform&&"none"!==N.transform&&(L(N.transform,U),f(N.transformOrigin,W),J.setPosition(W),W.negate(),Y.setPosition(W),(wk||"preserve-3d"!==N.transformStyle)&&(U.el[8]=0,U.el[9]=0,U.el[10]=1,U.el[11]=0),x.multiplyMatrices(Y,x),x.multiplyMatrices(U,x),x.multiplyMatrices(J,x)),!wk&&N.perspective&&"none"!==N.perspective&&(r.el[11]=-1/v(N.perspective),f(N.perspectiveOrigin,W),J.setPosition(W),W.negate(),Y.setPosition(W),x.multiplyMatrices(Y,x),x.multiplyMatrices(r,x),x.multiplyMatrices(J,x));for(var i=m.offsetParent,p=m.offsetLeft,d=m.offsetTop,H=m.parentElement;H&&H!==i;){var G=getComputedStyle(H);if("none"!==G.transform||"none"!==G.perspective)break;H=H.parentElement}return H==c&&m!==m.ownerDocument.documentElement&&"fixed"!==N.position&&(H=m.ownerDocument.documentElement),i!=c&&i!==H&&(p-=H.offsetLeft,d-=H.offsetTop),W.set(p,d,0),J.setPosition(W),x.multiplyMatrices(J,x),H&&V(H,x),x};return function(K,R){var A=K.parentElement;if(A){var C=A.updateAppendMatrix;if(C){delete A.updateAppendMatrix;var g=new ab;V(A,g);var m=new ab;m.getInverse(g),A._matrixAppend=m,A._maxrixPreAppend=g}return R?A._matrixAppend:A._maxrixPreAppend}}}(),sd=function(d,C){for(;d&&!d.hasOwnProperty(C);)d=i.getPrototypeOf(d);return d&&i.getOwnPropertyDescriptor(d,C)},ps=i.getPrototypeOf?function(Q,I,x){var M=sd(I,x);M&&i.defineProperty(Q,x,M)}:function(r,Y,W){r[W]=Y[W]},Wd={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Gh=function(){var Y={1:function(F,Q){return{x:F.x-Q.width/2,y:F.y-Q.height/2}},2:function(J,I){return{x:J.x+I.width/2,y:J.y-I.height/2}},3:function(x,D){return{x:x.x+x.width/2,y:x.y-D.height/2}},4:function(N,Q){return{x:N.x+N.width-Q.width/2,y:N.y-Q.height/2}},5:function(B,G){return{x:B.x+B.width+G.width/2,y:B.y-G.height/2}},6:function(K){return{x:K.x,y:K.y}},7:function(g){return{x:g.x+g.width/2,y:g.y}},8:function(s){return{x:s.x+s.width,y:s.y}},9:function(n,v){return{x:n.x-v.width/2,y:n.y+v.height/2}},10:function(b,D){return{x:b.x+D.width/2,y:b.y+D.height/2}},11:function(t,a){return{x:t.x+t.width/2,y:t.y+a.height/2}},12:function(H,I){return{x:H.x-I.width/2+H.width,y:H.y+I.height/2}},13:function(Y,g){return{x:Y.x+Y.width+g.width/2,y:Y.y+g.height/2}},14:function(X,A){return{x:X.x-A.width/2,y:X.y+X.height/2}},15:function(p){return{x:p.x,y:p.y+p.height/2}},16:function(I,E){return{x:I.x+E.width/2,y:I.y+I.height/2}},17:function(T){return{x:T.x+T.width/2,y:T.y+T.height/2}},18:function(P,g){return{x:P.x+P.width-g.width/2,y:P.y+P.height/2}},19:function(f){return{x:f.x+f.width,y:f.y+f.height/2}},20:function(C,w){return{x:C.x+C.width+w.width/2,y:C.y+C.height/2}},21:function(v,B){return{x:v.x-B.width/2,y:v.y+v.height-B.height/2}},22:function(_,W){return{x:_.x+W.width/2,y:_.y+_.height-W.height/2}},23:function(Q,k){return{x:Q.x+Q.width/2,y:Q.y+Q.height-k.height/2}},24:function(N,S){return{x:N.x+N.width-S.width/2,y:N.y+N.height-S.height/2}},25:function(v,W){return{x:v.x+v.width+W.width/2,y:v.y+v.height-W.height/2}},26:function(f){return{x:f.x,y:f.y+f.height}},27:function(m){return{x:m.x+m.width/2,y:m.y+m.height}},28:function(q){return{x:q.x+q.width,y:q.y+q.height}},29:function(b,W){return{x:b.x-W.width/2,y:b.y+b.height+W.height/2}},30:function(k,Y){return{x:k.x+Y.width/2,y:k.y+k.height+Y.height/2}},31:function(M,W){return{x:M.x+M.width/2,y:M.y+M.height+W.height/2}},32:function($,I){return{x:$.x+$.width-I.width/2,y:$.y+$.height+I.height/2}},33:function(a,N){return{x:a.x+a.width+N.width/2,y:a.y+a.height+N.height/2}},34:function(V,U){return{x:V.x,y:V.y-U.height/2}},35:function(R,h){return{x:R.x+R.width,y:R.y-h.height/2}},36:function(X,q){return{x:X.x,y:X.y+X.height+q.height/2}},37:function(E,e){return{x:E.x+E.width,y:E.y+E.height+e.height/2}},38:function(f,X){return{x:f.x+f.width/4,y:f.y-X.height/2}},39:function(E,F){return{x:E.x+3*E.width/4,y:E.y-F.height/2}},40:function(f){return{x:f.x+f.width/4,y:f.y}},41:function(h){return{x:h.x+3*h.width/4,y:h.y}},42:function(Y,G){return{x:Y.x+Y.width/4,y:Y.y+G.height/2}},43:function(u,b){return{x:u.x+3*u.width/4,y:u.y+b.height/2}},44:function(B,O){return{x:B.x+B.width/2,y:B.y+B.height/2-O.height/2}},45:function(O){return{x:O.x+O.width/4,y:O.y+O.height/2}},46:function(d,$){return{x:d.x+d.width/2-$.width/2,y:d.y+d.height/2}},47:function(Y,N){return{x:Y.x+Y.width/2+N.width/2,y:Y.y+Y.height/2}},48:function(V){return{x:V.x+3*V.width/4,y:V.y+V.height/2}},49:function(R,w){return{x:R.x+R.width/2,y:R.y+R.height/2+w.height/2}},50:function(O,M){return{x:O.x+O.width/4,y:O.y+O.height-M.height/2}},51:function(m,n){return{x:m.x+3*m.width/4,y:m.y+m.height-n.height/2}},52:function(e){return{x:e.x+e.width/4,y:e.y+e.height}},53:function(d){return{x:d.x+3*d.width/4,y:d.y+d.height}},54:function(G,U){return{x:G.x+G.width/4,y:G.y+G.height+U.height/2}},55:function(I,r){return{x:I.x+3*I.width/4,y:I.y+I.height+r.height/2}}};return Wf(j)?function(B,r,h){return Y[B](r,h?h:Cp)}:void 0}();kp(x,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var $p=x.reverse,Ep=x.transparent,Ee=x.rectSelectBackground,xq=x.dash,Mo=x.titleBackground,Po=x.titleIconBackground,Cm=x.headerBackground,pf=x.headerIconBackground,Pg=x.headerSeparator,tk=x.headerLine,Bd=x.contentIconBackground,Jl=x.contentLine,Fb=(x.widgetIconHighlight,x.widgetIconBorder),Xg=(x.widgetIconGradient,x.imageBackground),mg=x.imageGradient,zd=x.highlight,yr=x.label,Wm=x.labelSelect;if(Jo&&!j.shutAlert1){var mn=new Date,Gc=Jo.split("-"),Eg=new Date(mn.getFullYear(),mn.getMonth(),mn.getDate()),Jo=new Date(te(Gc[0],10),te(Gc[1],10)-1,te(Gc[2],10)),Xr=Eg.getTime(),hn=Jo.getTime(),Yg=R+"_try",wp=j.alert;try{var jc=j.localStorage;if(jc&&wp)if(hn>Xr&&1728e6>hn-Xr){var Mk=(hn-Xr)/864e5;jc&&jc[Yg]!=Mk&&(jc[Yg]=Mk,j.htWillExpire?wp(j.htWillExpire.replace("{{day}}",Mk)):wp("HT for Web free trial license will expire in "+Mk+" days, please apply for a new license!"))}else Xr>=hn&&(j.htExpired?wp(j.htExpired):wp("Your free trial of HT for Web has expired!")),jc&&delete jc[Yg]}catch(ro){}}Math.sign===c&&(Math.sign=function(d){return 0>d?-1:d>0?1:+d});var Zj="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Rd={encode:function(C,b){var F,z,S,f,V,I,G,h="",R=0;for(C=unescape(encodeURIComponent(C));R<C.length;)F=C.charCodeAt(R++),z=C.charCodeAt(R++),S=C.charCodeAt(R++),f=F>>2,V=(3&F)<<4|z>>4,I=(15&z)<<2|S>>6,G=63&S,isNaN(z)?I=G=64:isNaN(S)&&(G=64),h=h+b.charAt(f)+b.charAt(V)+b.charAt(I)+b.charAt(G);return h},decode:function(E,M,o){for(var x,l,U,T,r,s,$,D="",v=o||0;v<E.length;)T=M.indexOf(E.charAt(v++)),r=M.indexOf(E.charAt(v++)),s=M.indexOf(E.charAt(v++)),$=M.indexOf(E.charAt(v++)),x=T<<2|r>>4,l=(15&r)<<4|s>>2,U=(3&s)<<6|$,D+=String.fromCharCode(x),64!=s&&(D+=String.fromCharCode(l)),64!=$&&(D+=String.fromCharCode(U));return D=decodeURIComponent(escape(D))},_utf8_encode:function(S){S=S.replace(/\r\n/g,"\n");for(var U="",L=0;L<S.length;L++){var G=S.charCodeAt(L);128>G?U+=String.fromCharCode(G):G>127&&2048>G?(U+=String.fromCharCode(192|G>>6),U+=String.fromCharCode(128|63&G)):(U+=String.fromCharCode(224|G>>12),U+=String.fromCharCode(128|63&G>>6),U+=String.fromCharCode(128|63&G))}return U},_utf8_decode:function(r){for(var k="",N=0,f=0,p=0,m=0;N<r.length;)f=r.charCodeAt(N),128>f?(k+=String.fromCharCode(f),N++):f>191&&224>f?(p=r.charCodeAt(N+1),k+=String.fromCharCode((31&f)<<6|63&p),N+=2):(p=r.charCodeAt(N+1),m=r.charCodeAt(N+2),k+=String.fromCharCode((15&f)<<12|(63&p)<<6|63&m),N+=3);return k}},fj=[],kg=[],gi=T.Math={generateUUID:function(){for(var L=[],H=0;256>H;H++)L[H]=(16>H?"0":"")+H.toString(16).toUpperCase();return function(){var K=0|4294967295*Math.random(),c=0|4294967295*Math.random(),j=0|4294967295*Math.random(),M=0|4294967295*Math.random();return L[255&K]+L[255&K>>8]+L[255&K>>16]+L[255&K>>24]+"-"+L[255&c]+L[255&c>>8]+"-"+L[64|15&c>>16]+L[255&c>>24]+"-"+L[128|63&j]+L[255&j>>8]+"-"+L[255&j>>16]+L[255&j>>24]+L[255&M]+L[255&M>>8]+L[255&M>>16]+L[255&M>>24]}}(),clamp:function(K,t,V){return Math.max(t,Math.min(V,K))},generateIncreasingID:function(){var A=0;return function(){return++A}}(),encodeBase64:function(J,M){return Rd.encode(J,M||Zj)},decodeBase64:function(T,o){return Rd.decode(T,o||Zj)},randomArray:function(z,Z){Z=Z||z.length;for(var e=Z-1;e>0;e--){var f=Math.floor(Math.random()*(e+1)),t=z[e];z[e]=z[f],z[f]=t}return z},randomInt:function(f,q){return q===c&&(q=f,f=0),f+Math.floor(Math.random()*(q-f))},isPOT:function(q){return q>0&&0===(q-1&q)},nearestPOT:function(G){if(!G)return 1;var f=G;f--,f|=f>>1,f|=f>>2,f|=f>>4,f|=f>>8,f|=f>>16,f++;var P=f>>1;return G-P>f-G?f:P},requestMatrix4:function(){return fj.length>0?fj.pop():new gi.Matrix4},releaseMatrix4:function(M){fj.push(M)},requestVector3:function(){return kg.length>0?kg.pop():new gi.Vector3},releaseVector3:function(h){kg.push(h)}},Uh=T.Matrix=T.Math.Matrix2d=function(m,K,B,S,R){this.setFromTransform(m,K,B,S,R)},qe=Uh;Uh.prototype={},Uh.prototype.constructor=Uh,Uh.prototype.set=function(I,G,L,A,q,D){return this.a=I,this.b=G,this.c=L,this.d=A,this.tx=q,this.ty=D,this},Uh.prototype.setFromTransform=function(e,y,S,D,x){var R=this;if(e===c)return R.a=1,R.b=0,R.c=0,R.d=1,R.tx=0,R.ty=0,void 0;var m,W;return e?(m=z(e),W=K(e)):(m=0,W=1),D=D||1,x=x||1,R.a=W*D,R.b=m*D,R.c=-m*x,R.d=W*x,R.tx=y||0,R.ty=S||0,R},Uh.prototype.apply=function(Q,K){K=K||new xg;var U=Q.x,n=Q.y;return K.x=this.a*U+this.c*n+this.tx,K.y=this.b*U+this.d*n+this.ty,K},Uh.prototype.applyInverse=function(o,q){q=q||new xg;var n=1/(this.a*this.d+this.c*-this.b),l=o.x,T=o.y;return q.x=this.d*n*l+-this.c*n*T+(this.ty*this.c-this.tx*this.d)*n,q.y=this.a*n*T+-this.b*n*l+(-this.ty*this.a+this.tx*this.b)*n,q},Uh.prototype.translate=function(H,U){return this.tx+=H,this.ty+=U,this},Uh.prototype.scale=function(o,e){return this.a*=o,this.d*=e,this.c*=o,this.b*=e,this.tx*=o,this.ty*=e,this},Uh.prototype.rotate=function(b){var _=Math.cos(b),V=Math.sin(b),l=this.a,S=this.c,j=this.tx;return this.a=l*_-this.b*V,this.b=l*V+this.b*_,this.c=S*_-this.d*V,this.d=S*V+this.d*_,this.tx=j*_-this.ty*V,this.ty=j*V+this.ty*_,this},Uh.prototype.appendTranslate=function(t,c){return this.tx+=this.a*t+this.c*c,this.ty+=this.b*t+this.d*c,this},Uh.prototype.appendScale=function(h,M){return this.a*=h,this.d*=M,this.c*=M,this.b*=h,this},Uh.prototype.appendRotate=function(y){if(!y)return this;var x=Math.cos(y),z=Math.sin(y),$=this.a,w=this.b;return this.a=$*x+this.c*z,this.b=w*x+this.d*z,this.c=-$*z+this.c*x,this.d=-w*z+this.d*x,this},Uh.prototype.append=function(D){var d=this.a,F=this.b,C=this.c,u=this.d;return this.a=D.a*d+D.b*C,this.b=D.a*F+D.b*u,this.c=D.c*d+D.d*C,this.d=D.c*F+D.d*u,this.tx=D.tx*d+D.ty*C+this.tx,this.ty=D.tx*F+D.ty*u+this.ty,this},Uh.prototype.setTransform=function($,W,T,d,h,R,L,f,C){var a,n,V,P,j,J,s,g,N,u;return j=Math.sin(L),J=Math.cos(L),s=Math.cos(C),g=Math.sin(C),N=-Math.sin(f),u=Math.cos(f),a=J*h,n=j*h,V=-j*R,P=J*R,this.a=s*a+g*V,this.b=s*n+g*P,this.c=N*a+u*V,this.d=N*n+u*P,this.tx=$+(T*a+d*V),this.ty=W+(T*n+d*P),this},Uh.prototype.prepend=function($){var G=this.tx;if(1!==$.a||0!==$.b||0!==$.c||1!==$.d){var Y=this.a,g=this.c;this.a=Y*$.a+this.b*$.c,this.b=Y*$.b+this.b*$.d,this.c=g*$.a+this.d*$.c,this.d=g*$.b+this.d*$.d}return this.tx=G*$.a+this.ty*$.c+$.tx,this.ty=G*$.b+this.ty*$.d+$.ty,this},Uh.prototype.transform=Uh.prototype.prepend,Uh.prototype.invert=function(){var z=this.a,l=this.b,j=this.c,F=this.d,h=this.tx,U=z*F-l*j;return this.a=F/U,this.b=-l/U,this.c=-j/U,this.d=z/U,this.tx=(j*this.ty-F*h)/U,this.ty=-(z*this.ty-l*h)/U,this},Uh.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Uh.prototype.clone=function(){var l=new Uh;return l.a=this.a,l.b=this.b,l.c=this.c,l.d=this.d,l.tx=this.tx,l.ty=this.ty,l},Uh.prototype.copy=function(f){return f.a=this.a,f.b=this.b,f.c=this.c,f.d=this.d,f.tx=this.tx,f.ty=this.ty,f},Uh.prototype.tf=function(G,f){1===arguments.length&&(f=G.y,G=G.x);var Z=this;return{x:Z.a*G+Z.c*f+Z.tx,y:Z.b*G+Z.d*f+Z.ty}},Uh.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},Uh.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},Uh.prototype.tfi=function(p,n){1===arguments.length&&(n=p.y,p=p.x);var o=this,i=1/(o.a*o.d+o.c*-o.b);return{x:o.d*i*p+-o.c*i*n+(o.ty*o.c-o.tx*o.d)*i,y:o.a*i*n+-o.b*i*p+(-o.ty*o.a+o.tx*o.b)*i}},Uh.IDENTITY=new Uh,Uh.TEMP_MATRIX=new Uh;var oc=T.Math.Quaternion=function(k,c,X,t){this.set(k,c,X,t)};i.assign(oc.prototype,{set:function(N,A,l,G){var p=this;return p._x=N||0,p._y=A||0,p._z=l||0,p._w=G!==c?G:1,p},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(K){var Y=this;return Y._x=K._x,Y._y=K._y,Y._z=K._z,Y._w=K._w,Y},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(k){return this._x*k._x+this._y*k._y+this._z*k._z+this._w*k._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var n=this.length();return 0===n?(this._x=0,this._y=0,this._z=0,this._w=1):(n=1/n,this._x=this._x*n,this._y=this._y*n,this._z=this._z*n,this._w=this._w*n),this},fromArray:function(p,H){H===c&&(H=0);var E=this;return E._x=p[H],E._y=p[H+1],E._z=p[H+2],E._w=p[H+3],this},slerp:function(v,$){if(0===$)return this;if(1===$)return this.copy(v);var i=this._x,y=this._y,K=this._z,J=this._w,t=J*v._w+i*v._x+y*v._y+K*v._z;if(0>t?(this._w=-v._w,this._x=-v._x,this._y=-v._y,this._z=-v._z,t=-t):this.copy(v),t>=1)return this._w=J,this._x=i,this._y=y,this._z=K,this;var s=Math.sqrt(1-t*t);if(Math.abs(s)<.001)return this._w=.5*(J+this._w),this._x=.5*(i+this._x),this._y=.5*(y+this._y),this._z=.5*(K+this._z),this;var N=Math.atan2(s,t),R=Math.sin((1-$)*N)/s,L=Math.sin($*N)/s;return this._w=J*R+this._w*L,this._x=i*R+this._x*L,this._y=y*R+this._y*L,this._z=K*R+this._z*L,this},setFromAxisAngle:function(N,x){var u=x/2,L=Math.sin(u);return this._x=N.x*L,this._y=N.y*L,this._z=N.z*L,this._w=Math.cos(u),this},setFromEuler:function(a){var v=a._x,O=a._y,w=a._z,t=a._order,L=Math.cos,p=Math.sin,r=L(v/2),f=L(O/2),B=L(w/2),q=p(v/2),Z=p(O/2),s=p(w/2);return"XYZ"===t?(this._x=q*f*B+r*Z*s,this._y=r*Z*B-q*f*s,this._z=r*f*s+q*Z*B,this._w=r*f*B-q*Z*s):"YXZ"===t?(this._x=q*f*B+r*Z*s,this._y=r*Z*B-q*f*s,this._z=r*f*s-q*Z*B,this._w=r*f*B+q*Z*s):"ZXY"===t?(this._x=q*f*B-r*Z*s,this._y=r*Z*B+q*f*s,this._z=r*f*s+q*Z*B,this._w=r*f*B-q*Z*s):"ZYX"===t?(this._x=q*f*B-r*Z*s,this._y=r*Z*B+q*f*s,this._z=r*f*s-q*Z*B,this._w=r*f*B+q*Z*s):"YZX"===t?(this._x=q*f*B+r*Z*s,this._y=r*Z*B+q*f*s,this._z=r*f*s-q*Z*B,this._w=r*f*B-q*Z*s):"XZY"===t&&(this._x=q*f*B-r*Z*s,this._y=r*Z*B-q*f*s,this._z=r*f*s+q*Z*B,this._w=r*f*B+q*Z*s),this},setFromRotationMatrix:function(U){var b,z=U.el,t=z[0],d=z[4],y=z[8],e=z[1],c=z[5],P=z[9],Y=z[2],h=z[6],B=z[10],F=t+c+B;return F>0?(b=.5/Math.sqrt(F+1),this._w=.25/b,this._x=(h-P)*b,this._y=(y-Y)*b,this._z=(e-d)*b):t>c&&t>B?(b=2*Math.sqrt(1+t-c-B),this._w=(h-P)/b,this._x=.25*b,this._y=(d+e)/b,this._z=(y+Y)/b):c>B?(b=2*Math.sqrt(1+c-t-B),this._w=(y-Y)/b,this._x=(d+e)/b,this._y=.25*b,this._z=(P+h)/b):(b=2*Math.sqrt(1+B-t-c),this._w=(e-d)/b,this._x=(y+Y)/b,this._y=(P+h)/b,this._z=.25*b),this},setFromToVectors:function(){var D,n;return function(f,_){return D===c&&(D=new Xc),n=f.dot(_)+1,1e-7>n?(n=0,Math.abs(f.x)>Math.abs(f.z)?D.set(-f.y,f.x,0):D.set(0,-f.z,f.y)):D.crossVectors(f,_),this._x=D.x,this._y=D.y,this._z=D.z,this._w=n,this.normalize()}}(),setFromUnitVectors:function(){var r,D,p=1e-6;return function(s,v){return r===c&&(r=new Xc),D=s.dot(v)+1,p>D?(D=0,Math.abs(s.x)>Math.abs(s.z)?r.set(-s.y,s.x,0):r.set(0,-s.z,s.y)):r.crossVectors(s,v),this._x=r.x,this._y=r.y,this._z=r.z,this._w=D,this.normalize()}}(),multiply:function(b){return this.multiplyQuaternions(this,b)},premultiply:function(E){return this.multiplyQuaternions(E,this)},multiplyQuaternions:function(q,l){var B=q._x,w=q._y,n=q._z,D=q._w,L=l._x,p=l._y,k=l._z,t=l._w;return this._x=B*t+D*L+w*k-n*p,this._y=w*t+D*p+n*L-B*k,this._z=n*t+D*k+B*p-w*L,this._w=D*t-B*L-w*p-n*k,this},toArray:function(m,P){return m||(m=[]),P=P||0,m[P]=this._x,m[P+1]=this._y,m[P+2]=this._z,m[P+3]=this._w,m}});var xo=T.Math.Vector4=function(T,H,I,G){this.x=T||0,this.y=H||0,this.z=I||0,this.w=G!==c?G:1};i.assign(xo.prototype,{isVector4:!0,set:function(s,J,F,U){return this.x=s,this.y=J,this.z=F,this.w=U,this},setScalar:function(l){return this.x=l,this.y=l,this.z=l,this.w=l,this},setX:function(W){return this.x=W,this},setY:function(N){return this.y=N,this},setZ:function(n){return this.z=n,this},setW:function(l){return this.w=l,this},setComponent:function(I,X){switch(I){case 0:this.x=X;break;case 1:this.y=X;break;case 2:this.z=X;break;case 3:this.w=X;break;default:throw new Error("index is out of range: "+I)}return this},getComponent:function(h){switch(h){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+h)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(m){return this.x=m.x,this.y=m.y,this.z=m.z,this.w=m.w!==c?m.w:1,this},add:function(p,d){return d!==c?this.addVectors(p,d):(this.x+=p.x,this.y+=p.y,this.z+=p.z,this.w+=p.w,this)},addScalar:function(b){return this.x+=b,this.y+=b,this.z+=b,this.w+=b,this},addVectors:function(t,M){return this.x=t.x+M.x,this.y=t.y+M.y,this.z=t.z+M.z,this.w=t.w+M.w,this},addScaledVector:function(T,Q){return this.x+=T.x*Q,this.y+=T.y*Q,this.z+=T.z*Q,this.w+=T.w*Q,this},sub:function(v,x){return x!==c?this.subVectors(v,x):(this.x-=v.x,this.y-=v.y,this.z-=v.z,this.w-=v.w,this)},subScalar:function(j){return this.x-=j,this.y-=j,this.z-=j,this.w-=j,this},subVectors:function(K,E){return this.x=K.x-E.x,this.y=K.y-E.y,this.z=K.z-E.z,this.w=K.w-E.w,this},multiplyScalar:function(d){return this.x*=d,this.y*=d,this.z*=d,this.w*=d,this},applyMatrix4:function(U){var u=this.x,P=this.y,n=this.z,E=this.w,S=U.el;return this.x=S[0]*u+S[4]*P+S[8]*n+S[12]*E,this.y=S[1]*u+S[5]*P+S[9]*n+S[13]*E,this.z=S[2]*u+S[6]*P+S[10]*n+S[14]*E,this.w=S[3]*u+S[7]*P+S[11]*n+S[15]*E,this},divideScalar:function(B){return this.multiplyScalar(1/B)},setAxisAngleFromQuaternion:function(b){this.w=2*Math.acos(b.w);var h=Math.sqrt(1-b.w*b.w);return 1e-4>h?(this.x=1,this.y=0,this.z=0):(this.x=b.x/h,this.y=b.y/h,this.z=b.z/h),this},setAxisAngleFromRotationMatrix:function(F){var Z,R,a,A,K=.01,L=.1,k=F.el,G=k[0],c=k[4],x=k[8],X=k[1],P=k[5],v=k[9],d=k[2],g=k[6],l=k[10];if(Math.abs(c-X)<K&&Math.abs(x-d)<K&&Math.abs(v-g)<K){if(Math.abs(c+X)<L&&Math.abs(x+d)<L&&Math.abs(v+g)<L&&Math.abs(G+P+l-3)<L)return this.set(1,0,0,0),this;Z=Math.PI;var o=(G+1)/2,B=(P+1)/2,i=(l+1)/2,y=(c+X)/4,h=(x+d)/4,H=(v+g)/4;return o>B&&o>i?K>o?(R=0,a=.707106781,A=.707106781):(R=Math.sqrt(o),a=y/R,A=h/R):B>i?K>B?(R=.707106781,a=0,A=.707106781):(a=Math.sqrt(B),R=y/a,A=H/a):K>i?(R=.707106781,a=.707106781,A=0):(A=Math.sqrt(i),R=h/A,a=H/A),this.set(R,a,A,Z),this}var I=Math.sqrt((g-v)*(g-v)+(x-d)*(x-d)+(X-c)*(X-c));return Math.abs(I)<.001&&(I=1),this.x=(g-v)/I,this.y=(x-d)/I,this.z=(X-c)/I,this.w=Math.acos((G+P+l-1)/2),this},min:function(K){return this.x=Math.min(this.x,K.x),this.y=Math.min(this.y,K.y),this.z=Math.min(this.z,K.z),this.w=Math.min(this.w,K.w),this},max:function(Z){return this.x=Math.max(this.x,Z.x),this.y=Math.max(this.y,Z.y),this.z=Math.max(this.z,Z.z),this.w=Math.max(this.w,Z.w),this},clamp:function(Y,y){return this.x=Math.max(Y.x,Math.min(y.x,this.x)),this.y=Math.max(Y.y,Math.min(y.y,this.y)),this.z=Math.max(Y.z,Math.min(y.z,this.z)),this.w=Math.max(Y.w,Math.min(y.w,this.w)),this},clampScalar:function(){var a,N;return function(s,O){return a===c&&(a=new xo,N=new xo),a.set(s,s,s,s),N.set(O,O,O,O),this.clamp(a,N)}}(),clampLength:function(R,Q){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(R,Math.min(Q,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(r){return this.x*r.x+this.y*r.y+this.z*r.z+this.w*r.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function($){return this.normalize().multiplyScalar($)},lerp:function(h,C){return this.x+=(h.x-this.x)*C,this.y+=(h.y-this.y)*C,this.z+=(h.z-this.z)*C,this.w+=(h.w-this.w)*C,this},lerpVectors:function(U,s,k){return this.subVectors(s,U).multiplyScalar(k).add(U)},equals:function(N){return N.x===this.x&&N.y===this.y&&N.z===this.z&&N.w===this.w
},fromArray:function(B,R){return R===c&&(R=0),this.x=B[R],this.y=B[R+1],this.z=B[R+2],this.w=B[R+3],this},toArray:function(X,$){return X===c&&(X=[]),$===c&&($=0),X[$]=this.x,X[$+1]=this.y,X[$+2]=this.z,X[$+3]=this.w,X},fromBufferAttribute:function(n,k){return this.x=n.getX(k),this.y=n.getY(k),this.z=n.getZ(k),this.w=n.getW(k),this}});var Xc=T.Math.Vector3=function($,X,u){$===c?(this.x=0,this.y=0,this.z=0):"object"==typeof $?this.copy($):this.set($,X==c?$:X,u==c?$:u)},$k=T.Math.Vector3;i.assign(Xc.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(O,J,c){return this.x=O,this.y=J,this.z=c,this},equals:function(u){return u&&this.x===u.x&&this.y===u.y&&this.z===u.z},setScalar:function(L){return this.x=L,this.y=L,this.z=L,this},setX:function(T){return this.x=T,this},setY:function(h){return this.y=h,this},setZ:function(l){return this.z=l,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(C){return C.x===c?(this.x=C[0],this.y=C[1],this.z=C[2]):(this.x=C.x,this.y=C.y,this.z=C.z||0),this},add:function(M){return this.x+=M.x,this.y+=M.y,this.z+=M.z,this},addScalar:function(G){return this.x+=G,this.y+=G,this.z+=G,this},addVectors:function(W,j){return this.x=W.x+j.x,this.y=W.y+j.y,this.z=W.z+j.z,this},addScaledVector:function(G,k){return this.x+=G.x*k,this.y+=G.y*k,this.z+=G.z*k,this},sub:function(R){return this.x-=R.x,this.y-=R.y,this.z-=R.z,this},subScalar:function(q){return this.x-=q,this.y-=q,this.z-=q,this},subVectors:function(T,i){return this.x=T.x-i.x,this.y=T.y-i.y,this.z=T.z-i.z,this},divide:function(h){return this.x/=h.x,this.y/=h.y,this.z/=h.z,this},multiply:function(C){return this.x*=C.x,this.y*=C.y,this.z*=C.z,this},multiplyScalar:function(d){return this.x*=d,this.y*=d,this.z*=d,this},divideScalar:function(A){if(0!==A){var X=1/A;this.x*=X,this.y*=X,this.z*=X}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(X){var o=this.x-X.x,K=this.y-X.y,s=this.z-X.z;return o*o+K*K+s*s},distanceToSquared2:function(H){var X=this.x-H[0],c=this.y-H[1],l=this.z-H[2];return X*X+c*c+l*l},divideVectors:function(U,j){return this.x=U.x/j.x,this.y=U.y/j.y,this.z=U.z/j.z,this},multiplyVectors:function(t,L){return this.x=t.x*L.x,this.y=t.y*L.y,this.z=t.z*L.z,this},transformDirection:function(Q){var n=this.x,P=this.y,K=this.z,$=Q.el;return this.x=$[0]*n+$[4]*P+$[8]*K,this.y=$[1]*n+$[5]*P+$[9]*K,this.z=$[2]*n+$[6]*P+$[10]*K,this.normalize()},applyAxisAngle:function(){var v=new oc;return function(P,I){return this.applyQuaternion(v.setFromAxisAngle(P,I))}}(),applyEuler:function(){var t=new oc;return function(N){return this.applyQuaternion(t.setFromEuler(N))}}(),applyQuaternion:function(l){var w=this.x,Y=this.y,M=this.z,I=l._x,U=l._y,q=l._z,Z=l._w,J=Z*w+U*M-q*Y,h=Z*Y+q*w-I*M,e=Z*M+I*Y-U*w,O=-I*w-U*Y-q*M;return this.x=J*Z+O*-I+h*-q-e*-U,this.y=h*Z+O*-U+e*-I-J*-q,this.z=e*Z+O*-q+J*-U-h*-I,this},applyMatrix4:function(I){var g=this.x,V=this.y,o=this.z,H=I.el,X=1/(H[3]*g+H[7]*V+H[11]*o+H[15]);return this.x=(H[0]*g+H[4]*V+H[8]*o+H[12])*X,this.y=(H[1]*g+H[5]*V+H[9]*o+H[13])*X,this.z=(H[2]*g+H[6]*V+H[10]*o+H[14])*X,this},applyMatrix3:function(W){var s=this.x,C=this.y,K=this.z,r=W.el;return this.x=r[0]*s+r[3]*C+r[6]*K,this.y=r[1]*s+r[4]*C+r[7]*K,this.z=r[2]*s+r[5]*C+r[8]*K,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var K=new Xc;return function(q){return this.sub(K.copy(q).multiplyScalar(2*this.dot(q)))}}(),dot:function(o){return this.x*o.x+this.y*o.y+this.z*o.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var d=this.length();return d?this.multiplyScalar(1/d):this},setLength:function(O){return this.normalize().multiplyScalar(O)},fromArray:function(q,r){return r===c&&(r=0),this.x=q[r],this.y=q[r+1],this.z=q[r+2],this},toArray:function(k,x){return k===c&&(k=[0,0,0]),x===c&&(x=0),k[x]=this.x,k[x+1]=this.y,k[x+2]=this.z,k},cross:function(R){return this.crossVectors(this,R)},angleTo:function(V){var A=this.dot(V)/Math.sqrt(this.lengthSq()*V.lengthSq());return A>1||-1>A?0:Math.acos(A)},lerp:function(z,Z){return this.x+=(z.x-this.x)*Z,this.y+=(z.y-this.y)*Z,this.z+=(z.z-this.z)*Z,this},lerpVectors:function(E,o,j){return this.subVectors(o,E).multiplyScalar(j).add(E)},crossVectors:function(V,h){var f=V.x,g=V.y,S=V.z,H=h.x,t=h.y,R=h.z;return this.x=g*R-S*t,this.y=S*H-f*R,this.z=f*t-g*H,this},min:function($){return this.x=Math.min(this.x,$.x),this.y=Math.min(this.y,$.y),this.z=Math.min(this.z,$.z),this},max:function(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this.z=Math.max(this.z,o.z),this},setFromMatrixPosition:function(M){return this.setFromMatrixColumn(M,3)},setFromMatrixScale:function($){var R=this.setFromMatrixColumn($,0).length(),O=this.setFromMatrixColumn($,1).length(),J=this.setFromMatrixColumn($,2).length();return this.x=R,this.y=O,this.z=J,this},setFromMatrixColumn:function(K,D){return this.fromArray(K.el,4*D)}});var xg=T.Math.Vector2=function(T,m,B){"object"==typeof T&&(T.x!=c?(m=T.y,B=T.e,T=T.x):(B=T[2],m=T[1],T=T[0])),this.set(T||0,m||0,B)};xg.prototype={},xg.prototype.constructor=xg;var Ac=xg;i.defineProperties(xg.prototype,{width:{get:function(){return this.x},set:function(M){this.x=M}},height:{get:function(){return this.y},set:function(R){this.y=R}}}),xg.prototype.clone=function(){return new xg(this.x,this.y,this.e)},xg.prototype.copy=function(B){return this.set(B.x,B.y,B.e),this},xg.prototype.equals=function(i){return i.x===this.x&&i.y===this.y&&i.e===this.e},xg.prototype.set=function(A,k,J){return this.x=A||0,this.y=k||(0!==k?this.x:0),J!=c&&(this.e=J),this},xg.prototype.setScalar=function(w){return this.x=w,this.y=w,this.e=w,this},xg.prototype.setX=function(l){return this.x=l||0,this},xg.prototype.setY=function(l){return this.y=l||0,this},xg.prototype.setE=function(W){return this.e=W||0,this},xg.prototype.add=function(y){return this.x+=y.x,this.y+=y.y,this},xg.prototype.addVectors=function(z,p){return this.x=z.x+p.x,this.y=z.y+p.y,this},xg.prototype.addScalar=function(l){return this.x+=l,this.y+=l,this},xg.prototype.addScaledVector=function(_,h){return this.x+=_.x*h,this.y+=_.y*h,this},xg.prototype.sub=function(z){return this.x-=z.x,this.y-=z.y,this},xg.prototype.subScalar=function(O){return this.x-=O,this.y-=O,this},xg.prototype.subVectors=function(B,o){return this.x=B.x-o.x,this.y=B.y-o.y,this},xg.prototype.multiply=function(V){return this.x*=V.x,this.y*=V.y,this},xg.prototype.multiplyScalar=function(U){return this.x*=U,this.y*=U,this},xg.prototype.divide=function(O){return this.x/=O.x,this.y/=O.y,this},xg.prototype.divideScalar=function(i){return this.multiplyScalar(1/i)},xg.prototype.min=function(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this},xg.prototype.max=function(k){return this.x=Math.max(this.x,k.x),this.y=Math.max(this.y,k.y),this},xg.prototype.fromArray=function(q,U){return U===c&&(U=0),this.x=q[U],this.y=q[U+1],this},xg.prototype.clamp=function(H,u){return this.x=Math.max(H.x,Math.min(u.x,this.x)),this.y=Math.max(H.y,Math.min(u.y,this.y)),this},xg.prototype.clampScalar=function(){var M,C;return function(a,L){return M===c&&(M=new xg,C=new xg),M.set(a,a),C.set(L,L),this.clamp(M,C)}}(),xg.prototype.clampLength=function(B,d){var E=this.length();return this.multiplyScalar(Math.max(B,Math.min(d,E))/E)},xg.prototype.dot=function(_){return this.x*_.x+this.y*_.y},xg.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},xg.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},xg.prototype.normalize=function(){return this.divideScalar(this.length())},xg.prototype.angle=function(){var P=Math.atan2(this.y,this.x);return 0>P&&(P+=2*Math.PI),P},xg.prototype.distanceTo=function(M){return Math.sqrt(this.distanceToSquared(M))},xg.prototype.distanceToSquared=function(r){var J=this.x-r.x,V=this.y-r.y;return J*J+V*V},xg.prototype.isNearEnough=function(A){return this.distanceToSquared(A)<1e-8},xg.prototype.setLength=function(e){var K=this.length();return K?this.multiplyScalar(e/K):this},xg.prototype.lerp=function(C,w){return this.x+=(C.x-this.x)*w,this.y+=(C.y-this.y)*w,"number"==typeof C.e&&"number"==typeof this.e&&(this.e+=(C.e-this.e)*w),this},xg.prototype.lerpVectors=function(x,H,r){return this.subVectors(H,x).multiplyScalar(r).add(x)},xg.prototype.rotateAround=function($,N){var x=$?$.x:0,s=$?$.y:0,c=Math.cos(N),l=Math.sin(N),Y=this.x-x,C=this.y-s;return this.x=Y*c-C*l+x,this.y=Y*l+C*c+s,this};var bk=T.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};i.assign(bk.prototype,{isMatrix3:!0,set:function(w,K,y,s,e,N,m,$,W){var Y=this.el;return Y[0]=w,Y[1]=s,Y[2]=m,Y[3]=K,Y[4]=e,Y[5]=$,Y[6]=y,Y[7]=N,Y[8]=W,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(y){var n=this.el,t=y.el;return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],this},setFromMatrix4:function(m){var $=m.el;return this.set($[0],$[4],$[8],$[1],$[5],$[9],$[2],$[6],$[10]),this},applyToBufferAttribute:function(){var l=new Xc;return function(e){for(var $=0,X=e.count;X>$;$++)l.x=e.getX($),l.y=e.getY($),l.z=e.getZ($),l.applyMatrix3(this),e.setXYZ($,l.x,l.y,l.z);return e}}(),multiply:function(Z){return this.multiplyMatrices(this,Z)},premultiply:function(O){return this.multiplyMatrices(O,this)},multiplyMatrices:function(w,$){var q=w.el,l=$.el,Q=this.el,X=q[0],M=q[3],d=q[6],r=q[1],v=q[4],U=q[7],D=q[2],O=q[5],i=q[8],P=l[0],p=l[3],k=l[6],f=l[1],s=l[4],S=l[7],H=l[2],x=l[5],j=l[8];return Q[0]=X*P+M*f+d*H,Q[3]=X*p+M*s+d*x,Q[6]=X*k+M*S+d*j,Q[1]=r*P+v*f+U*H,Q[4]=r*p+v*s+U*x,Q[7]=r*k+v*S+U*j,Q[2]=D*P+O*f+i*H,Q[5]=D*p+O*s+i*x,Q[8]=D*k+O*S+i*j,this},multiplyScalar:function(H){var p=this.el;return p[0]*=H,p[3]*=H,p[6]*=H,p[1]*=H,p[4]*=H,p[7]*=H,p[2]*=H,p[5]*=H,p[8]*=H,this},determinant:function(){var p=this.el,q=p[0],n=p[1],b=p[2],g=p[3],x=p[4],Z=p[5],H=p[6],T=p[7],w=p[8];return q*x*w-q*Z*T-n*g*w+n*Z*H+b*g*T-b*x*H},getInverse:function(F){var m=F.el,P=this.el,S=m[0],g=m[1],y=m[2],$=m[3],B=m[4],t=m[5],l=m[6],C=m[7],U=m[8],R=U*B-t*C,H=t*l-U*$,Q=C*$-B*l,V=S*R+g*H+y*Q;if(0===V)return this.identity();var k=1/V;return P[0]=R*k,P[1]=(y*C-U*g)*k,P[2]=(t*g-y*B)*k,P[3]=H*k,P[4]=(U*S-y*l)*k,P[5]=(y*$-t*S)*k,P[6]=Q*k,P[7]=(g*l-C*S)*k,P[8]=(B*S-g*$)*k,this},transpose:function(){var j,i=this.el;return j=i[1],i[1]=i[3],i[3]=j,j=i[2],i[2]=i[6],i[6]=j,j=i[5],i[5]=i[7],i[7]=j,this},getNormalMatrix:function(C){return this.setFromMatrix4(C).getInverse(this).transpose()},transposeIntoArray:function(r){var z=this.el;return r[0]=z[0],r[1]=z[3],r[2]=z[6],r[3]=z[1],r[4]=z[4],r[5]=z[7],r[6]=z[2],r[7]=z[5],r[8]=z[8],this},setUvTransform:function(c,W,v,P,H,M,L){var Q=Math.cos(H),Z=Math.sin(H);this.set(v*Q,v*Z,-v*(Q*M+Z*L)+M+c,-P*Z,P*Q,-P*(-Z*M+Q*L)+L+W,0,0,1)},scale:function(m,v){var f=this.el;return f[0]*=m,f[3]*=m,f[6]*=m,f[1]*=v,f[4]*=v,f[7]*=v,this},rotate:function(P){var w=Math.cos(P),l=Math.sin(P),i=this.el,V=i[0],_=i[3],b=i[6],y=i[1],F=i[4],g=i[7];return i[0]=w*V+l*y,i[3]=w*_+l*F,i[6]=w*b+l*g,i[1]=-l*V+w*y,i[4]=-l*_+w*F,i[7]=-l*b+w*g,this},translate:function(o,s){var j=this.el;return j[0]+=o*j[2],j[3]+=o*j[5],j[6]+=o*j[8],j[1]+=s*j[2],j[4]+=s*j[5],j[7]+=s*j[8],this},equals:function(U){for(var F=this.el,L=U.el,R=0;9>R;R++)if(F[R]!==L[R])return!1;return!0},fromArray:function(v,n){n===c&&(n=0);for(var H=0;9>H;H++)this.el[H]=v[H+n];return this},toArray:function(h,S){h===c&&(h=[]),S===c&&(S=0);var P=this.el;return h[S]=P[0],h[S+1]=P[1],h[S+2]=P[2],h[S+3]=P[3],h[S+4]=P[4],h[S+5]=P[5],h[S+6]=P[6],h[S+7]=P[7],h[S+8]=P[8],h}});var bj=T.Math.Plane=function(e,N){this.normal=e!==c?e:new Xc(1,0,0),this.constant=N!==c?N:0};i.assign(bj.prototype,{set:function(j,Z){return this.normal.copy(j),this.constant=Z,this},setComponents:function(L,I,P,M){return this.normal.set(L,I,P),this.constant=M,this},setFromNormalAndCoplanarPoint:function(V,$){return this.normal.copy(V),this.constant=-$.dot(this.normal),this},setFromCoplanarPoints:function(){var D=new Xc,t=new Xc;return function(p,Y,E){var q=D.subVectors(E,Y).cross(t.subVectors(p,Y)).normalize();return this.setFromNormalAndCoplanarPoint(q,p),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(S){return this.normal.copy(S.normal),this.constant=S.constant,this},normalize:function(){var W=1/this.normal.length();return this.normal.multiplyScalar(W),this.constant*=W,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(i){return this.normal.dot(i)+this.constant},distanceToSphere:function(A){return this.distanceToPoint(A.center)-A.radius},projectPoint:function(Z,e){return e===c&&(e=new Xc),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(Z)).add(Z)},intersectLine:function(){var W=new Xc;return function(w,a){a===c&&(a=new Xc);var r=w.delta(W),P=this.normal.dot(r);if(0===P)return 0===this.distanceToPoint(w.start)?a.copy(w.start):c;var Z=-(w.start.dot(this.normal)+this.constant)/P;return 0>Z||Z>1?c:a.copy(r).multiplyScalar(Z).add(w.start)}}(),intersectsLine:function(c){var i=this.distanceToPoint(c.start),Q=this.distanceToPoint(c.end);return 0>i&&Q>0||0>Q&&i>0},intersectsBox:function(P){return P.intersectsPlane(this)},intersectsSphere:function(n){return n.intersectsPlane(this)},coplanarPoint:function(j){return j===c&&(j=new Xc),j.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var y=new Xc,j=new bk;return function(H,N){var z=N||j.getNormalMatrix(H),Y=this.coplanarPoint(y).applyMatrix4(H),S=this.normal.applyMatrix3(z).normalize();return this.constant=-Y.dot(S),this}}(),translate:function(Y){return this.constant-=Y.dot(this.normal),this},equals:function(x){return x.normal.equals(this.normal)&&x.constant===this.constant}});var Ne=T.Math.Ray=function(I,P){this.origin=I!==c?I.clone():new Xc,this.direction=P!==c?P.clone():new Xc};i.assign(Ne.prototype,{set:function(V,S){return this.origin.copy(V),this.direction.copy(S),this},clone:function(){return(new this.constructor).copy(this)},copy:function(r){return this.origin.copy(r.origin),this.direction.copy(r.direction),this.maxHitLen=r.maxHitLen,this},at:function(_,O){var m=O||new Xc;return m.copy(this.direction).multiplyScalar(_).add(this.origin)},setMaxHitLength:function(I){this.maxHitLen=I},lookAt:function(m){return this.direction.copy(m).sub(this.origin).normalize(),this},applyMatrix4:function(z){var w=this.maxHitLen;if(w){var k=this.direction.clone().multiplyScalar(w).add(this.origin);k.applyMatrix4(z)}return this.origin.applyMatrix4(z),this.direction.transformDirection(z),w&&(this.maxHitLen=this.origin.distanceTo(k)),this},distanceToPlane:function(L){var W=L.normal.dot(this.direction);if(0===W)return 0===L.distanceToPoint(this.origin)?0:null;var k=-(this.origin.dot(L.normal)+L.constant)/W;return k>=0?k:null},intersectPlane:function(d,c){var o=this.distanceToPlane(d);return null===o?null:this.at(o,c)},intersectSphere:function(){var $=new Xc;return function(k,K){$.subVectors(k.center,this.origin);var x=$.dot(this.direction),N=$.dot($)-x*x,r=k.radius*k.radius;if(N>r)return null;var H=Math.sqrt(r-N),u=x-H,P=x+H;return 0>u&&0>P?null:0>u?this.at(P,K):this.at(u,K)}}(),intersectEllipsoid:function(){var z=new Xc,k=new Xc;return function(h,Q){z.subVectors(h.center,this.origin),z.divide(h.radius),k.divideVectors(this.direction,h.radius);var y=k.lengthSq(),K=z.dot(k),T=z.dot(z)*y-K*K;if(T>y)return null;var J=Math.sqrt(y-T),H=(K-J)/y,u=(K+J)/y;return 0>H&&0>u?null:0>H?this.at(u,Q):this.at(H,Q)}}(),intersectBox:function(u,L){var U,J,d,C,n,x,H=1/this.direction.x,b=1/this.direction.y,Q=1/this.direction.z,w=this.origin;if(H>=0?(U=(u.min.x-w.x)*H,J=(u.max.x-w.x)*H):(U=(u.max.x-w.x)*H,J=(u.min.x-w.x)*H),b>=0?(d=(u.min.y-w.y)*b,C=(u.max.y-w.y)*b):(d=(u.max.y-w.y)*b,C=(u.min.y-w.y)*b),U>C||d>J)return null;if((d>U||U!==U)&&(U=d),(J>C||J!==J)&&(J=C),Q>=0?(n=(u.min.z-w.z)*Q,x=(u.max.z-w.z)*Q):(n=(u.max.z-w.z)*Q,x=(u.min.z-w.z)*Q),U>x||n>J)return null;if((n>U||U!==U)&&(U=n),(J>x||J!==J)&&(J=x),0>J)return null;var I=U>=0?U:J,q=this.maxHitLen;return q&&I>q?null:this.at(I,L)},intersectTriangle:function(){var Q=new Xc,Z=new Xc,O=new Xc,S=new Xc;return function(T,x,N,g,z){Z.subVectors(x,T),O.subVectors(N,T),S.crossVectors(Z,O);var l,w=this.direction.dot(S);if(w>0){if(g)return null;l=1}else{if(!(0>w))return null;l=-1,w=-w}Q.subVectors(this.origin,T);var r=l*this.direction.dot(O.crossVectors(Q,O));if(0>r)return null;var h=l*this.direction.dot(Z.cross(Q));if(0>h||r+h>w)return null;var L=-l*Q.dot(S);if(0>L)return null;var v=L/w,o=this.maxHitLen;return o&&v>o?null:this.at(v,z)}}()});var Ek=T.Math.Box3=function(t,W){this.min=t!==c?t:new Xc(1/0,1/0,1/0),this.max=W!==c?W:new Xc(-1/0,-1/0,-1/0)};i.assign(Ek.prototype,{set:function(f,n){return this.min.copy(f),this.max.copy(n),this},setFromArray:function(p){for(var C=1/0,r=1/0,s=1/0,l=-1/0,j=-1/0,N=-1/0,o=0,e=p.length;e>o;o+=3){var v=p[o],g=p[o+1],X=p[o+2];C>v&&(C=v),r>g&&(r=g),s>X&&(s=X),v>l&&(l=v),g>j&&(j=g),X>N&&(N=X)}return this.min.set(C,r,s),this.max.set(l,j,N),this},setFromPoints:function(X){this.makeEmpty();for(var Q=0,E=X.length;E>Q;Q++)this.expandByPoint(X[Q]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(j){return j.max.x<this.min.x||j.min.x>this.max.x||j.max.y<this.min.y||j.min.y>this.max.y||j.max.z<this.min.z||j.min.z>this.max.z?!1:!0},copy:function(M){return this.min.copy(M.min),this.max.copy(M.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(C){return this.min.min(C),this.max.max(C),this},expandByBox:function(d){return this.min.min(d.min),this.max.max(d.max),this},applyMatrix4:function(){var o=[new Xc,new Xc,new Xc,new Xc,new Xc,new Xc,new Xc,new Xc];return function(P){return this.isEmpty()?this:(o[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(P),o[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(P),o[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(P),o[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(P),o[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(P),o[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(P),o[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(P),o[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(P),this.setFromPoints(o),this)}}()});var _q=T.Math.Sphere=function(y,z){this.center=y!==c?y:new Xc,this.radius=z!==c?z:0};i.assign(_q.prototype,{set:function(e,X){return this.center.copy(e),this.radius=X,this},setFromPoints:function(){var O=new Ek;return function(p,Y){var X=this.center;Y!==c?X.copy(Y):O.setFromPoints(p).getCenter(X);for(var j=0,b=0,C=p.length;C>b;b++)j=Math.max(j,X.distanceToSquared(p[b]));return this.radius=Math.sqrt(j),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(y){return this.center.copy(y.center),this.radius=y.radius,this},empty:function(){return this.radius<=0},containsPoint:function(w){return w.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(O){return O.distanceTo(this.center)-this.radius},intersectsSphere:function(n){var F=this.radius+n.radius;return n.center.distanceToSquared(this.center)<=F*F},intersectsBox:function(d){return d.intersectsSphere(this)},intersectsPlane:function(M){return Math.abs(M.distanceToPoint(this.center))<=this.radius},clampPoint:function(p,n){var b=this.center.distanceToSquared(p);return n===c&&(n=new Xc),n.copy(p),b>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(v){return v===c&&(v=new Ek),v.set(this.center,this.center),v.expandByScalar(this.radius),v},applyMatrix4:function(O){return this.center.applyMatrix4(O),this.radius=this.radius*O.getMaxScaleOnAxis(),this},translate:function(k){return this.center.add(k),this},equals:function(_){return _.center.equals(this.center)&&_.radius===this.radius}});var Pj=T.Math.Frustum=function(K,R,e,m,C,P){this.planes=[K!==c?K:new bj,R!==c?R:new bj,e!==c?e:new bj,m!==c?m:new bj,C!==c?C:new bj,P!==c?P:new bj]};i.assign(Pj.prototype,{set:function(D,E,Z,A,d,z){var t=this.planes;return t[0].copy(D),t[1].copy(E),t[2].copy(Z),t[3].copy(A),t[4].copy(d),t[5].copy(z),this},clone:function(){return(new this.constructor).copy(this)},copy:function(X){for(var g=this.planes,J=0;6>J;J++)g[J].copy(X.planes[J]);return this},setFromMatrix:function(c){var b=this.planes,s=c.el,i=s[0],P=s[1],Q=s[2],L=s[3],h=s[4],f=s[5],T=s[6],y=s[7],x=s[8],M=s[9],O=s[10],I=s[11],n=s[12],E=s[13],k=s[14],d=s[15];return b[0].setComponents(L-i,y-h,I-x,d-n).normalize(),b[1].setComponents(L+i,y+h,I+x,d+n).normalize(),b[2].setComponents(L+P,y+f,I+M,d+E).normalize(),b[3].setComponents(L-P,y-f,I-M,d-E).normalize(),b[4].setComponents(L-Q,y-T,I-O,d-k).normalize(),b[5].setComponents(L+Q,y+T,I+O,d+k).normalize(),this},intersectsObject:function(){var P=new _q;return function(U){var R=U.geometry;return null===R.boundingSphere&&R.computeBoundingSphere(),P.copy(R.boundingSphere).applyMatrix4(U.matrixWorld),this.intersectsSphere(P)}}(),intersectsSprite:function(){var M=new _q;return function(e){return M.center.set(0,0,0),M.radius=.7071067811865476,M.applyMatrix4(e.matrixWorld),this.intersectsSphere(M)}}(),intersectsSphere:function(r){for(var l=this.planes,A=r.center,$=-r.radius,T=0;6>T;T++){var v=l[T].distanceToPoint(A);if($>v)return!1}return!0},intersectsBox:function(){var O=new Xc;return function(d){for(var c=this.planes,y=0;6>y;y++){var l=c[y];if(O.x=l.normal.x>0?d.max.x:d.min.x,O.y=l.normal.y>0?d.max.y:d.min.y,O.z=l.normal.z>0?d.max.z:d.min.z,l.distanceToPoint(O)<0)return!1}return!0}}(),containsPoint:function(C){for(var r=this.planes,H=0;6>H;H++)if(r[H].distanceToPoint(C)<0)return!1;return!0}});var ab=T.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};i.assign(ab.prototype,{set:function(Z,T,v,A,k,_,G,F,t,d,y,V,e,Q,X,w){var J=this.el;return J[0]=Z,J[4]=T,J[8]=v,J[12]=A,J[1]=k,J[5]=_,J[9]=G,J[13]=F,J[2]=t,J[6]=d,J[10]=y,J[14]=V,J[3]=e,J[7]=Q,J[11]=X,J[15]=w,this},clone:function(){return(new ab).fromArray(this.el)},fromArray:function(l,f){f===c&&(f=0);for(var j=this.el,E=0;16>E;E++)j[E]=l[E+f];return this},getElements:function(){return this.el},scale:function(T){var f=this.el,H=T.x,Z=T.y,X=T.z;return f[0]*=H,f[4]*=Z,f[8]*=X,f[1]*=H,f[5]*=Z,f[9]*=X,f[2]*=H,f[6]*=Z,f[10]*=X,f[3]*=H,f[7]*=Z,f[11]*=X,this},makeRotationFromEuler:function($){var B=this.el,g=$._x,L=$._y,e=$._z,Y=$._order,y=Math.cos(g),F=Math.sin(g),S=Math.cos(L),l=Math.sin(L),q=Math.cos(e),K=Math.sin(e);if("XYZ"===Y){var o=y*q,H=y*K,n=F*q,h=F*K;B[0]=S*q,B[4]=-S*K,B[8]=l,B[1]=H+n*l,B[5]=o-h*l,B[9]=-F*S,B[2]=h-o*l,B[6]=n+H*l,B[10]=y*S}else if("YXZ"===Y){var p=S*q,Q=S*K,x=l*q,c=l*K;B[0]=p+c*F,B[4]=x*F-Q,B[8]=y*l,B[1]=y*K,B[5]=y*q,B[9]=-F,B[2]=Q*F-x,B[6]=c+p*F,B[10]=y*S}else if("ZXY"===Y){var p=S*q,Q=S*K,x=l*q,c=l*K;B[0]=p-c*F,B[4]=-y*K,B[8]=x+Q*F,B[1]=Q+x*F,B[5]=y*q,B[9]=c-p*F,B[2]=-y*l,B[6]=F,B[10]=y*S}else if("ZYX"===Y){var o=y*q,H=y*K,n=F*q,h=F*K;B[0]=S*q,B[4]=n*l-H,B[8]=o*l+h,B[1]=S*K,B[5]=h*l+o,B[9]=H*l-n,B[2]=-l,B[6]=F*S,B[10]=y*S}else if("YZX"===Y){var C=y*S,M=y*l,j=F*S,D=F*l;B[0]=S*q,B[4]=D-C*K,B[8]=j*K+M,B[1]=K,B[5]=y*q,B[9]=-F*q,B[2]=-l*q,B[6]=M*K+j,B[10]=C-D*K}else if("XZY"===Y){var C=y*S,M=y*l,j=F*S,D=F*l;B[0]=S*q,B[4]=-K,B[8]=l*q,B[1]=C*K+D,B[5]=y*q,B[9]=M*K-j,B[2]=j*K-M,B[6]=F*q,B[10]=D*K+C}return B[3]=0,B[7]=0,B[11]=0,B[12]=0,B[13]=0,B[14]=0,B[15]=1,this},makeRotationFromQuaternion:function(P){var H=this.el,i=P._x,v=P._y,B=P._z,K=P._w,g=i+i,f=v+v,n=B+B,A=i*g,s=i*f,l=i*n,R=v*f,S=v*n,d=B*n,j=K*g,Z=K*f,F=K*n;return H[0]=1-(R+d),H[4]=s-F,H[8]=l+Z,H[1]=s+F,H[5]=1-(A+d),H[9]=S-j,H[2]=l-Z,H[6]=S+j,H[10]=1-(A+R),H[3]=0,H[7]=0,H[11]=0,H[12]=0,H[13]=0,H[14]=0,H[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(C){var f=this.el,R=C.el,Y=R[0],F=R[1],A=R[2],n=R[3],t=R[4],j=R[5],d=R[6],L=R[7],a=R[8],m=R[9],y=R[10],J=R[11],z=R[12],v=R[13],W=R[14],D=R[15],s=m*W*L-v*y*L+v*d*J-j*W*J-m*d*D+j*y*D,r=z*y*L-a*W*L-z*d*J+t*W*J+a*d*D-t*y*D,X=a*v*L-z*m*L+z*j*J-t*v*J-a*j*D+t*m*D,w=z*m*d-a*v*d-z*j*y+t*v*y+a*j*W-t*m*W,Q=Y*s+F*r+A*X+n*w;if(0===Q)return this.identity();var o=1/Q;return f[0]=s*o,f[1]=(v*y*n-m*W*n-v*A*J+F*W*J+m*A*D-F*y*D)*o,f[2]=(j*W*n-v*d*n+v*A*L-F*W*L-j*A*D+F*d*D)*o,f[3]=(m*d*n-j*y*n-m*A*L+F*y*L+j*A*J-F*d*J)*o,f[4]=r*o,f[5]=(a*W*n-z*y*n+z*A*J-Y*W*J-a*A*D+Y*y*D)*o,f[6]=(z*d*n-t*W*n-z*A*L+Y*W*L+t*A*D-Y*d*D)*o,f[7]=(t*y*n-a*d*n+a*A*L-Y*y*L-t*A*J+Y*d*J)*o,f[8]=X*o,f[9]=(z*m*n-a*v*n-z*F*J+Y*v*J+a*F*D-Y*m*D)*o,f[10]=(t*v*n-z*j*n+z*F*L-Y*v*L-t*F*D+Y*j*D)*o,f[11]=(a*j*n-t*m*n-a*F*L+Y*m*L+t*F*J-Y*j*J)*o,f[12]=w*o,f[13]=(a*v*A-z*m*A+z*F*y-Y*v*y-a*F*W+Y*m*W)*o,f[14]=(z*j*A-t*v*A-z*F*d+Y*v*d+t*F*W-Y*j*W)*o,f[15]=(t*m*A-a*j*A+a*F*d-Y*m*d-t*F*y+Y*j*y)*o,this},makeRotationAxis:function(P,q){var A=Math.cos(q),c=Math.sin(q),T=1-A,p=P.x,L=P.y,M=P.z,O=T*p,j=T*L;return this.set(O*p+A,O*L-c*M,O*M+c*L,0,O*L+c*M,j*L+A,j*M-c*p,0,O*M-c*L,j*M+c*p,T*M*M+A,0,0,0,0,1),this},multiply:function(k){return this.multiplyMatrices(this,k)},premultiply:function(G){return this.multiplyMatrices(G,this)},multiplyMatrices:function(b,e){var R=b.el,G=e.el,s=this.el,o=R[0],K=R[4],F=R[8],I=R[12],k=R[1],H=R[5],r=R[9],t=R[13],P=R[2],n=R[6],X=R[10],j=R[14],u=R[3],Z=R[7],v=R[11],A=R[15],S=G[0],i=G[4],f=G[8],g=G[12],J=G[1],p=G[5],$=G[9],h=G[13],B=G[2],Q=G[6],l=G[10],d=G[14],w=G[3],U=G[7],T=G[11],N=G[15];return s[0]=o*S+K*J+F*B+I*w,s[4]=o*i+K*p+F*Q+I*U,s[8]=o*f+K*$+F*l+I*T,s[12]=o*g+K*h+F*d+I*N,s[1]=k*S+H*J+r*B+t*w,s[5]=k*i+H*p+r*Q+t*U,s[9]=k*f+H*$+r*l+t*T,s[13]=k*g+H*h+r*d+t*N,s[2]=P*S+n*J+X*B+j*w,s[6]=P*i+n*p+X*Q+j*U,s[10]=P*f+n*$+X*l+j*T,s[14]=P*g+n*h+X*d+j*N,s[3]=u*S+Z*J+v*B+A*w,s[7]=u*i+Z*p+v*Q+A*U,s[11]=u*f+Z*$+v*l+A*T,s[15]=u*g+Z*h+v*d+A*N,this},lookAt:function(){var f=new Xc;return function(U,T,G){return f.subVectors(U,T),this.lookAtDirection(f,G)}}(),lookAtDirection:function(){var w=new Xc,V=new Xc,S=new Xc;return function(z,d){var o=this.el;return S.copy(z),0===S.lengthSq()&&(S.z=1),S.normalize(),w.crossVectors(d,S),0===w.lengthSq()&&(1===Math.abs(d.z)?S.x+=1e-4:S.z+=1e-4,S.normalize(),w.crossVectors(d,S)),w.normalize(),V.crossVectors(S,w),o[0]=w.x,o[4]=V.x,o[8]=S.x,o[1]=w.y,o[5]=V.y,o[9]=S.y,o[2]=w.z,o[6]=V.z,o[10]=S.z,this}}(),extractScale:function(){var $;return function(Q){$===c&&($=new Xc),Q===c&&(Q=new Xc);var T=$.setFromMatrixColumn(this,0).length(),W=$.setFromMatrixColumn(this,1).length(),O=$.setFromMatrixColumn(this,2).length();return Q.set(T,W,O),Q}}(),extractRotation:function(){var O;return function(R){O===c&&(O=new Xc),R===c&&(R=new ab);var d=this.el,a=R.el,_=1/O.setFromMatrixColumn(R,0).length(),i=1/O.setFromMatrixColumn(R,1).length(),h=1/O.setFromMatrixColumn(R,2).length();return d[0]=a[0]*_,d[1]=a[1]*_,d[2]=a[2]*_,d[4]=a[4]*i,d[5]=a[5]*i,d[6]=a[6]*i,d[8]=a[8]*h,d[9]=a[9]*h,d[10]=a[10]*h,this}}(),multiplyScalar:function(p){var h=this.el;return h[0]*=p,h[4]*=p,h[8]*=p,h[12]*=p,h[1]*=p,h[5]*=p,h[9]*=p,h[13]*=p,h[2]*=p,h[6]*=p,h[10]*=p,h[14]*=p,h[3]*=p,h[7]*=p,h[11]*=p,h[15]*=p,this},getPosition:function(N){return N===c&&(N=new Xc),N.setFromMatrixColumn(this,3)},setPosition:function(o){var N=this.el;return N[12]=o.x,N[13]=o.y,N[14]=o.z,this},toArray:function(d,A){d===c&&(d=[]),A===c&&(A=0);var L=this.el;return d[A]=L[0],d[A+1]=L[1],d[A+2]=L[2],d[A+3]=L[3],d[A+4]=L[4],d[A+5]=L[5],d[A+6]=L[6],d[A+7]=L[7],d[A+8]=L[8],d[A+9]=L[9],d[A+10]=L[10],d[A+11]=L[11],d[A+12]=L[12],d[A+13]=L[13],d[A+14]=L[14],d[A+15]=L[15],d},determinant:function(){var s=this.el,A=s[0],b=s[4],G=s[8],O=s[12],R=s[1],Y=s[5],m=s[9],T=s[13],u=s[2],J=s[6],H=s[10],C=s[14],M=s[3],c=s[7],e=s[11],p=s[15];return M*(+O*m*J-G*T*J-O*Y*H+b*T*H+G*Y*C-b*m*C)+c*(+A*m*C-A*T*H+O*R*H-G*R*C+G*T*u-O*m*u)+e*(+A*T*J-A*Y*C-O*R*J+b*R*C+O*Y*u-b*T*u)+p*(-G*Y*u-A*m*J+A*Y*H+G*R*J-b*R*H+b*m*u)},copy:function(V){var m=this.el,s=V.el;return m[0]=s[0],m[1]=s[1],m[2]=s[2],m[3]=s[3],m[4]=s[4],m[5]=s[5],m[6]=s[6],m[7]=s[7],m[8]=s[8],m[9]=s[9],m[10]=s[10],m[11]=s[11],m[12]=s[12],m[13]=s[13],m[14]=s[14],m[15]=s[15],this},compose:function(h,C,A){var O=this.el,T=C._x,t=C._y,n=C._z,B=C._w,i=T+T,e=t+t,R=n+n,X=T*i,G=T*e,Y=T*R,W=t*e,P=t*R,y=n*R,K=B*i,s=B*e,x=B*R,$=A.x,J=A.y,k=A.z;return O[0]=(1-(W+y))*$,O[1]=(G+x)*$,O[2]=(Y-s)*$,O[3]=0,O[4]=(G-x)*J,O[5]=(1-(X+y))*J,O[6]=(P+K)*J,O[7]=0,O[8]=(Y+s)*k,O[9]=(P-K)*k,O[10]=(1-(X+W))*k,O[11]=0,O[12]=h.x,O[13]=h.y,O[14]=h.z,O[15]=1,this},decompose:function(){var c=new Xc,G=new ab;return function(t,J,g){var P=this.el,y=c.set(P[0],P[1],P[2]).length(),W=c.set(P[4],P[5],P[6]).length(),V=c.set(P[8],P[9],P[10]).length(),U=this.determinant();0>U&&(y=-y),t.x=P[12],t.y=P[13],t.z=P[14],G.copy(this);var C=1/y,j=1/W,D=1/V;return G.el[0]*=C,G.el[1]*=C,G.el[2]*=C,G.el[4]*=j,G.el[5]*=j,G.el[6]*=j,G.el[8]*=D,G.el[9]*=D,G.el[10]*=D,J.setFromRotationMatrix(G),g.x=y,g.y=W,g.z=V,this}}()});var Gl=T.Math.Triangle=function(P,V,B){this.a=P!==c?P:new Xc,this.b=V!==c?V:new Xc,this.c=B!==c?B:new Xc};i.assign(Gl,{barycoordFromPoint:function(){var i=new Xc,j=new Xc,f=new Xc;return function(h,$,B,q,z){i.subVectors(q,$),j.subVectors(B,$),f.subVectors(h,$);var b=i.dot(i),M=i.dot(j),_=i.dot(f),I=j.dot(j),W=j.dot(f),N=b*I-M*M,Z=z||new Xc;if(0===N)return Z.set(-2,-1,-1);var v=1/N,e=(I*_-M*W)*v,O=(b*W-M*_)*v;return Z.set(1-e-O,O,e)}}()});var Lc=T.Math.Euler=function(L,C,$,o,e){this.set(L,C,$,o,e)};Lc.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Lc.DefaultOrder="XYZ",Lc.ReverseOrder=function(){var g={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(J){return g[J]}}(),i.defineProperties(Lc.prototype,{x:{get:function(){return this._x},set:function(l){this._x=l,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(k){this._y=k,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(N){this._z=N,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(z){this._order=z,this.onChangeCallback()}}}),i.assign(Lc.prototype,{set:function(z,n,k,e,u){return tj(z)&&(u=k,e=n,k=z[2],n=z[1],z=z[0]),e?u&&(e=Lc.ReverseOrder(e)):e="ZYX",this._x=z||0,this._y=n||0,this._z=k||0,this._order=e||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function($){return this._x=$._x,this._y=$._y,this._z=$._z,this._order=$._order,this.onChangeCallback(),this},setFromRotationMatrix:function(l,X,Z){var z=T.Math.clamp,B=l.el||l,s=B[0],o=B[4],a=B[8],y=B[1],U=B[5],c=B[9],p=B[2],_=B[6],h=B[10];return X=X||this._order,"XYZ"===X?(this._y=Math.asin(z(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(_,U),this._z=0)):"YXZ"===X?(this._x=Math.asin(-z(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(a,h),this._z=Math.atan2(y,U)):(this._y=Math.atan2(-p,s),this._z=0)):"ZXY"===X?(this._x=Math.asin(z(_,-1,1)),Math.abs(_)<.99999?(this._y=Math.atan2(-p,h),this._z=Math.atan2(-o,U)):(this._y=0,this._z=Math.atan2(y,s))):"ZYX"===X?(this._y=Math.asin(-z(p,-1,1)),Math.abs(p)<.99999?(this._x=Math.atan2(_,h),this._z=Math.atan2(y,s)):(this._x=0,this._z=Math.atan2(-o,U))):"YZX"===X?(this._z=Math.asin(z(y,-1,1)),Math.abs(y)<.99999?(this._x=Math.atan2(-c,U),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(a,h))):"XZY"===X?(this._z=Math.asin(-z(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(_,U),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-c,h),this._y=0)):console.warn("unsupported order: "+X),this._order=X,Z!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var J=new ab;return function(d,u,X){return J.makeRotationFromQuaternion(d),this.setFromRotationMatrix(J,u,X)}}(),setFromVector3:function(n,X){return this.set(n.x,n.y,n.z,X||this._order)
},reorder:function(){var G=new oc;return function(J){return G.setFromEuler(this),this.setFromQuaternion(G,J)}}(),equals:function(D){return D._x===this._x&&D._y===this._y&&D._z===this._z&&D._order===this._order},fromArray:function(z){return this._x=z[0],this._y=z[1],this._z=z[2],z[3]!==c&&(this._order=z[3]),this.onChangeCallback(),this},toArray:function(O,r){return O===c&&(O=[]),r===c&&(r=0),O[r]=this._x,O[r+1]=this._y,O[r+2]=this._z,O[r+3]=this._order,O},toVector3:function(X){return X?X.set(this._x,this._y,this._z):new Xc(this._x,this._y,this._z)},onChange:function(E){return this.onChangeCallback=E,this},onChangeCallback:function(){}});var Jm={ms_ac:function(c,m){for(var o=m.ms_ac,l=0;l<o.length;l++)pl(c,o[l])},ms_listener:function(I){I.addListeners=function(){var M=this,o=dn;L.mockTouch&&(o=$f.concat(kh).concat(Xj)),M.__events__=o;for(var E=0,U=o.length;U>E;E++){var f=o[E];"wheel"===f&&!M.handle_wheel&&M.handle_mousewheel&&(M.handle_wheel=function(U){ng(M,U)}),M["handle_"+f]&&Cc(f,M.getView(),M)}},I.removeListeners=function(){var w=this,z=w.__events__;if(z){w.__events__=c;for(var P=0,Q=z.length;Q>P;P++)w["handle_"+z[P]]&&oh(z[P],w.getView(),w)}}},ms_fire:function(c){c.mp=function(p,U,q){this.addPropertyChangeListener(p,U,q)},c.ump=function(S,P){this.removePropertyChangeListener(S,P)},c.fp=function(s,d,Z,t,A){return this.firePropertyChange(s,d,Z,t,A)},c.addPropertyChangeListener=function(D,g,i){var Z=this;Z._62I||(Z._62I=new wq),Z._62I.add(D,g,i)},c.removePropertyChangeListener=function(U,s){this._62I&&this._62I.remove(U,s)},c.firePropertyChange=function(K,$,G,X,U){if(X){if(X($,G))return!1}else if($===G)return!1;var g=this,E=U||{};return E.property=K,E.oldValue=$,E.newValue=G,E.source=g,E.data=g,g._62I&&g._62I.fire(E),g.onPropertyChanged&&g.onPropertyChanged(E),!0}},ms_attr:function(F){F.a=function(j,h){var T=this;if(2===arguments.length)T.setAttr(j,h);else{if(!Ue(j))return T.getAttr(j);for(var y in j)T.setAttr(y,j[y])}return T},F.getAttr=function(M,O){if(O===c&&(O=1),this._attrObject&&M in this._attrObject)return this._attrObject[M];if(this.getImage){var r=this.getImage();if(em(r)&&(r=pe[r]),Ue(r)&&"dataBindings"in r)for(var T=r.dataBindings,F=T.length-1;F>=0;F--){var p=T[F];if(p.attr===M){if("defaultValue"in p)return p.defaultValue;break}}}return O?A[M]:c},F.setAttr=function(Z,i){var p=this;p._attrObject||(p._attrObject={});var U=p._attrObject[Z];i===c?delete p._attrObject[Z]:p._attrObject[Z]=i,p.fp&&p.fp("a:"+Z,U,i)&&p.onAttrChanged&&p.onAttrChanged(Z,U,i)},F.getSerializableAttrs=function(){var a,q={};for(a in this._attrObject)q[a]=1;return q}},ms_bnb:function(h){h.getBodyColor=function(W){return W.s("body.color")},h.getBorderColor=function(K){return K.s("border.color")}},_51o:function(Q){Q.mi=function(G,M,H){this.addInteractorListener(G,M,H)},Q.umi=function($,t){this.removeInteractorListener($,t)},Q.fi=function(H){this.fireInteractorEvent(H)},Q.addInteractorListener=function(f,O,Y){var E=this;E._63I||(E._63I=new wq),E._63I.add(f,O,Y)},Q.removeInteractorListener=function(I,S){this._63I&&this._63I.remove(I,S)},Q.fireInteractorEvent=function(P){this._63I&&this._63I.fire(P)},Q.setInteractors=function(b){var w=this,i=w._interactors;i&&i.each(function(Y){Y.tearDown()}),tj(b)&&(b=new Dd(b)),w._interactors=b,b&&b.each(function(i){i.setUp()}),w.fp("interactors",i,b),w.invalidateSelection()},Q.getInteractors=function(){return this._interactors}},_49o:function(s){s._44O=Z,s._45O=Z,s.getTopPainters=function(){return this._44O},s.getBottomPainters=function(){return this._45O},s.addTopPainter=function(T){var o=this;o._44O||(o._44O=new Dd),o._44O.contains(T)||(o._44O.add(T),o.redraw&&o.redraw())},s.removeTopPainter=function(V){var e=this;e._44O&&(e._44O.remove(V),e.redraw&&e.redraw())},s.addBottomPainter=function(P){var F=this;F._45O||(F._45O=new Dd),F._45O.contains(P)||(F._45O.add(P),F.redraw&&F.redraw())},s.removeBottomPainter=function(u){var K=this;K._45O&&(K._45O.remove(u),K.redraw&&K.redraw())},s._93db=function(J,B){var j=this;j._45O&&j._45O.each(function(m){m.draw?m.draw(J,B):m.call(j,J,B)})},s._92db=function(m,y){var L=this;L._44O&&L._44O.each(function($){$.draw?$.draw(m,y):$.call(L,m,y)})}},ms_sm:function(F){F.sm=function(){return this.getSelectionModel()},F.setSelectableFunc=function(c){this.sm().setFilterFunc(c)},F.getSelectableFunc=function(){return this.sm().getFilterFunc()},F.getSelectionModel=function(){var E=this;return E._selectionModel?E._selectionModel:E.dm().sm()},F.isSelectionModelShared=function(){return!this._selectionModel},F.setSelectionModelShared=function(T){var G=this,M=!G._selectionModel,x=G.handleSelectionChange,p=G.dm();M!==T&&(G.invalidateSelection&&G.invalidateSelection(),T?(p.sm().ms(x,G),G._selectionModel.ums(x,G),G._selectionModel.dispose(),G._selectionModel=Z):(p.sm().ums(x,G),G._selectionModel=new cs(p),G._selectionModel.ms(x,G)),G.onSelectionModelSharedChanged(),G.fp("selectionModelShared",M,T))},F.onSelectionModelSharedChanged=function(){var e=this;e.redraw(),e.invalidateSelection&&e.invalidateSelection()},F.removeSelection=function(){var T=this.dm();T.beginTransaction(),this.sm().toSelection().each(T.remove,T),T.endTransaction()},F.selectAll=function(){var M=this;M.sm().ss(M.dm().toDatas(function(B){return M.isVisible(B)&&M.isSelectable(B)}))},F.isSelected=function(K){return this.sm().co(K)},F.isSelectedById=function(T){var n=this.dm().getDataById(T);return n?this.isSelected(n):!1},F.isSelectable=function(r){return this.sm().isSelectable(r)}},ms_tx:function(t){t._64I=0,t._65O=0,t.isScrollable=function(){return this.getWidth()<this._64I},t._40o=function(){return this.isScrollable()},t.getLogicalPoint=function(c){return we(c,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},t.tx=function(t){return t===c?this.getTranslateX():(this.setTranslateX(t),void 0)},t.getTranslateX=function(){return this._65O},t.setTranslateX=function(O){var Z=this,w=Z.getWidth()-Z._64I;w>O&&(O=w),O>0&&(O=0),O=y(O);var h=Z._65O;Z._65O=O,Z.fp(jm,h,O)}},ms_ty:function(P){P._23Q=0,P._66O=0,P._41o=function(){return this.getHeight()<this._23Q},P.getLogicalPoint=function(l){return we(l,this._canvas||this._view,this.tx?this.tx():0,this.ty())},P.ty=function(I){return I===c?this.getTranslateY():(this.setTranslateY(I),void 0)},P.getTranslateY=function(){return this._66O},P.setTranslateY=function(S){var h=this,_=h.getHeight()-h._23Q;_>S&&(S=_),S>0&&(S=0),S=y(S);var e=h._66O;h._66O=S,h.fp(uf,e,S)}},ms_txy:function(G){G._65O=0,G._66O=0,G.tx=function(j){return j===c?this.getTranslateX():(this.setTranslateX(j),void 0)},G.ty=function(e){return e===c?this.getTranslateY():(this.setTranslateY(e),void 0)},G.onTranslateEnded=function(){},G.setTranslate=function(s,a,n){var J=this;if(n=Ej(n)){J._65I&&J._65I.stop(!0);var N=J.tx(),x=J.ty();n.action=function(T){J.setTranslate(N+(s-N)*T,x+(a-x)*T)},n._37o=function(){delete J._66I,delete J._65I,J.onTranslateEnded()},J._66I=1,J._65I=uo(n)}else J.tx(s),J.ty(a)},G.getTranslateX=function(){return this._65O},G.setTranslateX=function(w){var g=this;w=g.adjustTranslateX(w);var n=g._65O;g._65O=w,g.fp(jm,n,w)},G.getTranslateY=function(){return this._66O},G.setTranslateY=function(X){var w=this;X=w.adjustTranslateY(X);var I=w._66O;w._66O=X,w.fp(uf,I,X)},G.adjustTranslateX=function(I){return y(I)},G.adjustTranslateY=function(i){return y(i)},G.translate=function(A,c,Y){this.setTranslate(this.tx()+A,this.ty()+c,Y)},G.getLogicalPoint=function(m){var e=this;return we(m,this._canvas||e._view,e.tx(),e.ty())}},ms_dm:function(B){B.dm=function(U){return U?(this.setDataModel(U),void 0):this.getDataModel()},B.getDataModel=function(){return this._dataModel}},ms_lp:function(r){r.lp=function(g){return this.getLogicalPoint(g)}},ms_v:function(V){V._disabled=!1,V.setDisabled=function(p,G){var M=this,J=M._disabled;J!==p&&(J&&(ws(M._63O),delete M._63O),p&&(Fd(M._view,M._63O=As(G)),M.iv()),M._disabled=p,M.fp("disabled",J,p))},V.isDisabled=function(){return this._disabled},V.getDisabledDiv=function(){return this._63O},V.getView=function(){return this._view},V.addToDOM=function(d){var w=this,F=w.getView(),C=F.style;d=d||t.body,d.appendChild(F),C.left="0",C.right="0",C.top="0",C.bottom="0",n(j,"resize",function(){w.iv()}),w.iv()},V.getWidth=function(){return this._view.clientWidth},V.getHeight=function(){return this._view.clientHeight},V.setWidth=function(g){var q=this;q._view.style.width=g+sj,q.iv(),q.fp&&q.fp(zp,Z,g)},V.setHeight=function(X){var U=this;U._view.style.height=X+sj,U.iv(),U.fp&&U.fp(Sn,Z,X)},V.setFocus=function(J){var n=this,k=n._currentEditor;return J&&k&&(k.getView&&(k=k.getView()),k.contains(J.target))?!1:(mk(n._view),n.endEditing&&n.endEditing(),n.fireViewEvent("focus"),!0)},V.iv=function(c){this.invalidate(c)},V.invalidate=function(v){var G=this;G._68I||(G._68I=1,jf(G.validate,G,Z,v),G.onInvalidated&&G.onInvalidated(),G.fireViewEvent("invalidate"))},V.validate=function(){var S=this,z=S._view;if(S._68I&&(delete S._68I,z.parentNode))if(0===z.offsetWidth&&0===z.offsetHeight&&S._67I!==Z)S._67I===c&&(S._67I=L.reinvalidateCount),S._67I>0?S._67I--:S._67I=Z,S.iv();else{S.fireViewEvent("beginValidate"),S.validateImpl(),S.onValidated&&S.onValidated(),S.fireViewEvent("validate");var y=S._63O;y&&(z.lastChild!==y&&(ws(y),Fd(z,y)),Rf(y,0,0,S.getWidth(),S.getHeight())),Pl(S),dm(S),bm(S)}},V.layout=function(h,E,B,c){1===arguments.length?Rf(this,h):Rf(this,h,E,B,c)},V.addViewListener=function(t,q,J){var k=this;k._67O||(k._67O=new wq),k._67O.add(t,q,J)},V.removeViewListener=function(W,z){this._67O.remove(W,z)},V.fireViewEvent=function(G){var K=this;K._67O&&(em(G)&&(G={kind:G}),K._67O.fire(G)),L.viewListener&&L.viewListener(K,G)}},ms_tip:function(G){G.setToolTipEnabled=function(_){var N=this;_?Km||N._13o||(N.enableToolTip(),N.fp("toolTipEnabled",!1,!0)):N._13o&&(N.disableToolTip(),N.fp("toolTipEnabled",!0,!1))},G.isToolTipEnabled=function(){return!!this._13o},G.enableToolTip=function(){var S=this;if(!Km&&!S._13o){S._13o=function(m){var X=S.getToolTip(m);X!=Z?(L.toolTipContinual&&L.isToolTipShowing()?Qh(m,X):(Te(),Xk={timeout:vc(On,ld),e:m,info:X}),Xd={e:m,view:S}):Te()};var o=S.getView();n(o,Cn,S._13o),n(o,"mouseleave",L.hideToolTip)}},G.disableToolTip=function(){var I=this;if(I._13o){var G=I.getView();M(G,Cn,I._13o),M(G,"mouseleave",L.hideToolTip),delete I._13o}},G.getToolTip=function(L){var V=this;if(V.getDataAt){var W=V.getDataAt(L);return W?W.getToolTip():Z}return V.getValue?V.getValue():void 0}},_52o:function(P){P._zoom=1,P._29I=Cp,P.zoomIn=function(I,m){this.setZoom(this._zoom*Yk,I,m)},P.zoomOut=function(F,w){this.setZoom(this._zoom/Yk,F,w)},P.zoomReset=function(s,E){this.setZoom(1,s,E)},P.scrollZoomIn=function(_){this.setZoom(this._zoom*ys,Z,_)},P.scrollZoomOut=function(L){this.setZoom(this._zoom/ys,Z,L)},P.pinchZoomIn=function(H){this.setZoom(this._zoom*yl,Z,H)},P.pinchZoomOut=function(h){this.setZoom(this._zoom/yl,Z,h)},P.adjustZoom=function(v){return ok>v?ok:v>Ho?Ho:v},P.getZoom=function(){return this._zoom},P.setZoom=function(w,g,d){var W=this;if(g=Ej(g)){W._14o&&W._14o.stop(!0);var p=W._zoom;g.action=function(x){W._96O(p+(w-p)*x,d)},g._37o=function(){delete W._zooming,delete W._14o,W.onZoomEnded()},W._zooming=1,W._14o=uo(g)}else W._96O(w,d)},P._96O=function(T,A){var E=this;if(T=E.adjustZoom(T),T!==E._zoom){E.validate();var W=E._29I,u=E._zoom;0!==W.width&&0!==W.height&&(A=A?A:{x:W.x+W.width/2,y:W.y+W.height/2},E.tx((A.x-W.x)*u-A.x*T),E.ty((A.y-W.y)*u-A.y*T)),E._zoom=T,E.fp("zoom",u,T)}}},ms_edge:function(D){D._2I=function(d){var h=this;h._44I||(h._44I=new Dd),h._42I||(h._42I=new Dd),h._44I.add(d),h._42I.add(d),h._20I()},D._4I=function(c){var Y=this;Y._44I||(Y._44I=new Dd),Y._43I||(Y._43I=new Dd),Y._44I.add(c),Y._43I.add(c),Y._20I()},D._16I=function(B){var X=this;X._44I.remove(B),X._42I.remove(B),X._44I.isEmpty()&&delete X._44I,X._42I.isEmpty()&&delete X._42I,X._20I()},D._18I=function(O){var G=this;G._44I.remove(O),G._43I.remove(O),G._44I.isEmpty()&&delete G._44I,G._43I.isEmpty()&&delete G._43I,G._20I()},D._20I=function(){var c=this;if(delete c._45I,!c._44I||c._44I.isEmpty())return delete c._70O,void 0;var v;c._44I.each(function(H){H.isLooped()&&(v||(v={}),v[H._id]||(c._45I||(c._45I=new Dd),c._45I.add(H),v[H._id]=H))}),v?(c._70O=new Dd,c._44I.each(function(m){v[m._id]?"A"===v[m._id]||(v[m._id]="A",c._70O.add(m)):c._70O.add(m)})):c._70O=c._44I},D.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},D.getSourceAgentEdges=function(){return this._46I},D.getTargetAgentEdges=function(){return this._47I},D._1I=function(K){var E=this;E._46I||(E._46I=new Dd),E._48I||(E._48I=new Dd),E._46I.add(K),E._48I.add(K),E._19I()},D._3I=function(l){var F=this;F._47I||(F._47I=new Dd),F._48I||(F._48I=new Dd),F._47I.add(l),F._48I.add(l),F._19I()},D._15I=function(M){var x=this;x._46I.remove(M),x._48I.remove(M),x._46I.isEmpty()&&delete x._46I,x._48I.isEmpty()&&delete x._48I,x._19I()},D._17I=function(C){var T=this;T._47I.remove(C),T._48I.remove(C),T._47I.isEmpty()&&delete T._47I,T._48I.isEmpty()&&delete T._48I,T._19I()},D._19I=function(){var E=this;delete E._49I;var W=E._48I;if(W&&!W.isEmpty()){var X={};W.each(function(a){X[a._id]?E._49I||(E._49I=new Dd):X[a._id]=a}),E._49I?W.each(function(r){X[r._id]&&(E._49I.add(r),delete X[r._id])}):E._49I=W}},D.getLoopedEdges=function(){return this._45I},D.getEdges=function(){return this._70O},D.getAgentEdges=function(){return this._49I},D.getSourceEdges=function(){return this._42I},D.getTargetEdges=function(){return this._43I},D._8I=function(){this._70O&&this._70O.each(function(j){j._7I()})}},ms_shadow:function(S){Al.PARAMS.forEach(function(j){var l=j.replace(/(^|\.)[a-z]/g,function(n){return n[n.length-1].toUpperCase()}),d=l.charAt(0).toLowerCase()+l.substr(1);S["getShadow"+l]=function(){return this._getShadowParam(d)},S["setShadow"+l]=function(A){this._setShadowParam(d,A)}}),S.enableShadow=function(J){this.shadowMap.setShadow(!0,J)},S.disableShadow=function(){this.shadowMap.setShadow(!1)},S._getShadowParam=function(w){return this.shadowMap.getShadow()[w]},S._setShadowParam=function(M,m){var X=this._getShadowParam(M),a={};a[M]=m;var D=this.shadowMap;D.setShadow(D.enable,a),this.firePropertyChange("shadow"+M.charAt(0).toUpperCase()+M.substr(1),X,m)}}};kp(L,{getVersion:function(){return"7.2.4"}},!0),kp(L,{numberDigits:5,crossOrigin:"",baseZIndex:c,isTouchable:Km,mockTouch:!0,devicePixelRatio:j.devicePixelRatio?j.devicePixelRatio:j.screen?j.screen.deviceXDPI/j.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:x.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return ei},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(e){return e*e},labelColor:yr,labelSelectColor:Wm,labelFont:"12px arial, sans-serif",widgetIndent:Km?30:20,widgetRowHeight:Km?30:20,widgetHeaderHeight:Km?32:22,widgetTitleHeight:Km?34:24,scrollBarColor:Ep,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Km?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:ln,intersectionLineLine:He,isEnter:Pp,isEsc:bf,isDelete:Tr,isSpace:Zh,isLeft:uj,isUp:np,isRight:Wn,isDown:ob,isTouchEvent:wf,getTarget:zj,isString:em,isNumber:km,isBoolean:Xe,isArray:tj,isSelectAll:Vi,isFunction:ik,isObject:Ue,getPropertyValue:Nl,setPropertyValue:In,addMethod:kp,createGradient:function(v,g,Z,B,U,s,y,L){var A=tb[g];return A(v,Z,B,U,s,y,L)},appendToScreen:function(B){B=B.getView?B.getView():B,(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement||t.body).appendChild(B)},encodeString:function(E){return T.Math.encodeBase64(E,L.encodeStringKey)},decodeString:function(H){return T.Math.decodeBase64(H,L.encodeStringKey)},findView:function(Z){var j=function(r,J){var z=J._ht;z&&r.push(z);var F=J.children,p=F.length;if(p)for(var L=0;p>L;L++)j(r,F[L])},p=[];j(p,t.body);var f=function(n,f){for(var L="2d"===f?si.GraphView:Ar.Graph3dView,O=0,M=n.length;M>O;O++)if(n[O]instanceof L)return p[O];return null};return"all"===Z?p:"2d"===Z?f(p,"2d"):"3d"===Z?f(p,"3d"):f(p,"3d")||f(p,"2d")},toggleFullscreen:function(n){var K=n.getView();if(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement)t.exitFullscreen?t.exitFullscreen():t.msExitFullscreen?t.msExitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen();else{var u=!0;if(n.isSelfViewEvent){var Q=n.getX(),N=n.getY(),$=n.getWidth(),e=n.getHeight(),P=K.style.background,q=K.style.backgroundColor;P||q||(K.style.backgroundColor="white"),K.requestFullscreen?K.requestFullscreen():K.msRequestFullscreen?K.msRequestFullscreen():K.mozRequestFullScreen?K.mozRequestFullScreen():K.webkitRequestFullscreen&&K.webkitRequestFullscreen();var g=setInterval(function(){if(K!==(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement))clearInterval(g),n.setX(Q),n.setY(N),n.setWidth($),n.setHeight(e),n._fullscreen=!1,K.style.oldBackgroundColor=q,n.iv();else{var P=T.Default.getWindowInfo();(u||P.width!==n.getWidth()||P.height!==n.getHeight())&&(n.setX(P.left),n.setY(P.top),n.setWidth(P.width),n.setHeight(P.height),n._fullscreen=!0,n.iv(),u=!1)}},500)}else{var w=K.style.left,j=K.style.top,$=K.style.width,e=K.style.height,P=K.style.background,q=K.style.backgroundColor;P||q||(K.style.backgroundColor="white"),K.requestFullscreen?K.requestFullscreen():K.msRequestFullscreen?K.msRequestFullscreen():K.mozRequestFullScreen?K.mozRequestFullScreen():K.webkitRequestFullscreen&&K.webkitRequestFullscreen();var g=setInterval(function(){if(K!==(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement))clearInterval(g),K.style.left=w,K.style.top=j,K.style.width=$,K.style.height=e,K.style.oldBackgroundColor=q,n.iv();else{var Q=T.Default.getWindowInfo();(u||Q.width!==n.getWidth()||Q.height!==n.getHeight())&&(Rf(n),u=!1)}},500)}}},appendTimeStamp:function(w){return w},setCompType:function(v,R){em(R)&&R.substr(0,12)==vq&&(R=L.parse(R)),ik(R)||Ue(R)?Ef[v]=R:jg(v)},getCompType:function(w){var M=Ef[w];return M===c&&xe.test(w)&&jg(w),M},getCompTypeMap:function(){return Ef},drawCompType:function(T,t,J,l,K,j){T(t,J,l,K,j)},numberListener:function(){var t={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(e){var H=e.keyCode;t[H]||65===H&&L.isCtrlDown(e)||86===H&&L.isCtrlDown(e)||67===H&&L.isCtrlDown(e)||88===H&&L.isCtrlDown(e)||H>=35&&40>=H||(e.shiftKey||48>H||H>57)&&(96>H||H>105)&&e.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(o){var p=o.target.tagName;("DIV"===p||"CANVAS"===p)&&!(L.ignoreKeyCodes.indexOf(o.keyCode)>=0)&&("keydown"!==o.type||uj(o)||Wn(o)||np(o)||ob(o)||Tr(o)||65===o.keyCode&&(o.metaKey||o.ctrlKey))&&o.cancelable===!0&&(o.preventDefault(),o.preventManipulation&&o.preventManipulation())},getWindowInfo:function(){var Q=t.documentElement,h=Q&&(Q.scrollLeft||Q.scrollTop)?Q:t.body;return{target:h,left:h.scrollLeft,top:h.scrollTop,width:j.innerWidth||h.clientWidth,height:j.innerHeight||h.clientHeight}},isDragging:function(){return!!ei},isLeftButton:function(h){return wf(h)?!0:0===h.button},isMiddleButton:function(D){return wf(D)?!1:D&&(1===D.button||4&(D.buttons||0))},isRightButton:function(G){return wf(G)?!1:G&&(2===G.button||2&(G.buttons||0))},isInput:function(Y){if(!Y)return!1;var F=Y.tagName;return"INPUT"===F||"TEXTAREA"===F||"SELECT"===F},getTouchCount:function(u){return wf(u)?u.touches.length:1},isDoubleClick:function(){function Q(E){E.details=0,E.timeout=null,E.lastPoint=null}var J={};return Mn=new Yi,rm=Mn.getTime(),function(P){if(hr(P)>1)return!1;var F=P.button==Z?"":P.button,S=P.type+F,i=S+"_isDoubleClick",Y=J[S];if(Y||(Y=J[S]={details:0,timeout:null,lastPoint:null}),P[i]===c){P[i]=!0;var p=Nq(P);Y.timeout&&(ki(Y.timeout),Y.timeout=null);var B=wf(P)?L.doubleTouchRange:L.doubleClickRange;Y.lastPoint&&Yf(Y.lastPoint,p)>B&&Q(Y),Y.lastPoint=p,Y.details++,Y.timeout=vc(function(){Q(this)}.bind(Y),L.doubleClickSpeed)}return 2===Y.details}}(),isShiftDown:function(e){return e?e.shiftKey:Pm["16"]},isCtrlDown:function(Z){return Z?Wb?Z.metaKey:Z.ctrlKey:Wb?Pm["91"]:Pm["17"]},getClientPoint:function(t){return wf(t)&&(t=Nb(t)),{x:t.clientX,y:t.clientY}},isMouseEvent:function(y){return y instanceof MouseEvent||0===y.type.indexOf("mouse")},getTargetElement:function(E){var U,R=Cr(E);if(U=L.isMouseEvent(E)||!t.elementFromPoint?E.target:t.elementFromPoint(R.x,R.y),wk&&t.elementFromPoint){for(var e=[],g=[];"none"===U.style.pointerEvents;)e.push(U),g.push(U.style.display||""),U.style.display="none",U=t.elementFromPoint(R.x,R.y);e.forEach(function(_,B){_.style.display=g[B]})}return U},getPagePoint:function(l){return wf(l)&&(l=Nb(l)),{x:l.pageX,y:l.pageY}},createObject:function(D,k){var A=new D;for(var l in k){var y=k[l];if(ik(y))A[l]=y;else if(0===l.indexOf("s:"))A.s(l.substr(2),k[l]);else if(0===l.indexOf("a:"))A.a(l.substr(2),k[l]);else{var F=ag(l),y=k[l];A[F]?(A[F](y),"setToolTip"===F&&A.enableToolTip&&A.enableToolTip()):A[l]=y}}return A},setImage:function(g,o,E,S){var h=arguments.length;4===h?gm(g,S,o,E):2===h?em(o)?o.substr(0,12)==vq?ek(g,L.parse(o)):gm(g,o):ek(g,o):1===h&&gm(g,g)},getImage:function(b,m,H){var x;if(b==Z)return Z;if(Ue(b)?x=b:(x=pe[b],b&&x===c&&(dq&&dq[b]||gm(b,b))),m&&x&&x.tagName){var z;z="override"===H?"colors_override":"override_rgb"===H?"colors_override_rgb":"override_a"===H?"colors_override_a":"colors",x[z]||(x[z]={__count__:0});var j=x[z][m];return j||(x[z].__count__>L.imageCacheThreshold&&(x[z]={__count__:0}),j=Qf(x,sc(m),x.width,x.height,H),x[z][m]=j,x[z].__count__++),j}return x},isImageComplete:function(x,Y,o){var z=qh(x);if(!z)return!1;if(z.tagName)return z.complete;for(var U,x,l,m=z.comps,n=!0,k=0,S=m.length;S>k;k++)if(U=m[k],l=U.type,"image"===U.type){x=U.name,x&&x.func&&(x=sn(x,Y));var u=ko(x,Y,o);if(!u){n=!1;break}}else if(xe.test(l)&&L.getCompType(l)===c){n=!1,jg(l);break}return n},getId:function(){var k=1;return function(){return++k}}(),callLater:function(U,s,$,A){var r=function(){U.apply(s,$)};return A?vc(r,A):j.requestAnimationFrame(r)},cancelLater:function(D,Y){Y?ki(D):j.cancelAnimationFrame(D)},clone:function(W){if(null==W||"object"!=typeof W)return W;if(W instanceof Date){var R=new Date;return R.setTime(W.getTime()),R}if(W instanceof Array){for(var R=[],h=0,s=W.length;s>h;h++)R[h]=zl(W[h]);return R}if(W instanceof Dd){for(var R=new Dd,h=0,s=W.length;s>h;h++)R.set(h,zl(W.get(h)));return R}if(W instanceof Od)return W;if(W instanceof Id){var R=new Id;return R.deserialize(W.serialize()),R}if(W instanceof i){var R={};for(var S in W)W.hasOwnProperty(S)&&(R[S]=zl(W[S]));return R}return W},callWhenLoaded:function(g,d){d=d||100;var T=qi(g,d);ff||(ff={}),ff[T]={tick:T,cb:g,delay:d}},beforeLoadURL:function(d,r){if(ff){var J={};for(var r in ff){var i=ff[r];ki(i.tick);var V=qi(i.cb,i.delay);J[V]={tick:V,delay:i.delay,cb:i.cb}}ff=J}return L.convertURL?L.convertURL(d,r):d},convertURL:function(h){return h},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return L.getImage("default_blank")},resizeImagePOT:function(f,$){if(!f||!f.tagName)return f;var Y=f.width,b=f.height;if(!Y||!b)return f;if(gi.isPOT(Y)&&gi.isPOT(b)&&(!$||Y===b))return f;var s,P;$?P=s=gi.nearestPOT(Math.min(Y,b)):(s=gi.nearestPOT(Y),P=gi.nearestPOT(b));var o=qs(),t=o.getContext("2d");return Ud(o,s,P,1),t.drawImage(f,0,0,Y,b,0,0,s,P),o},sortFunc:function(p,T){if(p===T)return 0;if(p==Z&&T!=Z)return 1;if(p!=Z&&T==Z)return-1;if(p==Z&&T==Z)return 0;var z,f=typeof p,N=typeof T;return f===Rc&&N===Rc?z=p.localeCompare(T):f===Mh&&N===Mh&&(z=p-T),z===c&&(z=(""+p).localeCompare(""+T)),z>0?1:0>z?-1:0},getClassMap:function(){return rg},getClass:function(k){if(em(k)){var y,E=rg[k];if(!E){y=k.split("."),E=j;for(var $=0;$<y.length;$++)E=E[y[$]];rg[k]=E}return E}return k},def:function(A,O,a){var c,D,P,h=function(){};if(h.prototype=O.prototype,c=new h,em(A)){if(rg[A])throw"'"+A+"' already defined";P=yf(A),c.getClassName=function(){return A}}else P=A;if(c.constructor=P,c.getClass=function(){return P},c.getSuperClass=function(){return O},a)for(D in a)Jm[D]&&Jm.hasOwnProperty(D)?Jm[D](c,a):ps(c,a,D);P.prototype=c,P.superClass=O.prototype},startAnim:function(){var p=function(I){I.duration&&(I.startTime=Ug()),I.timeId=jf(I.tick,Z,Z,I.interval)};return function(l){return l=zl(l),l.easing=l.easing||L.animEasing,l.duration||l.frames||(l.duration=L.animDuration),l.t=0,l.duration?l.interval=0:(l.frame=0,l.interval=l.interval||10),l.tick=function(){if(l.duration){var K=(Ug()-l.startTime)/l.duration;if(K>1&&(K=1),l.t=K,l.action(l.easing(K),K),!l.isRunning())return;1===K?l.stop():l._isPaused||(l.timeId=jf(l.tick))}else{if(l.frame++,K=l.t=l.frame/l.frames,l.action(l.easing(K),K),!l.isRunning())return;l.frame<l.frames?l._isPaused||(l.timeId=jf(l.tick,Z,Z,l.interval)):l.stop()}},l.resume=function(){l._isPaused&&(delete l._isPaused,l.duration?l.t<1&&(l.startTime=Ug()-l.duration*l.t,l.timeId=jf(l.tick)):l.frame<l.frames&&(l.timeId=jf(l.tick,Z,Z,l.interval)))},l.pause=function(){al(l.timeId,!l.duration),l._isPaused=!0},l.isPaused=function(){return this._isPaused},l.stop=function(h){l.isRunning()&&(al(l.timeId,!l.duration),delete l.timeId,l.duration?l.t<1&&h&&(l.t=1,l.action(l.easing(1),1)):l.frame<l.frames&&h&&(l.frame=l.frames,l.action(l.easing(1),1)),l._37o&&l._37o(),l.finishFunc&&l.finishFunc())},l.isRunning=function(){return l.timeId!=Z},l.delay?jf(p,Z,[l],l.delay):p(l),l}}(),getTextSize:function(){var u={},$=t?qs().getContext("2d"):Z;return function(j,F){$.font=j?j:iq;var Z=u[$.font];return Z||(Z=2*$.measureText("e").width+4,u[$.font]=Z),{width:$.measureText(F).width+L.textExtraWidth,height:Z}}}(),drawText:function(y,K,W,e,g,Y,G,a,D,F,B){if(K!=Z){var n=dd(W,K),w={};if(w.y=F&&F!==fi?F===Vl?Y+n.height/2:Y+a-n.height/2:Y+a/2,w.x=D&&D!==Cl?D===ij?g+G-n.width/2:g+G/2:g+n.width/2,nr(y,K,w,W,e),B){y.font=W;var I=y.measureText(K);y.beginPath(),y.strokeStyle=e,"underline"===B?(y.moveTo(w.x-n.width/2,w.y+I.actualBoundingBoxDescent+1),y.lineTo(w.x+n.width/2,w.y+I.actualBoundingBoxDescent+1)):"line.through"===B?(y.moveTo(w.x-n.width/2,w.y),y.lineTo(w.x+n.width/2,w.y)):"overline"===B&&(y.moveTo(w.x-n.width/2,w.y-I.fontBoundingBoxAscent),y.lineTo(w.x+n.width/2,w.y-I.fontBoundingBoxAscent)),y.stroke()}}},getDistance:function(A,G){var M=A.length;return G?3===M?V(Lm(A[0]-G[0])+Lm(A[1]-G[1])+Lm(A[2]-G[2])):2===M?V(Lm(A[0]-G[0])+Lm(A[1]-G[1])):A.z===c?V(Lm(G.x-A.x)+Lm(G.y-A.y)):V(Lm(G.x-A.x)+Lm(G.y-A.y)+Lm(G.z-A.z)):3===M?V(Lm(A[0])+Lm(A[1])+Lm(A[2])):2===M?V(Lm(A[0])+Lm(A[1])):void 0},brighter:function(N,w){return 0>w&&(w=-w),Vc(N,w?w:40)},darker:function(i,g){return g>0&&(g=-g),Vc(i,g?g:-40)},unionPoint:function(G,u){if(!G)return Z;if(2===arguments.length)return G&&u?{x:S(G.x,u.x),y:S(G.y,u.y),width:C(G.x-u.x),height:C(G.y-u.y)}:Z;var f=G;if(f._as&&(f=f._as),f.length===c)return Z;var M=f.length;if(0>=M)return Z;for(var Q=1,L=f[0],T={x:L.x,y:L.y,width:0,height:0};M>Q;Q++){L=f[Q];var O=S(T.x,L.x),d=$(T.x+T.width,L.x),i=S(T.y,L.y),z=$(T.y+T.height,L.y);T.x=O,T.y=i,T.width=d-O,T.height=z-i}return T},unionRect:function(w,K){if(w&&!K)return zl(w);if(!w&&K)return zl(K);if(w&&K){var Q={x:S(w.x,K.x),y:S(w.y,K.y)};return Q.width=$(w.x+w.width,K.x+K.width)-Q.x,Q.height=$(w.y+w.height,K.y+K.height)-Q.y,Q}return Z},containsPoint:function(T,p,$,t){if(t!=Z&&1!==t){var f=T.x+T.width/2,x=T.y+T.height/2;T={x:f-T.width/2*t,y:x-T.height/2*t,width:T.width*t,height:T.height*t}}if($){var s=T.width/2,M=T.height/2,P=z(-$),Q=K(-$),Y=p.x-T.x-s,r=p.y-T.y-M;return p={x:Q*Y-P*r,y:P*Y+Q*r},Gb({x:-s,y:-M,width:T.width,height:T.height},p)}return!(!T||p.x<T.x||p.y<T.y||p.x>T.x+T.width||p.y>T.y+T.height)},containsRect:function(K,c){if(!K||!c)return!1;var B=c.x,h=c.y,z=c.width,W=c.height,I=K.width,d=K.height;if(0>(I|d|z|W))return!1;var R=K.x,n=K.y;if(R>B||n>h)return!1;if(I+=R,z+=B,B>=z){if(I>=R||z>I)return!1}else if(I>=R&&z>I)return!1;if(d+=n,W+=h,h>=W){if(d>=n||W>d)return!1}else if(d>=n&&W>d)return!1;return!0},intersectsRect:function(J,F){if(!J||!F)return!1;var S=F.width,s=F.height,D=J.width,m=J.height;if(0>=D||0>=m||0>=S||0>=s)return!1;var k=F.x,M=F.y,Q=J.x,T=J.y;return D+=Q,m+=T,S+=k,s+=M,D>k&&m>M&&S>Q&&s>T},intersection:function(p,k){if(!p||!k)return Z;var B=k.x,d=k.y,E=p.x,w=p.y,S=B,g=d,e=E,G=w;return S+=k.width,g+=k.height,e+=p.width,G+=p.height,E>B&&(B=E),w>d&&(d=w),S>e&&(S=e),g>G&&(g=G),S-=B,g-=d,0>=S||0>=g?Z:{x:B,y:d,width:S,height:g}},grow:function(P,n,m){m===c&&(m=n),P.x-=n,P.y-=m,P.width=P.width+2*n,P.height=P.height+2*m},getScreenPoint:function(E,M,N,e,l,S,R){var i=N.getBoundingClientRect(),I=E*(S||1)-N.scrollLeft+(e||0),b=M*(R||1)-N.scrollTop+(l||0),J=Bm(N,!1);if(J){var f=new Xc(I,b,0);return f.applyMatrix4(J),console.log(f),{x:f.x,y:f.y}}return{x:I+i.left,y:b+i.top}},getLogicalPoint:function(h,k,O,u,Q,D){var w,n,p=k.getBoundingClientRect();h.target?(ig(h)?Wb?Pm["91"]=!0:Pm["17"]=!0:Wb?Pm["91"]=!1:Pm["17"]=!1,Pm["16"]=Ji(h)?!0:!1,h=wf(h)?Nb(h):h,w=h.clientX,n=h.clientY):(w=h.x,n=h.y);var J=Bm(k,!0);if(J){var U=new Xc(w,n,0);U.applyMatrix4(J);do{if(Math.abs(U.z)<=1e-6)break;var q=new Xc(w,n,1);if(q.applyMatrix4(matrix),Math.abs(q.z)<=1e-6){U=q;break}if(q.sub(U),Math.abs(q.z)<=1e-6)break;U.addScaledVector(q,-U.z/q.z)}while(!1);return{x:(U.x+k.scrollLeft-(O||0))/(Q||1),y:(U.y+k.scrollTop-(u||0))/(D||1)}}return{x:(w-p.left+k.scrollLeft-(O||0))/(Q||1),y:(n-p.top+k.scrollTop-(u||0))/(D||1)}},removeHTML:function(){var Y;return function(l){return l&&l.getView&&(l=l.getView()),l&&l.parentNode?Y===l?!0:(Y=l,l.parentNode.removeChild(l),Y=Z,!0):!1}}(),getToolTipDiv:function(){if(!rs){rs=Ke(),jd=Ke();var V=rs.style;L.baseZIndex!=Z&&(V.zIndex=te(L.baseZIndex)+3+""),V.whiteSpace="nowrap",V.color=L.toolTipLabelColor,V.background=L.toolTipBackground,V.font=L.toolTipLabelFont,V.padding="5px",V.boxShadow="0px 0px 3px "+L.toolTipShadowColor}return rs},isToolTipShowing:function(){return rs&&rs.parentNode?!0:jd&&jd.parentNode?!0:!1},updateToolTipContent:function(v,J){if(L.isToolTipShowing()&&(J||(J=Xd&&Xd.view),v===c&&J&&Xd.e&&(v=J.getToolTip(Xd.e)),v!=Z)){var i;v.html?(v=v.html,i=jd):i=rs,i.innerHTML=v}},hideToolTip:function(){if(L.isToolTipShowing()){ws(rs),ws(jd),sb();var P=Xd&&Xd.view;P&&P.onHideToolTip&&P.onHideToolTip(),Xd=Z}},showToolTip:function(g,h,s){if(!g||h==Z)return Te(),void 0;L.getToolTipDiv();var E,D;if(h.html?(h=h.html,E=jd,ws(rs)):(E=rs,ws(jd)),D=E.style,E.innerHTML=h,E.parentNode||T.Default.appendToScreen(E),g.target){g=Cr(g);var v=Pb(),m=g.x,I=g.y,R=Km?60:12;if(Km){var P=E.getBoundingClientRect();D.left=m-P.width/2+sj,D.top=I-P.height-R<v.top?I+R+sj:I-P.height-R+sj}else{D.left=m+R+sj,D.top=I+R+sj;var P=E.getBoundingClientRect();P.left+P.width>v.width&&(D.left=m-R-P.width+sj),P.top+P.height>v.height&&(D.top=I-R-P.height+sj),P.left<0&&(D.left=m+R+sj),P.top<0&&(D.top=I+R+sj)}}else D.left=g.x+sj,D.top=g.y+sj;sb(),s===c?s=Xd&&Xd.view:Xd={e:g,view:s},s&&s.onShowToolTip&&s.onShowToolTip()},startDragging:function(U,u,w){w==c&&(w=!0),U!==ei&&(ei?w&&(wf(u)?ei.handleWindowTouchEnd(u):ei.handleWindowMouseUp(u)):wf(u)?(n(j,ad,nb),n(j,Ah,Ph)):(n(j,Cn,dj),n(j,fr,Zk)),ei=U)},getImageMap:function(){return pe},toBoundaries:function(G,D,N,$){var T=[];return ac(G,D,N,$).forEach(function(s){var E=[];s.forEach(function(s){E.push(s.x,s.y)}),T.push(E)}),T},getCurrentKeyCodeMap:function(){return Pm},drawCenterImage:function(g,C,I,r,E,h,$,s){!E&&h&&h.isSelfViewEvent&&(E=h);var J=Vk(C,E,h),p=xl(C,E,h);Ce(g,C,y(I-J/2),y(r-p/2),J,p,E,h,$,s)},drawStretchImage:function(e,o,C,X,d,k,P,K,Q,m,I,q){!K&&Q&&Q.isSelfViewEvent&&(K=Q);var G,M=Vk(o,K,Q,k),l=xl(o,K,Q,P);
"uniform"===C?(G=S(k/M,P/l),M*=G,l*=G,X+=y((k-M)/2),d+=y((P-l)/2),k=M,P=l):"centerUniform"===C&&((M>k||l>P)&&(G=S(k/M,P/l),M*=G,l*=G),X+=y((k-M)/2),d+=y((P-l)/2),k=M,P=l);var F=e.interactiveInfo;if(F){var x;if(x="center"===C?{x:X+k/2-M/2,y:d+P/2-l/2,width:M,height:l}:{x:X,y:d,width:k,height:P},F.rect){var n=F.compInfos,A=n.length;A&&(n[A-1].rect.image=o)}else F.rect=x}if("center"===C){var V=I!==!1&&(M>k||l>P);V&&(e.save(),e.beginPath(),e.rect(X,d,k,P),e.clip()),Ce(e,o,X+k/2-M/2,d+P/2-l/2,M,l,K,Q,m,q),V&&e.restore()}else Ce(e,o,X,d,k,P,K,Q,m,q)},toCanvas:function(G,e,H,Z,V,k,I,J,b){G=qh(G,I),e=e||Vk(G,V),H=H||xl(G,V);var D=qs(),m=ms(D);return J?(Ud(D,e,H,J),m.scale(J,J)):Ud(D,e,H,1),_r(m,G,Z,0,0,e,H,V,k,I,b),G&&G.clampToEdge&&(D.clampToEdge=G.clampToEdge),m.restore(),D},toGrayColor:function(e){if(!e)return e;var j=ue(e),U=y(.299*j[0]+.587*j[1]+.114*j[2]);return"rgba("+U+","+U+","+U+","+j[3]/255+")"},createGradientImage:function(O,E,j,V){for(var m=["L",0,0,O,0,1,0,0,1,0,0],_=0,t=Math.min(E.length,j.length);t>_;_++)m.push(j[_],E[_]);var q=T.Default.toCanvas({width:O,height:O,clampToEdge:!0,comps:[{type:"shape",rotation:V||0,points:[0,0,O,0,O,O,0,O],background:"#ffffff",gradientPack:m}]});return q},createElement:function(a,V,C,P){var m=t.createElement(a);return Fn(m,V||x.widgetBorder,2),m.style.font=C?C:iq,P!=Z&&(m.value=P),L.onElementCreated&&L.onElementCreated(m),m},containedInView:function(p,A){var n=Dm(A).getBoundingClientRect();return Gb({x:n.left,y:n.top,width:n.width,height:n.height},Nq(p))},isIsolating:function(){return Sq>0},setIsolating:function(P){P?Sq++:Sq--},getMSMap:function(){return Jm},stringify:function(E,G,Y){var m=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var K=Id.prototype.toJSON;Id.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},G=Y?0:G==Z?2:G;var d=JSON.stringify(E,function(D,I){return"function"==typeof I?"__ht__"+(I.__ht__||I.toString()):km(I)?Hn(I):I instanceof T.List?"__ht__list"+(I.__ht__list||L.stringify(I._as)):I},G);return Date.prototype.toJSON=m,Id.prototype.toJSON=K,Y&&(d=vq+wj(d)),d},parse:function(k,p){return em(k)?k.substr(0,12)!=vq||(k=Bb(k.substr(12)),em(k))?(p=p||{},JSON.parse(k,function(u,c){if(em(c))if(p.ignoreFunction||"__ht__function"!=c.substr(0,14)){if(!p.ignoreDate&&"__ht__date"==c.substr(0,10))return new Date(te(c.substr(10)));if("__ht__list"===c.substr(0,10))return new Dd(L.parse(c.substr(10)));if(!p.ignoreDataModel&&"__ht__dataModel"===c.substr(0,15)){var r=new Id;return r.deserialize(L.parse(c.substr(15))),r}}else{var q=c.indexOf("{")+1,d=c.lastIndexOf("}"),y=c.indexOf("(")+1,C=c.indexOf(")");if(q&&d&&y&&C)try{var t=new Function(c.substring(y,C),c.substring(q,d));return t.__ht__=c.substr(6),t}catch(Q){throw console.info("=== SyntaxError ===\n",c),Q}}return c})):k:k},loadJS:function(H,y){y&&H.push(y);var P=H.shift();if(tj(P))H=P.contact(H),L.loadJS(H);else if(ik(P))P(),L.loadJS(H);else if(em(P)){var h=t.createElement("script");h.onload=function(){L.loadJS(H)},h.setAttribute("src",P),t.getElementsByTagName("head")[0].appendChild(h)}else H.length&&L.loadJS(H)},extendClass:function(U,q){var k=U.prototype;for(var K in q)Jm[K]&&Jm.hasOwnProperty(K)?Jm[K](k,q):k[K]=q[K]},toRoundedCorner:function(){function j(f,P,k){f.x=P.x,f.y=P.e||k,f.z=P.y}var x=new Xc,I=new Xc,t=new Xc,n=new Xc;return function(U,g){var J,Q=0;U.getPoints&&(Q=U.getElevation(),U=U.getPoints()),J=U instanceof Dd?U:new Dd(U);var a=J.size();if(0>=g)return{points:J};var l=new Dd,$=new Dd,F=J.get(0);j(x,F,Q),l.add(F),$.add(1);for(var z=1;a>z;z++)if(a>z+1){var Y=J.get(z),W=J.get(z+1);j(I,Y,Q),j(t,W,Q),n.subVectors(x,I).setLength(Math.min(.99*n.length(),g)).add(I),Y.e!==c||F.e!==c?l.add({x:n.x,y:n.z,e:n.y}):l.add({x:n.x,y:n.z}),l.add(Y),n.subVectors(t,I).setLength(Math.min(.99*n.length(),g)).add(I),Y.e!==c||W.e!==c?l.add(F={x:n.x,y:n.z,e:n.y}):l.add(F={x:n.x,y:n.z}),x.copy(n),$.addAll([2,3])}else l.add(J.get(z)),$.add(2);return{points:l,segments:$}}}(),toColorData:ue,setCanvas:Ud,createDiv:Ke,createDisabledDiv:As,createView:zf,createCanvas:qs,appendChild:Fd,initContext:ms,checkLoadingImage:Pl,translateAndScale:cd,layout:Rf,getPosition:Gh,drawPoints:Eh,drawRoundRect:Je,drawBorder:hj,setFocus:mk,getter:Hq,setter:ag,isEmptyObject:_j,cameraPriority:function(){var D={skybox:0,main:1e4,top:1e7,infinity:1/0};return i.seal(i.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return D.skybox},set:function(Q){if(Q>=D.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");D.skybox=Number(Q)}},main:{configurable:!1,enumerable:!1,get:function(){return D.main},set:function(J){if(J<=D.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(J>=D.top)throw new RangeError("Main camera must have lower priority than the top camera.");D.main=Number(J)}},top:{configurable:!1,enumerable:!1,get:function(){return D.top},set:function(x){if(x<=D.main)throw new RangeError("Top camera must have higher priority than the main camera.");D.top=Number(x)}}}))}()},!0),kp(h,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var bb=L.disabledOpacity,ld=L.toolTipDelay,Bj=L.devicePixelRatio,Un=L.autoMakeVisible,qc=L.autoHideScrollBar,Cj=L.imageGradient,Qh=L.showToolTip,Te=L.hideToolTip,op=L.dashPattern,Jb=L.lineCap,Vp=L.lineJoin,ec=L.labelColor,eo=L.labelSelectColor,iq=L.labelFont,Ul=L.widgetIndent,yk=L.widgetRowHeight,Mg=L.widgetHeaderHeight,Jc=L.widgetTitleHeight,Rh=L.scrollBarColor,Ql=L.scrollBarSize,us=L.scrollBarTimeout,le=L.scrollBarMinLength,ts=L.scrollBarInteractiveSize,Yk=L.zoomIncrement,ys=L.scrollZoomIncrement,yl=L.pinchZoomIncrement,Ho=L.zoomMax,ok=L.zoomMin,Mi=L.createObject,_m=L.preventDefault,Qr=L.setImage,qh=L.getImage,ko=L.isImageComplete,yo=L.drawCenterImage,_r=L.drawStretchImage,Se=L.getId,jf=L.callLater,al=L.cancelLater,xj=L.sortFunc,zl=L.clone,yf=L.getClass,uo=L.startAnim,fg=L.brighter,ub=L.darker,fm=L.drawText,dd=L.getTextSize,tp=L.isLeftButton,_h=L.isMiddleButton,Gm=L.isRightButton,hr=L.getTouchCount,_c=L.isDoubleClick,Ji=L.isShiftDown,ig=L.isCtrlDown,Nq=L.getClientPoint,Cr=L.getPagePoint,Yf=L.getDistance,An=L.unionPoint,ge=L.unionRect,Gb=L.containsPoint,pg=L.containsRect,Fg=L.intersectsRect,vr=L.intersection,Pb=L.getWindowInfo,Aq=L.grow,we=L.getLogicalPoint,hf=L.getScreenPoint,co=L.startDragging,ws=L.removeHTML,uh=L.createElement,pb=L.segmentResolution,Oo=L.shapeResolution,Kk=L.shapeSide,hk=L.def,is=function(z,o,X){hk(R+"."+z,o,X)},Ag=function(i,N){i.childNodes.forEach(function(O){N(O),Ag(O,N)})};kp(L,{toolTipLabelColor:ec,toolTipLabelFont:iq,toolTipBackground:x.toolTipBackground,toolTipShadowColor:Ep,debugTipLabelFont:iq,debugTipLabelColor:ec,debugTipBackground:x.toolTipBackground,drawBreakableText:wb,setDevicePixelRatio:function(V){Bj=L.devicePixelRatio="number"==typeof V?V:j.screen?j.screen.deviceXDPI/j.screen.logicalXDPI:1,Ag(t.body,function(k){var e=k._ht;e&&e._canvas&&(Ud(e._canvas,e.getWidth(),e.getHeight()),e.redraw?e.redraw():e.iv())})}},!0);var wi=1e-6,Vb="undefined"!=typeof Uint16Array?Uint16Array:Array,Sf="undefined"!=typeof Float32Array?Float32Array:Array,$i=function(X,u,$){var L=[X[0]-u[0],X[1]-u[1],X[2]-u[2]];if($){var n=Yf(L);n>0&&(L[0]/=n,L[1]/=n,L[2]/=n)}return L},Hi=function(){var c="charCodeAt",$=2*(2*tg.length+1);for(var i in j)if(i===R+Cl[0]+(sj.length+2)){var w=j[i];if(!w)break;for(var L=w.length,o=0;L>o;o++)if(w[o][c](0)===$&&w[o+1]!=Z&&w[o+1]===sj[0]&&w[o+2]!=Z&&w[o+2][c](0)===$){for(var g=o+3;L>g;g++)if(w[g][c](0)===$){if(0==w[g+1])for(var Y,d=g+2;L>d;d++){if(w[d][c](0)===$){0==w[d-1]&&Y&&(zi=Y.substr(0,Y.length-1));break}Y==Z?Y=w[d]:Y+=w[d]}break}break}break}return function(L){return[-L[0],-L[1],-L[2]]}}(),Wh=function(p,g){return 3===p.length?p[0]*g[0]+p[1]*g[1]+p[2]*g[2]:p[0]*g[0]+p[1]*g[1]},Bf=function(){var i=new Array(16);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},De=Bf(),Di=function(i){var h=new Array(16);return h[0]=i[0],h[1]=i[1],h[2]=i[2],h[3]=i[3],h[4]=i[4],h[5]=i[5],h[6]=i[6],h[7]=i[7],h[8]=i[8],h[9]=i[9],h[10]=i[10],h[11]=i[11],h[12]=i[12],h[13]=i[13],h[14]=i[14],h[15]=i[15],h},Om=function(Y,R){return Y[0]=R[0],Y[1]=R[1],Y[2]=R[2],Y[3]=R[3],Y[4]=R[4],Y[5]=R[5],Y[6]=R[6],Y[7]=R[7],Y[8]=R[8],Y[9]=R[9],Y[10]=R[10],Y[11]=R[11],Y[12]=R[12],Y[13]=R[13],Y[14]=R[14],Y[15]=R[15],Y},tc=function(K){return K[0]=1,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=1,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=1,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K},oi=function(Z,r){var F=Z[0],W=Z[1],f=Z[2];return Z[0]=r[0]*F+r[4]*W+r[8]*f+r[12],Z[1]=r[1]*F+r[5]*W+r[9]*f+r[13],Z[2]=r[2]*F+r[6]*W+r[10]*f+r[14],Z},Fk=function(F,H){var Y=F[0],C=F[1],r=F[2],f=F[3];return F[0]=H[0]*Y+H[4]*C+H[8]*r+H[12]*f,F[1]=H[1]*Y+H[5]*C+H[9]*r+H[13]*f,F[2]=H[2]*Y+H[6]*C+H[10]*r+H[14]*f,F[3]=H[3]*Y+H[7]*C+H[11]*r+H[15]*f,F},fk=function(){var w,E,z,T,u=Hd(rn[1]+rn[7]),m=Hd(rn[0]+rn[3]-rn[10]),X=Hd(rn[8]+2),D=function(){return E=z.charAt(w),w+=1,E},n=function(){var P="";if(E===X)for(;D();){if(E===X)return D(),P;P+=E}else D()},V=function(){for(;E&&" ">=E;)D()},_=function(){var y,p={};if(E===u){if(D(),V(),E===m)return D(),p;for(;E;){if(y=n(),V(),D(),p[y]=T(),V(),E===m)return D(),p;D(),V()}}};return T=function(){switch(V(),E){case u:return _();default:return n()}},function(O){if(W={},O){var I;if(z=O,w=0,E=" ",I=T(),V(),!E)return I}}}(),xb=function(j,M){if(M){var R=z(M),F=K(M),C=j[4],H=j[5],r=j[6],X=j[7],B=j[8],b=j[9],m=j[10],d=j[11];j[4]=C*F+B*R,j[5]=H*F+b*R,j[6]=r*F+m*R,j[7]=X*F+d*R,j[8]=B*F-C*R,j[9]=b*F-H*R,j[10]=m*F-r*R,j[11]=d*F-X*R}},Yn=function(f,P){if(P){var S=z(P),M=K(P),p=f[0],i=f[1],V=f[2],O=f[3],H=f[8],Y=f[9],X=f[10],C=f[11];f[0]=p*M-H*S,f[1]=i*M-Y*S,f[2]=V*M-X*S,f[3]=O*M-C*S,f[8]=p*S+H*M,f[9]=i*S+Y*M,f[10]=V*S+X*M,f[11]=O*S+C*M}},Qo=function(m,L){if(L){var B=z(L),i=K(L),k=m[0],o=m[1],U=m[2],D=m[3],f=m[4],p=m[5],e=m[6],w=m[7];m[0]=k*i+f*B,m[1]=o*i+p*B,m[2]=U*i+e*B,m[3]=D*i+w*B,m[4]=f*i-k*B,m[5]=p*i-o*B,m[6]=e*i-U*B,m[7]=w*i-D*B}},$l=function(u,t,_){return Vh(Z,_===!1?Z:u.getFinalScale3d(),u.getFinalRotation3d(),u.getRotationMode(),u.p3(),Z,t)},Vh=function(Z,F,g,b,w,$,W){return $||($=Bf()),w&&Kl($,w),nm($,g,b),W&&Pf($,$,W),F&&rk($,F),Z&&Pf($,$,Z),$},_l=function(S,g,P){g=te(g),P=te(P);var E=this;E.g=S,E._84O=g,E._85O=P,E._70I=!0,E.F=0,E._83O=g+P,E.pen={x:0,y:0}},Qn="lineDashOffset",tr="setLineDash",Rl=function(r){for(var z in r)1===z.length&&(Qn=r[z]);return z?1:0},Ui=function($,K,D){return lc(K)?$:$[tr]?($[tr](K),D&&($.lineDashOffset=D),$):new _l($,K[0],K.length>1?K[1]:K[0])},bh=function(n,v){!lc(v)&&n[tr]&&(n[tr](ym),n.lineDashOffset=0)};hk(_l,i,{_69I:6,moveTo:function(w,Y){var T=this,u=T.pen;u.x=w,u.y=Y,T.g.moveTo(w,Y),T.start||(T.start={x:w,y:Y})},lineTo:function(R,f){var E=this,w=E.pen,F=R-w.x,Q=f-w.y,t=Nh(Q,F),b=K(t),X=z(t),M=E._23O(w.x,w.y,R,f),h=E._85O,x=E._84O,$=E._83O;if(E.F){if(E.F>M)return E._70I?E._72I(R,f):E.moveTo(R,f),E.F-=M,void 0;if(E._70I?E._72I(w.x+b*E.F,w.y+X*E.F):E.moveTo(w.x+b*E.F,w.y+X*E.F),M-=E.F,E.F=0,E._70I=!E._70I,!M)return}var H=G(M/$);if(H){for(var l=b*x,d=X*x,C=b*h,V=X*h,p=0;H>p;p++)E._70I?(E._72I(w.x+l,w.y+d),E.moveTo(w.x+C,w.y+V)):(E.moveTo(w.x+C,w.y+V),E._72I(w.x+l,w.y+d));M-=$*H}E._70I?M>x?(E._72I(w.x+b*x,w.y+X*x),E.moveTo(R,f),E.F=h-(M-x),E._70I=!1):(E._72I(R,f),M===x?(E.F=0,E._70I=!E._70I):(E.F=x-M,E.moveTo(R,f))):M>h?(E.moveTo(w.x+b*h,w.y+X*h),E._72I(R,f),E.F=x-(M-h),E._70I=!0):(E.moveTo(R,f),M===h?(E.F=0,E._70I=!E._70I):E.F=h-M)},quadraticCurveTo:function(Z,W,A,$){var O,R=this,x=R.pen,u=x.x,S=x.y,s=R._22O(u,S,Z,W,A,$),b=0,N=0,T=R._85O,j=R._84O;if(R.F){if(R.F>s)return R._70I?R._71I(Z,W,A,$):R.moveTo(A,$),R.F-=s,void 0;if(b=R.F/s,O=R._20O(u,S,Z,W,A,$,b),R._70I?R._71I(O[2],O[3],O[4],O[5]):R.moveTo(O[4],O[5]),R.F=0,R._70I=!R._70I,!s)return}var p=s-s*b,J=G(p/R._83O),H=j/s,f=T/s;if(J)for(var h=0;J>h;h++)R._70I?(N=b+H,O=R._21O(u,S,Z,W,A,$,b,N),R._71I(O[2],O[3],O[4],O[5]),b=N,N=b+f,O=R._21O(u,S,Z,W,A,$,b,N),R.moveTo(O[4],O[5])):(N=b+f,O=R._21O(u,S,Z,W,A,$,b,N),R.moveTo(O[4],O[5]),b=N,N=b+H,O=R._21O(u,S,Z,W,A,$,b,N),R._71I(O[2],O[3],O[4],O[5])),b=N;p=s-s*b,R._70I?p>j?(N=b+H,O=R._21O(u,S,Z,W,A,$,b,N),R._71I(O[2],O[3],O[4],O[5]),R.moveTo(A,$),R.F=T-(p-j),R._70I=!1):(O=R._19O(u,S,Z,W,A,$,b),R._71I(O[2],O[3],O[4],O[5]),s===j?(R.F=0,R._70I=!R._70I):(R.F=j-p,R.moveTo(A,$))):p>T?(N=b+f,O=R._21O(u,S,Z,W,A,$,b,N),R.moveTo(O[4],O[5]),O=R._19O(u,S,Z,W,A,$,N),R._71I(O[2],O[3],O[4],O[5]),R.F=j-(p-T),R._70I=!0):(R.moveTo(A,$),p===T?(R.F=0,R._70I=!R._70I):R.F=T-p)},bezierCurveTo:function(){var s=arguments;this.pen={x:s[4],y:s[5]},this.g.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])},arc:function(d,D,T,c,G,h){h||(c=-c,G=-G),Qi(this,d,D,c,G-c,T,T,!1)},rect:function(U,M,O,S){var H=this;H.pen={x:U,y:M},H.moveTo(U,M),H.lineTo(U,M+S),H.lineTo(U+O,M+S),H.lineTo(U+O,M),H.lineTo(U,M)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(v,I,L,T){var i=L-v,E=T-I;return V(i*i+E*E)},_22O:function(G,h,j,V,s,S,J){for(var e,u,T,Z,O,K,z,x=0,r=G,o=h,d=J>0?J:this._69I,H=1;d>=H;H++)T=H/d,Z=1-T,O=Z*Z,K=2*T*Z,z=T*T,e=O*G+K*j+z*s,u=O*h+K*V+z*S,x+=this._23O(r,o,e,u),r=e,o=u;return x},_21O:function(J,A,h,c,l,B,i,G){var N=this;if(0===i)return N._20O(J,A,h,c,l,B,G);if(1===G)return N._19O(J,A,h,c,l,B,i);var m=N._20O(J,A,h,c,l,B,G);return m.push(i/G),N._19O.apply(N,m)},_20O:function(W,U,q,Q,t,b,v){if(1!==v){var N=q+(t-q)*v,i=Q+(b-Q)*v;q=W+(q-W)*v,Q=U+(Q-U)*v,t=q+(N-q)*v,b=Q+(i-Q)*v}return[W,U,q,Q,t,b]},_19O:function(x,Z,f,r,s,w,g){if(1!==g){var C=x+(f-x)*g,a=Z+(r-Z)*g;f+=(s-f)*g,r+=(w-r)*g,x=C+(f-C)*g,Z=a+(r-a)*g}return[x,Z,f,r,s,w]},_72I:function(Q,F){var r=this.pen;(Q!==r.x||F!==r.y)&&(r.x=Q,r.y=F,this.g.lineTo(Q,F))},_71I:function(i,K,J,z){var y=this.pen;(i!==J||K!==z||J!==y.x||z!==y.y)&&(y.x=J,y.y=z,this.g.quadraticCurveTo(i,K,J,z))}}),bl=Rr()+1,Qp&&j.console&&bl&&!1&&(j.navigator&&j.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?j.console.log.apply(console,["Hightopo - Version"+T.Default.getVersion()+" - %cTrialhttp://hightopo.com/request.html","color: #f00;"]):j.console.log("Hightopo - Version"+T.Default.getVersion()+" - Trialhttp://hightopo.com/request.html"));var vp=Z,Ol=Z,dm=L.checkLoadingCompType=function(w){vp&&!w._72O&&(Ol||(Ol={}),Ol[w._72O=Se()]=w)},jg=function(s,B){if(B||(B=s),B&&(vp||(vp={}),!vp[s])){var q=new Hl;if(vp[B]={request:q,url:B},B=L.beforeLoadURL(B,s),B.data){var N=L.parse(B.data);Ze(s,N),L.handleCompTypeLoaded(s,N)}else{q.onload=function(){if(200===this.status||0===this.status){var M=L.parse(q.getResponseText());Ze(s,M),L.handleCompTypeLoaded(s,M)}else Ze(s,Z)},q.onerror=function(){Ze(s,Z)};var $={};$.url=encodeURI(B),$.sync=!1,q.send($)}}},Ze=function(h,r){if(Ef[h]=r,delete vp[h],_j(vp)&&(vp=Z,Ol)){for(var E in Ol){var F=Ol[E];F.invalidateAll&&F.invalidateAll(c,"compTypeLoaded",h),F.redraw&&F.redraw(),F.iv(),delete F._72O}Ol=Z}if(r&&Ol)for(var E in Ol){var F=Ol[E];F.invalidateAll&&F.invalidateAll(c,"compTypeLoading",h),F.redraw&&F.redraw(),F.iv()}},Uj=x.chart,no="",od=!0,Iq=L.compStack=[],Yl=/^style@/,Fi=/^attr@/,ho=/^field@/,sr={x:.5,y:.5},se=function(){od=!0},Dr=function(){return od},Vk=function(J,E,O,l){if(!J)return 0;if(sn(J.fitSize,E,O)&&l)return l;var e=sn(J.width,E,O);return null==e?20:e},xl=function(z,T,E,W){if(!z)return 0;if(sn(z.fitSize,T,E)&&W)return W;var o=sn(z.height,T,E);return null==o?20:o},sn=function(g,I,S){if(!g||!g.func)return g;var b,$=g.func,V=g.value;return b=ik($)?S&&S.vectorDataBindingDisabled&&!g.isSafeFunc?V:$(I,S):I instanceof Od||(T.ui?I instanceof T.ui.View:0)?Fi.test($)?I.a(no+$.slice(5)):Yl.test($)?I.s(no+$.slice(6)):ho.test($)?I[$.slice(6)]:I[$]?I[$](S):V:V,V!==c&&b==Z?V:b},Ce=L.drawImage=function(){var C,i,H,F,W,B,J=3,N=6,e=function(F){var I,m,R,v=!1;return M(F,"shadow")&&(I=M(F,"shadowOffsetX")||J,m=M(F,"shadowOffsetY")||J,R=M(F,"shadowBlur")||N,v=!0),!v&&i instanceof Od&&((Nl(i,dp,"shadow")||"shadow"===Nl(i,dp,"select.type")&&H&&H.isSelected&&H.isSelected(i))&&(I=Nl(i,dp,"shadow.offset.x")||0,m=Nl(i,dp,"shadow.offset.y")||0,R=Nl(i,dp,"shadow.blur")||0,v=!0),!v&&Nl(i,dp,"shadow2")&&(I=Nl(i,dp,"shadow2.offset.x")||0,m=Nl(i,dp,"shadow2.offset.y")||0,R=Nl(i,dp,"shadow2.blur")||0,v=!0)),v?1.5*R+Math.max(I,m):0},Q=function(j,x){j.getValue&&j.getValue.compType===x||(j.getValue=function(C){var h=M(j,C);if(h===c&&x.properties){var V=x.properties[C];V&&(h=V.defaultValue)}return h},j.getColor=function(K,S){return S===!0?v(K):v(j.getValue(K))},j.getValue.compType=x)},M=function(l,g,u){var T,Y=!1;if(l.prefix&&i instanceof Od){var P=i.a(no+g);P!==c&&(Y=!0,T=P)}return T===c&&(T=l[g]),T&&T.func&&(Y=!0,T=sn(T,i,H)),u&&(T=u(T),Y||(l[g]=T)),T},v=function(J,x){var i;return i=x?M(J,x):J,C&&C.compGray&&i?L.toGrayColor(i):W&&i?Ip(i,W,B):i},p=function(G){if(tj(G)){for(var k=new Dd,D=G.length,E=0;D>E;E+=2)k.add({x:G[E],y:G[E+1]});G=k}return G},T=function(K){var m=M(K,"anchorX"),C=M(K,"anchorY");if(m!==c||C!==c)return{x:m===c?sr.x:m,y:C===c?sr.y:C};var e=M(K,"type"),b=M(K,"name");if("image"!==e||!b)return sr;var Q=qh(b);return Q&&Q.anchorX!==c&&Q.anchorY!==c?{x:Q.anchorX,y:Q.anchorY}:sr},w=function(I,y){var j=M(I,ug),o=T(I);if(tj(j)){var O=j.length,P=M(I,"relative"),K=y.width,Q=y.height;if(4===O)j={x:j[0],y:j[1],width:j[2],height:j[3]},P&&(j.x*=K,j.y*=Q,j.width*=K,j.height*=Q);else if(3===O){var n=j[0];j={width:j[1],height:j[2]},P&&(j.width*=K,j.height*=Q),"object"==typeof n?n.length&&(n={x:n[0],y:n[1]}):n=Gh(n,y,j),j.x=n.x-j.width*o.x,j.y=n.y-j.height*o.y}j.x+=M(I,"offsetX")||0,j.y+=M(I,"offsetY")||0,!P&&y.fitSize&&(j=g(I,j,y))}return j},g=function(G,g,i){if(g){var l,U,D,$={x:g.x,y:g.y,width:g.width,height:g.height},R=T(G),B=M(G,"layoutH"),u=M(G,"layoutV"),p=1,c=1,n=0,W=0,I=1,s=1;switch(B){case"left":break;case"right":$.x+=i.width-i.rw;break;case"center":$.x+=.5*(i.width-i.rw);break;case"scale":case"leftright":default:l=M(G,mp)||0,l&&(n=Math.abs(W=Math.sin(l)),I=Math.abs(s=Math.cos(l))),"leftright"!==B?(p+=I*(i.widthScale-1),c+=n*(i.widthScale-1)):(p+=$.width?I*(i.width-i.rw)/$.width:0,c+=$.height?n*(i.width-i.rw)/$.height:0,U=-Math.min(-R.x*s+R.y*W,-R.x*s-(1-R.y)*W,(1-R.x)*s+R.y*W,(1-R.x)*s-(1-R.y)*W))}switch(u){case"top":break;case"bottom":$.y+=i.height-i.rh;break;case"center":$.y+=.5*(i.height-i.rh);break;case"scale":case"topbottom":default:l==Z&&(l=M(G,mp),l&&(n=Math.abs(W=Math.sin(l)),I=Math.abs(s=Math.cos(l)))),"topbottom"!==u?(p+=n*(i.heightScale-1),c+=I*(i.heightScale-1)):(p+=$.width?n*(i.height-i.rh)/$.width:0,c+=$.height?I*(i.height-i.rh)/$.height:0,D=-Math.min(-R.x*W-R.y*s,-R.x*W+(1-R.y)*s,(1-R.x)*W-R.y*s,(1-R.x)*W+(1-R.y)*s))}return(1!==p||1!==c)&&("scale"!==B&&B?"leftright"===B&&($.x+=$.width*(1-p)*R.x+U*(i.width-i.rw)):$.x+=$.x*(i.widthScale-1)+R.x*$.width*(i.widthScale-p),"scale"!==u&&u?"topbottom"===u&&($.y+=$.height*(1-c)*R.y+D*(i.height-i.rh)):$.y+=$.y*(i.heightScale-1)+R.y*$.height*(i.heightScale-c),$.width*=p,$.height*=c),$.width<0&&($.width=0),$.height<0&&($.height=0),$}},n=function(f){return tj(f)?new Dd(f):f},_=function(s,g,O,W,S,a,G){var Z=C.interactiveInfo,t=s.transform;if(t)return C.save(),C.setTransform(t.a,t.b,t.c,t.d,t.tx,t.ty),Z&&Z.compInfos.push({comp:s,rect:g,matrix:t.clone(),prefix:no,refRect:Z.refRect}),!0;S===c&&(S=1),a===c&&(a=1);var J=M(s,"clipPercentage"),z=um(O,g);if(z&&!W&&1===S&&1===a&&!(1>J))return Z&&Z.compInfos.push({comp:s,rect:g,matrix:Z.matrix.clone(),prefix:no,refRect:Z.refRect}),!1;G=G||sr;var A=g.x+g.width*G.x,Q=g.y+g.height*G.y,$=O.x+O.width*G.x,Y=O.y+O.height*G.y,m=O.width?S*(g.width/O.width):1,K=O.height?a*(g.height/O.height):1;if(C.save(),Z&&(Z.matrix.appendTranslate(A,Q).appendRotate(W).appendScale(m,K).appendTranslate(-$,-Y),Z.compInfos.push({comp:s,rect:g,matrix:Z.matrix.clone(),prefix:no,refRect:Z.refRect})),Kn(C,A,Q),Uo(C,W||0),Pn(C,m,K),Kn(C,-$,-Y),1>J){0>J&&(J=0);var D=To(O,M(s,"clipDirection"),J,e(s));C.beginPath(),C.rect(D.x,D.y,D.width,D.height),C.clip()}return!0},b=function(){C.restore()},d=function(j,p,V){var U=M(j,"path"),N=M(j,mp),G=M(j,"scaleX"),o=M(j,"scaleY"),s=T(j),$=Z,g=kj(null,U);if(V||(V=j.unionRect,V||(V=An(g),j.path.func||(j.unionRect=V)),$=V),V){$||($=j.unionRect,$||($=An(g),j.path.func||(j.unionRect=$)));var Y=_(j,V,$,N,G,o,s),u=M(j,"borderPattern"),r=Ui(C,u),O=v(j,"background"),z=v(j,"borderColor"),A=M(j,"borderWidth"),E=M(j,"gradient"),w=v(j,"gradientColor"),Q=M(j,"border3d"),I=v(j,"border3dColor"),D=M(j,"border3dAccuracy"),a=C.lineJoin,P=C.lineCap;C.lineJoin=M(j,"borderJoin")||Vp,C.lineCap=M(j,"borderCap")||Jb,O?($d(C,O,E,w,$),kj(C,U),C.fill(),r!==C&&kj(C,U)):kj(C,U);var m=M(j,"borderWidthAbsolute");if(m&&(C.save(),C.setTransform(1,0,0,1,0,0)),A&&z&&(C.lineWidth=A,C.strokeStyle=z,C.stroke(),Q&&qd(C,z,I,A,F,D)),bh(C,u),M(j,"dash")){var W=M(j,"dashWidth")||A;if(W>0){u=M(j,"dashPattern")||op;var r=Ui(C,u,M(j,"dashOffset")),x=v(j,"dashColor")||v(xq);r!==C&&kj(C,U),C.strokeStyle=x,C.lineWidth=W,C.stroke(),M(j,"dash3d")&&qd(C,x,v(j,"dash3dColor"),W,F,M(j,"dash3dAccuracy")),bh(C,u)}}m&&C.restore(),p===ug&&yn(C,O,M(j,"depth"),$),C.lineJoin=a,C.lineCap=P,Y&&b()}},P=function(s,h,d,a){var $=M(s,Eb,p),K=M(s,mp),m=T(s);if($&&a.fitSize){var Y=new Dd,L=An($),Q=g(s,L,a),y=L.x+m.x*L.width,x=L.y+m.y*L.height,R=Q.x+m.x*Q.width,D=Q.y+m.y*Q.height,U=L.width?Q.width/L.width:1,A=L.height?Q.height/L.height:1;$.each(function(o){Y.add({x:R+(o.x-y)*U,y:D+(o.y-x)*A})}),$=Y,s.unionRect=null}var S=M(s,"scaleX"),o=M(s,"scaleY"),X=h===Gd,k=Z;if(!d&&X&&(d=s.unionRect,d||(d=An($),s.points.func||(s.unionRect=d)),k=d),d){X?k||(k=s.unionRect,k||(k=An($),s.points.func||(s.unionRect=k))):k=d;var t,I,w,q,J=_(s,d,k,K,S,o,m),E=M(s,"borderPattern"),G=Ui(C,E),V=v(s,"background"),u=qh(M(s,"repeatImage"),W,B),P=M(s,"gradientPack"),f=v(s,"borderColor"),c=M(s,"borderWidth"),r=qh(M(s,"borderRepeatImage"),W,B),N=M(s,"segments",n),j=M(s,"gradient"),l=v(s,"gradientColor"),O=M(s,"border3d"),z=v(s,"border3dColor"),xh=M(s,"border3dAccuracy"),Sb=M(s,"closePath"),ng=M(s,"fillRule")||"nonzero",ec=C.lineJoin,db=C.lineCap,Ci=e(s);if(C.lineJoin=M(s,"borderJoin")||Vp,C.lineCap=M(s,"borderCap")||Jb,X)if(V||u||P){var cs=M(s,"fillClipPercentage");if(1>cs){0>cs&&(cs=0);var Oo=To(k,M(s,"fillClipDirection"),cs,Ci);C.save(),C.beginPath(),C.rect(Oo.x,Oo.y,Oo.width,Oo.height),C.clip()}Eh(C,$,N,Sb),P?Lh(C,P,v):u?yq(C,u,W,B,i,H):$d(C,V,j,l,k),C.fill(ng),P&&C.restore(),1>cs&&C.restore(),G!==C&&Eh(G,$,N,Sb)}else Eh(G,$,N,Sb);else if("roundRect"===h?t=M(s,"cornerRadius"):"polygon"===h?t=M(s,"polygonSide"):"arc"===h&&(t=M(s,"arcFrom"),I=M(s,"arcTo"),w=M(s,"arcClose"),q=M(s,"arcOval")),V||u||P){var cs=M(s,"fillClipPercentage");if(1>cs){0>cs&&(cs=0);var Oo=To(k,M(s,"fillClipDirection"),cs,Ci);C.save(),C.beginPath(),C.rect(Oo.x,Oo.y,Oo.width,Oo.height),C.clip()}Up(C,h,k,t,I,w,q),P?Lh(C,P,v):u?yq(C,u,W,B,i,H):$d(C,V,j,l,k),C.fill(ng),P&&C.restore(),1>cs&&C.restore(),C!==G&&Up(G,h,k,t,I,w,q)}else Up(G,h,k,t,I,w,q);var bm=M(s,"borderWidthAbsolute");if(bm&&(C.save(),C.setTransform(1,0,0,1,0,0)),c&&(f||r)&&(C.lineWidth=c,r?ci(C,r,W,B,i,H):C.strokeStyle=f,C.stroke(),O&&qd(C,f,z,c,F,xh)),bh(C,E),M(s,"dash")){var _g=M(s,"dashWidth")||c;if(_g>0){E=M(s,"dashPattern")||op;var G=Ui(C,E,M(s,"dashOffset")),Cl=v(s,"dashColor")||v(xq);G!==C&&(X?Eh(G,$,N,Sb):Up(G,h,k,t,I,w,q)),C.strokeStyle=Cl,C.lineWidth=_g,C.stroke(),M(s,"dash3d")&&qd(C,Cl,v(s,"dash3dColor"),_g,F,M(s,"dash3dAccuracy")),bh(C,E)}}bm&&C.restore(),h===ug&&yn(C,V,M(s,"depth"),k),C.lineJoin=ec,C.lineCap=db,J&&b()}},a=function(s,g){var K=W||M(s,Ei),I=B||M(s,"blendMode"),O=M(s,"name"),G=qh(O,K,I);G&&G.cacheRule!=Z&&(G=Yp(C,G,M(s,"stretch"),g.width,g.height,i,H,K)),G?_r(C,G,M(s,"stretch"),g.x,g.y,g.width,g.height,i,H,K,null,I):od=!1},k=function(F,O){var H=M(F,"text");if(H!=Z){var X,k=M(F,"gradientPack"),P=M(F,"gradient"),e=v(F,"gradientColor"),V=M(F,"font"),w=M(F,"vertical"),D=M(F,"align"),l=M(F,"vAlign"),z=M(F,"decoration");if(X=k?Lh(C,k,v):v(F,Ei),!k&&P&&(X=L.createGradient(C,P,X||L.labelColor,e||x.imageGradient,O.x,O.y,O.width,O.height)),w){var f,I,_=H.length,d=0,j=1*(_-1),R=[];C.textBaseline=Vl,C.font=V;for(var B=0;_>B;B++){var n=C.measureText(H[B]);R.push(n),j+=n.fontBoundingBoxDescent,d=$(d,n.width)}I=l&&l!==fi?l===Vl?O.y:O.y+O.height-j:O.y+(O.height-j)/2,f=D&&D!==Cl?D===ij?O.x+O.width-d:O.x+(O.width-d)/2:O.x;for(var B=0;_>B;B++){var s=H[B],n=R[B];fm(C,s,V,X,f,I,d,n.fontBoundingBoxDescent,Wj,fi,z),I+=n.fontBoundingBoxDescent+1}}else fm(C,H,V,X,O.x,O.y,O.width,O.height,D,l,z);k&&C.restore()}},t=function(V,J){hj(C,v(V,Ei),J.x,J.y,J.width,J.height,M(V,"width"))},o=function(q,$){var V=M(q,jl),W=0;if(V&&(V.forEach(function(w){W+=w}),W>0)){for(var h=M(q,"colors")||Uj,P=M(q,"startAngle")||0,A=M(q,"hollow"),Y=M(q,Tp),O=M(q,Mr),b=M(q,Sg),Q=Y?new Dd:Z,e=$.x,L=$.y,B=$.width,I=$.height,m=e+B/2,f=L+I/2,l=S(B,I)/2,o=0,_=0;_<V.length;_++){var j=V[_],n=s*j/W,a=P+n;if(C.fillStyle=h[o++],o===h.length&&(o=0),C.beginPath(),A){var k=m+K(P)*l/2,E=f+z(P)*l/2,T=m+K(a)*l,r=f+z(a)*l;C.moveTo(k,E),C.arc(m,f,l/2,P,a,!1),C.lineTo(T,r),C.arc(m,f,l,a,P,!0)}else C.moveTo(m,f),C.arc(m,f,l,a,P,!0);Q&&(n=(P+a)/2,Q.add({text:ik(Y)?Y(j,_,W,i):j,x:m+.75*K(n)*l,y:f+.75*z(n)*l})),C.closePath(),C.fill(),P=a}Q&&Q.each(function(X){fm(C,X.text,O,b,X.x,X.y,0,0,Wj)})}},X=function(y,T){var b=M(y,Cd);if(b&&b.length>0){var I=b.length,K=M(y,Tp),Y=M(y,Mr),A=M(y,Sg),e=K?new Dd:Z,l=M(y,"minValue")||0,X=M(y,"maxValue");if(X==Z&&(X=0,b.forEach(function(m){M(m,jl).forEach(function(q){X=$(X,q)})})),l===X)return;for(var Q=T.height/(X-l),V=T.y+X*Q,R=M(b[0],jl).length,z=T.width/(3*R+1),m=2*z/I,P=0,d=0;I>d;d++)for(var u=b[d],o=M(u,Ei),f=M(u,"colors"),W=M(u,jl),v=0;R>v;v++){f?C.fillStyle=f[v]:o?C.fillStyle=o:(C.fillStyle=Uj[P++],P===Uj.length&&(P=0));var U=W[v],N=U*Q,s=T.x+(1+3*v)*z+d*m;if(Ki(C,s,V-N,m,N),e){var q=ik(K)?K(U,v,u,i):U,w=dd(Y,q).height;e.add({x:s,y:V-N-w,width:m,height:w,text:q})}}e&&e.each(function(b){fm(C,b.text,Y,A,b.x,b.y,b.width,b.height,Wj)})}},f=function(y,A){var p=M(y,Cd);if(p&&p.length>0){var Q=p.length,J=M(p[0],jl).length,t=A.width/(3*J+1),F=0,X=M(y,"maxValue"),j=M(y,Tp),r=M(y,Mr),x=M(y,Sg),c=j?new Dd:Z;if(X==Z){X=0;for(var T=0;J>T;T++){for(var S=0,m=0;Q>m;m++)S+=M(p[m],jl)[T];X=$(X,S)}}if(X>0){for(var T=0;J>T;T++)for(var d=A.y+A.height,m=0;Q>m;m++){var g=p[m],P=M(g,Ei),D=M(g,jl)[T],z=D/X*A.height;P?C.fillStyle=P:(C.fillStyle=Uj[F++],F===Uj.length&&(F=0)),d-=z;var u={x:A.x+(1+3*T)*t,y:d,width:2*t,height:z};Ki(C,u.x,u.y,u.width,u.height),c&&(u.text=ik(j)?j(D,T,g,i):D,c.add(u))}c&&c.each(function(I){fm(C,I.text,r,x,I.x,I.y,I.width,I.height,Wj)})}}},E=function(w,m){var B=M(w,Cd);if(B&&B.length>0){for(var A=B.length,V=M(B[0],jl).length,y=m.width/(3*V+1),$=0,z=M(w,Tp),F=M(w,Mr),o=M(w,Sg),j=z?new Dd:Z,W=0;V>W;W++){for(var h=0,l=0;A>l;l++)h+=M(B[l],jl)[W];if(h>0){var d=m.y+m.height;for(l=0;A>l;l++){var O=B[l],J=M(O,Ei),S=M(O,jl)[W],t=S/h*m.height;J?C.fillStyle=J:(C.fillStyle=Uj[$++],$===Uj.length&&($=0)),d-=t;var E={x:m.x+(1+3*W)*y,y:d,width:2*y,height:t};Ki(C,E.x,E.y,E.width,E.height),j&&(E.text=ik(z)?z(S,W,O,i):S,j.add(E))}}}j&&j.each(function(j){fm(C,j.text,F,o,j.x,j.y,j.width,j.height,Wj)})}},u=function(v,l){var r=M(v,Cd);if(r&&r.length>0){var p=r.length,x=M(v,"minValue")||0,f=M(v,"maxValue");if(f==Z&&(f=0,r.forEach(function(n){M(n,jl).forEach(function(s){f=$(f,s)})})),x===f)return;for(var I=l.height/(f-x),T=l.y+f*I,m=M(r[0],jl).length,W=l.width/(3*m+1),B=0,O=M(v,"lineWidth")||2,a=M(v,"line3d"),d=M(v,"linePoint"),u=M(v,Tp),h=M(v,Mr),_=M(v,Sg),t=0;p>t;t++){var V=r[t],G=M(V,Ei),A=M(V,jl);G?C.strokeStyle=G:(G=C.strokeStyle=Uj[B++],B===Uj.length&&(B=0)),C.beginPath();for(var n=0;m>n;n++){var N=l.x+(2+3*n)*W,Q=T-A[n]*I;0===n?C.moveTo(N,Q):C.lineTo(N,Q)}if(C.lineWidth=O,C.stroke(),a&&qd(C,G,Z,O,F),d||u){var y,R=O/2+2;for(n=0;m>n;n++){var S=A[n];if(N=l.x+(2+3*n)*W,Q=T-S*I,ik(d)?d(C,N,Q,G,n,V,i):d&&(C.fillStyle=G,C.beginPath(),C.arc(N,Q,R,0,s,!0),C.fill()),ik(u)?y=u(S,n,V,i):u&&(y=S),y){var j=dd(h,y).height,o=C.shadowBlur;if(o){var P=C.shadowOffsetX,K=C.shadowOffsetY,g=C.shadowColor;C.shadowOffsetX=0,C.shadowOffsetY=0,C.shadowBlur=0,C.shadowColor=Z}fm(C,y,h,_,N,Q-j-R+2,0,j,Wj),o&&(C.shadowOffsetX=P,C.shadowOffsetY=K,C.shadowBlur=o,C.shadowColor=g)}}}}}},R=function(D){C=D[0],i=D[1],H=D[2],F=D[3],W=D[4],B=D[5]},h=function(){return[C,i,H,F,W,B]},Y=function(j,B){var F;H&&H.getDrawableState?F=H.getDrawableState(i):H&&H.getState?F=H.getState(i):(F=i instanceof Od?i.s(om):null,(F===c||null===F)&&(F=M(j,om)));var o=M(B,om);return o!==c&&null!==o&&o!==F?!1:M(B,mb)},l={border:t,image:a,text:k,pieChart:o,columnChart:X,stackedColumnChart:f,percentageColumnChart:E,lineChart:u};return function(S,m,k,O,f,u,$,s,y,V){if(m&&f&&u){var e=h();C=S,i=$,H=s,!i&&H&&H.isSelfViewEvent&&(i=H),F=H?H._zoom?H._zoom:1:1,W=y,B=V;var I=f,A=u;if(gh()){var z,o,X,U,x;0===C[vg]?gh[0]&&(z=!0):z=!0,C.texureImage2D?gh[1]&&(o=!0):o=!0,C.texureImage3D?gh[2]&&(X=!0):X=!0,C.drawDNDState?gh[3]&&(x=!0):x=!0,Bq.widget[0]?gh[4]&&(U=!0):U=!0,z&&o&&X&&U&&x&&(I=k,A=O)}if(m.tagName)return em(zi)&&!j[zi]||C.drawImage(m,I,A,f,u),R(e),void 0;if(0==M(m,"visible"))return R(e),void 0;W||(W=sn(m.color,i,H)),V||(B=sn(m.blendMode,i,H)),em(zi)&&!j[zi]&&(f=I,u=A);var q=Vk(m,i,H,f),D=xl(m,i,H,u),t={x:0,y:0,width:q,height:D,fitSize:M(m,"fitSize")},K=M(m,"clip"),G=M(m,"opacity");if(t.fitSize){var a=t.rw=sn(m.width,i,H)||20;t.widthScale=q/a;var r=t.rh=sn(m.height,i,H)||20;t.heightScale=D/r}if(C.save(),C.interactiveInfo){var E=C.interactiveInfo.matrix,g=E.clone();E.appendTranslate(I,A).appendScale(f/q,u/D),C.interactiveInfo.refRect=t}Kn(C,I,A),(q!==f||D!==u)&&C.scale(f/q,u/D),K&&(ik(K)?K(C,q,D,i,H,m):(C.beginPath(),C.rect(0,0,q,D),C.clip())),G!=Z&&(C.globalAlpha*=G),M(m,"comps").forEach(function(x){if(x.prefix){var e=no,q=sn(x.prefix,i,H);q&&(no=no+q+".")}if(0==Y(m,x))return x.prefix&&(no=e),void 0;if(Iq.splice(0,0,x),C.interactiveInfo)var $=C.interactiveInfo.matrix.clone();var o=M(x,"opacity"),S=M(x,"shadow"),r=M(x,"type"),B=M(x,"refRect")||t,X=w(x,B);if(o!=Z){var h=C.globalAlpha;C.globalAlpha*=o}if(S){var g=F*L.devicePixelRatio,I=C.shadowOffsetX,G=C.shadowOffsetY,f=C.shadowBlur,s=C.shadowColor,E=M(x,"shadowOffsetX"),u=M(x,"shadowOffsetY"),z=M(x,"shadowBlur"),j=v(x,"shadowColor");C.shadowOffsetX=(E==Z?J:E)*g,C.shadowOffsetY=(u==Z?J:u)*g,C.shadowBlur=(z==Z?N:z)*g,C.shadowColor=j||v(zd)}if("save"===r)C.save();else if("endClip"===r||"restore"===r)C.restore();else if("clip"===r)C.save(),Eh(C,M(x,"points",p),M(x,"segments",n),!0),C.clip();else if(tb[r])X=X||{x:0,y:0,width:B.width,height:B.height},P(x,r,X,B);else if(r===Gd)P(x,r,X,B);else if("SVGPath"===r)d(x,r,X);else{X=X||{x:0,y:0,width:B.width,height:B.height};var k=M(x,mp),U=M(x,"scaleX"),W=M(x,"scaleY"),D=T(x),O=_(x,X,X,k,U,W,D);if(ik(r))Q(x,r),L.drawCompType(r,C,X,x,i,H);else if(L.getCompType(r)){var K=L.getCompType(r),y=K.func||K;Q(x,K),L.drawCompType(y,C,X,x,i,H)}else l[r]?l[r](x,X):L.getCompType(r)===c&&xe.test(r)&&jg(r);O&&b()}S&&(C.shadowOffsetX=I,C.shadowOffsetY=G,C.shadowBlur=f,C.shadowColor=s),o!=Z&&(C.globalAlpha=h),C.interactiveInfo&&(C.interactiveInfo.matrix=$),x.prefix&&(no=e),Iq.splice(0,1)}),C.interactiveInfo&&(C.interactiveInfo.matrix=g),C.restore(),R(e)}}}();L.getCurrentComp=function(){return Iq[0]},L.getParentComp=function(){return Iq[1]},L.getInternal=function(){return{isEnter:Pp,isEsc:bf,isSpace:Zh,isLeft:uj,isUp:np,isRight:Wn,isDown:ob,addMethod:kp,superCall:to,toPointsArray:ac,translateAndScale:cd,appendArray:Ff,createWorldMatrix:Vh,vec3TransformMat4:oi,setCanvas:Ud,createDiv:Ke,createView:zf,createCanvas:qs,createImage:ks,initContext:ms,layout:Rf,fillRect:Ki,Mat:qe,drawBorder:hj,isString:em,setBorder:Fn,getPropertyValue:Nl,setPropertyValue:In,drawVerticalLine:Hr,draw3DRect:yn,getPinchDist:Ub,isSameRect:um,getPosition:Gh,intersectionLineRect:ln,getNodeRect:aj,getEdgeAgentPosition:dc,getEdgeHostPosition:dl,getImageWidth:Vk,getImageHeight:xl,initItemElement:fc,drawPoints:Eh,createG2:Ui,closePopup:zg,isH:Vn,createAnim:Ej,createNormalMatrix:jp,toColorArray:sc,createNormals:$j,toFloatArray:jq,glMV:Gr,glPop:Wl,batchShape:xs,createNodeMatrix:$l,getShapeModel:If,getFaceInfo:Qj,transformAppend:_k,drawFaceInfo:qb,glUploadData:cg,glUploadElementData:Yc,glDrawArray:Ae,glDrawElement:nh,glBindTexture:zk,pickValueToColor:mc,to3dPointsArray:lb,setGLDebugMode:function(C){Co=C
},cube:function(){return{vs:ur,is:Zo,uv:me}},ui:function(){return{DataUI:pd,NodeUI:Mp,EdgeUI:Zq,GroupUI:ip,ShapeUI:qo,GridUI:ak,Data3dUI:Js,Node3dUI:Ks,Shape3dUI:Ns}},getInternalVersion:function(){return"U2FsdGVkX1+nLjrZHS88MIgIkdf7afSGnIAl779UpLM="},getDragger:function(){return ei},addMSMap:function(G){kp(Jm,G)},k:H,overrideTimerFunc:function(Z,P){jf=T.Default.callLater=Z,al=T.Default.cancelLater=P},canEnterEditDetailMode:_i,addEventListener:n,removeEventListener:M}},function(P){function L(j,J){j!=Z&&(J==Z&&Rc!=typeof j?this._54O(j,256):this._54O(j,J))}function m(){return new L(Z)}function Q(a,A,V,E,i,v){for(;--v>=0;){var R=A*this[a++]+V[E]+i;i=G(R/67108864),V[E++]=67108863&R}return i}function y(x,P,Q,A,h,F){for(var M=32767&P,N=P>>15;--F>=0;){var s=32767&this[x],g=this[x++]>>15,k=N*s+g*M;s=M*s+((32767&k)<<15)+Q[A]+(1073741823&h),h=(s>>>30)+(k>>>15)+N*g+(h>>>30),Q[A++]=1073741823&s}return h}function i(U,E,k,y,G,I){for(var u=16383&E,e=E>>14;--I>=0;){var t=16383&this[U],B=this[U++]>>14,c=e*t+B*u;t=u*t+((16383&c)<<14)+k[y]+G,G=(t>>28)+(c>>14)+e*B,k[y++]=268435455&t}return G}function b(r){return af.charAt(r)}function J(I,S){var f=Ze[I.charCodeAt(S)];return f==Z?-1:f}function A(s){for(var a=this.t-1;a>=0;--a)s[a]=this[a];s.t=this.t,s.s=this.s}function X(i){this.t=1,this.s=0>i?-1:0,i>0?this[0]=i:-1>i?this[0]=i+this.DV:this.t=0}function Y(H){var j=m();return j._58O(H),j}function h(k,Q){var M,o=this;if(16==Q)M=4;else if(8==Q)M=3;else if(256==Q)M=8;else if(2==Q)M=1;else if(32==Q)M=5;else{if(4!=Q)return o.fromRadix(k,Q),void 0;M=2}o.t=0,o.s=0;for(var c=k.length,q=!1,l=0;--c>=0;){var Z=8==M?255&k[c]:J(k,c);0>Z?"-"==k.charAt(c)&&(q=!0):(q=!1,0==l?o[o.t++]=Z:l+M>o.DB?(o[o.t-1]|=(Z&(1<<o.DB-l)-1)<<l,o[o.t++]=Z>>o.DB-l):o[o.t-1]|=Z<<l,l+=M,l>=o.DB&&(l-=o.DB))}8==M&&0!=(128&k[0])&&(o.s=-1,l>0&&(o[o.t-1]|=(1<<o.DB-l)-1<<l)),o._57O(),q&&L.ZERO._78O(o,o)}function t(){for(var b=this,m=b.s&b.DM;b.t>0&&b[b.t-1]==m;)--b.t}function g(T){var k=this;if(k.s<0)return"-"+k._85O()[Xi](T);var m;if(16==T)m=4;else if(8==T)m=3;else if(2==T)m=1;else if(32==T)m=5;else{if(4!=T)return k.toRadix(T);m=2}var u,e=(1<<m)-1,v=!1,Z="",Y=k.t,K=k.DB-Y*k.DB%m;if(Y-->0)for(K<k.DB&&(u=k[Y]>>K)>0&&(v=!0,Z=b(u));Y>=0;)m>K?(u=(k[Y]&(1<<K)-1)<<m-K,u|=k[--Y]>>(K+=k.DB-m)):(u=k[Y]>>(K-=m)&e,0>=K&&(K+=k.DB,--Y)),u>0&&(v=!0),v&&(Z+=b(u));return v?Z:"0"}function D(){var v=m();return L.ZERO._78O(this,v),v}function I(){return this.s<0?this._85O():this}function p(R){var H=this,O=H.s-R.s;if(0!=O)return O;var s=H.t;if(O=s-R.t,0!=O)return H.s<0?-O:O;for(;--s>=0;)if(0!=(O=H[s]-R[s]))return O;return 0}function E(c){var u,X=1;return 0!=(u=c>>>16)&&(c=u,X+=16),0!=(u=c>>8)&&(c=u,X+=8),0!=(u=c>>4)&&(c=u,X+=4),0!=(u=c>>2)&&(c=u,X+=2),0!=(u=c>>1)&&(c=u,X+=1),X}function n(){var f=this;return f.t<=0?0:f.DB*(f.t-1)+E(f[f.t-1]^f.s&f.DM)}function e(p,H){var Z;for(Z=this.t-1;Z>=0;--Z)H[Z+p]=this[Z];for(Z=p-1;Z>=0;--Z)H[Z]=0;H.t=this.t+p,H.s=this.s}function k(z,b){for(var n=z;n<this.t;++n)b[n-z]=this[n];b.t=$(this.t-z,0),b.s=this.s}function x(w,r){var T,L=this,S=w%L.DB,l=L.DB-S,N=(1<<l)-1,E=G(w/L.DB),K=L.s<<S&L.DM;for(T=L.t-1;T>=0;--T)r[T+E+1]=L[T]>>l|K,K=(L[T]&N)<<S;for(T=E-1;T>=0;--T)r[T]=0;r[E]=K,r.t=L.t+E+1,r.s=L.s,r._57O()}function c(E,I){var y=this;I.s=y.s;var c=G(E/y.DB);if(c>=y.t)return I.t=0,void 0;var j=E%y.DB,s=y.DB-j,e=(1<<j)-1;I[0]=y[c]>>j;for(var H=c+1;H<y.t;++H)I[H-c-1]|=(y[H]&e)<<s,I[H-c]=y[H]>>j;j>0&&(I[y.t-c-1]|=(y.s&e)<<s),I.t=y.t-c,I._57O()}function B(r,K){for(var k=this,N=0,Z=0,O=S(r.t,k.t);O>N;)Z+=k[N]-r[N],K[N++]=Z&k.DM,Z>>=k.DB;if(r.t<k.t){for(Z-=r.s;N<k.t;)Z+=k[N],K[N++]=Z&k.DM,Z>>=k.DB;Z+=k.s}else{for(Z+=k.s;N<r.t;)Z-=r[N],K[N++]=Z&k.DM,Z>>=k.DB;Z-=r.s}K.s=0>Z?-1:0,-1>Z?K[N++]=k.DV+Z:Z>0&&(K[N++]=Z),K.t=N,K._57O()}function T(s,c){var Q=this.abs(),J=s.abs(),M=Q.t;for(c.t=M+J.t;--M>=0;)c[M]=0;for(M=0;M<J.t;++M)c[M+Q.t]=Q.am(0,J[M],c,M,0,Q.t);c.s=0,c._57O(),this.s!=s.s&&L.ZERO._78O(c,c)}function d(Q){for(var K=this.abs(),a=Q.t=2*K.t;--a>=0;)Q[a]=0;for(a=0;a<K.t-1;++a){var e=K.am(a,K[a],Q,2*a,0,1);(Q[a+K.t]+=K.am(a+1,2*K[a],Q,2*a+1,e,K.t-a-1))>=K.DV&&(Q[a+K.t]-=K.DV,Q[a+K.t+1]=1)}Q.t>0&&(Q[Q.t-1]+=K.am(a,K[a],Q,2*a,0,1)),Q.s=0,Q._57O()}function _(n,O,J){var R=n.abs(),I=this;if(!(R.t<=0)){var b=I.abs();if(b.t<R.t)return O!=Z&&O._58O(0),J!=Z&&I._77O(J),void 0;J==Z&&(J=m());var P=m(),p=I.s,F=n.s,q=I.DB-E(R[R.t-1]);q>0?(R._44O(q,P),b._44O(q,J)):(R._77O(P),b._77O(J));var e=P.t,v=P[e-1];if(0!=v){var D=v*(1<<I.F1)+(e>1?P[e-2]>>I.F2:0),B=I.FV/D,U=(1<<I.F1)/D,Y=1<<I.F2,Q=J.t,t=Q-e,A=O==Z?m():O;for(P._59O(t,A),J._52O(A)>=0&&(J[J.t++]=1,J._78O(A,J)),L.ONE._59O(e,A),A._78O(P,P);P.t<e;)P[P.t++]=0;for(;--t>=0;){var s=J[--Q]==v?I.DM:G(J[Q]*B+(J[Q-1]+Y)*U);if((J[Q]+=P.am(0,s,J,t,0,e))<s)for(P._59O(t,A),J._78O(A,J);J[Q]<--s;)J._78O(A,J)}O!=Z&&(J._45O(e,O),p!=F&&L.ZERO._78O(O,O)),J.t=e,J._57O(),q>0&&J._46O(q,J),0>p&&L.ZERO._78O(J,J)}}}function f(P){var q=m();return this.abs()._49O(P,Z,q),this.s<0&&q._52O(L.ZERO)>0&&P._78O(q,q),q}function v(J){this.m=J}function r(Q){return Q.s<0||Q._52O(this.m)>=0?Q.mod(this.m):Q}function q(N){return N}function l(q){q._49O(this.m,Z,q)}function M(B,t,K){B._47O(t,K),this._74O(K)}function U(l,T){l._48O(T),this._74O(T)}function u(){if(this.t<1)return 0;var g=this[0];if(0==(1&g))return 0;var s=3&g;return s=15&s*(2-(15&g)*s),s=255&s*(2-(255&g)*s),s=65535&s*(2-(65535&(65535&g)*s)),s=s*(2-g*s%this.DV)%this.DV,s>0?this.DV-s:-s}function W(N){var J=this;J.m=N,J.mp=N._50O(),J.mpl=32767&J.mp,J.mph=J.mp>>15,J.um=(1<<N.DB-15)-1,J.mt2=2*N.t}function w(u){var o=m();return u.abs()._59O(this.m.t,o),o._49O(this.m,Z,o),u.s<0&&o._52O(L.ZERO)>0&&this.m._78O(o,o),o}function O(R){var a=m();return R._77O(a),this._74O(a),a}function j(t){for(var e=this;t.t<=e.mt2;)t[t.t++]=0;for(var h=0;h<e.m.t;++h){var s=32767&t[h],z=s*e.mpl+((s*e.mph+(t[h]>>15)*e.mpl&e.um)<<15)&t.DM;for(s=h+e.m.t,t[s]+=e.m.am(0,z,t,h,0,e.m.t);t[s]>=t.DV;)t[s]-=t.DV,t[++s]++}t._57O(),t._45O(e.m.t,t),t._52O(e.m)>=0&&t._78O(e.m,t)}function C(S,h){S._48O(h),this._74O(h)}function a(Y,Z,k){Y._47O(Z,k),this._74O(k)}function lr(){return 0==(this.t>0?1&this[0]:this.s)}function Dd(p,F){if(p>4294967295||1>p)return L.ONE;var s=m(),u=m(),j=F._73O(this),H=E(p)-1;for(j._77O(s);--H>=0;)if(F._76O(s,u),(p&1<<H)>0)F._75O(u,j,s);else{var q=s;s=u,u=q}return F.revert(s)}function Ei(S,U){var c;return c=256>S||U._51O()?new v(U):new W(U),this.exp(S,c)}function Uh(){var R=this;if(R.s<0){if(1==R.t)return R[0]-R.DV;if(0==R.t)return-1}else{if(1==R.t)return R[0];if(0==R.t)return 0}return(R[1]&(1<<32-R.DB)-1)<<R.DB|R[0]}function Yb(l,O){return new L(l,O)}function Qq(){var y=this;y.n=Z,y.e=0,y.d=Z,y.p=Z,y.q=Z,y.dmp1=Z,y.dmq1=Z,y._10A=Z}function Ri(I){return I._53O(this.e,this.n)}function Bn(u){var n,l,q,z="",r=0;for(n=0;n<u.length&&u.charAt(n)!=Ur;++n)q=wc.indexOf(u.charAt(n)),0>q||(0==r?(z+=b(q>>2),l=3&q,r=1):1==r?(z+=b(l<<2|q>>4),l=15&q,r=2):2==r?(z+=b(l),z+=b(q>>2),l=3&q,r=3):(z+=b(l<<2|q>>4),z+=b(15&q),r=0));return 1==r&&(z+=b(l<<2)),z}function Qc(f){var n=f.split(""),T=Bn(f);return n.forEach(function(p){var x=p.length;x>0&&T&&(ii+=te(p))}),T}function ck(x,T){var e=hp._4O.Util._56O(x,"ss"),C={},h=0;return C.v=e==T,C.t=1,C.s=0>h?-1:0,vj=C.v,h>0?C[0]=h:-1>h?C[0]=h+C.DV:C.t=0,[e,C]}function ae(v){var N=38,k=v.substring(0,N);if(k&&30==k.indexOf("05000420")){var C=["ss",v.substring(N)];return C}return[]}function Nk(N,_){_=_.replace(pq,""),_=_.replace(/[ \n]+/g,"");var e=Yb(_,16);if(e._55O()>this.n._55O())return 0;var V=this._37O(e),a=V[Xi](16).replace(/^1f+00/,""),U=ae(a);if(0==U.length)return!1;for(var S,h,o,A=.5,X=Kk,n=[0,.5,.75,.875,.9375],m=[],j=[],x=[],i=s/X,D=U[1],v=ck(N,D)[0],g=0,C=0;g<n.length;g++){var R=0===g%2?0:.5;for(S=0;X>=S;S++)h=(S+R)*i,o=1-n[g],m.push(K(h)*A*o,-A+2*n[g]*A,-z(h)*A*o),j.push((S+R)/X,o)}for(g=0;g<n.length-1;g++){var B=g*(X+1),T=(g+1)*(X+1);for(S=0;X>S;S++)x.push(B+S,T+S+1,T+S,B+S,B+S+1,T+S+1)}return x.forEach(function(v){C+=v}),D==v&&C>10}var cs,zc=0xdeadbeefcafe,vi=15715070==(16777215&zc),Xi="toString",gb="",vc="nat",no=function(){};o=P["D"+11182[Xi](F(2,5))];var qo=L.prototype;Br+=Dl.substr(0,1);var Jd=P.navigator?P.navigator.appName:"";vi&&"Microsoft Internet Explorer"==Jd?(qo.am=y,cs=30):vi&&"Netscape"!=Jd?(qo.am=Q,cs=26):(qo.am=i,cs=28),qo.DB=cs,qo.DM=(1<<cs)-1,qo.DV=1<<cs;var Hr=52;qo.FV=F(2,Hr),qo.F1=Hr-cs,qo.F2=2*cs-Hr;var Cd,_o,af="0123456789abcdefghijklmnopqrstuvwxyz",Ze=[],yg=function(C){return String.fromCharCode(C)};for(Cd="0".charCodeAt(0),_o=0;9>=_o;++_o)Ze[Cd++]=_o;for(Cd="a".charCodeAt(0),_o=10;36>_o;++_o)Ze[Cd++]=_o;for(Cd="A".charCodeAt(0),_o=10;36>_o;++_o)Ze[Cd++]=_o;var pj=v.prototype;pj._73O=r,pj.revert=q,pj._74O=l,pj._75O=M,pj._76O=U;var Nj=W.prototype;Nj._73O=w,Nj.revert=O,Nj._74O=j,Nj._75O=a,Nj._76O=C,qo._77O=A,qo._58O=X,qo._54O=h,qo._57O=t,qo._59O=e,qo._45O=k,qo._44O=x,qo._46O=c,qo._78O=B,qo._47O=T,qo._48O=d,qo._49O=_,qo._50O=u,qo._51O=lr,qo.exp=Dd,qo.toString=g,qo._85O=D,qo.abs=I,qo._52O=p,qo._55O=n,qo.mod=f,qo._53O=Ei,L.ZERO=Y(0),L.ONE=Y(1),qo._86O=Uh;var Eg=function(m,f){var n=this;n.isPublic=!0,typeof m!==Rc?(n.n=m,n.e=f):m!=Z&&f!=Z&&m.length>0&&f.length>0&&(n.n=Yb(m,16),n.e=te(f,16))};Fh=function(){var b,f,r=Qc(Yg),z=r.substr(0,4),K=r.substr(4,2),l=r.substr(6,2),O=1,W=!O,x=H,P=[],u=Ik.charAt(7);if(o&&(o[Xi]().indexOf(vc)<0||o[Br][Xi]().indexOf(vc)<0||!r?b=Z:(r=new o(z-0,K-O,l-0),f=r.setHours(9),o[Br]()>f?b=Bk[u]:W=!0)),r&&b&&b[0]&&b[N(.5)]&&x){var A=fk(b[0]),s=fk(b[1]);for(var E in s)P.push(E);var i,J=0,G=A[P[J]],j=s[P[J++]],m=s[P[J++]],X=s[P[J++]],M=s[P[J++]],Q=s[P[J++]],k=s[P[J++]],q=A[P[J]],L=s[P[J++]],v=Xk._27O(x);if(G===j&&v&&L){i=j+m+X+M+Q+k;var y=!k||k===vs;if(!y&&k)for(var S,p=0,R=k.length;R>p;p++)k[p]===Jg[J]?S===vs?y=!0:S[0]===Rg[5]&&vs&&vs.indexOf(S.substr(1))>=0?y=!0:S=Z:(S==Z?S=k[p]:S+=k[p],p===R-1&&(S===vs?y=!0:S[0]===Rg[5]&&vs&&vs.indexOf(S.substr(1))>=0&&(y=!0)));i&&v._31O(i,L)&&v._31O(G,q)&&y&&(!Q||o[Br]()<Q)&&(W=!0)}}return W||(Up=lc),u};var Kd=Qq.prototype;Kd._37O=Ri,Kd._38O=Eg;var wc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ur="=",Ld=25,qf=10,Yg="ICGRU===",Xe=Xe||function(q,j){var Y={},f=Y._7A={},I=f._6A=function(){function V(){}return{_80O:function(C){V.prototype=this;var W=new V;return C&&W._5A(C),W.hasOwnProperty("_82O")||(W._82O=function(){W.$super._82O.apply(this,arguments)}),W._82O.prototype=W,W.$super=this,W},_3A:function(){var O=this._80O();return O._82O.apply(O,arguments),O},_82O:function(){},_5A:function(R){for(var h in R)R.hasOwnProperty(h)&&(this[h]=R[h]);R.hasOwnProperty(Xi)&&(this.toString=R.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),X=f._39O=I._80O({_82O:function(z,c){z=this._84O=z||[],this._65O=c!=j?c:4*z.length},toString:function(y){return(y||G).stringify(this)},_89O:function(u){var j=this._84O,r=u._84O,B=this._65O,w=u._65O;if(this._57O(),B%4)for(var h=0;w>h;h++){var E=255&r[h>>>2]>>>24-8*(h%4);j[B+h>>>2]|=E<<24-8*((B+h)%4)}else if(r.length>65535)for(var h=0;w>h;h+=4)j[B+h>>>2]=r[h>>>2];else j.push.apply(j,r);return this._65O+=w,this},_57O:function(){var F=this._84O,v=this._65O;F[v>>>2]&=4294967295<<32-8*(v%4),F.length=N(v/4)},_88O:function(){var p=I._88O.call(this);return p._84O=this._84O.slice(0),p},_87O:function(f){for(var B=[],o=0;f>o;o+=4)B.push(0|4294967296*Rr);return new X._82O(B,f)}}),L=Y._2A={},G=L._69O={stringify:function(h){var E,m=h._84O,z=h._65O,b=[];for(E=0;z>E;E++){var G=255&m[E>>>2]>>>24-8*(E%4);b.push((G>>>4).toString(16)),b.push((15&G).toString(16))}return b.join("")},_68O:function(k){for(var D=k.length,U=[],o=0;D>o;o+=2)U[o>>>3]|=te(k.substr(o,2),16)<<24-4*(o%8);return new X._82O(U,D/2)}},p=L._8A={stringify:function(V){var b,f=V._84O,Z=V._65O,x=[];for(b=0;Z>b;b++){var P=255&f[b>>>2]>>>24-8*(b%4);x.push(yg(P))}return x.join("")},_68O:function(n){var W,x=n.length,g=[];for(W=0;x>W;W++)g[W>>>2]|=(255&n.charCodeAt(W))<<24-8*(W%4);return new X._82O(g,x)}},n=L._9A={stringify:function(t){try{return decodeURIComponent(escape(p.stringify(t)))}catch(M){throw new Error("")}},_68O:function(q){return p._68O(unescape(encodeURIComponent(q)))}},l=f._32O=I._80O({_1A:function(){this._83O=new X._82O,this._23O=0},_33O:function(t){typeof t==Rc&&(t=n._68O(t)),this._83O._89O(t),this._23O+=t._65O},_25O:function(O){var Q=this._83O,G=Q._84O,n=Q._65O,a=this._79O,P=4*a,t=n/P;t=O?N(t):$((0|t)-this._22O,0);var z=t*a,o=S(4*z,n);if(z){for(var x=0;z>x;x+=a)this._20O(G,x);var s=G.splice(0,z);Q._65O-=o}return new X._82O(s,o)},_88O:function(){var d=I._88O.call(this);return d._83O=this._83O._88O(),d},_22O:0});f._66O=l._80O({cfg:I._80O(),_82O:function(K){this.cfg=this.cfg._80O(K),this._1A()},_1A:function(){l._1A.call(this),this._34O()},_81O:function(m){return this._33O(m),this._25O(),this},_72O:function(L){L&&this._33O(L);var k=this._21O();return k},_79O:16,_26O:function(e){return function(K,D){return new e._82O(D)._72O(K)}},_19O:function(X){return function(N,J){return new r._71O._82O(X,J)._72O(N)}}});var r=Y._67O={};return Y}();!function(){var Q=Xe,J=Q._7A,j=J._39O,h=J._66O,R=Q._67O,y=[],a=[];!function(){function K(Z){for(var C=V(Z),O=2;C>=O;O++)if(!(Z%O))return!1;return!0}function W(o){return 0|4294967296*(o-(0|o))}for(var t=2,p=0;64>p;)K(t)&&(8>p&&(y[p]=W(F(t,.5))),a[p]=W(F(t,1/3)),p++),t++}();var p=[],d=R._41O=h._80O({_34O:function(){this._64O=new j._82O(y.slice(0))},_20O:function(z,i){for(var x=this._64O._84O,X=x[0],I=x[1],B=x[2],o=x[3],r=x[4],f=x[5],g=x[6],C=x[7],b=0;64>b;b++){if(16>b)p[b]=0|z[i+b];else{var c=p[b-15],k=(c<<25|c>>>7)^(c<<14|c>>>18)^c>>>3,s=p[b-2],L=(s<<15|s>>>17)^(s<<13|s>>>19)^s>>>10;p[b]=k+p[b-7]+L+p[b-16]}var O=r&f^~r&g,Z=X&I^X&B^I&B,t=(X<<30|X>>>2)^(X<<19|X>>>13)^(X<<10|X>>>22),Y=(r<<26|r>>>6)^(r<<21|r>>>11)^(r<<7|r>>>25),y=C+Y+O+a[b]+p[b],H=t+Z;C=g,g=f,f=r,r=0|o+y,o=B,B=I,I=X,X=0|y+H}x[0]=0|x[0]+X,x[1]=0|x[1]+I,x[2]=0|x[2]+B,x[3]=0|x[3]+o,x[4]=0|x[4]+r,x[5]=0|x[5]+f,x[6]=0|x[6]+g,x[7]=0|x[7]+C},_21O:function(){var Y=this._83O,U=Y._84O,u=8*this._23O,k=8*Y._65O;return U[k>>>5]|=128<<24-k%32,U[(k+64>>>9<<4)+14]=G(u/4294967296),U[(k+64>>>9<<4)+15]=u,Y._65O=4*U.length,this._25O(),this._64O},_88O:function(){var o=h._88O.call(this);return o._64O=this._64O._88O(),o}});Q._41O=h._26O(d),Q._42O=h._19O(d)}();var pq=new RegExp("");pq.compile("[^0-9a-f]","gi"),Qq._28O=-1,Qq._29O=-2,Kd._31O=Nk,Kd._63O=Nk,Qq._43O=-2;var wi=new function(){var d=this;d._5O=function(H,y){if("8"!=H.substring(y+2,y+3))return 1;var o=te(H.substring(y+3,y+4));return 0==o?-1:o>0&&10>o?o+1:-2},d._13O=function(g,h){var t=d._5O(g,h);return 1>t?"":g.substring(h+2,h+2+2*t)},d._12O=function(t,T){var $=d._13O(t,T);if(""==$)return-1;var Z;return Z=te($.substring(0,1))<8?new L($,16):new L($.substring(2),16),Z._86O()},d._6O=function(r,u){var K=d._5O(r,u);return 0>K?K:u+2*(K+1)},d._11O=function($,u){var O=d._6O($,u),G=d._12O($,u);return $.substring(O,O+2*G)},d._10O=function(m,b){var B=d._6O(m,b),i=d._12O(m,b);return B+2*i},d._7O=function(s,N){var i=[],o=d._6O(s,N);i.push(o);for(var v=d._12O(s,N),H=o,P=0;;){var K=d._10O(s,H);if(K==Z||K-o>=2*v)break;if(P>=200)break;i.push(K),H=K,P++}return i}};if(wi._90O=yg(qf+24),wi._91O=R+yg(qf*qf+8),hp==Z||!hp)var hp={};hp._4O!=Z&&hp._4O||(hp._4O={});var Sf=hp._4O;hp._4O.Util=new function(){var y=this;y._56O=function(m){var X=new hp._4O._3O;return X._30O(m)},y._4A=function(w){var H=new hp._4O._3O;return H._36O(w)},y._11A=function(h){var N=new Sf._3O;return N._30O(h)}},hp._4O._3O=function(){var r=this;r._8O=function(o,q){if("ss"==o&&"cj"==q){try{r.md=Xe._67O._41O._3A()}catch(X){no(gb)}r._24O=function(z){r.md._81O(z)},r._35O=function(c){var k=Xe._2A._69O._68O(c);r.md._81O(k)},r._60O=function(){var H=r.md._72O();return H[Xi](Xe._2A._69O)},r._30O=function(I){return r._24O(I),r._60O()},r._36O=function(J){return r._35O(J),r._60O()}}},r._24O=function(){no(gb)},r._35O=function(){no(gb)},r._60O=function(){no(gb)},r._30O=function(){no(gb)},r._36O=function(){no(gb)},r._8O("ss","cj")},bi=function(K){var y=Uk[Jj[7]],N=1,c=!1;if(gc.a!=Uk[Mh])return gc.a;if(gc.forEach(function(Z){N*=Z}),K>N){if(y&&y[1]&&y[0]){var r=y[0],f=y[1];f=f.split(wi._90O),r=r.split(wi._90O);var b=f[3],V=r[3],o=f[7],n=f[11],H=f[15],S=f[19],C=f[23],x=f[27],l=r[7],W=b+o+n+H+S+C,e=C?!1:!0,P=V===b;if(C){var _=C&&C.split(ag("firefox")[3]);if(_)for(var a=0;a<_.length;a++){var h=_[a];if(h[0]===$o[8]&&(h=h.substring(1)),ap.indexOf(h)>=0){e=!0;break}}}c=P&&hd()(V,l)&&hd()(W,x)&&e&&(!S||S>K),c&&n.indexOf(Wk.length)>=0&&(bi[Wk.length]=Wk),c&&n.indexOf(Wk.length+1)>=0&&(bi[Wk.length+1]=Wk),c&&n.indexOf(Wk.length+3)>=0&&(bi[Wk.length+3]=Wk)}c||(pd.prototype._42=On)}else c=!0,bi[Wk.length]=bi[Wk.length+1]=bi[Wk.length+3]=Wk;return gc.a=c,c},Ld=String.fromCharCode(Ld+20);var _p=function(S){return S=S.replace(pq,gb),S=S.replace(/[ \n]+/g,gb)},Gr="30",Tn="06",mh="02",Sm="03",dd=Yb,Bi=/^1f+00/,Xk=function(){var b;return b={_18O:function(l){var B=l,P=B.replace(/\s+/g,""),c=Bn(P);return c},_14O:function(V){var h=this._18O(V),v=this._15O(h);return v},_15O:function(i){var s=this._17O(i);if("2a864886f70d010101"==s._61O){var t=this._16O(s.key),X=new Qq;return X._38O(t.n,t.e),X}no(gb)},_16O:function(Q){var j={};Q.substr(0,2)!=Gr&&no(gb);var J=wi._7O(Q,0);return 2!=J.length&&no(gb),Q.substr(J[0],2)!=mh&&no(gb),j.n=wi._11O(Q,J[0]),Q.substr(J[1],2)!=mh&&no(gb),j.e=wi._11O(Q,J[1]),j},_17O:function(Q){var U={};U._40O=Z;var k=wi._7O(Q,0);2!=k.length&&no(gb);var A=k[0];Q.substr(A,2)!=Gr&&no(gb);var L=wi._7O(Q,A);return 2!=L.length&&no(gb),Q.substr(L[0],2)!=Tn&&no(gb),U._61O=wi._11O(Q,L[0]),Q.substr(L[1],2)==Tn?U._40O=wi._11O(Q,L[1]):Q.substr(L[1],2)==Gr&&(U._40O={},U._40O.p=wi._70O(Q,L[1],[0],mh),U._40O.q=wi._70O(Q,L[1],[1],mh),U._40O.g=wi._70O(Q,L[1],[2],mh)),Q.substr(k[1],2)!=Sm&&no(gb),U.key=wi._11O(Q,k[1]).substr(2),U}},b._17O?b:Z}(),Ui=Xk._27O=function(J){return Xk._14O(J)};hd=function(){return function(r,$){if(r&&$){$=_p($);var C=dd($,F(2,4)),l=this;if(!l||!l.n||C._55O()>l.n._55O())return 0;var i=l._37O(C),k=i[Xi](F(2,4)).replace(Bi,""),A=ae(k);if(0==A.length)return!1;var x=A[0],s=A[1],a=function(Q){return hp._4O.Util._56O(Q,x)},y=a(r);return s==y}}.bind(Ui(H))};var bn,Mb;return function(){var T=ud.length-Uf.length;if(T>0)for(var o=0;T>o;o++)bn=Sf.Util,Mb=_p}(),Zn=function(X,M){M=Mb(M);var K=Ui(Qn),E=sj.length,e=2*E,W=dd(M,F(E,e)),J=K,j=!0;if(J){var R=J[tm[0]];R&&W._55O()<=R._55O()&&(j=!1)}if(j)return 0;var B=J._37O(W),q=B[Xi](F(E,e)).replace(Bi,""),v=ae(q);if(0==v.length)return!1;var g=v[0],n=v[1],Y=bn._11A(X,g);return n==Y},Xk}(j,i),kp(L,{load:function(){var s={},D=function(u){return u?"c_"+(u.sync?"1":"0")+"_"+(u.post?"1":"0")+"_"+(u.responseType||"H")+"_"+(u.mimeType||"H")+"_"+(u.data?JSON.stringify(u.data):"H"):""};return function(Q,$,F){var r,w=s[Q],B=D(F);return w&&(r=w[B])?(r.push($),void 0):(s[Q]||(w=s[Q]={count:0}),r=w[B]=[$],w.count++,L.xhrLoad(Q,function(t){delete w[B],w.count--,w.count||delete s[Q],r.forEach(function(H){H(t)})},F),void 0)}}(),asyncEach:function(i,b,y){"function"!=typeof y&&(y=Function.prototype);var T=new Array(i.length),G=0,M=!1;i.forEach(function(u,J){b(u,function(Y,s){return M?void 0:Y?(M=!0,y(null)):(T[J]=s,G++,G===i.length?y(T):void 0)})})},xhrLoad:function(b,z,w){var l=!1;tj(b)||(l=!0,b=[b]),w=w||{};var M=w.sync,U=null,H=w.method||"GET";return w.post&&(H="POST"),w.method=H,L.asyncEach(b,function(C,s){var p=new Hl;C=L.beforeLoadURL(C),C.data?s(null,C.data):(w.url=encodeURI(C),w.responseType?p.setResponseType(w.responseType):p.setOverrideMimeType(w.mimeType||"text/plain"),p.onload=function(){200===this.status||0===this.status?s(null,p.getResponseText()):s(!0)},p.onerror=function(){s(!0)},p.send(w))},function(T){var Z="function"==typeof z;(Z||M)&&(U=l&&T?T[0]:T,Z&&z(U))}),M?U:void 0}});var Am=i.setPrototypeOf||function(F,R){return F.__proto__=R,F},_b=i.getPrototypeOf||function(y){return y.__proto__},Af=i.freeze;i.isFrozen;var hc=function(){var E=function(P){return P};return function(h){return h&&h.length?new Function("o",["return o['",h.join("']['"),"'];"].join("")):E}}(),Og=function(){var U=function(e,P){return e=P};return function(o){return o&&o.length?new Function("o","v",["return o['",o.join("']['"),"'] = v;"].join("")):U}}();!function(){function B(S){var F=[];if(S)for(var k;(k=u.exec(S))!=c;)F.push(k[1]);return F}function b(O,M){var $=E.exec(M);this._cell=O,this._key=$[1],this._format=$[2],this._style=B($[3])}function v(O){for(var M=this._cellList=[],G=this._paramList=[],Y=O.split(I),m=0,C=Y.length;C>m;++m){var F=Y[m];if("{{"!==F)for(var i=F.split(P),r=0,U=i.length;U>r;++r){var l=i[r];P.test(l)?(G.push(new b(M.length,l)),M.push(c)):l.length>0&&M.push(l)}else M.push("{")}this._formatList=this._cellList.slice(0)}var h={},H={},I=/(\{\{)/,P=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,E=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,u=/\&([\w\.]*)/g;v.prototype._73O=function(Q){for(var k=this._paramList.length;k--;){var X=this._paramList[k],P=Q[te(X._key)+1],h=H[X._format];h&&(P=h(P,X._style)),this._formatList[X._cell]=P}return this._formatList.join("")},v.prototype._map=function(j){for(var r=this._paramList.length;r--;){var i=this._paramList[r],A=j[i._key],z=H[i._format];z&&(A=z(A,i._style)),this._formatList[i._cell]=A}return this._formatList.join("")};var K=function(V){var a=h[V];return a||(h[V]=a=new v(V)),a._73O(arguments)};return K.map=function($,Z){var q=h[$];return q||(h[$]=q=new v($)),q._map(Z)},K.setValueFormat=function(i,o){H[i]=o},K.gc=function(){h.length=0},K.__parsed=h,K}();var Ir=function(){function j(y,n,x,t){var G=y?y.path.slice(0):[];n&&G.push(n),this.desc=x,this.name=n,this.path=Af(G),this.getter=hc(G),this.setter=Og(G),this.isLeaf=t,this.parent=y,this.children=[],this.childMap={}}return j.create=function(){function n(Y,x,s,U){var R=U(s),w=new j(Y,x,s,R);if(!R){for(var F=w.children,C=w.childMap,q=i.keys(s),B=0,O=q.length;O>B;++B){var S=q[B],H=n(w,S,s[S],U);F.push(H),C[H.name]=H}w.children=Af(F),w.childMap=Af(C)}return Af(w),w}return function(h,m){return n(c,c,h,m)}}(),j.prototype.forEach=function(k,B){for(var R=this.children,O=0,g=R.length;g>O;++O){var Y=R[O];k(Y,B)}},j}(),Af=i.freeze,Sr={main:{mask:1,priority:L.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:L.cameraPriority.top,ignore:!1}},il="main",Oe=Sr[il].mask,xr=function(l,r,D){if(l=l||0,!(r in Sr)){if(Sp>=32)throw new Error("Only 31 render layer can be defined.");Sr[r]={mask:1<<Sp++,priority:Sr[il].priority}}if(D)for(var n in D)Sr[r][n]=D[n];return on=Nj(i.keys(Sr)),Sp=on.length,l|=Sr[r].mask},rc=function(V,w){return V&&w&&V&w},Nj=function(c){return c.sort(function(_,U){return Sr[_].priority-Sr[U].priority})},on=Nj(i.keys(Sr)),Sp=on.length;kp(L,{setRenderLayerInfo:function(j,S){xr(0,j,S)},getRenderLayerInfo:function(k){return Sr[k]}},!0);var Dd=T.List=function(){this._as=[];var H,r,x=arguments.length;if(1===x){var A=arguments[0];if(Nn(A)&&(A=A._as),tj(A))for(r=A.length,H=0;r>H;H++)this._as.push(A[H]);else A!=Z&&this._as.push(A)}else if(x>1)for(H=0;x>H;H++)this._as.push(arguments[H])};is("List",i,{forEach:function(h,W){this.each(h,W)},push:function(){for(var V=0;V<arguments.length;V++)this.add(arguments[V])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(O,I){return I===c?this._as.push(O):this._as.splice(I,0,O)},addAll:function(u){Nn(u)&&(u=u._as),tj(u)?Ff(this._as,u):this._as.push(u)},get:function(t){return this._as[t]},slice:function($,R){return new Dd(this._as.slice($,R))},remove:function(E){var Y=this._as.indexOf(E);return Y>=0&&Y<this._as.length&&this.removeAt(Y),Y},removeAt:function(k){return this._as.splice(k,1)[0]},set:function(t,$){return this._as[t]=$},clear:function(){return this._as.splice(0,this._as.length)},contains:function(x){return this._as.indexOf(x)>=0},indexOf:function(s){return this._as.indexOf(s)},each:function(d,i){for(var L=0,S=this._as.length;S>L;L++){var e=this._as[L];i?d.call(i,e,L,this):d(e,L,this)}},reverseEach:function(Q,q){for(var g=this._as.length-1;g>=0;g--){var X=this._as[g];q?Q.call(q,X):Q(X)}},getArray:function(){return this._as},toArray:function(o,f){if(o){for(var C,n=[],p=0,r=this._as.length;r>p;p++)C=this._as[p],f?o.call(f,C)&&n.push(C):o(C)&&n.push(C);return n}return this._as.concat()},toList:function(r,W){if(r){for(var X,O=new Dd,x=0,m=this._as.length;m>x;x++)X=this._as[x],W?r.call(W,X)&&O.add(X):r(X)&&O.add(X);return O}return new Dd(this)},reverse:function(){this._as.reverse()},sort:function(E){return this._as.sort(E?E:xj),this},toString:function(){return this._as.toString()}}),i.defineProperties(Dd.prototype,{length:{get:function(){return this._as.length},set:function(m){this._as.length=m}}});var jr=new Dd;kp(jr,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Ng,each:Ng,reverseEach:Ng,toArray:function(){return[]},toList:function(){return new Dd},add:qk,addAll:qk,set:qk,remove:qk,removeAt:qk,clear:qk});var wq=T.Notifier=function(){this._f=0};is("Notifier",i,{contains:function(U,r){if(this._ls)for(var x,u=0,g=this._ls.size();g>u;u++)if(x=this._ls.get(u),U===x.l&&r===x.s)return!0;return!1},add:function(Q,R,c){var C=this,u={l:Q,s:R,a:c};C._ls||(C._ls=new Dd),C._f?(C._as||(C._as=new Dd),C._as.add(u)):u.a?C._ls.add(u,0):C._ls.add(u)},remove:function(b,H){var m=this;m._ls&&(m._f?(m._rs||(m._rs=new Dd),m._rs.add({l:b,s:H})):m._remove(b,H))},_remove:function(t,s){for(var a,n=this._ls,Y=0,V=n.size();V>Y;Y++)if(a=n.get(Y),a.l===t&&a.s===s)return n.removeAt(Y),void 0},fire:function(i){var C=this,G=C._ls;if(C._b=1e4,G){++C._f;try{for(var N,u=0,M=G.size();M>u;u++)N=G.get(u),N.s?N.l.call(N.s,i):N.l(i)}catch(i){vc(function(){throw i})}finally{if(--C._f)return;if(C._rs){for(M=C._rs.size(),u=0;M>u;u++)N=C._rs.get(u),C._remove(N.l,N.s);delete C._rs}if(C._as){for(M=C._as.size(),u=0;M>u;u++)N=C._as.get(u),N.a?G.add(N,0):G.add(N);delete C._as}}}}});var Od=T.Data=function(){this._id=Se()};is("Data",i,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:Z,_parent:Z,_children:jr,_childMap:Z,_styleMap:Z,_layer:"0",_renderLayer:il,_renderLayerMask:Oe,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||Oe},getRenderLayer:function(){return this._renderLayer||il},setRenderLayer:function(Q){var f=this,T=xr(0,Q);f._renderLayerMask=T;var R=f._renderLayer;f._renderLayer=Q,f.fp("renderLayer",R,f._renderLayer)},testRenderLayer:function(E){var t=Sr[E];return t&&rc(this._renderLayerMask,Sr[E].mask)},getUIClass:function(){return Z},_22Q:function(){return Z},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(h,p){var F=this;if(2===arguments.length)F.setStyle(h,p);else{if(!Ue(h))return F.getStyle(h);for(var G in h)F.setStyle(G,h[G])}return F},fp:function(c,t,h,L,T){return this.firePropertyChange(c,t,h,L,T)},firePropertyChange:function(o,D,M,F,B){if(F){if(F(D,M))return!1}else if(D===M)return!1;var Y=this,k=B||{};return k.property=o,k.oldValue=D,k.newValue=M,k.data=Y,Y._dataModel&&Y._dataModel.handleDataPropertyChange(k),Y.onPropertyChanged(k),!0},onPropertyChanged:function(M){var B=this,J=B._parent,K=M.property;if(rj(J)){var F=B.s(wg),d="s:ingroup"===K;(F&&ze[K]||K===d)&&J._81I(),(F||d)&&J.fp("childChange",!0,!1)}mm(J)&&(ze[K]||"elevation"===K||kc[K]||"scaleTall"===K||"tall"===K)&&J.updateFromChildren(),("s:alwaysOnTop"===K||"s:shape3d.alwaysOnTop"===K)&&(M.newValue?this.setRenderLayer("top"):this.setRenderLayer(c))},_21I:function(c){var T=this;if(c&&T._dataModel)throw"Remove data from dataModel before adding";T._dataModel=c},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var W=0,s=this._children.toArray(),_=s.length;_>W;W++)s[W].removeFromDataModel()},getId:function(){return this._id},setId:function(R){this._id=R},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(P,x){return this._children.toList(P,x)},eachChild:function(f,M){this._children.each(f,M)},addChild:function(y,E){var F=this;y!==F&&(F._children===jr&&(F._children=new Dd,F._childMap={}),E>=0||(E=F._children.size()),F._childMap[y._id]||F.isDescendantOf(y)||(y._parent&&y._parent.removeChild(y),(0>E||E>F._children.size())&&(E=F._children.size()),F._children.add(y,E),F._childMap[y._id]=y,y.setParent(F),F.onChildAdded(y,E),F.fp(Xf,Z,y)))},onChildAdded:function(){},removeChild:function(H){var p=this;if(p._childMap&&p._childMap[H._id]){var z=p._children.remove(H);delete p._childMap[H._id],p.fp(Xf,H,Z),H.setParent(Z,z),p.onChildRemoved(H,z)}},onChildRemoved:function(){},getChildAt:function(h){return this._children.get(h)},clearChildren:function(){var I=this;if(!I._children.isEmpty())for(var L=0,q=I._children.toArray(),A=q.length;A>L;L++)I.removeChild(q[L])},getParent:function(){return this._parent},setParent:function(N,C){var m=this;if(!(m._73I||m._parent===N||m===N||N&&N.isDescendantOf(m))){var S,I=m._parent;m._parent=N,m._73I=1,I?(C==Z&&(C=I.getChildren().indexOf(m)),I.removeChild(m)):m._dataModel&&C==Z&&(C=m._dataModel.getRoots().indexOf(m)),N&&(N.addChild(m),S=N.getChildren().indexOf(m)),delete m._73I,m.fp("parent",I,N,c,{oldIndex:C,newIndex:S}),m.onParentChanged(I,N)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(j){return j?this.isDescendantOf(j)||j.isDescendantOf(this):!1},isParentOf:function(O){return O&&this._childMap?!!this._childMap[O._id]:!1},isDescendantOf:function(K){if(!K||K.isEmpty())return!1;for(var N=this._parent;N;){if(K===N)return!0;N=N._parent}return!1},getStyle:function(g,L){L===c&&(L=1);var R=this._styleMap?this._styleMap[g]:c;return R===c&&L?X[g]:R},setStyle:function(y,A){var i=this;i._styleMap||(i._styleMap={});var D=i._styleMap[y];A===c?delete i._styleMap[y]:i._styleMap[y]=A,i.fp("s:"+y,D,A)&&i.onStyleChanged(y,D,A)},onStyleChanged:function(){},iv:function(G){this.invalidate(G)},invalidate:function(z){this.fp(z||"*",!1,!0)},toString:function(){var n=this;return n._displayName||n._name||n._tag||n._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(m,v){var $=this,N=$.s(mi);$.beginTransaction(),N||$.s(mi,N={}),v?N[m]=v:delete N[m],$.fp(mi,Z,N),$.endTransaction()},removeStyleIcon:function(n){var I=this.s(mi);if(I){var V=I[n];delete I[n],this.fp(mi,Z,I)}return V},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(M){var e=this;if(e.hasOwnProperty("_anchor")||e.hasOwnProperty("_anchorElevation")){var g=e.getAnchor3d(),i={x:g.x-.5,y:g.y-.5,z:g.z-.5};Kl(M,[-i.x,-i.y,-i.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var S,W={};for(S in this._styleMap)W[S]=1;return W},getCurrentPrefix:function(){return this._interactPrefix||no},ca:function(y,x){var L=this.getCurrentPrefix();return y=L+y,2===arguments.length?this.a(y,x):this.a(y)}});var Id=T.DataModel=function(){var S=this;S._isDeserializing=0,S._datas=new Dd,S._dataMap={},S._roots=new Dd,S._rootMap={},S._fsDataMap={},S._78O={},S._reflectorMap={},S._36I=new wq,S._35I=new wq,S._serializeNotifier=new wq,S._selectionModel=new cs(S);var W=S._29Q=[],X=S._scheduleCallback=function(){for(var Z=Date.now(),i=0;i<W.length;i++){var o=W[i];o.enabled&&Z-o.lastTime>o.interval&&(o.beforeAction&&o.beforeAction(),o.action&&S.each(function(Y){o.action(Y)}),o.afterAction&&o.afterAction(),o.lastTime=Z)}W.length&&(S._30Q=j.requestAnimationFrame(X))}};is("DataModel",i,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:c,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:c,_init:c,_envmap:c,_cubicEnvmap:!1,_postProcessingData:c,sm:function(){return this.getSelectionModel()},mm:function(t,r,X){this.addDataModelChangeListener(t,r,X)
},umm:function(D,Z){this.removeDataModelChangeListener(D,Z)},md:function(p,R,G){this.addDataPropertyChangeListener(p,R,G)},umd:function(N,c){this.removeDataPropertyChangeListener(N,c)},mh:function(A,N,S){this.addHierarchyChangeListener(A,N,S)},umh:function(l,r){this.removeHierarchyChangeListener(l,r)},getAttrObject:function(){return this._attrObject},setAttrObject:function(c){return this._attrObject=c},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(i){return this._dataMap[i]},removeDataById:function(E){this.remove(this.getDataById(E))},toDatas:function(J,h){return this._datas.toList(J,h)},each:function(b,X){this._datas.each(b,X)},getDataByTag:function(i){return this._78O[i]},getTagMap:function(){return this._78O},removeDataByTag:function(l){this.remove(this.getDataByTag(l))},add:function(t,L,b){var T=this,D=t._id,C=t._tag,p=T._roots;if(T._dataMap[D])throw"'"+D+"' already exists";C!=Z&&(T._78O[C]=t),T._dataMap[D]=t,b>=0?T._datas.add(t,b):T._datas.add(t),t._parent||(T._rootMap[D]=t,L>=0?p.add(t,L):p.add(t)),t.s("fullscreen")!==c&&(T._fsDataMap[D]=t),t.s("shape3d.reflector")&&(T._reflectorMap[D]=t),t._21I(T),T.onAdded(t),T._36I.fire({kind:"add",data:t,rootsIndex:L,datasIndex:b})},onAdded:function(){},remove:function(S,h){if(S){var W=this,P=S._id,o=h&&h.keepStructure,n=h&&h.keepChildren,G=S.getTag();if(S._dataModel===W){var z=S instanceof Tb;z&&L.setIsolating(!0),this.beginTransaction(),o?W._removingData||(W._removingData=S):W.prepareRemove(S),n||S.toChildren().each(function(Q){W.remove(Q,h)},W),o?W._removingData===S&&(S._parent&&S._parent.removeChild(S),delete W._removingData):S._parent&&S._parent.removeChild(S);var _=W._datas.remove(S);delete W._dataMap[P],G!=Z&&delete W._78O[G];var y;W._rootMap[P]&&(delete W._rootMap[P],y=W._roots.remove(S)),W._fsDataMap[P]&&delete W._fsDataMap[P],W._reflectorMap[P]&&delete W._reflectorMap[P],S._21I(Z),W.onRemoved(S),W._36I.fire({kind:Ri,data:S,rootsIndex:y,datasIndex:_}),this.endTransaction(),z&&L.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var F=this;if(F._datas.size()){var r=F._historyManager?this.toJSON():c;F._datas.toArray().forEach(function(V){V._21I(Z)}),F._datas.clear(),F._dataMap={},F._roots.clear(),F._rootMap={},F._fsDataMap={},F._reflectorMap={},F._78O={},F._36I.fire({kind:cr,json:r})}},contains:function(r){return r&&r._dataModel===this},handleDataPropertyChange:function(L){var W=this,D=L.data,y=L.property;if("parent"===y){var i=D._id,b=W._rootMap,C=W._roots;D._parent?b[i]&&(delete b[i],C.remove(D)):b[i]||(b[i]=D,C.add(D))}else if("tag"===y){var M=L.oldValue,_=L.newValue,n=W._78O;M!=Z&&delete n[M],_!=Z&&(n[_]=D)}else if("s:fullscreen"===y){var i=D._id,H=W._fsDataMap;L.oldValue!=Z&&delete H[i],L.newValue!=Z&&(H[i]=D)}else if("s:shape3d.reflector"===y){var i=D._id,V=W._reflectorMap;L.oldValue&&delete V[i],L.newValue&&(V[i]=D)}this.onDataPropertyChanged(D,L),this._35I.fire(L)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(s,e,v){this._36I.add(s,e,v)},removeDataModelChangeListener:function(S,t){this._36I.remove(S,t)},addSerializeListener:function(I,F,x){this._serializeNotifier.add(I,F,x)},removeSerializeListener:function(z,b){this._serializeNotifier.remove(z,b)},fireSerializeEvent:function(V){this._serializeNotifier.fire(V)},addDataPropertyChangeListener:function(f,e,c){this._35I.add(f,e,c)},removeDataPropertyChangeListener:function(f,R){this._35I.remove(f,R)},_38I:function(A,s,R){this._37I&&this._37I.fire({data:A,oldIndex:s,newIndex:R})},addHierarchyChangeListener:function(J,K,O){this._37I||(this._37I=new wq),this._37I.add(J,K,O)},removeHierarchyChangeListener:function(g,D){this._37I.remove(g,D)},getSiblings:function(A){var X=A._parent;return X?X._children:this._roots},eachByHierarchical:function(C,J,z){if(J)return this._eachByHierarchical(C,J,z);for(var S=0,G=this._roots,h=G.size();h>S;S++)if(this._eachByHierarchical(C,G.get(S),z)===!1)return!1;return!0},_eachByHierarchical:function(J,N,V){if(V){if(J.call(V,N)===!1)return!1}else if(J(N)===!1)return!1;for(var n=N.size(),l=0;n>l;l++)if(this._eachByHierarchical(J,N.getChildAt(l),V)===!1)return!1;return!0},reverseEachByHierarchical:function(y,i,w){if(i)return this._reverseEachByHierarchical(y,i,w);for(var X=this._roots,J=X.size(),R=J-1;R>=0;R--)if(this._reverseEachByHierarchical(y,X.get(R),w)===!1)return!1;return!0},_reverseEachByHierarchical:function(e,G,C){for(var F=G.size(),z=F-1;z>=0;z--)if(this._reverseEachByHierarchical(e,G.getChildAt(z),C)===!1)return!1;if(C){if(e.call(C,G)===!1)return!1}else if(e(G)===!1)return!1;return!0},eachByDepthFirst:function(b,D,T){if(D)return this._11I(b,D,T);for(var s=0,V=this._roots,l=V.size();l>s;s++)if(this._11I(b,V.get(s),T)===!1)return!1;return!0},_11I:function(N,m,k){for(var z=m.size(),_=0;z>_;_++)if(this._11I(N,m.getChildAt(_),k)===!1)return!1;if(k){if(N.call(k,m)===!1)return!1}else if(N(m)===!1)return!1;return!0},eachByBreadthFirst:function(e,x,l){var n=new Dd;for(x?n.add(x):this._roots.each(n.add,n);n.size()>0;)if(x=n.removeAt(0),x.eachChild(n.add,n),l){if(e.call(l,x)===!1)return!1}else if(e(x)===!1)return!1;return!0},moveTo:function(s,y){var f=this.getSiblings(s),l=f.indexOf(s);l===y||0>l||y>=0&&y<=f.size()&&(f.remove(s),y>f.size()&&y--,f.add(s,y),this._38I(s,l,y))},moveUp:function(T){this.moveTo(T,this.getSiblings(T).indexOf(T)-1)},moveDown:function(Y){this.moveTo(Y,this.getSiblings(Y).indexOf(Y)+1)},moveToTop:function(n){this.moveTo(n,0)},moveToBottom:function(K){this.moveTo(K,this.getSiblings(K).size())},moveSelectionUp:function(b){this.beginTransaction(),b||(b=this.sm());var W=new Dd;Ak(b,W,this._roots),W.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(i){this.beginTransaction(),i||(i=this.sm());var Z=new Dd;pp(i,Z,this._roots),Z.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(A){this.beginTransaction(),A||(A=this.sm());var K=new Dd;Gn(A,K,this._roots),K.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(Y){this.beginTransaction(),Y||(Y=this.sm());var O=new Dd;Cq(Y,O,this._roots),O.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(c,E,T){var w=this.getDatas();null==T&&(T=w.indexOf(c)),T===E||0>T||E>=0&&E<=w.size()&&(w.remove(c),E>w.size()&&E--,w.add(c,E),this._76I(c,T,E))},bringForward:function(A){this.moveToIndex(A,this.getDatas().indexOf(A)+1)},bringToFront:function(f){this.moveToIndex(f,this.size())},sendBackward:function(k){this.moveToIndex(k,this.getDatas().indexOf(k)-1)},sendToBack:function(M){this.moveToIndex(M,0)},bringSelectionForward:function(O){this.beginTransaction(),O||(O=this.sm());for(var Z=new Dd,z=this.getDatas(),c=!1,i=0;i<z.size();i++){var $=z.get(z.size()-1-i);O.contains($)?c&&Z.add($):c=!0}Z.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(y){this.beginTransaction(),y||(y=this.sm());for(var C=new Dd,r=this.getDatas(),H=0;H<r.size();H++){var w=r.get(H);y.contains(w)&&C.add(w)}C.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(T){this.beginTransaction(),T||(T=this.sm());for(var l=new Dd,C=this.getDatas(),V=!1,M=0;M<C.size();M++){var v=C.get(M);T.contains(v)?V&&l.add(v):V=!0}l.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(X){this.beginTransaction(),X||(X=this.sm());for(var K=new Dd,D=this.getDatas(),q=0;q<D.size();q++){var Z=D.get(D.size()-1-q);X.contains(Z)&&K.add(Z)}K.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(c){var G=this;G.removeScheduleTask(c),c.enabled==Z&&(c.enabled=!0),c.interval==Z&&(c.interval=10),c.lastTime=Date.now(),G._29Q.push(c),G._30Q==Z&&(G._30Q=j.requestAnimationFrame(G._scheduleCallback))},removeScheduleTask:function(Q){var V=this,L=V._29Q,K=L.indexOf(Q);K>=0&&L.splice(K,1),L.length||V._30Q==Z||(j.cancelAnimationFrame(V._30Q),delete V._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(D){this._historyManager||new T.HistoryManager(this),null!=D&&this._historyManager.setMaxHistoryCount(D),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(l){this._historyManager&&this._historyManager.undo(l)},redo:function(M){this._historyManager&&this._historyManager.redo(M)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(Q){this._historyManager&&this._historyManager.addHistory(Q)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(I){I?this._isDeserializing++:this._isDeserializing--},isCubicEnvmap:function(){return this._cubicEnvmap},setCubicEnvmap:function(o){var X=this._cubicEnvmap;this._cubicEnvmap=o,this.fp("cubicEnvmap",X,o)},updateLayoutAttach:function(i){this.each(function(s){s instanceof Eq&&s.getImage()===i&&s.updateLayoutAttaches()})}});var cs=T.SelectionModel=function(J){var W=this;W._68O=Kc,W._map={},W._73O=new Dd,W._74I=new wq,W._21I(J)};is("SelectionModel",i,{ms_fire:1,ms_dm:1,ms:function(O,u,Z){this.addSelectionChangeListener(O,u,Z)},ums:function(h,N){this.removeSelectionChangeListener(h,N)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Ih},co:function(y){return this._map[y._id]!=Z},ss:function(g){this.setSelection(g)},as:function(i){this.appendSelection(i)},rs:function(T){this.removeSelection(T)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(t){var j=this;if(j._68O!==t&&(t===tm||t===Ih||t===Kc)){j.cs();var C=j._68O;j._68O=t,j.fp("selectionMode",C,t)}},_21I:function(x){var R=this,E=R._dataModel;E!==x&&(E&&(R.cs(),E.umm(R.handleDataModelChange,R)),R._dataModel=x,x.mm(R.handleDataModelChange,R,!0),R.fp(vi,E,x))},dispose:function(){var _=this;_.cs(),_._dataModel.umm(_.handleDataModelChange,_)},handleDataModelChange:function($){var F=this;if($.kind===Ri){var h=$.data;F.co(h)&&(F._73O.remove(h),delete F._map[h._id],F._75I(Ri,new Dd(h)))}else $.kind===cr&&F.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(q){var j=this;if(j._filterFunc!==q){j.cs();var T=j._filterFunc;j._filterFunc=q,j.fp("filterFunc",T,j._filterFunc)}},_75I:function(_,B,v,I){v&&(this._73O.each(function(R){I[R._id]?v.remove(R):v.add(R)}),B=v.toList()),this._74I.fire({kind:_,datas:new Dd(B)})},addSelectionChangeListener:function(m,a,H){this._74I.add(m,a,H)},removeSelectionChangeListener:function($,U){this._74I.remove($,U)},_97O:function(R,G){for(var f,B=this,z=0,s=new Dd(R);z<s.size();z++)f=s.get(z),(B._filterFunc&&!B._filterFunc(f)||G&&B.co(f)||!G&&!B.co(f)||!B._dataModel.contains(f))&&(s.removeAt(z),z--);return s},appendSelection:function(P){var x=this;if(x._68O!==tm){var T,z,U=x._73O,d=x._97O(P,!0);d.isEmpty()||(x.sg()&&(T=new Dd(U),z=x._map,U.clear(),x._map={},d=new Dd(d.get(d.size()-1))),d.each(function(X){U.add(X),x._map[X._id]=X}),x._75I("append",d,T,z))}},removeSelection:function(_){var X=this,l=X._97O(_),E=0,Z=l.size();if(0!==Z){for(;Z>E;E++){var $=l.get(E);X._73O.remove($),delete X._map[$._id]}X._75I(Ri,l)}},toSelection:function(G,J){return this._73O.toList(G,J)},getSelection:function(){return this._73O},each:function(u,p){this._73O.each(u,p)},setSelection:function(w){var d=this,n=d._73O;if(d._68O!==tm&&!(n.isEmpty()&&!w||1===n.size()&&d.ld()===w)){var P=new Dd(n),y=d._map;n.clear(),d._map={};var K=d._97O(w,!0);d.sg()&&K.size()>1&&(K=new Dd(K.get(K.size()-1))),K.each(function(R){n.add(R),d._map[R._id]=R}),d._75I("set",Z,P,y)}},clearSelection:function(){var E=this,D=E._73O;if(D.size()>0){var b=D.toList();D.clear(),E._map={},E._75I(cr,b)}},selectAll:function(){var J=this;if(J._68O!==tm){var i,U,m=J._dataModel.toDatas();if(J._filterFunc)for(i=0;i<m.size();i++)U=m.get(i),J._filterFunc(U)||(m.removeAt(i),i--);var x=J._73O,h=new Dd(x),t=J._map;x.clear(),J._map={},J.sg()&&m.size()>1&&(m=new Dd(m.get(m.size()-1)));var Q=m.size();for(i=0;Q>i;i++)U=m.get(i),x.add(U),J._map[U._id]=U;J._75I("all",Z,h,t)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(q){return this._map[q._id]!=Z},getLastData:function(){var q=this._73O;return q.size()>0?q.get(q.size()-1):Z},getFirstData:function(){var c=this._73O;return c.size()>0?c.get(0):Z},isSelectable:function(k){var Z=this;return k&&Z._68O!==tm?Z._filterFunc?Z._filterFunc(k):!0:!1},getTopSelection:function(){var H=this,Q=new Dd;return H._73O.each(function(K){for(var _=K.getParent();_;){if(H.contains(_)){K=Z;break}_=_.parent}K&&Q.add(K)}),Q}});var aj=function(){return kb(0),function(e,t){var N;if(lq(t)){var G=e.getDataUI(t);G&&G._88I&&(N=G._88I.rect)}return N?N:t.getRect()}}();kp(L,{edgeGroupAgentFunc:Z,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:x.rectSelectBorder,graphViewRectSelectBackground:Ee,graphViewEditPointSize:Km?17:7,graphViewEditPointBorderColor:x.editPointBorder,graphViewEditPointBackground:x.editPointBackground,setEdgeType:function(Y,M,$){Kp[Y]=M,Lo[Y]=$},getEdgeType:function($){return Kp[$]},getEdgeTypeMap:function(){return Kp},getNodeRect:aj},!0);var tn={"layout.h":c,"layout.v":c,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":c,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:c,ingroup:!0,"body.color":c,"2d.gray":!1,fullscreen:c,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:c,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":zd,"select.width":1,"select.padding":2,"select.type":ug,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":zd,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":c,"border.width":2,"border.padding":2,"border.type":ug,label:c,"label.font":c,"label.color":ec,"label.background":c,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":c,"label.max":c,"label.opacity":c,"label.scale":1,"label.align":c,"label.selectable":!0,label2:c,"label2.font":c,"label2.color":ec,"label2.background":c,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":c,"label2.max":c,"label2.opacity":c,"label2.scale":1,"label2.align":c,"label2.selectable":!0,note:c,"note.expanded":!0,"note.font":c,"note.color":eo,"note.background":zd,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":c,"note.toggleable":!0,"note.border.width":1,"note.border.color":c,"note.opacity":c,"note.scale":1,"note.align":c,note2:c,"note2.expanded":!0,"note2.font":c,"note2.color":eo,"note2.background":zd,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":c,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":c,"note2.opacity":c,"note2.scale":1,"note2.align":c,"group.type":c,"group.image":c,"group.image.stretch":"fill","group.repeat.image":c,"group.border.repeat.image":c,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":c,"group.title.color":eo,"group.title.background":x.groupTitleBackground,"group.title.align":Cl,"group.title.orientation":Vl,"group.background":x.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":c,"group.border.color":Xg,"group.border.radius":c,"group.border.cap":Jb,"group.border.join":Vp,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":Z,"group.gradient.color":"#FFF",shape:c,"shape.background":Xg,"shape.repeat.image":c,"shape.border.repeat.image":c,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Xg,"shape.border.3d":!1,"shape.border.3d.color":c,"shape.border.3d.accuracy":c,"shape.border.cap":Jb,"shape.border.join":Vp,"shape.border.pattern":c,"shape.gradient":Z,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":op,"shape.dash.offset":0,"shape.dash.color":xq,"shape.dash.width":c,"shape.dash.3d":!1,"shape.dash.3d.color":c,"shape.dash.3d.accuracy":c,"shape.polygon.side":6,"shape.arc.from":v,"shape.arc.to":s,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":c,"shape.gradient.pack":c,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":c,"shape.foreground.gradient":Z,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":c,"autolayout.hgap":c,"autolayout.vgap":c,"edge.type":c,"edge.points":c,"edge.segments":c,"edge.color":Xg,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":c,"edge.3d.accuracy":c,"edge.cap":Jb,"edge.join":Vp,"edge.source.position":17,"edge.source.anchor.x":c,"edge.source.anchor.y":c,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":c,"edge.target.anchor.y":c,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":c,"edge.dash":!1,"edge.dash.pattern":op,"edge.dash.offset":0,"edge.dash.color":xq,"edge.dash.width":c,"edge.dash.3d":!1,"edge.dash.3d.color":c,"edge.dash.3d.accuracy":c,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":c,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":c,"grid.column.percents":c,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":x.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":x.gridCellBorderColor,"grid.block":c,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":x.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":ec,"text.gradient.pack":c,"text.font":iq,"text.shadow":!1,"text.shadow.color":zd,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":c,"text.gradient.color":"#FFF","text.decoration":c,"text.vertical":!1,keepPosition:!0};tn[om]=c,kp(X,tn,!0),kp(Id,{_76I:function(W,K,L){this._39I&&this._39I.fire({data:W,oldIndex:K,newIndex:L})},addIndexChangeListener:function(S,Z,V){var A=this;A._39I||(A._39I=new wq),A._39I.add(S,Z,V)},removeIndexChangeListener:function(P,g){this._39I.remove(P,g)},prepareRemove:function(G){El(G)&&(G.setSource(Z),G.setTarget(Z)),G._70O&&G._70O.toList().each(this.remove,this),G._69O&&G._69O.toList().each(function(f){f.setHost(Z)}),G._host&&G.setHost(Z)},onAdded:function(t){this.isAutoAdjustIndex()&&this.adjustIndex(t)},onDataPropertyChanged:function(Q,z){Bp[z.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(Q)},isAdjustable:function(K){return lm(K)||El(K)},isAdjustedToBottom:function(P){return rj(P)?P.isExpanded()&&Gk(P):!1},adjustIndex:function(J){var o=this;this.isHierarchicalRendering()||(o.isAdjustedToBottom(J)?(o.sendToBottom(J),J.eachChild(o.adjustIndex,o)):o.sendToTop(J))},sendToTop:function(w){var l=this;if(l.contains(w)&&l.isAdjustable(w)){var v=l._datas;if(w!==v.get(l.size()-1)){var I=v.indexOf(w);v.removeAt(I),v.add(w),l._76I(w,I,l.size()-1)}if(El(w)){var _=w._40I;_&&!l.isAdjustedToBottom(_)&&l.sendToTop(_),_=w._41I,_&&!l.isAdjustedToBottom(_)&&l.sendToTop(_)}w._69O&&w._69O.each(function(Z){Z.isRelatedTo(w)||lm(w)&&Z.isLoopedHostOn(w)||l.sendToTop(Z)}),w.ISubGraph||(!rj(w)||w.isExpanded())&&w._adjustChildrenToTop&&w.eachChild(function(u){El(u)||l.sendToTop(u)})}},sendToBottom:function(w,g){var b=this;if(w!==g&&b.contains(w)&&b.isAdjustable(w)&&(!g||b.contains(g))){var m=b._datas,e=m.remove(w),E=g?b._datas.indexOf(g):0;if(m.add(w,E),e!==E){b._76I(w,e,E);var f=w._parent;!f||f.ISubGraph||El(f)||b.sendToBottom(w._parent,w)}}}}),kp(Jm,{ms_edit:function(N){N._46O=function(a){var j=this,f=j.gv.dm(),Z=j._index,L=j._89I,p=j._node,D=j._shape,P=j._edge,h=j._77I;p&&L?(this.fi({kind:"endEditRect",event:a,data:p,direction:L}),f.endTransaction()):D&&Z>=0?(j.fi({kind:"endEditPoint",event:a,data:D,index:Z}),f.endTransaction()):P&&Z>=0?(j.fi({kind:"endEditPoint",event:a,data:P,index:Z}),f.endTransaction()):h&&(j.fi({kind:"endEditRotation",event:a,data:h}),f.endTransaction())},N._78I=function(z){var q=this;q.autoScroll(z);var R=q.gv.lp(z),J=q._index,B=q._89I,e=q._node,p=q._shape,T=q._edge,H=q._77I;if(e&&B)q._80O(R),q.fi({kind:"betweenEditRect",event:z,data:e,direction:B});else if(p&&J>=0)R.e=p.getPoints().get(J).e,p.setPoint(J,R),q.fi({kind:"betweenEditPoint",event:z,data:p,index:J});else if(T&&J>=0){var Q=T.s(xi);R.e=Q.get(J).e,Q.set(J,R),T.fp(xi,Z,Q),q.fi({kind:"betweenEditPoint",event:z,data:T,index:J})}else if(H){var $=H.p(),K=H.getScale(),m=So+Nh(R.y-$.y,R.x-$.x);K.y<0&&(m+=v),C(m)<.04&&(m=0),H.setRotation(m),q.fi({kind:"betweenEditRotation",event:z,data:H})}},N._80O=function(a){var z=this,m=z._node,G=z._rect,F=G.x,A=G.y,O=G.width,k=G.height,T=z._89I,q=z._anchor,u=z._matrix,a=u.tfi(a);"northwest"===T?G=An(a,{x:F+O,y:A+k}):T===Wk?G=An({x:F,y:a.y},{x:F+O,y:A+k}):"northeast"===T?G=An({x:F,y:a.y},{x:a.x,y:A+k}):T===Dl?G=An({x:a.x,y:A},{x:F+O,y:A+k}):T===Jn?G=An({x:F,y:A},{x:a.x,y:A+k}):"southwest"===T?G=An({x:a.x,y:A},{x:F+O,y:a.y}):"south"===T?G=An({x:F,y:A},{x:F+O,y:a.y}):"southeast"===T&&(G=An({x:F,y:A},a)),m.setPosition(u.tf(G.x+G.width*q.x,G.y+G.height*q.y)),m.setWidth(G.width),m.setHeight(G.height)},N._80I=function(k,U,R,J){var v=this,g=v.gv._zoom,X=(v.gv.getEditPointSize()+2)/g;return Gb({x:U-X/2,y:R-X/2,width:X,height:X},k)?(v._89I!==J&&(v._89I=J),!0):!1},N._79I=function(o,D,I){var w=this,l=w.gv,x=D?l.getDataUI(D):Z,A=x?x._55O:Z;if(A){var u,g,P,v,c=l._zoom,y=(l.getEditPointSize()+2)/c,G=l.lp(o);if(lm(D)){if(A._56O&&lm(D)&&(g=A._98o,Gb({x:g.x-y/2,y:g.y-y/2,width:y,height:y},G)))return w._77I=D,I&&w.fi({kind:"beginEditRotation",event:o,data:D}),w.setCursor("crosshair"),!0;if(A._43O&&D instanceof jh)for(P=D.getPoints(),u=P.size()-1;u>=0;u--)if(g=P.get(u),Gb({x:g.x-y/2,y:g.y-y/2,width:y,height:y},G))return w._index=u,w._shape=D,I&&w.fi({kind:"beginEditPoint",event:o,data:D,index:u}),w.setCursor("crosshair"),!0;if(A._42O)for(var m=D.getEditControlPoints(),X=["northwest",-1,-1,Dl,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Jn,1,0,"northeast",1,-1,Wk,0,-1],u=0,v=m.length;v>u;u++){var Q=X[3*u],H=m[u];if(w._80I(G,H.x,H.y,Q)){w._node=D;var B=D.getWidth(),V=D.getHeight(),t=D.getAnchor();w._rect={x:-B*t.x,y:-V*t.y,width:B,height:V},w._anchor=t,w._matrix=D.getMatrix();var k=D.getRotation(),h=K(k),d=z(k),a=X[3*u+1]*ns(D.getScale().x),U=X[3*u+2]*ns(D.getScale().y),i=Math.atan2(-d*a-h*U,h*a-d*U),b=(Math.round(i/(Math.PI/4))+8)%8,s=[Vm,"nesw-resize",Ik,"nwse-resize",Vm,"nesw-resize",Ik,"nwse-resize"][b];return w.setCursor(s),I&&w.fi({kind:"beginEditRect",event:o,data:D,direction:w._89I}),!0}}}if(A._43O&&El(D)&&D.s(Qe)===Eb&&(P=D.s(xi)))for(u=P.size()-1;u>=0;u--)if(g=P.get(u),Gb({x:g.x-y/2,y:g.y-y/2,width:y,height:y},G))return w._index=u,w._edge=D,I&&w.fi({kind:"beginEditPoint",event:o,data:D,index:u}),w.setCursor("crosshair"),!0}return!1}},ms_gv:function(d){d._currentSubGraph=Z,d._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},d.upSubGraph=function(){this.setCurrentSubGraph(jo(this._currentSubGraph))},d.isVisible=function(P){var F=this;if(jo(P)!==F._currentSubGraph)return!1;if(El(P)){var K=P._40I,C=P._41I;if(!K||!C)return!1;if(!(P.s("edge.independent")||F.isVisible(K)&&F.isVisible(C)))return!1;if(P.isEdgeGroupHidden())return!1}else for(var Z=P._parent;Z&&!Z.ISubGraph;){if(rj(Z)&&(!Z.isExpanded()||!F.isVisible(Z)))return!1;Z=Z._parent}if(P._parent instanceof Tb&&!F.isVisible(P._parent))return!1;if(P._refGraph instanceof en&&!F.isVisible(P._refGraph))return!1;if(F instanceof Dk){if(!P.s("3d.visible"))return!1}else{var i=F.getLayersInfo();if(i){var e=i[P._layer];if(e&&e.visible===!1)return!1}if(!P.s("2d.visible"))return!1}return F._visibleFunc?F._visibleFunc(P):!0},d.handleSelectionChange=function(D){var n=this;D.datas.each(function(q){n.invalidateData(q);var C=q._parent;rj(C)&&lm(q)&&q.s(wg)&&(n.invalidateData(C),C._49I&&C._49I.each(function(U){n.invalidateData(U)}))}),n.onSelectionChanged(D)},d.onSelectionChanged=function(H){var J=this,Q=J.sm();if(1===Q.size()&&("set"===H.kind||"append"===H.kind)){var p=Q.ld();J.isAutoMakeVisible()&&J.makeVisible(p),J.adjustIndex&&J._dataModel.isAutoAdjustIndex()&&J.adjustIndex(p)}},d.makeVisible=function(z){if(z){var Y=this,m=Y.getDataUI?Y.getDataUI(z):Y.getData3dUI(z);if(m){var C=z,c=jo(z);for(c!==Y._currentSubGraph&&Y.setCurrentSubGraph(c);(C=C._parent)&&C!==c;)rj(C)&&C.setExpanded(!0);Y._23I=z,Y.iv()}}},d.getLabel=function(X){var R=X.getStyle(Tp);return R===c?X.getName():R},d.getLabelBackground=function(e){return e.getStyle("label.background")},d.getLabelColor=function(N){return N.getStyle("label.color")},d.getLabel2=function(x){return x.getStyle("label2")},d.getLabel2Background=function(Z){return Z.getStyle("label2.background")},d.getLabel2Color=function(p){return p.getStyle("label2.color")},d.getNote=function($){return $.getStyle(Bl)},d.getNoteBackground=function(w){return w.getStyle("note.background")},d.getNote2=function(u){return u.getStyle(re)},d.getNote2Background=function(k){return k.getStyle("note2.background")},d.handleClick=function(D,u,g){var F=this;u?(F.fi({kind:"clickData",event:D,data:u,part:g}),F.onDataClicked(u,D)):(F.fi({kind:"clickBackground",event:D}),F.onBackgroundClicked(D))},d.handleDoubleClick=function(H,G,U){var w=this;tp(H)&&(G?(w.fi({kind:"doubleClickData",event:H,data:G,part:U}),w.onDataDoubleClicked(G,H,U),w.checkDoubleClickOnNote(H,G,U)||w.checkDoubleClickOnRotation&&w.checkDoubleClickOnRotation(H,G,U)||(El(G)?w.onEdgeDoubleClicked(G,H,U):G.ISubGraph?w.onSubGraphDoubleClicked(G,H,U):rj(G)?w.onGroupDoubleClicked(G,H,U):G.IDoorWindow?w.onDoorWindowDoubleClicked(G,H,U):G.ICSGBox&&w.onCSGBoxDoubleClicked(G,H,U))):(w.fi({kind:"doubleClickBackground",event:H}),w.onBackgroundDoubleClicked(H)))},d.onSubGraphDoubleClicked=function(Q){this.setCurrentSubGraph(Q)},d.onEdgeDoubleClicked=function(l,E){this.isEditable(l)||(l.ISubGraph&&!ig(E)?this.setCurrentSubGraph(l):l.s("edge.toggleable")&&l.toggle())},d._39Q=function(I){return this.isInteractive(I)?this.preventDefaultWhenInteractive(I):!1},d.preventDefaultWhenInteractive=function(y){return y.s("preventDefaultWhenInteractive")},d.onGroupDoubleClicked=function(E){E.s("group.toggleable")&&E.toggle()},d.onDoorWindowDoubleClicked=function(V){V.s("dw.toggleable")&&V.toggle(!0)},d.onCSGBoxDoubleClicked=function(Y,h){var l=this;if(l instanceof Dk){var q=l.intersectObject(h,Y);q&&Y.s(q.part+".toggleable")&&Y.toggleFace(q.part,!0)}},d.onBackgroundClicked=function(){},d.onBackgroundDoubleClicked=function(){this.upSubGraph()},d.onDataClicked=function(){},d.onDataDoubleClicked=function(){},d.onAutoLayoutEnded=function(){},d.onMoveEnded=function(){},d.onPanEnded=function(){},d.onPinchEnded=function(){},d.onRectSelectEnded=function(){},d.onZoomEnded=function(){},d.serialize=function(S){return this.dm().serialize(S)},d.toJSON=function(){return this.dm().toJSON()},d.deserialize=function(N,f){var Y=this;f=f instanceof Od?{rootParent:f}:Xe(f)?{setId:f}:ik(f)?{finishFunc:f}:f||{},f.view=Y;var E=Y.dm();return f.__innerHandler__=function(_){if(Xe(E.a("toolTipEnable"))&&(E.a("toolTipEnable")?Y.enableToolTip():Y.disableToolTip()),Y instanceof T.graph.GraphView&&(Xe(E.a("zoomable"))&&Y.setZoomable&&Y.setZoomable(E.a("zoomable")),Xe(E.a("pannable"))&&Y.setPannable&&Y.setPannable(E.a("pannable")),Xe(E.a("rectSelectable"))&&Y.setRectSelectable&&Y.setRectSelectable(E.a("rectSelectable")),E.a("fitContent")===!0&&Y.fitContent&&Y.fitContent(!0,0)),Y instanceof T.graph3d.Graph3dView){var m=_.scene;m&&m.shadow!=Z&&Y.shadowMap.setShadow(m.shadow,m.shadowParams);var I=E.a("sceneContext");I?(I.eye&&Y.setEye(I.eye),I.center&&Y.setCenter(I.center),km(I.far)&&Y.setFar(I.far),km(I.near)&&Y.setNear(I.near)):(km(E.a("sceneNear"))&&Y.setNear(E.a("sceneNear")),km(E.a("sceneFar"))&&Y.setFar(E.a("sceneFar")),m&&(m.eye&&Y.setEye(m.eye),m.center&&Y.setCenter(m.center))),Xe(E.a("sceneShadowEnabled"))&&(E.a("sceneShadowEnabled")?Y.enableShadow():Y.disableShadow()),km(E.a("sceneShadowDegreeX"))&&Y.setShadowDegreeX(E.a("sceneShadowDegreeX")),km(E.a("sceneShadowDegreeZ"))&&Y.setShadowDegreeZ(E.a("sceneShadowDegreeZ")),km(E.a("sceneShadowIntensity"))&&Y.setShadowIntensity(E.a("sceneShadowIntensity")),E.a("sceneShadowQuality")!=Z&&Y.setShadowQuality(E.a("sceneShadowQuality")),E.a("sceneShadowType")&&Y.setShadowType(E.a("sceneShadowType")),km(E.a("sceneShadowRadius"))&&Y.setShadowRadius(E.a("sceneShadowRadius")),km(E.a("sceneShadowBias"))&&Y.setShadowBias(E.a("sceneShadowBias")),Xe(E.a("sceneDashEnable"))&&Y.setDashDisabled(!E.a("sceneDashEnable")),em(E.a("sceneHighlightMode"))&&Y.setHighlightMode(E.a("sceneHighlightMode")),km(E.a("sceneHighlightWidth"))&&Y.setHighlightWidth(E.a("sceneHighlightWidth")),E.a("sceneHighlightColor")&&Y.setHighlightColor(E.a("sceneHighlightColor")),E.a("sceneHighlightType")&&Y.setHighlightType(E.a("sceneHighlightType")),E.a("sceneHighlightGlow")&&Y.setHighlightGlow(E.a("sceneHighlightGlow")),E.a("sceneHighlightStrength")&&Y.setHighlightStrength(E.a("sceneHighlightStrength")),Xe(E.a("sceneHeadlightEnable"))&&Y.setHeadlightDisabled(!E.a("sceneHeadlightEnable")),km(E.a("sceneHeadlightRange"))&&Y.setHeadlightRange(E.a("sceneHeadlightRange")),E.a("sceneHeadlightColor")&&Y.setHeadlightColor(E.a("sceneHeadlightColor")),km(E.a("sceneHeadlightIntensity"))&&Y.setHeadlightIntensity(E.a("sceneHeadlightIntensity")),km(E.a("sceneHeadlightAmbientIntensity"))&&Y.setHeadlightAmbientIntensity(E.a("sceneHeadlightAmbientIntensity")),Xe(E.a("sceneFogEnable"))&&Y.setFogDisabled(!E.a("sceneFogEnable")),E.a("sceneFogMode")&&Y.setFogMode(E.a("sceneFogMode")),km(E.a("sceneFogDensity"))&&Y.setFogDensity(E.a("sceneFogDensity")),E.a("sceneFogColor")&&Y.setFogColor(E.a("sceneFogColor")),km(E.a("sceneFogNear"))&&Y.setFogNear(E.a("sceneFogNear")),km(E.a("sceneFogFar"))&&Y.setFogFar(E.a("sceneFogFar")),Xe(E.a("sceneBatchBrightnessDisabled"))&&Y.setBatchBrightnessDisabled(E.a("sceneBatchBrightnessDisabled")),Xe(E.a("sceneBatchBlendDisabled"))&&Y.setBatchBlendDisabled(E.a("sceneBatchBlendDisabled")),Xe(E.a("sceneBatchColorDisabled"))&&Y.setBatchColorDisabled(E.a("sceneBatchColorDisabled")),E.a("sceneBatchInfoMap")&&Y.setBatchInfoMap(E.a("sceneBatchInfoMap")),km(E.a("sceneMoveStep"))&&Y.setMoveStep(E.a("sceneMoveStep")),km(E.a("sceneRotateStep"))&&Y.setRotateStep(E.a("sceneRotateStep")),Xe(E.a("sceneSortable"))&&Y.setSortable(E.a("sceneSortable")),ik(E.a("sceneSortFunc"))&&Y.setSortFunc(E.a("sceneSortFunc"));var N=E.a("sceneSkyboxType")||"sphere";if(N!=Z){var S={},t=!1;if("sphere"===N){S.shape3d=N;var g=E.a("sceneSkyboxImage");g&&(S["shape3d.image"]=g,t=!0)
}else S.shape3d=c,["front","back","left","right","top","bottom"].forEach(function(z){var C=z+".image",$=z.charAt(0).toUpperCase()+z.slice(1),y=E.a("sceneSkybox"+$+"Image");y&&(S[C]=y,t=!0)});if(t){var H=new Eq,k=E.a("sceneSkyboxDiameter");km(k)?H.s3(k,k,k):H.s3(20,20,20),S["body.color"]=E.a("sceneSkyboxBodyColor"),S.envmap=E.a("sceneSkyboxEnvmap"),S.light=!1,S["texture.wrap"]="clampToEdge",H.s(S),["X","Y","Z"].forEach(function(e){var T=E.a("sceneSkyboxRotation"+e);km(T)&&H["setRotation"+e](T)}),Y.setSkybox(H)}}}},E.deserialize(N,f.rootParent,f)},d.isDebugTipShowing=function(){return!!this._debugDiv},d.showDebugTip=function(){var S=this,e=S._debugDiv;if(!e){e=S._debugDiv=t.createElement("div"),e.style.position="absolute",e.style.overflow="hidden",e.style.font=L.debugTipLabelFont,e.style.padding="6px",e.style.backgroundColor=L.debugTipBackground,e.style.color=L.debugTipLabelColor;var i=S.getView();S._79O?i.insertBefore(e,S._79O):i.appendChild(e);var o=function(){S.redraw();var b=S._canvas,J="FPS: "+S._fpsInfo.fps+"<br/>"+"Datas: "+S.dm().getDatas().length+(b?"<br/>Size: "+b.width+" * "+b.height:""),G=S.dm()._historyManager;G&&(J+="<br/>Undoes: "+G.getHistories().length+" index: "+G.getHistoryIndex());var x=S.getDebugTip();x&&(J+="<hr>"+x),e.innerHTML=J,S._isDebugging&&requestAnimationFrame(o)};requestAnimationFrame(o),S._isDebugging=!0}},d.hideDebugTip=function(){var L=this,Z=L._debugDiv;Z&&(delete L._debugDiv,L.getView().removeChild(Z),L._isDebugging=!1)},d.updateDOMAppendMatrix=function(){var V=this.getView();V&&(V.updateAppendMatrix=!0)},d.countFrame=function(){if(this._isDebugging){var l=Date.now(),Y=this._fpsInfo;l-Y.time>1e3?(Y.fps=Math.round(1e5*(Y.frames+1)/(l-Y.time))/100,Y.time=l,Y.frames=0):Y.frames++}}},ms_icons:function(i){i.getRotation=function(N){return N==Z?0:N},i._15O=function(){var s=this,C=s.s(mi);if(C){var j=s,G=s.data||s._data,I=s._38o={icons:C,rects:{}};for(var B in C){var O=C[B],d=sn(O.shape3d,G,j);if(!(sn(O.visible,G,j)===!1||sn(O.for3d,G,j)&&!s.I3d||d&&!s.I3d)){var Y=d?[d]:sn(O.names,G,j),X=Y?Y.length:0,h=sn(O.position,G,j)||3,M=sn(O.offsetX,G,j)||0,L=sn(O.offsetY,G,j)||0,u=sn(O.direction,G,j)||Jn,b=sn(O.gap,G,j),y=b!=Z?b:1,q=sn(O.rotation,G,j),N=sn(O.keepOrien,G,j),K=sn(O.rotationFixed,G,j)?q:s.getRotation(q,N,h),t=Z,T=I.rects[B]=new Array(X);T.rotation=K;for(var H=0;X>H;H++){var V,E,F,m,Q=Y[H];if(d)F=0,m=0;else{var i=qh(Q);F=sn(O.width,G,j),m=sn(O.height,G,j),F==Z&&(F=Vk(i,G)),m==Z&&(m=xl(i,G))}if(t?u===Jn?M+=F/2:u===Dl?M-=F/2:u===Wk?L-=m/2:L+=m/2:t={width:F,height:m},s.I3d){var D=-F/2,z=-m/2;E={width:F,height:m,mat:s._16O(sn(O.autorotate,G,j),h,t,sn(O.face,G,j)||qn,sn(O.t3,G,j),sn(O.r3,G,j),sn(O.rotationMode,G,j),M,L),vs:new Sf([D,-z,0,D,-z-m,0,D+F,-z-m,0,D+F,-z,0])}}else V=s.getPosition(h,M,L,t,sn(O.positionFixed,G,j)),E={x:V.x-F/2,y:V.y-m/2,width:F,height:m},s._68o(E,K);T[H]=E,u===Jn?M+=F/2+y:u===Dl?M-=F/2+y:u===Wk?L-=m/2+y:L+=m/2+y}}}}}}});var No={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Zi={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},th={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Bp={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},ze={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},$r={"edge.type":1,"edge.group":1},kc={rotation:1,rotationX:1,rotationZ:1},Ln={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},qm={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Wg={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},ke={shape:1,thickness:1,position:1,anchor:1,scale:1},jo=function(n){if(!n)return Z;if(El(n)){var K=n._40I,M=n._41I;if(!K||!M)return Z;var i=jo(K),h=jo(M);return i===h?i:Z}for(var E=n._parent;El(E)&&!E.ISubGraph;)E=E._parent;return E?E.ISubGraph?E:jo(E):Z},Ig=function($,A,u,O){var D=A.getStyle(u)*O;D&&Aq($,D),D=A.getStyle(u+".left")*O,D&&($.x-=D,$.width+=D),D=A.getStyle(u+".right")*O,D&&($.width+=D),D=A.getStyle(u+".top")*O,D&&($.y-=D,$.height+=D),D=A.getStyle(u+".bottom")*O,D&&($.height+=D),$.width<0&&($.width=-$.width,$.x-=$.width),$.height<0&&($.height=-$.height,$.y-=$.height)},Gk=function(Y){for(var l,v=0,k=Y.size();k>v;v++)if(l=Y.getChildAt(v),lm(l)&&Gk(l))return!0;return Y.hasAgentEdges()},gn=function(v){if(!v)return Z;for(var t=v._parent;rj(t);){if(!rj(t._parent))return t.isExpanded()?v:t;t.isExpanded()||(v=t),t=t._parent}return v},vn=function(f,r){if(!f||!r)return Z;var N,l,C,n=jo(f),z=jo(r);if(n!==z){for(;z&&n!==z;)z=jo(z);if(n===z)return f;N=new Dd,N.add(f,0);for(var M=f._parent;lm(M)&&!r.isDescendantOf(M);)N.add(M,0),M=M._parent;for(C=N.size(),l=0;C>l;l++){var K=N.get(l);if(rj(K)&&!K.isExpanded())return K;if(K.ISubGraph)return K}return f}return f},Zc=function(M){if(M.isLooped())return M._source;var B=gn(M._source),D=gn(M._target);return B===D?M._source:vn(B,D)},Bi=function(I){if(I.isLooped())return I._target;var x=gn(I._source),y=gn(I._target);return x===y?I._target:vn(y,x)},dl=function(A,U,c){"target"!==c&&(c="source");var C="target"===c?U.getTargetAgent():U.getSourceAgent(),R="edge."+c+".";if(El(C)){var o=A.getDataUI(C);o._79o();var b=U.s(R+"index");if(b>=0){var y=jk(o);return y[Math.max(0,Math.min(b,y.length-1))]}var j=U.s(R+"percent")||0;j=Math.max(0,Math.min(j,1));var g=Qq(o);return ib(g,100*j)}return dc(A,C,U.s(R+"position"),U.s(R+"offset.x"),U.s(R+"offset.y"),U.s(R+"anchor.x"),U.s(R+"anchor.y"))},dc=function(m,i,q,t,E,s,f){if(!i)return Z;var D,L=i.getRotation?i.getRotation():0;if(s!==c||f!==c){s=s===c?.5:s,f=f===c?.5:f;var S=i.getScale();if(L&&!lq(i,m)||S.x<0||S.y<0){var e=i.getPosition(),B=i.getWidth(),g=i.getHeight(),Q=i.getAnchor(),w=new qe(L,e.x,e.y,S.x,S.y);q=w.tf((s-Q.x)*B,(f-Q.y)*g)}else D=aj(m,i),q={x:D.x+s*D.width,y:D.y+f*D.height}}else q=Gh(q,aj(m,i));if(L){var n=K(L),r=z(L),M=t*n-E*r;E=t*r+E*n,t=M}return q.x+=t,q.y+=E,q},Pe=function(G,q){if(!G||!q)return Z;var E,Y,A,c,J,R;if(G===q){if(c=G.getLoopedEdges(),!c)return Z;c=new Dd(c)}else{if(J=G.getAgentEdges(),R=q.getAgentEdges(),!J||!R)return Z;for(Y=J.size(),E=0;Y>E;E++)A=J.get(E),R.contains(A)&&(c||(c=new Dd),c.add(A))}if(c)for(E=0;E<c.size();E++)A=c.get(E),A.getStyle(Qe)===Eb&&(A._22I(Z),c.removeAt(E),E--);return c},ed=function(N,K){var L=Pe(N,K);if(L&&!L.isEmpty()){if(1===L.size())return L.get(0)._22I(Z),void 0;var H=new Dd,V=new Dd;L.each(function(n){var t=n.s("edge.group");H.contains(t)||H.add(t)}),H.sort(),H.each(function(q){V.add(new T.EdgeGroup(L.toList(function(C){return q===C.s("edge.group")}),V))}),V.each(function(J){J.each(function(M){M._22I(J)})})}},Zm=function(Z,d,H){var p=Z._canvas;Z._zoom;var e=we(d,p),o=we(H,p);return{x:e.x-o.x,y:e.y-o.y}},$n=function(T,L){if(L){var m=L.rect,M=L.color,R=L.rotation,Q=L.labelWidth,j=L.background,i=L.opacity,D=L.scale,J=D!=Z&&1!==D;if(i!=Z){var r=T.globalAlpha;T.globalAlpha*=i}if(R||J){T.save();var u=m.x+m.width/2,s=m.y+m.height/2;Kn(T,u,s),R&&Uo(T,R),J&&T.scale(D,D),Kn(T,-u,-s)}if(j&&Ki(T,m.x,m.y,m.width,m.height,j),Q){var p=m.width,l=T.createLinearGradient(m.x,m.y,m.x+p,m.y);l.addColorStop(0,M),l.addColorStop(.9,M),l.addColorStop(1,Gg),M=l,m.width=Q}wb(T,L.ss,m,L.font,M,L.align),Q&&(m.width=p),(R||J)&&T.restore(),i!=Z&&(T.globalAlpha=r)}},Qk=function(A,g){if(g){var Y=g.rect,H=Y.x,n=Y.y,B=Y.width,W=Y.height,o=g.background,Q=g.backgroundImage,a=g.borderWidth,w=g.borderColor,T=g.labelWidth,x=g.opacity,e=g.scale,i=e!=Z&&1!==e;if(x!=Z){var m=A.globalAlpha;A.globalAlpha*=x}if(i){A.save();var C=Y.x+Y.width/2,k=Y.y+Y.height/2;Kn(A,C,k),A.scale(e,e),Kn(A,-C,-k)}if(g.expanded){var q=S(8,B/4),z=n+W-8;if(A.fillStyle=o,A.beginPath(),A.moveTo(H,n),A.lineTo(H,z),A.lineTo(H+B/2,z),A.lineTo(H+B/2,n+W),A.lineTo(H+B/2+q,z),A.lineTo(H+B,z),A.lineTo(H+B,n),A.closePath(),A.fill(),a&&(A.lineWidth=a,A.lineJoin="round",A.lineCap="round",w?(A.strokeStyle=w,A.stroke()):(A.strokeStyle=ub(o),A.beginPath(),A.moveTo(H+B,n),A.lineTo(H+B,z),A.lineTo(H+B/2+q,z),A.lineTo(H+B/2,n+W),A.stroke(),A.strokeStyle=fg(o),A.beginPath(),A.moveTo(H+B,n),A.lineTo(H,n),A.lineTo(H,z),A.lineTo(H+B/2,z),A.lineTo(H+B/2,n+W),A.stroke())),Q)_r(A,qh(Q),En,Y.x,Y.y,Y.width,Y.height-8,g.data,g.view);else{if(Y.height-=8,o=g.color,T){var b=B,O=A.createLinearGradient(H,n,H+b,n);O.addColorStop(0,o),O.addColorStop(.9,o),O.addColorStop(1,Gg),o=O,Y.width=T}wb(A,g.ss,Y,g.font,o,g.align),T&&(Y.width=b),Y.height+=8}}else if(g.icon)Ce(A,qh(g.icon),H,n,B,W,g.data,g.view);else{var I=B/2;a&&(A.lineWidth=a,A.lineJoin="round",A.lineCap="round",A.strokeStyle=w?w:ub(o),A.beginPath(),A.arc(H+I,n+I,I,So,1.6*v,!0),A.moveTo(H+I,n+W),A.lineTo(H+B-I/5,n+I),A.stroke(),A.strokeStyle=w?w:fg(o),A.beginPath(),A.arc(H+I,n+I,I,1.6*v,So,!0),A.moveTo(H+I,n+W),A.lineTo(H+I/5,n+I),A.stroke()),A.fillStyle=o,A.beginPath(),A.arc(H+I,n+I,I,0,s,!0),A.moveTo(H+I,n+W),A.lineTo(H+B-I/5,n+I),A.lineTo(H+I/5,n+I),A.closePath(),A.fill(),A.fillStyle=g.color,A.beginPath(),A.arc(H+I,n+I,I/3,0,s,!0),A.fill()}i&&A.restore(),x!=Z&&(A.globalAlpha=m)}},xc=function(X,Z){return Z>2*X?X:Z/2},Mm=function(w,Y,R,a){if(!w||!Y)return 0;var T=Nh(Y.y-w.y,Y.x-w.x);return R||(T=Y.x<w.x?T+v:T),T+a},kf=function(_,X,p,h,i,n,f){f&&(_.x>X.x||_.x===X.x&&_.y>X.y)&&(p=Wd[p],i=-i);var Z=Gh(p,{x:0,y:0,width:Yf(_,X),height:0},n);return Z.x+=h,Z.y+=i,Z=new qe(Nh(X.y-_.y,X.x-_.x)).tf(Z),Z.x+=_.x,Z.y+=_.y,Z},qj=function(N,u,D,X,l){if(N._19Q=!0,!D.getEdgeGroup())return X?D.s("edge.gap"):0;if(El(D.getSourceAgent())||El(D.getTargetAgent()))return 0;var i,M=0,E=0,e=0;if(D.getEdgeGroup().getSiblings().each(function(L){L.each(function(h){if(u.isVisible(h)&&h.s(Qe)==l){var y=h.s("edge.gap");i?(E+=e/2+y/2,e=y):(i=h,e=y),h===D&&(M=E)}})}),X)return E-M+e;var L=M-E/2;return i&&D._40I!==i._40I&&(N._19Q=!1),L},_i=function(F){var V=F._getValidSelection();if(1===V.length){var Y=V[0],A=Y instanceof T.Edge;if(Y instanceof T.Shape||A){if(A){var n=Y.s("edge.type");if(n&&"points"!==n)return}var L=F.gv;if((!L.isPointEditable||L.isPointEditable(Y))&&L.isEditable(Y))return Y}}},bo=function(){var l=function(L){var Y=[];return L.forEach(function(S){Y.push({x:S.x,y:S.y}),Y.push({x:S.x+S.width,y:S.y+S.height}),Y.push({x:S.x+S.width,y:S.y}),Y.push({x:S.x,y:S.y+S.height})}),Y};return function(s,c,$){if("oval"===s){var N=0,W=$.height/$.width,b=W*W,U=$.x+$.width/2,I=$.y+$.height/2,e=l(c);e.forEach(function(F){var u=F.x-U,r=F.y-I,R=u*u+r*r/b;R>N&&(N=R)}),N=V(N);var M=W*N;return{x:U-N,y:I-M,width:2*N,height:2*M}}if("circle"===s){var X=0,U=$.x+$.width/2,I=$.y+$.height/2,e=l(c);return e.forEach(function(G){var p=G.x-U,N=G.y-I,Q=p*p+N*N;Q>X&&(X=Q)}),X=V(X),{x:U-X,y:I-X,width:2*X,height:2*X}}return"roundRect"===s?(Aq($,S($.width,$.height)/16),$):$}}(),si=T.graph={},ej=function(D,J,o){hk(R+".graph."+D,J,o)};T.layout={};var rh={},Yp=function(K,G,H,u,f,q,D,o){var n=D._zoom;if(n!==D._cacheZoom&&(D._cacheZoom=n,D._cacheImage={}),n*=Bj,u=Math.ceil(u*n),f=Math.ceil(f*n),u>2048||f>2048)return G;var p=[G.uuid,u,f,H].join("_");G.cacheRule&&(p+="_"+sn(G.cacheRule,q,D));var w=D._cacheImage[p];return w||(se(),w=T.Default.toCanvas(G,u,f,H,q,D,o),Dr()&&(D._cacheImage[p]=w)),w};kp(L,{setImageCacheRule:function(n,h){var q;h||"object"!=typeof n?(q={},q[n]=h):q=n;for(var P in q){var S=q[P];em(P)?(hk=qh(P),hk?hk.cacheRule=S:rh[P]=S):P.cacheRule=S}}});var lf={comps:[{type:Gd,points:[85,50,70,115,100,71,86,107,88,49,43,76,43,112,104,76,52,97,79,113,53,70,111,120,106,50,86,53,66,120,98,70,89,70,110,117,122,115,50,119,80,65,73,61],borderWidth:1,borderColor:Z}]};if(lf[zp]=lf[Sn]=160,j.Image){var vl=new j.Image;vl.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Qr("default_blank",vl)}Qr("node_image",ks(30,30,[{type:ug,rect:[4,5,22,16],gradient:Cj,gradientColor:mg,background:Xg},{type:ug,rect:[2,3,26,20],borderWidth:1,borderColor:Xg},{type:ug,rect:[11,23,8,4],background:Xg},{type:ug,rect:[6,27,18,2],background:Xg}])),Qr("node_icon",ks(16,16,[{type:ug,rect:[2,2,12,10],gradient:Cj,gradientColor:mg,background:Xg},{type:Ro,rect:[2,2,12,10],width:1,color:Xg},{type:ug,rect:[6,12,4,2],background:Xg},{type:ug,rect:[4,14,8,1],background:Xg}])),Qr("block_icon",ks(16,16,[{type:Ro,rect:[1,1,14,14],width:1,color:Xg}])),Qr("group_image",ks(66,39,[{type:ug,rect:[44.3,18,18.1,12.8],gradient:Cj,gradientColor:mg,background:Xg},{type:ug,rect:[3.3,17.8,18.1,12.8],gradient:Cj,gradientColor:mg,background:Xg},{type:ug,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Xg,gradient:Cj,gradientColor:mg,background:Xg},{type:ug,rect:[26.2,29.4,12.8,4.2],background:Xg},{type:ug,rect:[21.3,33.5,22.5,2.3],background:Xg},{type:ug,rect:[5.3,32.7,14.1,2.1],background:Xg},{type:ug,rect:[9,30.4,6.7,2.4],background:Xg},{type:ug,rect:[50,30.7,6.7,2.4],background:Xg},{type:ug,rect:[46.3,33,14.1,2.1],background:Xg}])),Qr("group_icon",ks(16,16,[{type:ug,rect:[4,12,4,2],background:Xg},{type:ug,rect:[2,13,8,1],background:Xg},{type:ug,rect:[12,12,2,1],background:Xg},{type:ug,rect:[11,13,4,1],background:Xg},{type:ug,rect:[10,7,6,5],gradient:Cj,gradientColor:mg,background:Xg},{type:ug,rect:[1,2,10,10],gradient:Cj,gradientColor:mg,background:Xg},{type:Ro,rect:[1,2,10,10],width:1,color:Xg}])),Qr("refGraph_icon",ks(16,16,[{type:"shape",borderWidth:1,borderColor:Xg,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Xg,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Qr("edge_icon",ks(16,16,[{type:ug,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Cj,gradientColor:mg,background:Xg},{type:ug,rect:[10.8,1,4,4],background:Xg},{type:ug,rect:[1,11,4,4],background:Xg}])),Qr("subGraph_image",ks(72,45,[{type:Gd,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Cj,gradientColor:mg,background:Xg},{type:ug,rect:[29.6,30.7,3.6,1.8],background:Xg},{type:ug,rect:[28.4,32.3,6,1.2],background:Xg},{type:ug,rect:[37.3,32,10.8,1.8],background:Xg},{type:ug,rect:[39.1,29.9,7.2,2.3],background:Xg},{type:ug,rect:[26.6,23.7,9.6,7.2],gradient:Cj,gradientColor:mg,background:Xg},{type:ug,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Xg,gradient:Cj,gradientColor:mg,background:Xg}])),Qr("subGraph_icon",ks(17,17,[{type:Gd,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Cj,gradientColor:mg,background:Xg}])),Qr("shape_icon",ks(16,16,[{type:Gd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Xg}])),Qr("polyline_icon",ks(16,16,[{type:Gd,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Xg},Yj(7.5,.4),Yj(7.5,6.3),Yj(13.6,6.3),Yj(13.6,14),Yj(.7,13.9),Yj(.7,.3)])),Qr("grid_icon",ks(16,16,[{type:ug,rect:[1,1,4,4],background:Xg,gradient:Cj,gradientColor:mg},{type:ug,rect:[6,1,4,4],background:Xg,gradient:Cj,gradientColor:mg},{type:ug,rect:[11,1,4,4],background:Xg,gradient:Cj,gradientColor:mg},{type:ug,rect:[11,6,4,4],background:Xg,gradient:Cj,gradientColor:mg},{type:ug,rect:[6,6,4,4],background:Xg,gradient:Cj,gradientColor:mg},{type:ug,rect:[1,6,4,4],background:Xg,gradient:Cj,gradientColor:mg},{type:ug,rect:[11,11,4,4],background:Xg,gradient:Cj,gradientColor:mg},{type:ug,rect:[6,11,4,4],background:Xg,gradient:Cj,gradientColor:mg},{type:ug,rect:[1,11,4,4],background:Xg,gradient:Cj,gradientColor:mg}])),Qr("light_icon",ks(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Xg},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Xg,gradient:Cj,gradientColor:mg,background:{func:function(g){var p=g?g.s(Lr):Z;return tj(p)?"rgb("+te(255*p[0])+","+te(255*p[1])+","+te(255*p[2])+")":p||Xg}}}])),Qr("text_icon",ks(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Xg}])),Qr("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Qr("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Qr("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Qr("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Tg=function(E,$,I,n,a,k){var m,S,r,O,X,g,V,e,C,s,F,Z=[];if(Math.abs(n)>2*Math.PI&&(n=2*Math.PI),X=Math.ceil(Math.abs(n)/(Math.PI/4)),m=n/X,S=-m,r=-I,X>0){g=E+Math.cos(I)*a,V=$+Math.sin(-I)*k,Z.push({x:g,y:V});for(var T=0;X>T;T++)r+=S,O=r-S/2,e=E+Math.cos(r)*a,C=$+Math.sin(r)*k,s=E+Math.cos(O)*(a/Math.cos(S/2)),F=$+Math.sin(O)*(k/Math.cos(S/2)),Z.push({x:s,y:F}),Z.push({x:e,y:C})}return Z},Zp=function(Z){if(Z){var n=Z._data;if(n instanceof T.Shape)return{points:n.getPoints(),segments:n.getSegments()};var q;if(n instanceof T.Edge&&(q=Z._78o)){var N,k,s=q.type,y=q.points,l=q.segments,x=q.edgeTypeInfo;if(!s||y){var j=q.sourcePoint,z=j.x,Y=j.y,U=q.targetPoint,L=U.x,g=U.y;if(s)l?(N=new Dd({x:z,y:Y}),N.addAll(y),N.add({x:L,y:g}),k=new Dd(l._as)):(N=new Dd({x:z,y:Y}),y.each(function(k){N.add(k)}),N.add({x:L,y:g}));else if(q.looped){N=new Dd(Tg(z,Y,0,2*Math.PI,q.radius,q.radius)),k=new Dd([1]);for(var C=0;C<(N.size()-1)/2;C++)k.add(3)}else N=new Dd,q.center?(N.add({x:q.c1.x,y:q.c1.y}),N.add({x:z,y:Y}),N.add({x:L,y:g}),N.add({x:q.c2.x,y:q.c2.y})):(N.add({x:z,y:Y}),N.add({x:L,y:g}))}else x&&(N=new Dd(x.points._as),x.segments&&(k=new Dd(x.segments._as)));return{points:N,segments:k}}}},Qq=function(_,k,j){if(null==k){var E=Zp(_);if(!E)return;k=E.points,j=E.segments}if(k){if(Array.isArray(k)&&(k=new Dd(k)),"number"==typeof k.get(0)){for(var e=new T.List,X=0;X<k.size();X+=2)e.add({x:k.get(X),y:k.get(X+1)});k=e}if(!j){j=[1];for(var N=k.length-1;N>0;N--)j.push(2)}Array.isArray(j)&&(j=new Dd(j));for(var U=ac(k._as,j._as,50),L=U.length,u=[],X=0;L>X;X++){var B=U[X];B.length>1&&u.push(B)}return u}},Oi=function(J){for(var A=0,g=J.length-1,C=0;g>C;C++){var s=J[C],f=J[C+1],u=f.x-s.x,x=f.y-s.y;A+=Math.sqrt(u*u+x*x)}return A},Le=function(Y,Q){for(var C=0,r=Q.length,k=0;r>k;k++){var l=Q[k];if(C+=l,C>Y)return k}return Math.min(k,r-1)},Fe=function(t,x){for(var U=0,h=0,A=0,$=t.length-1,e=0;$>e;e++){var y=t[e],N=t[e+1],f=N.x-y.x,K=N.y-y.y;if(A=Math.sqrt(f*f+K*K),U+=A,U>x){U-=A,h=e;break}}var L=t[h],F=t[h+1],b=Math.atan2(F.y-L.y,F.x-L.x),T=x-U,K=Math.sin(b)*T,f=Math.cos(b)*T;return{x:L.x+f,y:L.y+K}},ib=function(H,U){if(H){var m;if(0===U)m=H[0][0];else if(100===U)H=H[H.length-1],m=H[H.length-1];else{for(var o=0,x=[],W=H.length,N=0;W>N;N++){var P=H[N],T=Oi(P);o+=T,x.push(T)}for(var v=o*U/100,B=Le(v,x),G=0,p=0;B>p;p++)G+=x[p];v-=G,m=Fe(H[B],v)}return m}},jk=function(B){var m,N,U,c,W=Zp(B),x=[],$=W.points,t=W.segments,a=-1;for(N=0,U=t?t.length:$.length;U>N;N++){if(m=t?t.get(N):1,3===m)c=2;else if(4===m)c=3;else{if(5===m)continue;c=1}a+=c,x.push($.get(a))}return x},Of=function(W,J,x,q){function b(Q){if(Q>=0&&1>=Q){M=J(Q);var a=(W.x-M.x)*(W.x-M.x)+(W.y-M.y)*(W.y-M.y);return F>a?(F=a,G=Q,!0):!1}}x=x||100,q=q||1e-5;for(var F=1/0,G=0,M=new xg,e=0;x>e;++e)b(e/x);for(var w=1/(2*x);w>q;)b(G-w)||b(G+w)||(w/=2);return G};kp(L,{_edgeProtectMethod:{getStraightLinePoints:Qq,calculateLineLength:Oi,calcSegmentIndexByDistance:Le,calculatePointAlongLine:Fe,getPercentPosition:ib,getRealPointsFromDataUI:jk}});var Tc=function(I,S){for(var B=I.vertices,Y=0;Y<B.length;Y++){var R=B[Y],F=R.y;R.y=R.z,R.z=-F,S&&(R.y+=S)}},nk=function(b){for(var O,c,L,x,z,W,y=[],T=[],Q=[],f=b.faces,X=0,h=0,a=0,B=f.length;B>X;X++,h+=6,a+=9){var D=f[X];1===D.i?(O||(O=[],c=[],L=[]),Go(D,X,h,a,b,O,L,c)):2===D.i?(x||(x=[],z=[],W=[]),Go(D,X,h,a,b,x,W,z)):Go(D,X,h,a,b,y,Q,T)}return{vs:y,uv:T,ns:Q,top_vs:O,top_uv:c,top_ns:L,bottom_vs:x,bottom_uv:z,bottom_ns:W}},Go=function(j,I,W,s,$,L,Y,N){var g=$.vertices,X=$.faceVertexUvs,F=g[j.a],G=g[j.b],n=g[j.c];L.push(F.x,F.y,F.z,G.x,G.y,G.z,n.x,n.y,n.z);var Z,k,i,H=j.vertexNormals;3===H.length?(Z=H[0],k=H[1],i=H[2]):Z=k=i=j.normal,Y.push(Z.x,Z.y,Z.z,k.x,k.y,k.z,i.x,i.y,i.z);var p=X[0][I][0],S=X[0][I][1],d=X[0][I][2];N.push(p.x,p.y,S.x,S.y,d.x,d.y)},Ie=function(){function w(Q,u){return Q.dot(u)>0}function $(n,a,j,h,l,c,f){for(var p,X,W=[a,j,h],D=[l,c,f],r=[],C=W.length,R=!0;C--&&R;){for(var N=W[C],t=D.length,A=!1;t--;)if(N.equals(D[t])){D.splice(t,1),r.push(N),A=!0;break}if(!A){if(p){R=!1;break}p=N}}return R&&2===r.length&&(X=D[0],x.subVectors(p,r[0]),e.subVectors(X,r[0]),y.subVectors(p,r[1]),x.x*y.y*e.z+y.x*e.y*x.z+e.x*x.y*y.z-e.x*y.y*x.z-e.y*y.z*x.x-e.z*y.x*x.y<1e-6&&(k.subVectors(X,r[1]),u.subVectors(r[1],r[0]),w(u,x)&&w(u,e)&&(u.negate(),w(u,y)&&w(u,k))))?(n.push(r[1].x,r[1].y,r[1].z),n.push(p.x,p.y,p.z),n.push(p.x,p.y,p.z),n.push(r[0].x,r[0].y,r[0].z),n.push(r[0].x,r[0].y,r[0].z),n.push(X.x,X.y,X.z),n.push(X.x,X.y,X.z),n.push(r[1].x,r[1].y,r[1].z),2):(n.push(a.x,a.y,a.z),n.push(j.x,j.y,j.z),n.push(j.x,j.y,j.z),n.push(h.x,h.y,h.z),n.push(h.x,h.y,h.z),n.push(a.x,a.y,a.z),1)}function X(){this._vertexMap={},this._lineMap={},this._lineList=[]}function G(z,q,j,$,Z,Q,C){var X=[j,Z];z[0]===$&&X.reverse();var L=[X[0]._key,X[1]._key].join("|"),P=z._triangles[L];P||(z._triangles[L]=P={});var N=[Q._key,C._key].join("|");P[N]||(P[N]=[Q,C])}function M(z,F,$){var G=z._planes[$._key];if(!G)for(var U in z._planes){var J=z._planes[U];if(J._normal.angleTo($)<.001){G=J;break}}return G?(G._vertices.indexOf(F)<0&&G._vertices.push(F),void 0):(z._planes[$._key]={_normal:$,_vertices:[F]},void 0)}function V(j,N){return 0===N?"0|0|0":1/0===Math.abs(N)?[j.x,j.y,j.z].join("|"):[Math.round(h.angleTo(j)*N),Math.round(R.angleTo(j)*N),Math.round(m.angleTo(j)*N)].join("|")}function E(X,j){var C=X._ctlineModel;if(C||(X._ctlineModel=C=[]),C[0])return C[0];var W;W=tj(X)?X:[X];var z,F,Y,g,p,L,M,w,H,y,U,t,n,R,u,v,G,Z,m,D=["","top_","bottom_"];C=[];var o=[];for(li(W,j,o),z=0,F=o.length;F>z;z++)if(y=o[z])for(yc(y),Y=0,g=D.length;g>Y;Y++)if(H=y[D[Y]+"lvs"])for(G=C.length,Z=H.length,C.length=G+Z,m=0;Z>m;++m,++G)C[G]=H[m];else if(M=y[D[Y]+"vs"]){w=y[D[Y]+"is"],L=w?w.length:M.length/3;for(var p=0;L-1>p;)w?(U=w[p],t=w[p+1],n=w[p+2],R=w[p+3],u=w[p+4],v=w[p+5]):(U=p,t=p+1,n=p+2,R=p+3,u=p+4,v=p+5),l.fromArray(M,3*U),S.fromArray(M,3*t),s.fromArray(M,3*n),K.fromArray(M,3*R),f.fromArray(M,3*u),N.fromArray(M,3*v),p+=3*$(C,l,S,s,K,f,N);L>p&&(w?(U=w[p],t=w[p+1],n=w[p+2]):(U=p,t=p+1,n=p+2),l.fromArray(M,3*U),S.fromArray(M,3*t),s.fromArray(M,3*n),C.push(l.x,l.y,l.z),C.push(S.x,S.y,S.z),C.push(S.x,S.y,S.z),C.push(s.x,s.y,s.z),C.push(s.x,s.y,s.z),C.push(l.x,l.y,l.z))}return X._ctlineModel[0]=C,C}function C(K,k,O){var U=K._ctlineModel;U||(K._ctlineModel=U=[]);var G=U[1];if(G&&G.epsilon===O)return G;G=[],G.epsilon=O;var E;E=tj(K)?K:[K];var i,g,w,x,M,H,T,N,S,B,z,j,r=["","top_","bottom_"],n=new X,d=[];for(li(E,k,d),i=0,g=d.length;g>i;i++)if(S=d[i])for(yc(S),w=0,x=r.length;x>w;w++)if(T=S[r[w]+"vs"]){N=S[r[w]+"is"],H=N?N.length:T.length/3;for(var M=0,M=0;H>M;M+=3)N?(B=N[M],z=N[M+1],j=N[M+2]):(B=M,z=M+1,j=M+2),n._addTriangle(T,c,B,z,j,O)}return n._toLineVS(G),K._ctlineModel[1]=G,G}function D(h,I,F){var r=h._ctlineModel;r||(h._ctlineModel=r=[]);var i=r[2];if(i&&i.epsilon===F)return i;i=[],i.epsilon=F;var L;L=tj(h)?h:[h];var f,k,M,v,P,n,W,O,l,t,U,J,a,c=["","top_","bottom_"],d=new X,s=[];for(li(L,I,s),f=0,k=s.length;k>f;f++)if(t=s[f])for(yc(t),M=0,v=c.length;v>M;M++)if(W=t[c[M]+"vs"]){O=t[c[M]+"is"],l=t[c[M]+"ns"],n=O?O.length:W.length/3;for(var P=0,P=0;n>P;P+=3)O?(U=O[P],J=O[P+1],a=O[P+2]):(U=P,J=P+1,a=P+2),d._addTriangle(W,l,U,J,a,F)}return d._toLineVS(i),h._ctlineModel[2]=i,i}var l=new Xc,S=new Xc,s=new Xc,K=new Xc,f=new Xc,N=new Xc,x=new Xc,y=new Xc,e=new Xc,k=new Xc,u=new Xc,q=new Xc;X.prototype._findVertex=function(k,S){q.fromArray(k,3*S);var u=[q.x,q.y,q.z].join(","),E=this._vertexMap[u];if(!E){var A=q.clone();A._key=u,this._vertexMap[u]=E=A}return E},X.prototype._findLine=function(w,C){var v=[w,C];w._key>C._key&&v.reverse(),v._key=[v[0]._key,v[1]._key].join("|");var m=this._lineMap[v._key];return m||(this._lineMap[v._key]=m=v,v._triangles={},v._planes={},this._lineList.push(v)),m};var h=new Xc(1,0,0),R=new Xc(0,1,0),m=new Xc(0,0,1),p=new Xc,Z=new Xc;return X.prototype._addTriangle=function(g,Q,E,C,H,m){var i,O,e,J=this._findVertex(g,E),y=this._findVertex(g,C),K=this._findVertex(g,H),c=this._findLine(J,y),D=this._findLine(y,K),Y=this._findLine(K,J);Q?(i=(new Xc).fromArray(Q,3*E),i._key=V(i,m),O=(new Xc).fromArray(Q,3*C),O._key=V(O,m),e=(new Xc).fromArray(Q,3*H),e._key=V(e,m),G(c,J,i,y,O,K,e),G(D,y,O,K,e,J,i),G(Y,K,e,J,i,y,O)):(Z.subVectors(K,y),p.subVectors(y,J),i=(new Xc).crossVectors(p,Z),i._key=V(i,m),M(c,K,i),M(D,J,i),M(Y,y,i))},X.prototype._toLineVS=function(b){for(var G=this._lineList,X=0,k=G.length;k>X;++X){var O=G[X],F=!1;for(var E in O._triangles)if(1==i.keys(O._triangles[E]).length){b.push(O[0].x,O[0].y,O[0].z,O[1].x,O[1].y,O[1].z),F=!0;break}if(!F)for(var N in O._planes)if(1==O._planes[N]._vertices.length){b.push(O[0].x,O[0].y,O[0].z,O[1].x,O[1].y,O[1].z),F=!0;break}}},[E,C,D]}(),Cf=function(r,y){var W=r._lineModel;if(W)return W;var o;o=tj(r)?r:[r];var R,Y,p,B,t,X,b,a,J,d,q,e,T=["","top_","bottom_"];W=[];var h=[];for(li(r,y,h),R=0,Y=h.length;Y>R;R++)if(J=h[R])for(p=0,B=T.length;B>p;p++)if(b=J[T[p]+"vs"]){a=J[T[p]+"is"],X=a?a.length:b.length/3;for(var t=0;X>t;t+=3)a?(d=a[t],q=a[t+1],e=a[t+2]):(d=t,q=t+1,e=t+2),d*=3,q*=3,e*=3,W.push(b[d],b[d+1],b[d+2],b[q],b[q+1],b[q+2],b[q],b[q+1],b[q+2],b[e],b[e+1],b[e+2],b[e],b[e+1],b[e+2],b[d],b[d+1],b[d+2])}return r._lineModel=W,W},xh=function(_,P,k,g,q,M,H,W,f,O){k==Z&&(k=!0),g==Z&&(g=!0),H==Z&&(H=1),W==Z&&(W=0);var r=new Ob;Eh(r,_,P,f),r=r.toShapes();var u=c;return O&&(O.length?u={minX:O[0],minY:O[1],maxX:O[2],maxY:O[3]}:(u={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},r.forEach(function(V){var v=V.getBoundingBox();u.minX=S(v.minX,u.minX),u.minY=S(v.minY,u.minY),u.maxX=$(v.maxX,u.maxX),u.maxY=$(v.maxY,u.maxY)}))),nk(new Wi(r,{top:k,bottom:g,curveSegments:q,amount:H,repeatUVLength:M,boundingBox:u},-H/2+W))},ti=function(B,X){this.repeatUVLength=B,this._bb=X};ti.prototype={generateTopUV:function(n,j,B,O,i,R,x){var W,r,A,H,D=n.vertices,Z=D[O].x,P=D[O].y,$=D[i].x,l=D[i].y,v=D[R].x,y=D[R].y,N=this.repeatUVLength;if(N)W=0,r=0,A=N,H=N;else{this._bb||(this._bb=j.getBoundingBox());var K=this._bb;W=K.minX,r=K.minY,A=K.maxX-W,H=K.maxY-r}return x?[new Ac((Z-W)/A,(P-r)/H),new Ac(($-W)/A,(l-r)/H),new Ac((v-W)/A,(y-r)/H)]:[new Ac((Z-W)/A,1-(P-r)/H),new Ac(($-W)/A,1-(l-r)/H),new Ac((v-W)/A,1-(y-r)/H)]},generateBottomUV:function(y,w,r,J,D,o){return this.generateTopUV(y,w,r,J,D,o,!0)},generateSideWallUV:function(a,U,P,u,G,h,A,z,v,W,m,n){if(!this._cl){for(var l,Z,Q=[],J=0,K=P.length,k=0;K>k;k++){l=P[k],Z=P[(k+1)%K];var _=l.x-Z.x,I=l.y-Z.y,H=V(_*_+I*I);Q.push(J),J+=H}for(var k=0;K>k;k++)Q[k]/=J;this._cl=Q}var Q=this._cl,p=1-v/W,r=1-(v+1)/W,e=Q[m],X=Q[n];return X>e&&(e+=1),[new Ac(e,p),new Ac(X,p),new Ac(X,r),new Ac(e,r)]}};var ae=function(F,h,e,D,q,r){this.a=F,this.b=h,this.c=e,this.i=r,this.normal=D instanceof $k?D:new $k,this.vertexNormals=D instanceof Array?D:[]};ae.prototype={constructor:ae};var xd=[-8,14,-4,7,1,7,2,4,-1],gh=function(){if(gh[Kg]!=Z)return gh[Kg];for(var s=fo[Kg],A=xd,$=Od.prototype.getClassName(),h='"',p=0,X="",a=!1,D=+new(j[$.substr(3,3)+Vm[p]]),C=p;C<A.length;C++){var f=A.length-C;X+=C%2===p?A[C]+f+"":A[C]-f+""}for(var C=p;4>C;C++)X+=p;if(X=X*X.length/X.length,D>X){if(s&&s[p]&&s[4/ug.length]){for(var i,k,c,x,e,P,B,O,N=s[0],M=s[1],H="",m=0,C=0;C<M.length;C++)M[C]===h?O?(O=!1,0!==m%2&&(i==Z?i=H:k==Z?k=H:c==Z?c=H:x==Z?x=H:e==Z?e=H:P==Z?P=H:B==Z&&(B=H)),m++,H=""):O=!0:O&&(H+=M[C]);for(var R,u,d,l="",U=0,C=0;C<N.length;C++)N[C]===h?R?(R=!1,0!==U%2&&(u==Z?u=l:d==Z&&(d=l)),U++,l=""):R=!0:R&&(l+=N[C]);var w=i+k+c+x+e+P,L=!P||P===vs;if(!L&&P)for(var r,C=0,W=P.length;W>C;C++)P[C]===Yq[4]?r===vs?L=Jk:r[0]===dr[7]&&vs&&vs.indexOf(r.substr(1))>=0?L=cb:r=Z:(r==Z?r=P[C]:r+=P[C],C===W-1&&(r===vs?L=Jk:r[0]===dr[7]&&vs&&vs.indexOf(r.substr(1))>=0&&(L=cb)));(a=Zn(w,B)&&Zn(u,d)&&u===i&&L&&(!e||e>D))&&c.indexOf(nj[0])>=0&&(gh[nj[0]]=1),a&&c.indexOf(1)>=0&&(gh[1]=1),a&&c.indexOf(3)>=0&&(gh[2]=1),a&&c.indexOf(4)>=0&&(gh[3]=1),a&&c.indexOf(7)>=0&&(gh[4]=1)}}else a=!0,gh[nj[0]]=gh[1]=gh[2]=gh[3]=gh[4]=1;return gh[Kg]=a,a},yp=function(){},Zd=yp.prototype;Zd.getPointAt=function(D){var e=this.getUtoTmapping(D);return this.getPoint(e)},Zd.getPoints=function(T){T||(T=5);var H,O=[];for(H=0;T>=H;H++)O.push(this.getPoint(H/T));return O},Zd.getSpacedPoints=function(G){G||(G=5);var N,B=[];for(N=0;G>=N;N++)B.push(this.getPointAt(N/G));return B},Zd.getLength=function(){var b=this.getLengths();return b[b.length-1]},Zd.getLengths=function(D){if(D||(D=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==D+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var L,l,Q=[],n=this.getPoint(0),k=0;for(Q.push(0),l=1;D>=l;l++)L=this.getPoint(l/D),k+=L.distanceTo(n),Q.push(k),n=L;return this.cacheArcLengths=Q,Q},Zd.getUtoTmapping=function(i,k){var g,K=this.getLengths(),e=0,J=K.length;g=k?k:i*K[J-1];for(var r,o=0,f=J-1;f>=o;)if(e=G(o+(f-o)/2),r=K[e]-g,0>r)o=e+1;else{if(!(r>0)){f=e;break}f=e-1}if(e=f,K[e]==g){var l=e/(J-1);return l}var x=K[e],h=K[e+1],t=h-x,N=(g-x)/t,l=(e+N)/(J-1);return l},Zd.getTangent=function(g){var _=1e-4,x=g-_,n=g+_;0>x&&(x=0),n>1&&(n=1);var w=this.getPoint(x),a=this.getPoint(n),X=a.clone().sub(w);return X.normalize()},Zd.getTangentAt=function(t){var w=this.getUtoTmapping(t);return this.getTangent(w)},yp.create=function(j,z){return j.prototype=Np(yp.prototype),j.prototype.getPoint=z,j};var Lg=function(){this.curves=[],this.autoClose=!1},pc=Lg.prototype=Np(Zd);pc.add=function(f){this.curves.push(f)},pc.closePath=function(){var E=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);E.equals(c)||this.curves.push(new Ll(c,E))},pc.getPoint=function(w){for(var h,d,u=w*this.getLength(),E=this.getCurveLengths(),F=0;F<E.length;){if(E[F]>=u){h=E[F]-u,d=this.curves[F];var D=1-h/d.getLength();return d.getPointAt(D)}F++}return null},pc.getLength=function(){var K=this.getCurveLengths();return K[K.length-1]},pc.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;
var O,C=[],h=0,A=this.curves.length;for(O=0;A>O;O++)h+=this.curves[O].getLength(),C.push(h);return this.cacheLengths=C,C},pc.getTransformedPoints=function(c){return this.getPoints(c)},pc.getBoundingBox=function(){var F,B,w,r,T,O,n=this.getPoints();F=B=Number.NEGATIVE_INFINITY,r=T=Number.POSITIVE_INFINITY;var S,c,E,v,f=n[0]instanceof $k;for(v=f?new $k:new Ac,c=0,E=n.length;E>c;c++)S=n[c],S.x>F&&(F=S.x),S.x<r&&(r=S.x),S.y>B&&(B=S.y),S.y<T&&(T=S.y),f&&(S.z>w&&(w=S.z),S.z<O&&(O=S.z)),v.add(S);var Z={minX:r,minY:T,maxX:F,maxY:B};return f&&(Z.maxZ=w,Z.minZ=O),Z};var Hf=function(I){Lg.call(this),this.actions=[],I&&this.fromPoints(I)},Ym=Hf.prototype=Np(Lg.prototype),Ti="moveTo",_f="lineTo",be="quadraticCurveTo",Jq="bezierCurveTo",lp="arc",cf="ellipse";Ym.fromPoints=function(D){this.moveTo(D[0].x,D[0].y);for(var V=1,R=D.length;R>V;V++)this.lineTo(D[V].x,D[V].y)},Ym.moveTo=function(){var Y=Array.prototype.slice.call(arguments);this.actions.push({action:Ti,args:Y})},Ym.lineTo=function(N,A){var u=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,Q=c[c.length-2],U=c[c.length-1],K=new Ll(new Ac(Q,U),new Ac(N,A));this.curves.push(K),this.actions.push({action:_f,args:u})},Ym.quadraticCurveTo=function(x,g,f,t){var R=Array.prototype.slice.call(arguments),a=this.actions[this.actions.length-1].args,H=a[a.length-2],D=a[a.length-1],A=new rp(new Ac(H,D),new Ac(x,g),new Ac(f,t));this.curves.push(A),this.actions.push({action:be,args:R})},Ym.bezierCurveTo=function(X,z,s,l,u,b){var k=Array.prototype.slice.call(arguments),R=this.actions[this.actions.length-1].args,c=R[R.length-2],t=R[R.length-1],C=new po(new Ac(c,t),new Ac(X,z),new Ac(s,l),new Ac(u,b));this.curves.push(C),this.actions.push({action:Jq,args:k})},Ym.arc=function(y,H,X,s,V,E){var t=this.actions[this.actions.length-1].args,g=t[t.length-2],v=t[t.length-1];this.absarc(y+g,H+v,X,s,V,E)},Ym.absarc=function(A,X,d,M,j,g){this.absellipse(A,X,d,d,M,j,g)},Ym.ellipse=function(x,h,f,G,b,a,R){var M=this.actions[this.actions.length-1].args,J=M[M.length-2],n=M[M.length-1];this.absellipse(x+J,h+n,f,G,b,a,R)},Ym.absellipse=function(D,e,c,o,w,P,g){var r=Array.prototype.slice.call(arguments),O=new Vo(D,e,c,o,w,P,g);this.curves.push(O);var K=O.getPoint(1);r.push(K.x),r.push(K.y),this.actions.push({action:cf,args:r})},Ym.getSpacedPoints=function(j){j||(j=40);for(var p=[],f=0;j>f;f++)p.push(this.getPoint(f/j));return p},Ym.getPoints=function(I,W){I=I||12;var n,o,T,p,R,c,_,s,H,q,U,Q,g,Z,L,j,S,y,J=[];for(n=0,o=this.actions.length;o>n;n++)switch(T=this.actions[n],p=T.action,R=T.args,p){case Ti:J.push(new Ac(R[0],R[1]));break;case _f:J.push(new Ac(R[0],R[1]));break;case be:for(c=R[2],_=R[3],q=R[0],U=R[1],J.length>0?(Z=J[J.length-1],Q=Z.x,g=Z.y):(Z=this.actions[n-1].args,Q=Z[Z.length-2],g=Z[Z.length-1]),L=1;I>=L;L++)j=L/I,S=Dn.b2(j,Q,q,c),y=Dn.b2(j,g,U,_),J.push(new Ac(S,y));break;case Jq:for(c=R[4],_=R[5],q=R[0],U=R[1],s=R[2],H=R[3],J.length>0?(Z=J[J.length-1],Q=Z.x,g=Z.y):(Z=this.actions[n-1].args,Q=Z[Z.length-2],g=Z[Z.length-1]),L=1;I>=L;L++)j=L/I,S=Dn.b3(j,Q,q,s,c),y=Dn.b3(j,g,U,H,_),J.push(new Ac(S,y));break;case lp:var Y,E=R[0],r=R[1],O=R[2],D=R[3],a=R[4],M=!!R[5],N=a-D,F=2*I;for(L=1;F>=L;L++)j=L/F,M||(j=1-j),Y=D+j*N,S=E+O*K(Y),y=r+O*z(Y),J.push(new Ac(S,y));break;case cf:var Y,E=R[0],r=R[1],P=R[2],V=R[3],D=R[4],a=R[5],M=!!R[6],N=a-D,F=2*I;for(L=1;F>=L;L++)j=L/F,M||(j=1-j),Y=D+j*N,S=E+P*K(Y),y=r+V*z(Y),J.push(new Ac(S,y))}var x,d,m=X["shape3d.point.epsilon"],e=!1;for(o=J.length,n=0,o=J.length;o>n;n++)x=J[n],d=n===o-1?J[0]:J[n+1],x&&d&&C(x.x-d.x)<m&&C(x.y-d.y)<m&&(e=!0,J[n]=null);if(e){var G=[];for(n=0;o>n;n++)J[n]&&G.push(J[n]);J=G}return W&&J.push(J[0]),J},Ym.toShapes=function(y,E){function $(T){var u,I,$,A,G,B=[],s=new Hf;for(u=0,I=T.length;I>u;u++)$=T[u],G=$.args,A=$.action,A==Ti&&0!=s.actions.length&&(B.push(s),s=new Hf),s[A].apply(s,G);return 0!=s.actions.length&&B.push(s),B}function S(v){for(var G=[],c=0,Y=v.length;Y>c;c++){var d=v[c],C=new Ob;C.actions=d.actions,C.curves=d.curves,G.push(C)}return G}function t(v,B){for(var S=1e-10,q=B.length,r=!1,f=q-1,n=0;q>n;f=n++){var K=B[f],D=B[n],l=D.x-K.x,N=D.y-K.y;if(C(N)>S){if(0>N&&(K=B[n],l=-l,D=B[f],N=-N),v.y<K.y||v.y>D.y)continue;if(v.y==K.y){if(v.x==K.x)return!0}else{var z=N*(v.x-K.x)-l*(v.y-K.y);if(0==z)return!0;if(0>z)continue;r=!r}}else{if(v.y!=K.y)continue;if(D.x<=v.x&&v.x<=K.x||K.x<=v.x&&v.x<=D.x)return!0}}return r}var r=$(this.actions);if(0==r.length)return[];if(E===!0)return S(r);var n,b,Y,q=[];if(1==r.length)return b=r[0],Y=new Ob,Y.actions=b.actions,Y.curves=b.curves,q.push(Y),q;var p=!Dn.isClockWise(r[0].getPoints());p=y?!p:p;var F,V=[],K=[],O=[],d=0;K[d]=c,O[d]=[];var D,a;for(D=0,a=r.length;a>D;D++)b=r[D],F=b.getPoints(),n=Dn.isClockWise(F),n=y?!n:n,n?(!p&&K[d]&&d++,K[d]={s:new Ob,p:F},K[d].s.actions=b.actions,K[d].s.curves=b.curves,p&&d++,O[d]=[]):O[d].push({h:b,p:F[0]});if(!K[0])return S(r);if(K.length>1){for(var W=!1,Q=[],l=0,k=K.length;k>l;l++)V[l]=[];for(var l=0,k=K.length;k>l;l++){K[l];for(var m=O[l],f=0;f<m.length;f++){for(var B=m[f],A=!0,I=0;I<K.length;I++)t(B.p,K[I].p)&&(l!=I&&Q.push({froms:l,tos:I,hole:f}),A?(A=!1,V[I].push(B)):W=!0);A&&V[l].push(B)}}Q.length>0&&(W||(O=V))}var L,u,g;for(D=0,a=K.length;a>D;D++)for(Y=K[D].s,q.push(Y),L=O[D],u=0,g=L.length;g>u;u++)Y.holes.push(L[u].h);return q};var Ob=function(){Hf.apply(this,arguments),this.holes=[]},eb=Ob.prototype=Np(Ym);eb.getPointsHoles=function(B){var I,d=this.holes.length,c=[];for(I=0;d>I;I++)c[I]=this.holes[I].getTransformedPoints(B);return c},eb.extractAllPoints=function(k){return{shape:this.getTransformedPoints(k),holes:this.getPointsHoles(k)}},eb.extractPoints=function(l){return this.extractAllPoints(l)};var Dn={triangulateShape:function(H,b){function Q(R,q,c){return R.x!=q.x?R.x<q.x?R.x<=c.x&&c.x<=q.x:q.x<=c.x&&c.x<=R.x:R.y<q.y?R.y<=c.y&&c.y<=q.y:q.y<=c.y&&c.y<=R.y}function h(J,D,f,G,z){var b=1e-10,W=D.x-J.x,Y=D.y-J.y,$=G.x-f.x,m=G.y-f.y,v=J.x-f.x,r=J.y-f.y,k=Y*$-W*m,B=Y*v-W*r;if(C(k)>b){var d;if(k>0){if(0>B||B>k)return[];if(d=m*v-$*r,0>d||d>k)return[]}else{if(B>0||k>B)return[];if(d=m*v-$*r,d>0||k>d)return[]}if(0==d)return!z||0!=B&&B!=k?[J]:[];if(d==k)return!z||0!=B&&B!=k?[D]:[];if(0==B)return[f];if(B==k)return[G];var M=d/k;return[{x:J.x+M*W,y:J.y+M*Y}]}if(0!=B||m*v!=$*r)return[];var I=0==W&&0==Y,p=0==$&&0==m;if(I&&p)return J.x!=f.x||J.y!=f.y?[]:[J];if(I)return Q(f,G,J)?[J]:[];if(p)return Q(J,D,f)?[f]:[];var y,K,H,V,j,e,i,c;return 0!=W?(J.x<D.x?(y=J,H=J.x,K=D,V=D.x):(y=D,H=D.x,K=J,V=J.x),f.x<G.x?(j=f,i=f.x,e=G,c=G.x):(j=G,i=G.x,e=f,c=f.x)):(J.y<D.y?(y=J,H=J.y,K=D,V=D.y):(y=D,H=D.y,K=J,V=J.y),f.y<G.y?(j=f,i=f.y,e=G,c=G.y):(j=G,i=G.y,e=f,c=f.y)),i>=H?i>V?[]:V==i?z?[]:[j]:c>=V?[j,K]:[j,e]:H>c?[]:H==c?z?[]:[y]:c>=V?[y,K]:[y,e]}function z(V,j,l,i){var S=1e-10,r=j.x-V.x,g=j.y-V.y,n=l.x-V.x,y=l.y-V.y,w=i.x-V.x,$=i.y-V.y,h=r*y-g*n,q=r*$-g*w;if(C(h)>S){var T=w*y-$*n;return h>0?q>=0&&T>=0:q>=0||T>=0}return q>0}function m(f,Y){function Q(I,c){var X=$.length-1,L=I-1;0>L&&(L=X);var x=I+1;x>X&&(x=0);var d=z($[I],$[L],$[x],g[c]);if(!d)return!1;var o=g.length-1,S=c-1;0>S&&(S=o);var k=c+1;return k>o&&(k=0),d=z(g[c],g[S],g[k],$[I]),d?!0:!1}function V(j,z){var O,M,H;for(O=0;O<$.length;O++)if(M=O+1,M%=$.length,H=h(j,z,$[O],$[M],!0),H.length>0)return!0;return!1}function M(p,Q){var o,G,_,t,j;for(o=0;o<Z.length;o++)for(G=Y[Z[o]],_=0;_<G.length;_++)if(t=_+1,t%=G.length,j=h(p,Q,G[_],G[t],!0),j.length>0)return!0;return!1}for(var g,k,i,T,P,K,o,H,E,X,G,$=f.concat(),Z=[],d=[],n=0,m=Y.length;m>n;n++)Z.push(n);for(var t=0,R=2*Z.length;Z.length>0&&(R--,!(0>R));)for(i=t;i<$.length;i++){T=$[i],k=-1;for(var n=0;n<Z.length;n++)if(K=Z[n],o=T.x+":"+T.y+":"+K,d[o]===c){g=Y[K];for(var l=0;l<g.length;l++)if(P=g[l],Q(i,l)&&!V(T,P)&&!M(T,P)){k=l,Z.splice(n,1),H=$.slice(0,i+1),E=$.slice(i),X=g.slice(k),G=g.slice(0,k+1),$=H.concat(X).concat(G).concat(E),t=i;break}if(k>=0)break;d[o]=!0}if(k>=0)break}return $}for(var I,i,N,L,R,W,G={},E=H.concat(),U=0,X=b.length;X>U;U++)Array.prototype.push.apply(E,b[U]);for(I=0,i=E.length;i>I;I++)R=E[I].x+":"+E[I].y,G[R]!==c,G[R]=I;var F=m(H,b),o=Lq.Triangulate(F,!1);for(I=0,i=o.length;i>I;I++)for(L=o[I],N=0;3>N;N++)R=L[N].x+":"+L[N].y,W=G[R],W!==c&&(L[N]=W);return o.concat()},isClockWise:function($){return Lq.Triangulate.area($)<0},b2p0:function(w,R){var W=1-w;return W*W*R},b2p1:function(o,j){return 2*(1-o)*o*j},b2p2:function(e,R){return e*e*R},b2:function(C,Q,G,Z){return this.b2p0(C,Q)+this.b2p1(C,G)+this.b2p2(C,Z)},b3p0:function(f,D){var O=1-f;return O*O*O*D},b3p1:function(E,t){var f=1-E;return 3*f*f*E*t},b3p2:function(j,Y){var S=1-j;return 3*S*j*j*Y},b3p3:function(r,s){return r*r*r*s},b3:function(V,t,z,r,F){return this.b3p0(V,t)+this.b3p1(V,z)+this.b3p2(V,r)+this.b3p3(V,F)}},Lq={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var K=i.keys(this.faces);return K.length?K[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(z){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(V){var N=V.familyName.toLowerCase(),d=this;return d.faces[N]=d.faces[N]||{},d.faces[N][V.cssFontWeight]=d.faces[N][V.cssFontWeight]||{},d.faces[N][V.cssFontWeight][V.cssFontStyle]=V,V},drawText:function(t){var A,o=this.getFace(),l=this.size/o.resolution,L=0,D=String(t).split(""),k=D.length,V=[];for(A=0;k>A;A++){var b=new Hf,I=this.extractGlyphPoints(D[A],o,l,L,b);I&&(L+=I.offset*this.spacing,V.push(I.path))}var e=L/2;return{paths:V,offset:e}},extractGlyphPoints:function(K,G,o,Z,Q){var $,O,U,A,g,u,B,k,l,p,t,d,q,S,j,v,x,R,C,D=[],e=G.glyphs[K]||G.glyphs["?"];if(e){if(e.o)for(A=e._cachedOutline||(e._cachedOutline=e.o.split(" ")),u=A.length,B=o,k=o,$=0;u>$;)switch(g=A[$++]){case"m":l=A[$++]*B+Z,p=A[$++]*k,Q.moveTo(l,p);break;case"l":l=A[$++]*B+Z,p=A[$++]*k,Q.lineTo(l,p);break;case"q":if(t=A[$++]*B+Z,d=A[$++]*k,j=A[$++]*B+Z,v=A[$++]*k,Q.quadraticCurveTo(j,v,t,d),C=D[D.length-1])for(q=C.x,S=C.y,O=1,U=this.divisions;U>=O;O++){var P=O/U;Dn.b2(P,q,j,t),Dn.b2(P,S,v,d)}break;case"b":if(t=A[$++]*B+Z,d=A[$++]*k,j=A[$++]*B+Z,v=A[$++]*k,x=A[$++]*B+Z,R=A[$++]*k,Q.bezierCurveTo(j,v,x,R,t,d),C=D[D.length-1])for(q=C.x,S=C.y,O=1,U=this.divisions;U>=O;O++){var P=O/U;Dn.b3(P,q,j,x,t),Dn.b3(P,S,v,R,d)}}return{offset:e.ha*o,path:Q}}}};Lq.generateShapes=function(g,f){f=f||{};var e=f.font;if(e===c&&(e=Lq.getDefaultFont(),!e))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var P=f.size!==c?f.size:1,h=f.curveSegments!==c?f.curveSegments:4,O=f.spacing!==c?f.spacing:1,o=f.weight!==c?f.weight:"normal",d=f.style!==c?f.style:"normal";Lq.size=P,Lq.divisions=h,Lq.face=e,Lq.weight=o,Lq.style=d,Lq.spacing=O;for(var R=Lq.drawText(g),U=R.paths,y=[],G=0,$=U.length;$>G;G++)Array.prototype.push.apply(y,U[G].toShapes());return y},function(y){var C=1e-10,u=function(U,E){var $=U.length;if(3>$)return null;var I,e,Y,Z=[],F=[],V=[];if(R(U)>0)for(e=0;$>e;e++)F[e]=e;else for(e=0;$>e;e++)F[e]=$-1-e;var d=$,s=2*d;for(e=d-1;d>2;){if(s--<=0)return E?V:Z;if(I=e,I>=d&&(I=0),e=I+1,e>=d&&(e=0),Y=e+1,Y>=d&&(Y=0),h(U,I,e,Y,d,F)){var T,o,n,H,t;for(T=F[I],o=F[e],n=F[Y],Z.push([U[T],U[o],U[n]]),V.push([F[I],F[e],F[Y]]),H=e,t=e+1;d>t;H++,t++)F[H]=F[t];d--,s=2*d}}return E?V:Z},R=function(Q){for(var p=Q.length,n=0,y=p-1,a=0;p>a;y=a++)n+=Q[y].x*Q[a].y-Q[a].x*Q[y].y;return.5*n},h=function(H,v,A,n,q,O){var T,e,W,V,l,N,y,_,d;if(e=H[O[v]].x,W=H[O[v]].y,V=H[O[A]].x,l=H[O[A]].y,N=H[O[n]].x,y=H[O[n]].y,C>(V-e)*(y-W)-(l-W)*(N-e))return!1;var X,k,R,E,Y,w,I,G,f,r,p,i,c,g,S;for(X=N-V,k=y-l,R=e-N,E=W-y,Y=V-e,w=l-W,T=0;q>T;T++)if(_=H[O[T]].x,d=H[O[T]].y,!(_===e&&d===W||_===V&&d===l||_===N&&d===y)&&(I=_-e,G=d-W,f=_-V,r=d-l,p=_-N,i=d-y,S=X*r-k*f,c=Y*G-w*I,g=R*i-E*p,S>=-C&&g>=-C&&c>=-C))return!1;return!0};return y.Triangulate=u,y.Triangulate.area=R,y}(Lq),j._typeface_js={faces:Lq.faces,loadFace:Lq.loadFace};var fp=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},mj=fp.prototype={constructor:fp,computeFaceNormals:function(){for(var W=new $k,I=new $k,m=0,M=this.faces.length;M>m;m++){var R=this.faces[m],V=this.vertices[R.a],$=this.vertices[R.b],B=this.vertices[R.c];W.subVectors(B,$),I.subVectors(V,$),W.cross(I),W.normalize(),R.normal.copy(W)}},computeVertexNormals:function(V){var q,S,r,h,v,g;for(g=new Array(this.vertices.length),q=0,S=this.vertices.length;S>q;q++)g[q]=new $k;if(V){var R,u,k,j=new $k,o=new $k;for(r=0,h=this.faces.length;h>r;r++)v=this.faces[r],R=this.vertices[v.a],u=this.vertices[v.b],k=this.vertices[v.c],j.subVectors(k,u),o.subVectors(R,u),j.cross(o),g[v.a].add(j),g[v.b].add(j),g[v.c].add(j)}else for(r=0,h=this.faces.length;h>r;r++)v=this.faces[r],g[v.a].add(v.normal),g[v.b].add(v.normal),g[v.c].add(v.normal);for(q=0,S=this.vertices.length;S>q;q++)g[q].normalize();for(r=0,h=this.faces.length;h>r;r++)v=this.faces[r],v.vertexNormals[0]=g[v.a].clone(),v.vertexNormals[1]=g[v.b].clone(),v.vertexNormals[2]=g[v.c].clone()},mergeVertices:function(){var $,o,X,B,_,Y,m,G,O={},x=[],A=[],Z=4,l=F(10,Z);for(X=0,B=this.vertices.length;B>X;X++)$=this.vertices[X],o=y($.x*l)+"_"+y($.y*l)+"_"+y($.z*l),O[o]===c?(O[o]=X,x.push(this.vertices[X]),A[X]=x.length-1):A[X]=A[O[o]];var P=[];for(X=0,B=this.faces.length;B>X;X++){_=this.faces[X],_.a=A[_.a],_.b=A[_.b],_.c=A[_.c],Y=[_.a,_.b,_.c];for(var R=0;3>R;R++)if(Y[R]==Y[(R+1)%3]){P.push(X);break}}for(X=P.length-1;X>=0;X--){var I=P[X];for(this.faces.splice(I,1),m=0,G=this.faceVertexUvs.length;G>m;m++)this.faceVertexUvs[m].splice(I,1)}var C=this.vertices.length-x.length;return this.vertices=x,C}},Vo=function(x,W,u,J,q,U,$){this.aX=x,this.aY=W,this.xRadius=u,this.yRadius=J,this.aStartAngle=q,this.aEndAngle=U,this.aClockwise=$};Vo.prototype=Np(Zd),Vo.prototype.getPoint=function(V){var G,T=this.aEndAngle-this.aStartAngle;0>T&&(T+=s),T>s&&(T-=s),G=this.aClockwise===!0?this.aEndAngle+(1-V)*(s-T):this.aStartAngle+V*T;var _=this.aX+this.xRadius*K(G),J=this.aY+this.yRadius*z(G);return new Ac(_,J)};var Ll=function(x,W){this.v1=x,this.v2=W},Lk=Ll.prototype=Np(Zd);Lk.getPoint=function(T){var g=this.v2.clone().sub(this.v1);return g.multiplyScalar(T).add(this.v1),g},Lk.getPointAt=function(W){return this.getPoint(W)},Lk.getTangent=function(){var l=this.v2.clone().sub(this.v1);return l.normalize()};var rp=function(e,h,s){this.v0=e,this.v1=h,this.v2=s};rp.prototype=Np(Zd),rp.prototype.getPoint=function(y){var $,l;return $=Dn.b2(y,this.v0.x,this.v1.x,this.v2.x),l=Dn.b2(y,this.v0.y,this.v1.y,this.v2.y),new Ac($,l)};var po=function(d,e,w,f){this.v0=d,this.v1=e,this.v2=w,this.v3=f};po.prototype=Np(Zd),po.prototype.getPoint=function(p){var F,H;return F=Dn.b3(p,this.v0.x,this.v1.x,this.v2.x,this.v3.x),H=Dn.b3(p,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Ac(F,H)},yp.create(function(Q,f){this.v1=Q,this.v2=f},function(Z){var R=new $k;return R.subVectors(this.v2,this.v1),R.multiplyScalar(Z),R.add(this.v1),R});var tl=yp.create(function(T,u,Y){this.v0=T,this.v1=u,this.v2=Y},function(x){var e,Y,d;return e=Dn.b2(x,this.v0.x,this.v1.x,this.v2.x),Y=Dn.b2(x,this.v0.y,this.v1.y,this.v2.y),d=Dn.b2(x,this.v0.z,this.v1.z,this.v2.z),new $k(e,Y,d)}),Zr=yp.create(function(P,K,X,m){this.v0=P,this.v1=K,this.v2=X,this.v3=m},function(d){var v,n,m;return v=Dn.b3(d,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=Dn.b3(d,this.v0.y,this.v1.y,this.v2.y,this.v3.y),m=Dn.b3(d,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new $k(v,n,m)}),Yo=function(w,S,f,C,t,N,L,u){fp.call(this),C=C!==c?C:.5,t=t!==c?t:.5,u=u!==c?u:1,w=w||8,N=N||0,L=L||s;var Q,M,e=1,x=u/2,Z=[],o=[],H=this.vertices,U=this.faces,v=this.faceVertexUvs;for(M=0;e>=M;M++){var O=[],b=[],X=M/e,q=X*(t-C)+C;for(Q=0;w>=Q;Q++){var Y=Q/w,A=new $k,B=-(Y*L+N);A.z=q*z(B),A.y=-X*u+x,A.x=q*K(B),H.push(A),O.push(H.length-1),b.push(new Ac(Y,X))}Z.push(O),o.push(b)}var p,d,R=(t-C)/u;for(Q=0;w>Q;Q++)for(0!==C?(p=H[Z[0][Q]].clone(),d=H[Z[0][Q+1]].clone()):(p=H[Z[1][Q]].clone(),d=H[Z[1][Q+1]].clone()),p.setY(V(p.x*p.x+p.z*p.z)*R).normalize(),d.setY(V(d.x*d.x+d.z*d.z)*R).normalize(),M=0;e>M;M++){var T=Z[M][Q],P=Z[M+1][Q],F=Z[M+1][Q+1],J=Z[M][Q+1],W=p.clone(),l=p.clone(),G=d.clone(),I=d.clone(),_=o[M][Q].clone(),m=o[M+1][Q].clone(),D=o[M+1][Q+1].clone(),k=o[M][Q+1].clone();U.push(new ae(T,P,J,[W,l,I])),v[0].push([_,m,k]),U.push(new ae(P,F,J,[l.clone(),G,I.clone()])),v[0].push([m.clone(),D,k.clone()])}if(S&&C>0)for(this.vertices.push(new $k(0,x,0)),Q=0;w>Q;Q++){var T=Z[0][Q],P=Z[0][Q+1],F=this.vertices.length-1,W=new $k(0,1,0),l=new $k(0,1,0),G=new $k(0,1,0),_=o[0][Q].clone(),m=o[0][Q+1].clone(),D=new Ac(m.x,0);U.push(new ae(T,P,F,[W,l,G],null,1));var y=Q/w*s,r=K(y),h=z(y),E=(Q+1)/w*s,n=K(E),j=z(E);v[0].push([new Ac(.5+.5*r,.5+.5*h),new Ac(.5+.5*n,.5+.5*j),new Ac(.5,.5)])}if(f&&t>0)for(this.vertices.push(new $k(0,-x,0)),Q=0;w>Q;Q++){var T=Z[M][Q+1],P=Z[M][Q],F=H.length-1,W=new $k(0,-1,0),l=new $k(0,-1,0),G=new $k(0,-1,0),_=o[M][Q+1].clone(),m=o[M][Q].clone();U.push(new ae(T,P,F,[W,l,G],null,2));var y=Q/w*s,r=K(y),h=z(y),E=(Q+1)/w*s,n=K(E),j=z(E);v[0].push([new Ac(.5+.5*n,.5-.5*j),new Ac(.5+.5*r,.5-.5*h),new Ac(.5,.5)])}};Yo.prototype=Np(mj);var jn=function(U,R,a,j,M,B,$){fp.call(this),$=$||.5,U=U||16,R=R||16,a=(a!==c?a:0)-v,j=j!==c?j:s,M=M!==c?M:0,B=B!==c?B:v;var e,i,Y=[],t=[],L=this.vertices,l=this.faces,V=this.faceVertexUvs;for(i=0;R>=i;i++){var E=[],b=[];for(e=0;U>=e;e++){var H=e/U,p=i/R,o=new $k;o.x=-$*K(a+H*j)*z(M+p*B),o.y=$*K(M+p*B),o.z=$*z(a+H*j)*z(M+p*B),L.push(o),E.push(L.length-1),b.push(new Ac(H,p))}Y.push(E),t.push(b)}for(i=0;R>i;i++)for(e=0;U>e;e++){var h=Y[i][e+1],T=Y[i][e],P=Y[i+1][e],Z=Y[i+1][e+1],W=L[h].clone().normalize(),Q=L[T].clone().normalize(),D=L[P].clone().normalize(),F=L[Z].clone().normalize(),n=t[i][e+1].clone(),k=t[i][e].clone(),O=t[i+1][e].clone(),w=t[i+1][e+1].clone();C(L[h].y)===$?(n.x=(n.x+k.x)/2,l.push(new ae(h,P,Z,[W,D,F])),V[0].push([n,O,w])):C(L[P].y)===$?(O.x=(O.x+w.x)/2,l.push(new ae(h,T,P,[W,Q,D])),V[0].push([n,k,O])):(l.push(new ae(h,T,Z,[W,Q,F])),V[0].push([n,k,w]),l.push(new ae(T,P,Z,[Q.clone(),D,F.clone()])),V[0].push([k.clone(),O,w.clone()]))}};jn.prototype=Np(mj);var pj=function(k,f,J,G,i,S){fp.call(this),k=k||.33,f=f||.17,G=G||8,J=J||6,i=i||0,S=S||s;for(var L=new $k,V=[],p=[],e=0;G>=e;e++)for(var W=e/G*s+v,r=0;J>=r;r++){var E=r/J*S+i;L.x=k*K(E),L.z=-k*z(E);var j=new $k,Y=k+f*K(W);j.x=Y*K(E),j.z=-Y*z(E),j.y=f*z(W),this.vertices.push(j),V.push(new Ac(r/J,1-e/G)),p.push(j.clone().sub(L).normalize())}for(var e=1;G>=e;e++)for(var r=1;J>=r;r++){var X=(J+1)*e+r-1,m=(J+1)*(e-1)+r-1,x=(J+1)*(e-1)+r,g=(J+1)*e+r,o=new ae(X,m,g,[p[X].clone(),p[m].clone(),p[g].clone()]);this.faces.push(o),this.faceVertexUvs[0].push([V[X].clone(),V[m].clone(),V[g].clone()]),o=new ae(m,x,g,[p[m].clone(),p[x].clone(),p[g].clone()]),this.faces.push(o),this.faceVertexUvs[0].push([V[m].clone(),V[x].clone(),V[g].clone()])}this.computeFaceNormals()};pj.prototype=Np(mj);var Wi=function(j,a,e){return j?(fp.call(this),j=j instanceof Array?j:[j],this.addShapeList(j,a),a.convertYZ!==!1&&Tc(this,e),this.computeFaceNormals(),void 0):(j=[],void 0)},Mq=Wi.prototype=Np(fp.prototype);Mq.addShapeList=function(I,o){for(var R=I.length,E=0;R>E;E++){var i=I[E];this.addShape(i,o)}},Mq.addShape=function(A,z){function v(){if(z.bottom)for(var a=0;l>a;a++)F=K[a],y(F[2],F[1],F[0],!0);if(z.top)for(a=0;l>a;a++)F=K[a],y(F[0]+C*e,F[1]+C*e,F[2]+C*e,!1)}function I(){var Y=0;for(W(i,Y),Y+=i.length,J=0,x=Z.length;x>J;J++)L=Z[J],W(L,Y),Y+=L.length}function W(E,o){for(var v,h,w=E.length;--w>=0;){v=w,h=w-1,0>h&&(h=E.length-1);var N=0,O=e;for(N=0;O>N;N++){var F=C*N,D=C*(N+1),S=o+v+F,L=o+h+F,l=o+h+D,K=o+v+D;G(S,L,l,K,E,N,O,v,h)}}}function n(G,u,f){X.vertices.push(new $k(G,u,f))}function y(g,y,v,C){g+=p,y+=p,v+=p,X.faces.push(new ae(g,y,v,null,null,C?2:1));var S=C?m.generateBottomUV(X,A,z,g,y,v):m.generateTopUV(X,A,z,g,y,v);X.faceVertexUvs[0].push(S)}function G(n,y,W,R,U,M,t,L,Z){n+=p,y+=p,W+=p,R+=p,X.faces.push(new ae(n,y,R)),X.faces.push(new ae(y,W,R));var Y=m.generateSideWallUV(X,A,U,z,n,y,W,R,M,t,L,Z);X.faceVertexUvs[0].push([Y[0],Y[1],Y[3]]),X.faceVertexUvs[0].push([Y[1],Y[2],Y[3]])}var E,M,h,q,g,O=z.amount,T=z.curveSegments||Oo,e=z.steps||1,w=z.extrudePath,N=!1,m=new ti(z.repeatUVLength,z.boundingBox);w&&(E=w.getSpacedPoints(e),N=!0,M=z.frames!==c?z.frames:new kr.FrenetFrames(w,e,!1),h=new $k,q=new $k,g=new $k);var L,J,x,X=this,p=this.vertices.length,B=A.extractPoints(T),j=B.shape,Z=B.holes,k=!Dn.isClockWise(j);if(k){for(j=j.reverse(),J=0,x=Z.length;x>J;J++)L=Z[J],Dn.isClockWise(L)&&(Z[J]=L.reverse());k=!1}var K=Dn.triangulateShape(j,Z),i=j;for(J=0,x=Z.length;x>J;J++)L=Z[J],j=j.concat(L);for(var r,F,C=j.length,l=K.length,D=0;C>D;D++)r=j[D],N?(q.copy(M.normals[0]).multiplyScalar(r.x),h.copy(M.binormals[0]).multiplyScalar(r.y),g.copy(E[0]).add(q).add(h),n(g.x,g.y,g.z)):n(r.x,r.y,0);var U;for(U=1;e>=U;U++)for(D=0;C>D;D++)r=j[D],N?(q.copy(M.normals[U]).multiplyScalar(r.x),h.copy(M.binormals[U]).multiplyScalar(r.y),g.copy(E[U]).add(q).add(h),n(g.x,g.y,g.z)):n(r.x,r.y,O/e*U);v(),I()};var kr=function(u,N,q,W,Y){function x(Y,l,L){return n.vertices.push(new $k(Y,l,L))-1}fp.call(this),N=N||64,q=q||1,W=W||8,Y=Y||!1;var X,E,G,h,r,I,H,S,T,Q,J,D,g,l,P,o,$,w,_,B,F=[],n=this,m=N+1,V=new $k,C=new kr.FrenetFrames(u,N,Y),Z=C.tangents,M=C.normals,U=C.binormals;for(this.tangents=Z,this.normals=M,this.binormals=U,T=0;m>T;T++)for(F[T]=[],h=T/(m-1),S=u.getPointAt(h),X=Z[T],E=M[T],G=U[T],Q=0;W>Q;Q++)r=Q/W*s,I=-q*K(r),H=q*z(r),V.copy(S),V.x+=I*E.x+H*G.x,V.y+=I*E.y+H*G.y,V.z+=I*E.z+H*G.z,F[T][Q]=x(V.x,V.y,V.z);for(T=0;N>T;T++)for(Q=0;W>Q;Q++)J=Y?(T+1)%N:T+1,D=(Q+1)%W,g=F[T][Q],l=F[J][Q],P=F[J][D],o=F[T][D],$=new Ac(T/N,Q/W),w=new Ac((T+1)/N,Q/W),_=new Ac((T+1)/N,(Q+1)/W),B=new Ac(T/N,(Q+1)/W),this.faces.push(new ae(g,l,o)),this.faceVertexUvs[0].push([$,w,B]),this.faces.push(new ae(l,P,o)),this.faceVertexUvs[0].push([w.clone(),_,B.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};kr.prototype=Np(mj),kr.FrenetFrames=function(X,i,H){function A(){B[0]=new $k,J[0]=new $k,b=Number.MAX_VALUE,u=C(r[0].x),h=C(r[0].y),W=C(r[0].z),b>=u&&(b=u,y.set(1,0,0)),b>=h&&(b=h,y.set(0,1,0)),b>=W&&y.set(0,0,1),S.crossVectors(r[0],y).normalize(),B[0].crossVectors(r[0],S),J[0].crossVectors(r[0],B[0])}var L,b,u,h,W,m,d,y=new $k,r=[],B=[],J=[],S=new $k,Z=new ab,D=i+1,V=1e-4;for(this.tangents=r,this.normals=B,this.binormals=J,m=0;D>m;m++)d=m/(D-1),r[m]=X.getTangentAt(d),r[m].normalize();for(A(),m=1;D>m;m++)B[m]=B[m-1].clone(),J[m]=J[m-1].clone(),S.crossVectors(r[m-1],r[m]),S.length()>V&&(S.normalize(),L=l(qg(r[m-1].dot(r[m]),-1,1)),B[m].applyMatrix4(Z.makeRotationAxis(S,L))),J[m].crossVectors(r[m],B[m]);if(H)for(L=l(qg(B[0].dot(B[D-1]),-1,1)),L/=D-1,r[0].dot(S.crossVectors(B[0],B[D-1]))>0&&(L=-L),m=1;D>m;m++)B[m].applyMatrix4(Z.makeRotationAxis(r[m],L*m)),J[m].crossVectors(r[m],B[m])};var Um=function(g,d,D,X){fp.call(this),d=d||18,D=D||0,X=X==Z?s:X;for(var N=1/(g.length-1),M=1/d,T=0,i=d;i>=T;T++)for(var L=D+T*M*X,j=K(L),l=z(L),p=0,x=g.length;x>p;p++){var V=g[p],o=new $k;o.x=j*V.x-l*V.y,o.y=l*V.x+j*V.y,o.z=V.z,this.vertices.push(o)}for(var c=g.length,T=0,i=d;i>T;T++)for(var p=0,x=g.length-1;x>p;p++){var q=p+c*T,G=q,k=q+c,j=q+1+c,e=q+1,O=T*M,R=p*N,B=O+M,f=R+N;this.faces.push(new ae(G,e,k)),this.faceVertexUvs[0].push([new Ac(O,R),new Ac(O,f),new Ac(B,R)]),this.faces.push(new ae(k,e,j)),this.faceVertexUvs[0].push([new Ac(B,R),new Ac(O,f),new Ac(B,f)])}this.mergeVertices(),Tc(this),this.computeFaceNormals(),this.computeVertexNormals()};Um.prototype=Np(mj);var Qm=function(t,P){P=P||{};var X=Lq.generateShapes(t,P);P.amount=P.amount!==c?P.amount:.5,P.convertYZ=!1,P.fill!==!1&&(P.bottom=!0,P.top=!0),Wi.call(this,X,P)};Qm.prototype=Np(Mq);var Eq=T.Node=function(){to(Eq,this)},Vf={X:xb,Y:Yn,Z:Qo},Th={X:0,Y:1,Z:2},Zb={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},uk="xzy",nm=function(E,k,Q){if(k){var g=k[0],m=k[1],f=k[2];"xzy"===Q?(Yn(E,m),Qo(E,f),xb(E,g)):"xyz"===Q?(Qo(E,f),Yn(E,m),xb(E,g)):"yxz"===Q?(Qo(E,f),xb(E,g),Yn(E,m)):"yzx"===Q?(xb(E,g),Qo(E,f),Yn(E,m)):"zxy"===Q?(Yn(E,m),xb(E,g),Qo(E,f)):"zyx"===Q?(xb(E,g),Yn(E,m),Qo(E,f)):(Yn(E,m),Qo(E,f),xb(E,g))}};is("Node",Od,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:uk,_64O:0,_rotationX:0,_53O:0,_host:Z,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Mp},_22Q:function(){return Ks},getX:function(){return this.p().x},setX:function(u){this.p(u,this.p().y)},getY:function(){return this.p().y},setY:function(m){this.p(this.p().x,m)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(n){this.setAnchor(n,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(y){this.setAnchor(this.getAnchor().x,y)},getScaleX:function(){return this.getScale().x},setScaleX:function(n){this.setScale(n,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(Q){this.setScale(this.getScale().x,Q)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(S){var D=(new Lc).setFromQuaternion(S,Lc.ReverseOrder(this.getRotationMode()));return this.r3(D.x,D.y,D.z)},getQuaternion:function(){var R=new Lc,M=new Lc,d=new oc;return function(x){return x||(x=new oc),this.getEuler(R),R.equals(M)?x.copy(d):x.copy(d.setFromEuler(M.copy(R)))}}(),getEuler:function(H){var y=this.r3();return H||(H=new Lc),H.set(y[0],y[1],y[2],Lc.ReverseOrder(this.getRotationMode()))},setEuler:function(g){return g=g.clone().reorder(Lc.ReverseOrder(this.getRotationMode())),this.r3(g.x,g.y,g.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(n,K){oi(n,Vh(Z,Z,this.r3(),this.getRotationMode())),this.translate3d(n[0]*K,n[1]*K,n[2]*K)},translateFront:function(A){this.translate3dBy([0,0,1],A)},translateBack:function(o){this.translate3dBy([0,0,-1],o)},translateLeft:function(k){this.translate3dBy([-1,0,0],k)},translateRight:function(F){this.translate3dBy([1,0,0],F)},translateTop:function(n){this.translate3dBy([0,1,0],n)},translateBottom:function(D){this.translate3dBy([0,-1,0],D)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(H,U,q){1===arguments.length&&(U=H[1],q=H[2],H=H[0]),this.p(H,q),this.setElevation(U)},translate3d:function(g,D,y){1===arguments.length&&(D=g[1],y=g[2],g=g[0]),this.translate(g,y),this.setElevation(this._54O+D)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(e,n,v){1===arguments.length&&(n=e[1],v=e[2],e=e[0]),this.setSize(e,v),this.setTall(n)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(r,q,H){1===arguments.length&&(q=r[1],H=r[2],r=r[0]),this.setRotationX(r),this.setRotation(-q),this.setRotationZ(H)},setRotationY:function(H){this.setRotation(-H)},getRotationY:function(){return-this._64O},lookAtDirection:function(X,w){w=w||qn;var i=this,m=Yf(X);w===qn?(i.r3([-f(X[1]/m),-Nh(X[2],X[0])+So,0]),i.setRotationMode("xzy")):w===ij?(i.r3(0,-Nh(X[2],X[0]),f(X[1]/m)),i.setRotationMode("zyx")):w===Cl?(i.r3(0,-Nh(X[2],X[0])+v,-f(X[1]/m)),i.setRotationMode("zyx")):w===Vl?(i.r3([-f(X[1]/m)+So,-Nh(X[2],X[0])+So,0]),i.setRotationMode("xzy")):w===mf&&(i.r3([-f(X[1]/m)-So,-Nh(X[2],X[0])+So,0]),i.setRotationMode("xzy")),w===Kf&&(i.r3([-f(X[1]/m)+v,-Nh(X[2],X[0])+So,v]),i.setRotationMode("zxy"))},lookAt:function(U,j){return this.lookAtDirection($i(U,this.p3()),j)},lookAtX:function(){var q=new Xc,g=new Xc,o=new Xc,A=new ab,l=new ab,y=new Lc;return function(w,h){var F=$l(this);if(A.fromArray(F),o.copy(this.p3()),q.copy(w).sub(o),!(q.lengthSq()<1e-6)){q.normalize(),h===qn?g.set(0,0,1):h===Kf?g.set(0,0,-1):h===Cl?g.set(-1,0,0):h===ij?g.set(1,0,0):h===Vl?g.set(0,1,0):h===mf&&g.set(0,-1,0),g.applyMatrix4(A).sub(o).normalize();var t=Math.acos(q.dot(g));if(t){var _=q.clone().cross(g);_.lengthSq()<1e-6&&(h===Vl||h===mf?_.set(0,0,1).applyMatrix4(A).sub(o):_.set(0,1,0).applyMatrix4(A).sub(o)),_.normalize(),y.set(this.r3(),this.getRotationMode(),!0),A.makeRotationFromEuler(y),l.makeRotationAxis(_,-t),y.setFromRotationMatrix(l.multiply(A)),this.r3([y.x,y.y,y.z])}}}}(),getHost:function(){return this._host},setHost:function(_){var q=this;if(q!==_&&q._host!==_){var g=q._host;g&&(g._removeAttach(q),g.updateLayoutAttaches()),q._host=_,q._host&&(q._host._addAttach(q),q._host.updateLayoutAttaches()),q.fp("host",g,_),q.onHostChanged(g,_)}},getAttaches:function(){return this._69O},_addAttach:function(e){var H=this;H._69O||(H._69O=new Dd),H._69O.add(e),H.fp("attaches",Z,e)},_removeAttach:function(p){var L=this;L._69O.remove(p),L._69O.isEmpty()&&delete L._69O,L.fp("attaches",p,Z)},getImage:function(){if(this._pendingCheckImageJSON){var l=L.getImage(this._image);l&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof en&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(_){var H=this,f=H._image,X=H.getWidth(),j=H.getHeight();H._image=_,H.fp("image",f,_)&&(null!=_&&(Ue(_)||em(_)&&/\.json$/i.test(_))&&(this._pendingCheckImageJSON=!0),H.fp(zp,X,H.getWidth()),H.fp(Sn,j,H.getHeight()))},getElevation:function(){return this._54O},setElevation:function(n){var P=this;if(!P._50O){P._50O=1;var M=P._54O;P._54O=n,P.fp(bc,M,n),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(J){var i=this;if(!i._49O){i._49O=1;var Z=i._64O;i._64O=J,i.fp(mp,Z,J),delete i._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(F){var G=this;if(!G._51O){G._51O=1;var I=G._rotationX;G._rotationX=F,G.fp("rotationX",I,F),delete G._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(R){var l=this;if(!l._52O){l._52O=1;var D=l._53O;l._53O=R,l.fp("rotationZ",D,R),delete l._52O}},getPosition:function(){return this._position},setPosition:function(d,t){var O=this;if(!O._50I){O._50I=1;var q;if(q=2===arguments.length?{x:d,y:t}:d,q.x!==O._position.x||q.y!==O._position.y){var Z=O._position;O._position=q,O.fp(yg,Z,q)}delete O._50I}},translate:function(h,g){var m=this._position;this.p(m.x+h,m.y+g)},getWidth:function(){var x=this;if(x._width>=0)return x._width;var Q=x.getStyle("shape3d");if(Q){var n=Xh(Q);if(n&&n.rawS3)return n.rawS3[0];if("billboard"===Q||"plane"===Q){var O=qh(x.getStyle("shape3d.image"));return O?Vk(O,x):20}}var O=qh(x._image);return O?Vk(O,x):20},setWidth:function(z){var n=this,P=n._width;n._width=z,n.fp(zp,P,z)},getHeight:function(){var d=this;if(d._height>=0)return d._height;var c=d.getStyle("shape3d");if(c){var Z=Xh(c);if(Z&&Z.rawS3)return Z.rawS3[2];if("plane"===c){var m=qh(d.getStyle("shape3d.image"));return m?xl(m,d):20}if("billboard"===c)return 2}var m=qh(d._image);return m?xl(m,d):20},setHeight:function(T){var h=this,D=h._height;h._height=T,h.fp(Sn,D,T)},getTall:function(){var k=this;if(k._tall>=0)return k._tall;var s=k.getStyle("shape3d");if(s){var J=Xh(s);if(J&&J.rawS3)return J.rawS3[1];if("billboard"===s){var C=qh(k.getStyle("shape3d.image"));return C?xl(C,k):20}if("plane"===s)return 2}return 20},setTall:function(c){var l=this,H=l._tall;l._tall=c,l.fp("tall",H,c)},setSize:function(R,T){var M=this;2===arguments.length?(M.setWidth(R),M.setHeight(T)):(M.setWidth(R.width),M.setHeight(R.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(S,T,P,f,K){var y=this,v=y.getAnchor(),w=y.getScale();arguments.length<=2&&(K=T,T=S.y,P=S.width,f=S.height,S=S.x);var q=K&&w.x<0?1-v.x:v.x,R=K&&w.y<0?1-v.y:v.y;y.p(S+P*q,T+f*R),K&&(P/=Math.abs(w.x),f/=Math.abs(w.y)),y.setWidth(P),y.setHeight(f)},getMatrix:function(){var H=this,v=H._64O,W=H._position,_=H.getScale();return new qe(v,W.x,W.y,_.x,_.y)
},getMatrix4:function(){var s=new Xc,l=new oc,f=new Xc;return function(X){return this.getQuaternion(l),s.copy(this.p3()),f.copy(this.getFinalScale3d()),X||(X=new ab),X.compose(s,l,f)}}(),getAnchorRect:function(){var G=this,R=G.getWidth(),m=G.getHeight(),r=G.getAnchor();return{x:-R*r.x,y:-m*r.y,width:R,height:m}},toLocal:function(G){return this.getMatrix().tfi(G)},toGlobal:function(K){return this.getMatrix().tf(K)},getAttachPosition:function(){var Y=new qe;return function(p,T,_,O){_=_||0,O=O||0;var q=this,n=q.getAnchor(),x=q._64O,N=q._position,j=q.getScale();return Y.setFromTransform(x,N.x,N.y).tf({x:_+j.x*q.getWidth()*(p-n.x),y:O+j.y*q.getHeight()*(T-n.y)})}}(),isInRect:function(x){x=this.toLocal(x);var I=this.getWidth(),y=this.getHeight();return x.x+=I*this.getAnchorX(),x.y+=y*this.getAnchorY(),!(x.x<0||x.y<0||x.x>I||x.y>y)},getRect:function(){var P=this,H=P.getWidth(),U=P.getHeight(),z=P.getAnchor(),V={x:-H*z.x,y:-U*z.y,width:H,height:U},h=P.getMatrix();return V=An([h.tf(V.x,V.y),h.tf(V.x+V.width,V.y),h.tf(V.x+V.width,V.y+V.height),h.tf(V.x,V.y+V.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var W=this,k=W.getAnchor(),$=W._anchorElevation;return{x:k.x,y:$,z:k.y}},setAnchorElevation:function(n){var I=this,X=I._anchorElevation;return X!==n?(I._anchorElevation=n,I.fp("anchorElevation",X,n),!0):!1},setAnchor3d:function(J,L,R,h){var g,j=this;"number"==typeof J?g={x:J,y:L,z:R}:(g=J.length?{x:J[0],y:J[1],z:J[2]}:J,h=L);var f=j.getDataModel();f&&f.beginTransaction();var Z=j.getAnchor3d(),l=j.setAnchor(g.x,g.z);if(j.setAnchorElevation(g.y)&&(l=!0),l&&h&&!Sq){j.getAnchor3d();var W=$l(j),d=oi([g.x-Z.x,g.y-Z.y,g.z-Z.z],W);j.p3(d)}return f&&f.endTransaction(),l},getAnchor:function(){var E=this;if(E.hasOwnProperty("_anchor"))return E._anchor;var R=qh(E._image);return R&&R.anchorX!==c?{x:R.anchorX,y:R.anchorY}:E._anchor},setAnchor:function(n,f,r){var A,B=this;"number"==typeof n?A={x:n,y:f}:(A=n.length?{x:n[0],y:n[1]}:n,r=f);var e=B.getAnchor();if(e.x!==A.x||e.y!==A.y){var C=B.getDataModel();if(C&&C.beginTransaction(),B._anchor=A,B.fp("anchor",e,A),r&&!Sq){var V=B.getPosition(),O=B.getSize(),M=B.getRotation(),p=B.getScale(),i=-O.width*(e.x-A.x)*p.x,m=-O.height*(e.y-A.y)*p.y,s=z(M),q=K(M);B.setPosition(V.x+q*i-s*m,V.y+s*i+q*m)}return C&&C.endTransaction(),!0}return!1},getLocalQuaternion:function(V){var A=this,M=A.getHost();if(!M)return A.getQuaternion(V);var P=M.getQuaternion(),h=A.getQuaternion();return V||(V=new oc),V.copy(P).inverse().multiply(h)},setLocalQuaternion:function(w){var X=this,c=X.getHost();if(!c)return X.setQuaternion(w);var A=c.getQuaternion();X.setQuaternion(A.clone().multiply(w))},getLocalEuler:function(){var P=new oc;return function(q){var Q=this,S=Q.getHost();return S?(Q.getLocalQuaternion(P),q||(q=new Lc),q.setFromQuaternion(P,Lc.ReverseOrder(this.getRotationMode()))):Q.getEuler(q)}}(),setLocalEuler:function(){var y=new oc;return function(q){var k=this,b=k.getHost();return b?(y.setFromEuler(q),k.setLocalQuaternion(y)):k.setEuler(q)}}(),getLocalPosition3d:function(j){var Q=this;j||(j=new Xc),j.copy(Q.p3());var D=Q.getHost();if(!D)return j;var X=D.getMatrix4();return j.applyMatrix4(X.getInverse(X))},setLocalPosition3d:function(p){var r=this,m=r.getHost();if(!m)return p.x!==c?r.p3(p.x,p.y,p.z):r.p3(p),void 0;var X=m.getMatrix4(),S=new Xc(p);S.applyMatrix4(X),r.p3(S.x,S.y,S.z)},getScale:function(){return this._scale},setScale:function(Z,M){var m,T=this;m=2===arguments.length?{x:Z,y:M}:Z;var V=T.getScale();(V.x!==m.x||V.y!==m.y)&&(T._scale=m,T.fp("scale",V,m))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var s=this,X=s._scaleTall,g=s.getScale();return[g.x,X,g.y]},getFinalScale3d:function(){var f=this,V=f.s3(),l=f._dynamicScale3d,n=f.getScale3d();return V&&(n[0]*=V[0],n[1]*=V[1],n[2]*=V[2]),l&&(n[0]*=l[0],n[1]*=l[1],n[2]*=l[2]),n},getFinalRotation3d:function(){var r=this;return r._dynamicRotation||r.r3()},setScaleTall:function(J){var d=this,l=d._scaleTall;l!==J&&(d._scaleTall=J,d.fp("scaleTall",l,J))},setScale3d:function(s,J,V){var v,b=this;v="number"==typeof s?{x:s,y:J,z:V}:s.length?{x:s[0],y:s[1],z:s[2]}:s,b.setScaleTall(v.y),b.setScale(v.x,v.z)},getCorners:function(e,J){e==Z&&(e=0),J==Z&&(J=e);var I=this,B=I.getAnchor(),v=I.getWidth(),g=I.getHeight(),i=-v*B.x-e,r=-g*B.y-J,m=v+2*e,C=g+2*J,q=I.getMatrix();return[q.tf(i,r),q.tf(i,r+C),q.tf(i+m,r+C),q.tf(i+m,r)]},getEditControlPoints:function(y,N,j){N==Z&&(N=0),j==Z&&(j=N);var H=this,c=H.getAnchor(),X=H.getWidth(),S=H.getHeight(),a=-X*c.x-N,B=-S*c.y-j,u=X+2*N,l=S+2*j;if(y)return[{x:a,y:B},{x:a,y:0},{x:a,y:B+l},{x:0,y:B+l},{x:a+u,y:B+l},{x:a+u,y:0},{x:a+u,y:B},{x:0,y:B}];var G=H.getMatrix();return[G.tf(a,B),G.tf(a,0),G.tf(a,B+l),G.tf(0,B+l),G.tf(a+u,B+l),G.tf(a+u,0),G.tf(a+u,B),G.tf(0,B)]},rotateAt:function(J,t,s){var p=this,m=p._position,g=p._64O,T=new qe(g,m.x,m.y).tf(J,t),v=V(J*J+t*t),d=Nh(m.y-T.y,m.x-T.x)+s;p.setRotation(g+s),p.p(T.x+v*K(d),T.y+v*z(d))},onParentChanged:function(){Eq.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var k={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(F){k[F]=!0}),function(m){var F=this;if(Eq.superClass.onPropertyChanged.call(F,m),k[m.property]&&!F._layoutUpdating&&F.updateLayoutParameters(null,m.property),F._69O&&F._69O.each(function(E){E.handleHostPropertyChange(m)}),F._49I&&F._49I.each(function(e){e.fp("agentChange",!0,!1)}),Ln[m.property]&&this.updateLayoutAttaches(),"a:layout"===m.property.substring(0,8)){this.updateLayoutAttaches();var B=F._host;B&&B.updateLayoutAttaches()}}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(D){this.updateAttach(D)},onStyleChanged:function(X){Eq.superClass.onStyleChanged.apply(this,arguments),Wg[X]&&this.updateAttach()},updateLayoutAttaches:function(){var b,Q,F=this;return b=qh(F.getImage()),b&&b.layoutAttach&&(Q=b.layoutAttach,Q&&Q(F))?!0:void 0},updateAttach:function(e){var b=this;return Sq?(b.updateLayoutParameters(),void 0):(b._51I||(b._51I=1,b._71O(e),delete b._51I),void 0)},_71O:function(Y){var J,Q,F,K,r,g,n=this,W=n._host,M=Y?Y.property:Z,k=Y?Y.oldValue:Z,t=Y?Y.newValue:Z;if(W instanceof Eq&&(!Y||Ln[M])){var O;if(O=qh(W.getImage()),O&&O.layoutAttach)return}if(W instanceof T.Grid){if(M===bc)n.setElevation(n._54O+t-k);else if(!Y||qm[M]){if(J=n.s("attach.row.index"),Q=n.s("attach.column.index"),F=W.getCellRect(J,Q),!F)return;K=n.s("attach.row.span"),r=n.s("attach.column.span"),(1!==K||1!==r)&&(F=ge(F,W.getCellRect(J+K-1,Q+r-1))),Ig(F,n,"attach.padding",1),n.setRect(F)}}else if(W instanceof jh&&(g=n.s("attach.index"))>=0&&(!Y||ke[M])){var u=n.s("attach.thickness"),$=W.getScale(),e=Math.max($.x,$.y);u>0&&n.setHeight(W.getThickness()*u*e);var j=n.s("attach.offset"),I=W.getPoints(),q=I.size();if(q>g){var C=W.getPointsMatrix2d(),v=I.get(g),B=q===g+1?I.get(0):I.get(g+1);v=C.apply(v),B=C.apply(B);var V=[B.x-v.x,B.y-v.y],s=Yf(V);if(s){n.s("attach.offset.relative")&&(j*=s),n.s("attach.offset.opposite")&&(j=s-j);var l={x:v.x+V[0]/s*j,y:v.y+V[1]/s*j},P=n.s("attach.gap");P&&(n.s("attach.gap.relative")&&(P*=W.getThickness()*e),l=Ab(Z,l,B,P)),n.p(l),n.setRotation(Nh(V[1],V[0]))}}}else Y&&(M===yg?n.translate(t.x-k.x,t.y-k.y):M===bc?n.setElevation(n._54O+t-k):kc[M]?n._11Q(W,M,t-k):("anchor"===M||"width"===M||"height"===M||"scale"===M)&&n.layout(W))},_11Q:function(){var J=new T.Math.Euler,e=T.Math.Euler.ReverseOrder,W=new T.Math.Vector2,k=new T.Math.Vector2;return function(s,Z,V){var B=this,H=s.p3(),p=s.r3(),S=B.p3(),$=B.r3();if(Z===mp&&(Z="rotationY",V=-V),(Z===mp||"rotationY"===Z)&&0===$[0]&&0===$[2]&&0===p[0]&&0===p[2]&&0===S[1]&&0===H[1])return B.setRotation(-$[1]-V),W.set(S[0],S[2]).rotateAround(k.set(H[0],H[2]),-V),B.p(W.x,W.y),void 0;var O=Zb[s.getRotationMode()],r=O[0],x=O[1],D=O[2],K=Vf[r],n=Vf[x],I=Vf[D],F=Bf();Z===mp+r?(I(F,p[Th[D]]),n(F,p[Th[x]]),K(F,V),n(F,-p[Th[x]]),I(F,-p[Th[D]])):Z===mp+x?(I(F,p[Th[D]]),n(F,V),I(F,-p[Th[D]])):Z===mp+D&&I(F,V);var L=$i(S,H);oi(L,F),B.p3(H[0]+L[0],H[1]+L[1],H[2]+L[2]);var X=B.getRotationMode();nm(F,B.r3(),X),J.setFromRotationMatrix(F,e(X)),B.r3([J.x,J.y,J.z])}}(),isHostOn:function(I){var o=this;if(o._host&&I&&I._69O)for(var j={},Y=o._host;Y&&Y!==o&&!j[Y._id];){if(Y===I)return!0;j[Y._id]=Y,Y=Y._host}return!1},isLoopedHostOn:function(S){return this.isHostOn(S)&&S.isHostOn(this)},getScaledSize:function(){var x=this.getSize(),h=this.getScale();return x.width*=Math.abs(h.x),x.height*=Math.abs(h.y),x},layout:function(r){if(r=r||this.getHost()){var W=this,F=W.s("layout.h")||"center",H=W.s("layout.v")||"center";if("center"!==F||"center"!==H){var g=new T.Math.Vector2,N=r.getPosition(),a=r.getAnchor(),o=r.getScaledSize();W.getPosition();var $,k,l,y,w,Q=1,e=1;switch(W._layoutUpdating=!0,F){case"left":g.setX(W._layoutHValue-a.x*o.width);break;case"right":g.setX((1-a.x)*o.width-W._layoutHValue);break;case"leftright":$=o.width-W._layoutHValue[2],l=W.getRotation()-r.getRotation(),y=Math.abs(Math.sin(l)),w=Math.abs(Math.cos(l)),Q+=w*$/W._layoutHValue[3],e+=y*$/W._layoutHValue[4],g.setX(W._layoutHValue[1]+(W._layoutHValue[5]-a.x)*o.width);break;case"center":g.setX((.5-a.x)*o.width-W._layoutHValue);break;case"scale":l=W.getRotation()-r.getRotation(),y=Math.abs(Math.sin(l)),w=Math.abs(Math.cos(l)),g.setX((.5-a.x)*o.width-W._layoutHValue[1]*o.width/W._layoutHValue[0]),k=o.width/W._layoutHValue[2]-1,Q+=w*k,e+=y*k}switch(H){case"top":g.setY(W._layoutVValue-a.y*o.height);break;case"bottom":g.setY((1-a.y)*o.height-W._layoutVValue);break;case"topbottom":l||(l=W.getRotation()-r.getRotation(),y=Math.abs(Math.sin(l)),w=Math.abs(Math.cos(l))),$=o.height-W._layoutVValue[2],Q+=y*$/W._layoutVValue[3],e+=w*$/W._layoutVValue[4],g.setY(W._layoutVValue[1]+(W._layoutVValue[5]-a.y)*o.height);break;case"center":g.setY((.5-a.y)*o.height-W._layoutVValue);break;case"scale":l||(l=W.getRotation()-r.getRotation(),y=Math.abs(Math.sin(l)),w=Math.abs(Math.cos(l))),g.setY((.5-a.y)*o.height-W._layoutVValue[1]*o.height/W._layoutVValue[0]),k=o.height/W._layoutVValue[2]-1,Q+=y*k,e+=w*k}if("leftright"===F||"scale"===F||"topbottom"===H||"scale"===H){var p=this.getScale(),n=Math.abs(p.x),s=Math.abs(p.y);"leftright"===F||"scale"===F?W.setSize(W._layoutHValue[3]*Q/n,W._layoutHValue[4]*e/s):W.setSize(W._layoutVValue[3]*Q/n,W._layoutVValue[4]*e/s)}g.rotateAround(null,r.getRotation()),this.setPosition(g.x+N.x,g.y+N.y),W._layoutUpdating=c}}},updateLayoutParameters:function(d,l){if(d=d||this.getHost()){var q=this,m=q.s("layout.h"),g=q.s("layout.v");if(m||g){var C,X,i,u,z,j,L=new T.Math.Vector2,E=d.getPosition(),b=d.getAnchor(),v=d.getScaledSize(),s=q.getPosition(),G=q.getScaledSize();switch(L.set(s.x-E.x,s.y-E.y),L.rotateAround(null,-d.getRotation()),m){case"left":q._layoutHValue=L.x+b.x*v.width;break;case"right":q._layoutHValue=-L.x+(1-b.x)*v.width;break;case"center":q._layoutHValue=-L.x+(.5-b.x)*v.width;break;case"leftright":case"scale":"scale"===m?C=-L.x+(.5-b.x)*v.width:(X=q.getAnchor(),i=q.getRotation()-d.getRotation(),u=Math.cos(i),z=Math.sin(i),j=-Math.min(-X.x*u+X.y*z,-X.x*u-(1-X.y)*z,(1-X.x)*u+X.y*z,(1-X.x)*u-(1-X.y)*z),C=L.x-(j-b.x)*v.width),"position"===l&&"object"==typeof q._layoutHValue?(q._layoutHValue[0]=v.width,q._layoutHValue[1]=C):q._layoutHValue=[v.width,C,v.width,G.width,G.height,j]}switch(g){case"top":q._layoutVValue=L.y+b.y*v.height;break;case"bottom":q._layoutVValue=-L.y+(1-b.y)*v.height;break;case"center":q._layoutVValue=-L.y+(.5-b.y)*v.height;break;case"topbottom":case"scale":"scale"===g?C=-L.y+(.5-b.y)*v.height:(i||(X=q.getAnchor(),i=q.getRotation()-d.getRotation(),u=Math.cos(i),z=Math.sin(i)),j=-Math.min(-X.x*z-X.y*u,-X.x*z+(1-X.y)*u,(1-X.x)*z-X.y*u,(1-X.x)*z+(1-X.y)*u),C=L.y-(j-b.y)*v.height),"position"===l&&"object"==typeof q._layoutVValue?(q._layoutVValue[0]=v.height,q._layoutVValue[1]=C):q._layoutVValue=[v.height,C,v.height,G.width,G.height,j]}}}},getSerializableProperties:function(){var C=Eq.superClass.getSerializableProperties.call(this);return kp(C,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),C}});var os=T.Edge=function(r,k){var c=this;to(os,c),c.setSource(r),c.setTarget(k)};is("Edge",Od,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Zq},_22Q:function(){return Ms},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(e){if(e===this)return!1;if(lm(e))return!0;for(var _,X,b,j,G,q=[this],r=-1,f=0;f>r;)if(r++,_=q[r],X=_._44I)for(X=X.getArray(),j=0,G=X.length;G>j;j++)if(b=X[j],El(b)&&!(q.indexOf(b)>=0)){if(b===e)return!1;q.push(b),f++}return!0},setSource:function(q){var G=this;if(G._source!==q&&G.canSetSourceTarget(q)){var W=G._source;G._source=q,W&&W._16I(G),q&&q._2I(G),G._7I(),G.fp("source",W,q)}},setTarget:function(F){var i=this;if(i._target!==F&&i.canSetSourceTarget(F)){var c=i._target;i._target=F,c&&c._18I(i),F&&F._4I(i),i._7I(),i.fp("target",c,F)}},isLooped:function(){var H=this;return H._source===H._target&&lm(H._source)&&lm(H._target)},onPropertyChanged:function(){var y=this;y._49I&&y._49I.each(function(X){X.fp("agentChange",!0,!1)})},_7I:function(){var P,E=this,O=Zc(E);E._40I!==O&&(P=this._40I,P&&P._15I(E),E._40I=O,O&&O._1I(E),E.fp("sourceAgent",P,O),ed(P,E._41I),ed(O,E._41I));var x=Bi(E);E._41I!==x&&(P=E._41I,P&&P._17I(E),E._41I=x,x&&x._3I(E),E.fp("targetAgent",P,x),ed(P,E._40I),ed(x,E._40I))},_22I:function(e){this._52I=e,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var x=this;return x._52I&&x._52I.get(0)!==x&&!x.getStyle(Bh)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var x=this,V=x._52I;return V&&!x.getStyle(Bh)&&V.size()>1&&x===V.get(0)},toggle:function(){this.beginTransaction();var p=this._52I,Y=!this.s(Bh);p&&p.size()>1&&(p.each(function(W){W.s(Bh,Y)}),p.getSiblings().each(function(l){l!==p&&l.each(function(A){A.fp("edgeGroup",Z,l)})})),this.endTransaction()},setStyle:function(K,E){(K===xi||"edge.segments"===K)&&(E=Vj(E)),os.superClass.setStyle.call(this,K,E)},onStyleChanged:function(c){os.superClass.onStyleChanged.apply(this,arguments),$r[c]&&ed(this._41I,this._40I)},getSerializableProperties:function(){var g=os.superClass.getSerializableProperties.call(this);return kp(g,{source:1,target:1}),g}});var $h=T.Group=function(){to($h,this)};is("Group",Eq,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return ip},onChildAdded:function(){$h.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){$h.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var v=this;if(!v._54I&&!Sq){var b=v.getChildrenRect();b&&(v._53I=1,v.p(Gh(v.s("group.position"),b,v.getSize())),delete v._53I)}},getChildrenRect:function(){var g,D=this;return D.eachChild(function(t){lm(t)&&(g=ge(g,D.getChildRect(t)))}),g},getChildRect:function(c){var O;return lm(c)&&c.s(wg)&&(rj(c)&&c.isExpanded()&&c.eachChild(function(q){O=ge(O,c.getChildRect(q))}),!O&&c.getRect&&(O=c.getRect())),O},setPosition:function(l,O){var I=this;if(!I._54I){var X;X=2===arguments.length?{x:l,y:O}:l,Sq||I._53I||(I._54I=1,Lb(I._children,X.x-I._position.x,X.y-I._position.y),delete I._54I),$h.superClass.setPosition.call(this,X)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(w){var P=this;if(P._57O!==w){var x=P._57O;P._57O=w,P.fp("expanded",x,P._57O),P._fireInvalidateDeep(),P._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(I){rj(I)?I._fireInvalidateDeep():I.iv()})},_8I:function(){$h.superClass._8I.call(this),this.eachChild(function(Q){lm(Q)&&Q._8I()})},onStyleChanged:function(A){$h.superClass.onStyleChanged.apply(this,arguments),"group.position"===A&&this._81I()},getSerializableProperties:function(){var W=$h.superClass.getSerializableProperties.call(this);return W.expanded=1,W}});var Tb=T.Block=function(){to(Tb,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};is("Block",Eq,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return gq},_22Q:function(){return Ls},onChildAdded:function(){Tb.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Tb.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function H(C,Z,i){m.fromArray($l(Z));var E=Z.getAnchor3d();C.push((new Xc).set(0-E.x,0-E.y,0-E.z).applyMatrix4(m).applyMatrix4(i)),C.push((new Xc).set(0-E.x,0-E.y,1-E.z).applyMatrix4(m).applyMatrix4(i)),C.push((new Xc).set(0-E.x,1-E.y,0-E.z).applyMatrix4(m).applyMatrix4(i)),C.push((new Xc).set(0-E.x,1-E.y,1-E.z).applyMatrix4(m).applyMatrix4(i)),C.push((new Xc).set(1-E.x,0-E.y,0-E.z).applyMatrix4(m).applyMatrix4(i)),C.push((new Xc).set(1-E.x,0-E.y,1-E.z).applyMatrix4(m).applyMatrix4(i)),C.push((new Xc).set(1-E.x,1-E.y,0-E.z).applyMatrix4(m).applyMatrix4(i)),C.push((new Xc).set(1-E.x,1-E.y,1-E.z).applyMatrix4(m).applyMatrix4(i))}function s(P,E){var V=(new ab).makeRotationFromEuler(this.getEuler()).setPosition((new Xc).fromArray(this.p3()));V.getInverse(V),P.forEach(function(C){lm(C)&&H(E,C,V)})}var m=new ab;return function(c,d){if(c instanceof Eq&&(c=[c]),!c||0===c.length)return Z;var d=[];s.call(this,c,d);var l=[1/0,1/0,1/0],T=[-1/0,-1/0,-1/0];return d.forEach(function(H){l[0]=Math.min(H.x,l[0]),l[1]=Math.min(H.y,l[1]),l[2]=Math.min(H.z,l[2]),T[0]=Math.max(H.x,T[0]),T[1]=Math.max(H.y,T[1]),T[2]=Math.max(H.z,T[2])}),{min:l,max:T}}}(),updateFromChildren:function(){var r=this;if(!Sq&&!r._updatingToChildren&&r._syncSize&&0!==r.size()&&!r._freezeSyncFromChildren){var P=this._getBoundingBox(r.toChildren(lm));if(P){r._updatingFromChildren=1;var z=(new Xc).fromArray(this.getScale3d()),e=(new Xc).fromArray(P.min),$=(new Xc).fromArray(P.max),W=L.blockMinSize,t=new Xc,U=$.clone().sub(e);0===U.x&&t.setX(.5),0===U.y&&t.setY(.5),0===U.z&&t.setZ(.5);var V=this._width==Z||-1===this._width,c=new Xc(this.getAnchor3d()),o=z.clone().multiply((new Xc).fromArray(this.s3())),w=U.clone();0===w.x&&w.setX(W),0===w.y&&w.setY(W),0===w.z&&w.setZ(W);var F=c.clone().multiply(o),h=F.clone().multiplyScalar(-1).sub(e).divide(w).add(F.divide(w)).add(t),G=this.s("keepPosition");if(V||this._anchorChanged||this._scaleChanged||!G){!V&&G&&(c=h);var A=c.clone().multiply(U).add(e).applyEuler(this.getEuler()).add((new Xc).fromArray(this.p3()));this.p3([A.x,A.y,A.z])}else this.setAnchor3d(h.x,h.y,h.z);var i=new Xc(1,1,1).divide(z).multiply(U);this.s3(Math.abs(i.x),Math.abs(i.y),Math.abs(i.z)),delete r._updatingFromChildren}}},setPosition:function(v,q){var _=this;if(!_._updatingToChildren){var N;N=2===arguments.length?{x:v,y:q}:v,Sq||_._updatingFromChildren||(_._updatingToChildren=1,Lb(_._children,N.x-_._position.x,N.y-_._position.y),delete _._updatingToChildren),Tb.superClass.setPosition.call(this,N)}},setSize3d:function(){this.beginTransaction(),Tb.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(J){var H=this;if(!H._updatingToChildren){this.beginTransaction(),J=$(J,L.blockMinSize);var z=H.getTall();if(J!==z&&Tb.superClass.setTall.call(H,J),!Sq&&!H._updatingFromChildren){H._updatingToChildren=1;var e=J/z;H._adjustChildTallOrScale(e,"size"),delete H._updatingToChildren,H.updateFromChildren()}this.endTransaction()}},setWidth:function(y){return this.setSize(y,this.getHeight())},setHeight:function(h){return this.setSize(this.getWidth(),h)},setSize:function(B,x){var n=L.blockMinSize;B=$(B,n),x=$(x,n);var Q=this;if(!Q._updatingToChildren){2!==arguments.length&&(x=B.height,B=B.width),this.beginTransaction();var o=Q.getWidth(),P=Q.getHeight();if(B!==o&&Tb.superClass.setWidth.call(Q,B),x!==P&&Tb.superClass.setHeight.call(Q,x),!Sq&&!Q._updatingFromChildren){Q._updatingToChildren=1;var Z=B/o,b=x/P;Q._adjustChildScaleOrSize(Z,b,"size"),delete Q._updatingToChildren,Q.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(G,u,k){var c=this;if(c._syncSize){var y=c.getPosition(),L=c.getRotation();c.eachChild(function(c){if(lm(c)){var t=c.getPosition(),N=c.getRotation(),Q=c.getWidth(),E=c.getHeight(),g=c.getScale(),s=g.x*Q,l=g.y*E;if(0!==s&&0!==l){0>G*u&&c.setRotation(-1*N);var S=new qe(N,t.x,t.y,s,l);S.translate(-y.x,-y.y),S.rotate(-L),N=Nh(S.b*Math.sign(s),S.a*Math.sign(s)),S.scale(G,u);var U,C,x,Z=K(N);if(Math.abs(Z)<.001?(U=z(N),C=S.b/U,x=-S.c/U):(C=S.a/Z,x=S.d/Z),"scale"===k)c.setScale(C/Q,x/E);else if("size"===k){var A=C/g.x,$=x/g.y;c.setScale(ns(C)*Math.abs(g.x),ns(x)*Math.abs(g.y)),c instanceof T.Shape?(c.setWidthForce(Math.max(Math.abs(A),1e-5)),c.setHeightForce(Math.max(Math.abs($),1e-5))):c.setSize(Math.max(.01,Math.abs(A)),Math.max(.01,Math.abs($)))}S.rotate(L),S.translate(y.x,y.y),c.setPosition(S.tx,S.ty)}}})}},_calcChangeFactor:function(E,A,i,Z){var u,R,a,N;return u=C(E),R=C(i),a=u>R?u/R:R/u,u=C(A),R=C(Z),N=u>R?u/R:R/u,$(a,N)},setElevation:function(h){var r=this;if(!r._updatingToChildren){var E=r.getElevation(),t=h-E;0!==t&&(Sq||r._updatingFromChildren||(r._updatingToChildren=1,Lb(r._children,0,t,0),delete r._updatingToChildren),Tb.superClass.setElevation.apply(r,arguments))}},setScaleTall:function(l){var n=this;if(!n._updatingToChildren){var a=n.getScaleTall();if(C(l)<.01&&(l=.01*(ns(l)||ns(a))),Tb.superClass.setScaleTall.call(n,l),!Sq&&!n._updatingFromChildren){n._updatingToChildren=1;var R=l/a;n._adjustChildTallOrScale(R,"size"),delete n._updatingToChildren,n._scaleChanged=1,this.updateFromChildren(),delete n._scaleChanged}}},_adjustChildTallOrScale:function(n,l){var k=this;if(k._syncSize){var f=k.getElevation();k.eachChild(function(A){if(lm(A))if("size"===l){var O=A.getTall();0>n&&A.setScaleTall(-1*A.getScaleTall()),A.setTall(Math.max(.01,Math.abs(O*n))),A.setElevation(f+(A.getElevation()-f)*n)}else{var g=A.getScaleTall();A.setScaleTall(g*n)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var B=Tb.superClass.setAnchor3d.apply(this,arguments);return B&&!Sq&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),B}},setAnchor:function(){var s=this;if(!s._updatingToChildren){var Q=s.getAnchor(),B=Tb.superClass.setAnchor.apply(s,arguments);if(Sq||s._updatingFromChildren||!s._syncSize)return B;s._updatingToChildren=1;var n=s.getAnchor();s.getPosition();var k=s.getSize(),i=s.getScale(),P=s.getRotation(),U=-k.width*i.x*(Q.x-n.x),C=-k.height*i.y*(Q.y-n.y),e=z(P),m=K(P),a=m*U-e*C,R=e*U+m*C;return s.eachChild(function(W){if(lm(W)){var F=W.getPosition();W.setPosition(F.x-a,F.y-R)}}),delete s._updatingToChildren,B}},setAnchorElevation:function(){var c=this;if(!c._updatingToChildren){var N=c.getAnchorElevation(),d=Tb.superClass.setAnchorElevation.apply(c,arguments);if(Sq||c._updatingFromChildren||!c._syncSize)return d;c._updatingToChildren=1;var D=c.getAnchorElevation(),B=c.getTall(),E=c.getScaleTall(),Z=-B*E*(N-D);return c.eachChild(function(j){if(lm(j)){var L=j.getElevation();j.setElevation(L-Z)}}),delete c._updatingToChildren,d}},setRotation:function(i){this._updateChildrenRotation3d("rotation",i)},setRotationX:function(N){this._updateChildrenRotation3d("rotationX",N)},setRotationZ:function(V){this._updateChildrenRotation3d("rotationZ",V)},_updateChildrenRotation3d:function(T,U){var C=this;if(!C._updatingToChildren){var l=C[Hq(T)]();if(Tb.superClass[ag(T)].call(C,U),!Sq&&!C._updatingFromChildren){C._updatingToChildren=1;var b=U-l;C.eachChild(function(i){lm(i)&&i._11Q(C,T,b)}),delete C._updatingToChildren}}},setScale:function(O,f){var e=this;if(!e._updatingToChildren){null==f&&(f=O.y,O=O.x);var q=e.getScale();if(C(O)<.01&&(O=.01*(ns(O)||ns(q.x))),C(f)<.01&&(f=.01*(ns(f)||ns(q.y))),Tb.superClass.setScale.call(e,O,f),!Sq&&!e._updatingFromChildren){e._updatingToChildren=1;var P=O/q.x,p=f/q.y;e._adjustChildScaleOrSize(P,p,"size"),delete e._updatingToChildren,e._scaleChanged=1,e.updateFromChildren(),delete e._scaleChanged}}},onPropertyChanged:function(d){Tb.superClass.onPropertyChanged.call(this,d),"s:3d.visible"===d.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(H){(H.s("batch")||H.s("wf.geometry")||H.s("wf.visible"))&&H.iv(),H instanceof Tb&&H._invalidateChildrenBatch()})},getSerializableProperties:function(){var k=Tb.superClass.getSerializableProperties.call(this);return k.clickThroughEnabled=1,k.syncSize=1,k}});var ql=T.Grid=function(){to(T.Grid,this)};is("Grid",Eq,{IRotatable:!1,_icon:"grid_icon",_image:Z,getUIClass:function(){return ak},setRotation:function(){},getCellRect:function(M,r){var I=this,c=I.s("grid.row.count"),y=I.s("grid.column.count");if(0>=c||0>=y||0>M||M>=c||0>r||r>=y)return Z;var W,u,X,f=I.getRect(),s=I.s("grid.row.percents"),g=I.s("grid.column.percents");if(Ig(f,I,"grid.border",-1),s&&s._as&&(s=s._as),g&&g._as&&(g=g._as),s&&s.length===c){for(X=0,W=0;M>W;W++)X+=f.height*s[W];f.y+=X,f.height=f.height*s[M]}else f.height=f.height/c,f.y+=f.height*M;if(g&&g.length===y){for(u=0,W=0;r>W;W++)u+=f.width*g[W];f.x+=u,f.width=f.width*g[r]}else f.width=f.width/y,f.x+=f.width*r;return Aq(f,-I.s("grid.gap")),f}});var rr=T.Text=function(){to(rr,this),this.setSize(100,50),this.s("text","TEXT")};is("Text",Eq,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return xp},setWidth:function(Q){Q||(Q=.001),rr.superClass.setWidth.call(this,Q)},setHeight:function(o){o||(o=.001),rr.superClass.setHeight.call(this,o)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Qr("__text__",{width:{value:100,isSafeFunc:!0,func:function(j){return j?j._width:100}},height:{value:50,isSafeFunc:!0,func:function(I){return I?I._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"}}]});var jh=T.Shape=function(){to(jh,this),this._59O=new Dd};jh.__de__=lf,is("Shape",Eq,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return qo},_22Q:function(){return Ns},getLength:function(c){return xf(ac(this._59O,this._58O,c,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var j=this._58O;return j?new Dd(j._as.slice(0)):j},setSegments:function(D){var i=this._58O;D=D?tj(D)?new Dd(D.slice(0)):new Dd(D._as.slice(0)):null,(i&&D&&i._as.join(",")!==D._as.join(",")||i!==D)&&(this._58O=D,this.fp("segments",i,D))},getPoints:function(){return this._59O},toPoints:function(){var V=this._59O;return new Dd(V._as.slice(0))},getPointsMatrix2d:function(){var M=this,H=new gi.Matrix2d,x=M.getPosition(),F=M.getScale(),z=M.getRotation();return H.translate(-x.x,-x.y).scale(F.x,F.y).rotate(z).translate(x.x,x.y),H},getPointsMatrix3d:function(){return function(){var y=this,B=new gi.Matrix4,J=B.getElements(),C=y.p3();Kl(J,C),nm(J,y.getFinalRotation3d(),y.getRotationMode());var h=y.getScale3d(),e=y._dynamicScale3d;return e&&(h[0]*=e[0],h[1]*=e[1],h[2]*=e[2]),rk(J,h),Kl(J,Hi(C)),B}}(),setPoints:function(c,L){var d=this,H=d._59O;c=c?tj(c)?new Dd(c.slice(0)):new Dd(c._as.slice(0)):new Dd;var F,K,O,T,I,m;L&&(F=d.getPosition(),m=new qe(d.getRotation(),0,0,d.getScale().x,d.getScale().y)),(H&&c&&H._as.join(",")!==c._as.join(",")||H!==c)&&(d._59O=c,d.fs(),d.fp("points",H,c)),L&&(K=d.getPosition(),O=K.x-F.x,T=K.y-F.y,I=m.tf(O,T),d.setPosition(K.x-O+I.x,K.y-T+I.y))},addPoint:function(V,D,w){var f=this.toPoints();f.add(V,D),this.setPoints(f,w)},setPoint:function(H,S,j){var N=this.toPoints();N.set(H,S),this.setPoints(N,j)},removePointAt:function(r){var N=this.toPoints();N.removeAt(r),this.setPoints(N)},setWidthForce:function(J){var B=this;if(!B._55I&&!Sq&&B.getWidth()){B._55I=1;var f=B._position.x,b=J/B.getWidth(),E=B.toPoints(),j=new Dd;1!==b&&(E.each(function(B){j.add({x:(B.x-f)*b+f,y:B.y,e:B.e})}),B.setPoints(j),Bk(B,[b,0,0,1,f*(1-b),0]),B.fs()),delete B._55I}jh.superClass.setWidth.call(B,J)},setWidth:function(Y){return this.setWidthForce(wi>Y?wi:Y)},setHeightForce:function(c){var a=this;if(!a._55I&&!Sq&&a.getHeight()){a._55I=1;var X=a._position.y,S=c/a.getHeight(),l=a.toPoints(),f=new Dd;1!==S&&(l.each(function(n){f.add({x:n.x,y:(n.y-X)*S+X,e:n.e})}),a.setPoints(f),Bk(a,[1,0,0,S,0,X*(1-S)]),a.fs()),delete a._55I}jh.superClass.setHeight.call(a,c)},setHeight:function(G){return this.setHeightForce(wi>G?wi:G)},setAnchorElevation:function(e){var J=this;J._55I=!0;var u=J._updatingAnchor3d,j=!Sq&&!u;if(j){var h,B=e,Q=J.getAnchorElevation(),S=J.getTall();h=S*(Q-B),0!==h&&J.shiftPointsElevation(h)}var V=jh.superClass.setAnchorElevation.apply(J,arguments);return u||delete J._55I,V},getShapeElevation:function(){var K=this,d=K._54O;return d-(K.getTall()||0)*(K._anchorElevation-.5)},setAnchor3d:function(s,W,k,Y){var C,E=this;"number"==typeof s?C={x:s,y:W,z:k}:(C=s.length?{x:s[0],y:s[1],z:s[2]}:s,Y=W),E._55I=!0,E._updatingAnchor3d=!0;var R=E.getDataModel();if(R&&R.beginTransaction(),!Sq){var A=E.getAnchor3d(),M=E.getSize(),l=E.getTall(),I=M.width*(A.x-C.x),d=M.height*(A.z-C.z),U=l*(A.y-C.y);Y||E.shiftPoints(I,d,U);var z=E.p3()}var r=jh.superClass.setAnchor3d.apply(E,arguments);if(!Sq&&Y){var B=E.p3();E.shiftPoints(B[0]-z[0]+I,B[2]-z[2]+d,B[1]-z[1]+U)}return R&&R.endTransaction(),delete E._updatingAnchor3d,delete E._55I,r},setAnchor:function(l,O,p){var c=this;c._55I=!0;var S=c._updatingAnchor3d,r=!Sq&&!S;if(r){var v,z,J;"number"==typeof l?J={x:l,y:O}:(J=l.length?{x:l[0],y:l[1]}:l,p=O);var u=c.getAnchor(),d=c.getSize();v=d.width*(u.x-J.x),z=d.height*(u.y-J.y),p||c.shiftPoints(v,z);var R=c.getPosition()}var A=jh.superClass.setAnchor.apply(c,arguments);if(r){var I=c.getPosition();p&&c.shiftPoints(I.x-R.x+v,I.y-R.y+z)}return S||delete c._55I,A},shiftPoints:function(f,g,w){if(f||g||w){var W=this,T=W.getElevation()||0,S=W.toPoints(),p=new Dd;S.each(function(_){var m=_.e;w&&(m=(m==Z?T:m)+w),p.add({x:_.x+f,y:_.y+g,e:m})}),W.setPoints(p),W.fs()}},shiftPointsElevation:function(_){return this.shiftPoints(0,0,_)},setPosition:function(w,A){var $,a=this;if(!a._28Q){if(a._28Q=1,!a._55I&&!Sq){$=2===arguments.length?{x:w,y:A}:w;var U=$.x-a._position.x,u=$.y-a._position.y;if(0===U&&0===u)return delete a._28Q,void 0;a._55I=1,a.shiftPoints(U,u),Bk(a,[1,0,0,1,U,u]),delete a._55I}jh.superClass.setPosition.apply(a,arguments),delete a._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var E=this;if(2!==E._59O.size())return!1;var v=E._58O;return v?2===v.size()&&1===v.get(0)&&2===v.get(1)?!0:!1:!0},fireShapeChange:function(){var k=this;if(!k._55I&&!Sq){var e=An(k._59O);e&&(k._55I=1,k.setRect(e),delete k._55I)}k.fp(Gd,!1,!0)},getSerializableProperties:function(){var G=jh.superClass.getSerializableProperties.call(this);return G.segments=1,G.points=1,G.thickness=1,G.closePath=1,G}});var Bg=T.Points=function(){to(Bg,this)};is("Points",Eq,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return Os},getPoints:function(){return this._59O},setPoints:function(r){var y=this._59O;r=r?r.slice(0):[],this._59O=r,this._pointsDirty=!0,this.fp("points",y,this._59O)},setPoint:function(C,H){var F=this._59O.slice(0);F[C]=H,this.setPoints(F)},addPoint:function(y){this.setPoint(this._59O.length,y)},getColors:function(){return this._colors
},setColors:function(H){var s=this._colors;H=H?H.slice(0):[],this._colors=H,this._colorsDirty=!0,this.fp("colors",s,H)},setPointColor:function(P,l){var Y=this._colors.slice(0);Y[P]=l,this.setColors(Y)},getSizes:function(){return this._sizes},setSizes:function(F){var p=this._sizes;F=F?F.slice(0):[],this._sizes=F,this._sizesDirty=!0,this.fp("sizes",p,this._sizes)},setPointSize:function(M,E){var n=this._sizes.slice(0);n[M]=E,this.setSizes(n)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(p){var O=this._uvoffsets;p=p?p.slice(0):[],this._uvoffsets=p,this._offsetsDirty=!0,this.fp("uvoffsets",O,this._uvoffsets)},setPointUvoffset:function(w,G,k){var d;"object"==typeof G?(d=G[0],k=G[1]):d=G;var f=this._uvoffsets.slice(0);f[2*w+0]=d,f[2*w+1]=k,this.setUvoffsets(f)},getPointInfo:function(R){var p=this.getPoints();if(!p||p[R]==Z)return Z;var $=p[R],f=[$.x,$.e,$.y],V=this.mat||$l(this),x=[f[0],f[1],f[2]];oi(x,V);var S=this.getColors(),L=S[R]||this.s("points.color"),B=this.getSizes(),n=B[R];return{size:n==Z?this.s("points.size"):n,color:L,local:f,world:x}},getSerializableProperties:function(){var I=Bg.superClass.getSerializableProperties.call(this);return I.points=1,I.colors=1,I.sizes=1,I.uvoffsets=1,I},onPropertyChanged:function(v){Bg.superClass.onPropertyChanged.call(this,v);var t=v.property;"s:points.color"===t?this._colorsDirty=!0:"s:points.size"===t?this._sizesDirty=!0:"s:points.model"===t&&(this._modelDirty=!0)},getWidth:function(){var c=this;if(c._width>=0)return c._width;var d=c.getStyle("points.model");if(d){var Z=Xh(d);if(Z&&Z.rawS3)return Z.rawS3[0]}return 1},getHeight:function(){var U=this;if(U._height>=0)return U._height;var m=U.getStyle("points.model");if(m){var R=Xh(m);if(R&&R.rawS3)return R.rawS3[2]}return 1},getTall:function(){var e=this;if(e._tall>=0)return e._tall;var Y=e.getStyle("points.model");if(Y){var w=Xh(Y);if(w&&w.rawS3)return w.rawS3[1]}return 1}});var Io=T.Polyline=function(){to(Io,this),this.s({"shape.background":null,"shape.border.width":2})};is("Polyline",jh,{_icon:"polyline_icon",_22Q:function(){return Rs},getUIClass:function(){return zb},setClosePath:function(){},setTall:function(E){var V=this,g=V.getDataModel();if(g&&g.beginTransaction(),!V._55I&&!V._24Q&&!Sq&&V.getTall()){V._24Q=1;var R=V._54O,I=E/V.getTall();if(1!==I){var h=V.toPoints(),L=new Dd;h.each(function(V){L.add({x:V.x,y:V.y,e:V.e==Z?V.e:(V.e-R)*I+R})}),V.setPoints(L),V.fs()}delete V._24Q}Io.superClass.setTall.call(V,E),g&&g.endTransaction()},setElevation:function(Y){var $=this,d=$.getDataModel();if(d&&d.beginTransaction(),!$._55I&&!$._24Q&&!Sq){$._24Q=1;var W=Y-$._54O;0!==W&&$.shiftPointsElevation(W),delete $._24Q}Io.superClass.setElevation.apply($,arguments),d&&d.endTransaction()},fireShapeChange:function(){var h=this,L=h._59O;if(!h._55I&&!h._24Q&&!Sq){var l=L.size();if(l){var V=1,v=L.get(0),D=h._54O;v.e==Z&&(v.e=D);for(var x=v.e,d=0;l>V;V++){v=L.get(V),v.e==Z&&(v.e=D);var Y=S(x,v.e),A=$(x+d,v.e);x=Y,d=A-Y}h._24Q=1,h.setTall(d),h.setElevation(x+d*h._anchorElevation),delete h._24Q}}Io.superClass.fireShapeChange.apply(h,arguments)}});var nd=T.SubGraph=function(){to(nd,this)};is("SubGraph",Eq,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){nd.superClass._8I.call(this),this.eachChild(function(F){lm(F)&&F._8I()})}}),L.loadingRefGraph=0;var en=T.RefGraph=function(){to(en,this)};is("RefGraph",Tb,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(l){var f=this._ref;this._ref=l,this.fp("ref",f,l),this.updateRef()},_21I:function(){en.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var W=this;if(L.loadingRefGraph++,W.clearChildrenFromDataModel(),L.loadingRefGraph--,W._ref&&W._dataModel){W._xhrLoadHandler&&(W._xhrLoadHandler.cancel=!0);var e=Sq,M=W._xhrLoadHandler=function(r){if(r&&W._dataModel){L.loadingRefGraph++;var c=W._pendingUpdateInfo={needToRestore:e};e&&(c.p3=W.p3(),c.s3=W.s3(),c.r3=W.r3(),c.anchor3d=W.getAnchor3d(),c.scale3d=W.getScale3d()),W.r3(0,0,0),W.setScale3d(1,1,1),W.setAnchor3d(.5,.5,.5),W.p3(0,0,0);var V=L.parse(r),g=W._dataModel.deserialize(V,W,{justDatas:!0});g.each(function(r){r._refGraph=W}),W.checkPendingUpdateInfo(),L.loadingRefGraph--,L.handleRefGraphLoaded(W,g,V)}};M.xhrLoadCalled=!1,L.load(W._ref,function(w){M.cancel||(M.xhrLoadCalled?M(w):jf(function(){M(w)}))}),M.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var C=this,E=C._pendingUpdateInfo;if(!E)return C.onPendingUpdated&&(L.loadingRefGraph++,C.onPendingUpdated(),L.loadingRefGraph--),void 0;var r=!0;this.eachChild(function(m){(m._pendingCheckImageJSON||m._pendingUpdateInfo)&&(r=!1)}),r&&(L.loadingRefGraph++,C._pendingUpdateInfo=null,C.updateFromChildren(),E.needToRestore&&(C.setAnchor3d(E.anchor3d),C.setScale3d(E.scale3d),C.r3(E.r3),C.p3(E.p3)),this.getParent()instanceof en&&this.getParent().checkPendingUpdateInfo(),C.onPendingUpdated&&C.onPendingUpdated(),L.loadingRefGraph--)},getSerializableProperties:function(){var O=en.superClass.getSerializableProperties.call(this);return O.ref=1,O}}),T.EdgeGroup=function(c,v){this._70O=c,this._siblings=v;for(var x,g,V=0,w=c.size(),f=X[Bh];w>V;V++)if(x=c.get(V).getStyle(Bh,!1),x!=Z){f=x;break}f==Z&&(f=!0);var W=L.edgeGroupAgentFunc;for(W&&(g=W(c),g&&g!==c.get(0)&&(c.remove(g),c.add(g,0))),V=0;w>V;V++)c.get(V).s(Bh,f)},is("EdgeGroup",i,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function($){return this._70O.get($)},indexOf:function(S){return this._70O.indexOf(S)},each:function(p,q){this._70O.each(p,q)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(G,g){this._siblings.each(function(s){s._70O.each(G,g)})}});var gg=function(x,n,P){var w=sl[x]={type:x,action:n};if(P)for(var v in P)w[v]=P[v]};kp(L,{setConnectAction:gg,getConnectAction:function(F,E){if(!E){if(!F)return null;E=F.getCurrentConnectActionType()}return sl[E]},doConnectAction:function(L,n,t,B){B=B||L.getCurrentConnectActionType();var M=sl[B];if(!M)return!1;var K=M.action;return K?(n instanceof nc.Group?L.sm().getSelection().each(function(_){K.call(null,L,_,t)}):K.call(null,L,n,t),!0):!1},doDeleteConnectionAction:function(h,e,u){u=u||h.getCurrentConnectActionType();var c=sl[u];if(!c||!c.delete)return!1;var X=c.delete.action;return X?(e instanceof nc.Group?h.sm().getSelection().each(function(I){X.call(null,h,I)}):X.call(null,h,e),!0):!1}});var Yd=T.JSONSerializer=function(r,k){this.dm=this._dataModel=r,this._hierarchical=L.forceHierarchicalSerialization?!0:k==Z?r.isHierarchicalRendering():k};is("JSONSerializer",i,{ms_ac:["hierarchical"],serialize:function(I){return L.stringify(this.toJSON(),I)},toJSON:function(){var o=this,p=o.dm,J=p.getRoots(),W=o.json={v:L.getVersion(),p:{},a:{},d:[]},h=p.getSerializableAttrs();p.getInit()&&(W.init=p.getInit()),p.getName()&&(W.p.name=p.getName()),p.getBackground()&&(W.p.background=p.getBackground()),p.getLayers()&&(W.p.layers=p.getLayers()),p.getEnvmap()&&(W.p.envmap=p.getEnvmap()),p.isCubicEnvmap()&&(W.p.cubicEnvmap=p.isCubicEnvmap()),W.p.autoAdjustIndex=p.isAutoAdjustIndex(),W.p.hierarchicalRendering=p.isHierarchicalRendering();for(var v in h){var Z=p.a(v);Z!==c&&o[Jj](v,Z,W.a)}return _j(W.a)&&delete W.a,o._hierarchical?J.each(o.serializeData,this):p.each(function(T){o.serializeData(T)}),p.fireSerializeEvent({type:"serialize",json:W}),p.getPostProcessingData()&&(W.p.postProcessingData=p.getPostProcessingData()),W},isSerializable:function(){return!0},getProperties:function(E){return E.getSerializableProperties()},getStyles:function(O){return O.getSerializableStyles()},getAttrs:function(F){return F.getSerializableAttrs()},serializeData:function(c){var u=this;if(u.isSerializable(c)&&!c._refGraph){var X,p,f,V,M=yf(c.getClassName())||c.getClass(),z=new M,F={c:c.getClassName(),i:c.getId(),p:{},s:{},a:{}};u.json.d.push(F),X=u.getProperties(c);for(p in X)if(/^_/.test(p)){if(f=c[p],!("_width"!==p&&"_height"!==p||f!=Z&&-1!==f)){var S;((c.s("layout.h")||c.s("layout.v"))&&c.getHost()||c instanceof T.Node&&(S=c.getParent())&&S instanceof T.Block||c.s("fullscreen"))&&(f=c[p]="_width"===p?c.getWidth():c.getHeight())}f!==z[p]&&u[Jj](p.substr(1),f,F.p)}else V=Hq(p),c[V]&&(f=c[V](),f!==z[V]()&&u[Jj](p,f,F.p));X=u.getStyles(c);for(p in X)f=c.s(p),f!==z.s(p)&&u[Jj](p,f,F.s);X=u.getAttrs(c);for(p in X)f=c.a(p),f!==z.a(p)&&u[Jj](p,f,F.a);_j(F.p)&&delete F.p,_j(F.s)&&delete F.s,_j(F.a)&&delete F.a}u._hierarchical&&c.getChildren().each(u.serializeData,u)},serializeValue:function(P,e,y){Nn(e)?e={__a:e._as}:e instanceof Od?e={__i:e.getId()}:e instanceof Id&&(e={__dm:e.serialize(0)}),y[P]=e},deserialize:function(H,m,M){var T=this;return em(H)&&/.json$/.test(H)?(L.xhrLoad(H,function(Q){T.deserializeImpl(Q,m,M)}),void 0):T.deserializeImpl(H,m,M)},deserializeImpl:function(l,n,z){var a=this,d=a.dm;d.setDeserializing(!0),z=Xe(z)?{setId:z}:ik(z)?{finishFunc:z}:z||{},l=a.json=em(l)?L.parse(l):l,!z.justDatas&&l.a&&l.a.onPreDeserialize&&!z.disableOnPreDeserialize&&l.a.onPreDeserialize(l,d,z.view),d.beginTransaction(),Sq++,a._82I={};var x=new Dd,j=new Dd,G=0,o=l.d.length;if(z.justDatas||(!z.disableInit&&ik(l.init)&&l.init(d),d.setInit(l.init)),!z.justDatas){for(var O in l.a)d.a(O,a[Gf](l.a[O]));for(var F in l.p)d[ag(F)](l.p[F])}for(;o>G;G++){var r=l.d[G],i=yf(r.c),u=new i,t=r.i;z.setId&&t!=Z&&(u._id=t),a._82I[t]=u,x.add(u),j.add(r)}for(G=0;o>G;G++)a.deserializeData(x.get(G),j.get(G));return x.each(function(p){n&&!p.getParent()&&p.setParent(n),d.add(p)}),z.__innerHandler__&&z.__innerHandler__(l,d,z.view,x),d.fireSerializeEvent({type:"deserialize",json:l}),Sq--,d.endTransaction(),!z.justDatas&&l.a&&l.a.onPostDeserialize&&!z.disableOnPostDeserialize&&l.a.onPostDeserialize(l,d,z.view,x),z.finishFunc&&z.finishFunc(l,d,z.view,x),d.setDeserializing(!1),x},deserializeData:function(v,C){for(var X in C.p)v[ag(X)](this[Gf](C.p[X]));for(X in C.s)v.s(X,this[Gf](C.s[X]));for(X in C.a)v.a(X,this[Gf](C.a[X]))},deserializeValue:function(H){if(Ue(H)){var m=H.__i;if(m!=Z)return this._82I[m];if(m=H.__dm,m!=Z){var b=new T.DataModel;return b.deserialize(m),b}if(m=H.__a,tj(m))return new Dd(m)}return H}}),kp(Id,{serialize:function(c,L){return new Yd(this,L).serialize(c)},toJSON:function(C){return new Yd(this,C).toJSON()},deserialize:function(N,m,d){return new Yd(this).deserialize(N,m,d)}});var _e=T.OverlappingBox=function(J){this.gv=J,this.boxes={}};is("OverlappingBox",i,{clear:function(){var T,x,e=this.boxes;for(T in e)x=e[T],x.length=0},isOverlapping:function(i,K){var l,o,p=this,N=p.boxes,H=N[i];H?(l=H.rects,o=H.length):H=N[i]={rects:l=[],length:o=0};var h,P,K;for(h=0;o>h;h++)if(P=l[h],P.x<K.x+K.w&&P.x+P.w>K.x&&P.y<K.y+K.h&&P.h+P.y>K.y)return!0;return l.length<=o?(l.push(K),H.length++):l[H.length++]=K,!1}}),kp(L,{fetch:function(u,E){var k="GET",U=!1,$=null,G="";E&&(k=E.method||"GET",U=E.sync,G=E.url,$=E.data||null),u.open(k,G,!U),E.responseType?u.responseType=E.responseType:E.overrideMimeType&&u.overrideMimeType&&u.overrideMimeType(E.overrideMimeType),u.send($)},convertImageSrc:function(i,E){E&&"function"==typeof E||(E=function(){}),E(i)}});var Hl=T.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};is("Request",i,{_responseType:null,_overrideMimeType:"text/plain",send:function(b){var P=this._xhr,K=this.onload,A=this.onerror;this.getResponseType()?b.responseType=this.getResponseType():this.getOverrideMimeType()&&(b.overrideMimeType=this.getOverrideMimeType()),P.onload=K,P.onerror=A,L.fetch(P,b)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(Y){this._responseType=Y},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(l){this._overrideMimeType=l},getResponseText:function(){var u=this._xhr;return u.response||u.responseText}}),si.GraphView=function(Y){var T=this;T._24I={},T._34I=new Dd,T._25I={},T._56I={},T._view=zf(1,T),T._canvas=qs(T._view),T.dm(Y?Y:new Id),this._coreInteractor=new Lj(this),T.setEditable(!1),T.setScrollBarVisible(L.graphViewScrollBarVisible),T._initView()},ej("GraphView",i,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Gp,id,lk,$o,"resettable","editInteractor",dr,"zoomable","pannable","rectSelectable","autoScrollZone",Jg,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:L.graphViewZoomable,_resettable:L.graphViewResettable,_pannable:L.graphViewPannable,_rectSelectable:L.graphViewRectSelectable,_autoScrollZone:L.graphViewAutoScrollZone,_rectSelectBackground:L.graphViewRectSelectBackground,_rectSelectBorderColor:L.graphViewRectSelectBorderColor,_editPointSize:L.graphViewEditPointSize,_editPointBorderColor:L.graphViewEditPointBorderColor,_editPointBackground:L.graphViewEditPointBackground,_scrollBarColor:Rh,_scrollBarSize:Ql,_autoHideScrollBar:qc,_autoMakeVisible:Un,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(j){this._dataModel.setLayers(j)},setEditable:function(L){var E=this,z=E.__interactorMap__;if(!z){var M=si.XEditInteractor;z=E.__interactorMap__={scrollBar:new nq(E),select:new Zg(E),edit:M?new M(E):new Pi(E),text:new pm(E),move:new Dj(E),"default":new pr(E),touch:new Md(E,{editable:!1})}}L?(E._uieditable=!0,E.setInteractors([z.scrollBar,z.select,z.edit,z.text,z.move,z.default,z.touch])):(E._uieditable=!1,E.setInteractors([z.scrollBar,z.select,z.move,z.default,z.touch]))},getCanvas:function(){return this._canvas},_33I:function(A){var e=A.getUIClass();return e?new e(this,A):Z},getDataUI:function(P){var H=this,L=H._25I[P._id];return L===c&&(L=H._33I(P),H._25I[P._id]=L),L},getNodeRect:function(v){return L.getNodeRect(this,v)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(Q){var I=this.getDataUI(Q);return I?(I._79o(),I._78o):null},getEdgeSourcePosition:function(t){var Z=this,l=Z.getDataUI(t),k=l.s,d=l._data._40I;return dc(Z,d,k("edge.source.position"),k("edge.source.offset.x"),k("edge.source.offset.y"),k("edge.source.anchor.x"),k("edge.source.anchor.y"))},getEdgeTargetPosition:function(P){var K=this,g=K.getDataUI(P),p=g.s,Q=g._data._41I;return dc(K,Q,p("edge.target.position"),p("edge.target.offset.x"),p("edge.target.offset.y"),p("edge.target.anchor.x"),p("edge.target.anchor.y"))},invalidateAll:function(a){var B=this;if(a){for(var V in B._25I){var o=B._25I[V];o&&o.dispose()}B._25I={},B._56I={},B._24I={},B._34I.clear(),B.redraw()}else B.dm().each(function(m){B.invalidateData(m)})},invalidateSelection:function(){var n=this;n.sm().each(function(N){n.invalidateData(N)})},invalidateData:function(O){var i=this;i._24I[O._id]=O,i._21Q(O),i.iv()},_21Q:function(d){var H=this,b=H._24I;if(El(d)&&Lo[d.s(Qe)]){var x=d.getSourceAgent();x&&x.getAgentEdges().each(function(Z){b[Z._id]=Z}),x=d.getTargetAgent(),x&&x.getAgentEdges().each(function(R){b[R._id]=R}),H.iv()}},redraw:function(y){var C=this;C._32I||(y?C._34I.add(y):(C._32I=1,C._34I.clear()),C.iv())},each:function(h,s){var p,D,e,k=0,B=this.getLayers(),H=this._dataModel,v=H._datas._as,T=v.length;if(B){for(var g=B.length;g>k;k++)if(e=B[k],Ue(e)&&(e=e.name),H.isHierarchicalRendering()){var X=function(W){return W._layer===e?s?h.call(s,W):h(W):void 0};if(this._dataModel.eachByHierarchical(X)===!1)return}else for(var C=0;T>C;C++)if(p=v[C],p._layer===e&&(D=s?h.call(s,p):h(p),D===!1))return}else if(H.isHierarchicalRendering())this._dataModel.eachByHierarchical(h,null,s);else for(;T>k;k++)if(p=v[k],D=s?h.call(s,p):h(p),D===!1)return},reverseEach:function(P,n){var a,_,R,v,O=this._dataModel,T=O._layers,E=O._datas._as,k=E.length;if(T){for(a=T.length-1;a>=0;a--)if(v=T[a],Ue(v)&&(v=v.name),O.isHierarchicalRendering()){var d=function(B){return B._layer===v?n?P.call(n,B):P(B):void 0};if(O.reverseEachByHierarchical(d)===!1)return}else for(var z=k-1;z>=0;z--)if(_=E[z],_._layer===v&&(R=n?P.call(n,_):P(_),R===!1))return}else if(O.isHierarchicalRendering())O.reverseEachByHierarchical(P,null,n);else for(a=k-1;a>=0;a--)if(_=E[a],R=n?P.call(n,_):P(_),R===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var g=this,P=g._84I;if(!P){var p=this.dm().a("width"),y=this.dm().a("height");p>0&&y>0?g._84I={x:0,y:0,width:p,height:y}:(g.each(function(t){g.isVisible(t)&&(P=ge(P,g.getDataUIBounds(t)))}),g._84I=P?P:Cp)}return g._84I},getScrollRect:function(){return ge(this.getContentRect(),this._29I)},makeCenter:function(R,k,w){var r=this;if(!r.getWidth()||!r.getHeight())return w||jf(r.makeCenter,r,[R,k,!0],500),void 0;r.makeVisible(R),r.validate();var N=r.getDataUIBounds(R);if(N){var p=r.getWidth(),z=r.getHeight(),K=N.x+N.width/2,d=N.y+N.height/2,I=-K*r._zoom+p/2,s=-d*r._zoom+z/2;r.setTranslate(I,s,k)}},fitData:function(K,N,e,m,U){var X=this;if(!X.getWidth()||!X.getHeight())return U||jf(X.fitData,X,[K,N,e,m,!0],500),void 0;var R=function(){X.makeVisible(K),X.validate();var S=X.getDataUIBounds(K);S&&(S=zl(S),Aq(S,e==Z?20:e),X.fitRect(S,N,m))};N?L.callWhenLoaded(R):R()},fitContent:function(r,R,J,F){var A=this;if(!A.getWidth()||!A.getHeight())return F||jf(A.fitContent,A,[r,R,J,!0],500),void 0;var X=function(){A.validate();var b=zl(A.getContentRect());Aq(b,R==Z?20:R),A.fitRect(b,r,J)};r?L.callWhenLoaded(X):X()},fitRect:function(_,C,i){var L=this,E=L.getWidth(),K=L.getHeight(),g=_.x+_.width/2,k=_.y+_.height/2,J=S(E/_.width,K/_.height),W=L._zoom,V=-g*W+E/2,Y=-k*W+K/2;0===J||isNaN(J)||(i&&(J=S(1,J)),C?(L._65I&&(delete L._65I.finishFunc,L._65I.stop(!0)),L._14o&&L._14o.stop(!0),L.setTranslate(V,Y,{finishFunc:function(){L.setZoom(J,C)}})):(L.setTranslate(V,Y),L.setZoom(J)))},fitSelection:function(c,n,Z){var H=this,N=H.sm(),B=null;N.size()&&(N.each(function($){B=ge(H.getDataUIBounds($),B)}),c&&Aq(B,c),H.fitRect(B,n,Z))},toCanvas:function(G,l,t){l=l||this._zoom,this.validateImpl();var J=this,x=J.getContentRect();t&&Aq(x,t),x.width||(x.width=10),x.height||(x.height=10);var L=qs(),n=x.x*l,w=x.y*l,Q=Math.ceil(x.width*l),X=Math.ceil(x.height*l);Ud(L,Q,X,1);var O=ms(L);return G=G||this._dataModel.getBackground(),G&&Ki(O,0,0,Q,X,G),Kn(O,-n,-w),O.scale(l,l),J._42(O),O.restore(),L},toDataURL:function(A,_,s,r){return this.toCanvas(A,s,r).toDataURL(_||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(c,L){var n=this,q=n.dm().getBackground();if(q){var C=n.dm().a("width"),_=n.dm().a("height");C>0&&_>0&&Ki(c,0,0,C,_,q)}var B=n.__htmlOrderList,H=[],N=n._forcedLayoutHTML;if(n._93db(c,L),n.each(function(C){var J=n.getDataUI(C);if(J){var B=n._56I[C._id],w=J._htmlView;if(B){var E=J._79o();if(w=J._htmlView,T.HtmlNode&&C instanceof T.HtmlNode)J._42(c);else{var I=n.getViewRect(),$=w&&w.layoutHTML;!L||Fg(L,E)?($&&(w.layoutHTML(),J.__outerLayout&&delete J.__outerLayout),J._42(c)):Fg(I,E)||!$||J.__outerLayout&&!N||(w.layoutHTML(),J.__outerLayout=!0)}}w&&(H.push(w),w.getView&&(w=w.getView()),w.style.display=B?"block":tm)}}),B&&H.length>0){var A=!1;if(B.length!==H.length)A=!0;else for(var P=0;P<H.length;P++)if(H[P]!==B[P]){A=!0;break}A&&(H.forEach(function(S){S.autoAdjustIndex!==!1&&n.appendHTML(S,!0)}),this.__htmlOrderList=H)}else this.__htmlOrderList=H;n._92db(c,L)},validateImpl:function(){this.tryUpdateRootData();var z,l,U,E,g,A=this,v=A.tx(),B=A.ty(),L=A._zoom,h=A._canvas,d=this.getWidth(),Y=this.getHeight(),V=A._29I,t={x:-v/L,y:-B/L,width:d/L,height:Y/L},W={},P=A._34I,D=A._24I,Q=A._32I,K=A._23I;A._24I={},(d!==h.clientWidth||Y!==h.clientHeight)&&(Ud(h,d,Y),Q=1,A._forcedLayoutHTML=1),Q||um(t,V)||(Q=1,A._forcedLayoutHTML=1),A._29I=t,A.each(function(B){l=B._id;var y=W[l]=A.isVisible(B);y!==A._56I[l]&&(D[l]=B,U=A.getDataUI(D[l]),U&&U._84o(y),A._84o(B,y))},A);for(l in D)U=A.getDataUI(D[l]),U&&(!Q&&A._56I[l]&&(g=U._79o(),g&&P.add(g)),U.invalidate()),A._83I=1;if(A._56I=W,!Q)for(l in D)W[l]&&(U=A.getDataUI(D[l]),U&&(g=U._79o(),g&&P.add(g)));if(Q?E=t:(P.each(function(T){Fg(t,T)&&(E=ge(E,T))}),E&&(Aq(E,$(1,1/L)),E.x=G(E.x*L)/L,E.y=G(E.y*L)/L,E.width=N(E.width*L)/L,E.height=N(E.height*L)/L,E=vr(t,E))),A._74O=E,E&&0!==E.width&&0!==E.height){z=ms(h);var Z=E.x,o=E.y,q=E.width,m=E.height;Z=Math.floor((Z*L+v)*Bj),o=Math.floor((o*L+B)*Bj),q=Math.ceil(q*L*Bj)+1,m=Math.ceil(m*L*Bj)+1,Q||(E.x=(Z/Bj-v)/L,E.y=(o/Bj-B)/L,E.width=q/Bj/L,E.height=m/Bj/L),z.beginPath(),z.rect(Z,o,q,m),z.clip(),z.clearRect(Z,o,q,m),cd(z,v,B,L),A._42(z,E),z.restore(),delete A._74O}if(P.clear(),delete A._32I,delete A._forcedLayoutHTML,K&&d>0&&Y>0){var U=A.getDataUI(K);if(U){var g=U._79o(),O=A._29I,C=O.x,R=O.y,u=O.width,T=O.height,L=A._zoom;g&&!Fg(g,O)&&(g.x+g.width<C&&A.tx(-g.x*L),g.x>C+u&&A.tx(-(g.x+g.width-u)*L),g.y+g.height<R&&A.ty(-g.y*L),g.y>R+T&&A.ty(-(g.y+g.height-T)*L))}delete A._23I}A._83I&&(delete A._83I,delete A._84I),A._98O(),A.countFrame(),_j(A._24I)||jf(A.iv,A)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var Z,z=this.getFullscreenDatas();for(var R in z)Z=z[R],this.scaleRootData(Z);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(H){var O=H.s("fullscreen");if("uniform"===O||"fill"===O){H.getRotation()&&H.setRotation(0);var p=H.s("fullscreen.gap")||0,f=this.getWidth(),M=this.getHeight();if(f&&M){var S,t,B,w=f-2*p,s=M-2*p,I=H.getAnchor(),v=H.getScaledSize(),Q=v.width,G=v.height,X=H.s("fullscreen.lock");if(X)return"uniform"===O?w/s>Q/G?(S=s/G,Q=G*w/s):(S=w/Q,G=Q*s/w):"v"===X?(S=s/G,Q=w/S,H.getWidth()!==Q&&H.setWidth(Q)):(S=w/Q,G=s/S,H.getHeight()!==G&&H.setHeight(G)),this.setZoom(S),t=p-(H.getX()-I.x*Q)*S,B=p-(H.getY()-I.y*G)*S,t!==this.tx()&&this.tx(t),B!==this.ty()&&this.ty(B),void 0;t=this.tx(),B=this.ty(),S=this._zoom;var N={x:(-t+p)/S,y:(-B+p)/S,width:w/S,height:s/S};if("uniform"===O){var i=Q/G,U=Math.min(N.width,N.height*i),n=U/i;N.x+=.5*(N.width-U),N.y+=.5*(N.height-n),N.width=U,N.height=n}w=N.width/H.getScaleX(),s=N.height/H.getScaleY(),(H.getWidth()!=w||H.getHeight()!==s)&&H.setSize(w,s);var o=N.x+I.x*N.width,R=N.y+I.y*N.height,d=H.getPosition();(o!==d.x||R!==d.y)&&H.setPosition(o,R)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(G){var p=this;G!==p.isScrollBarVisible()&&(G?(Fd(p._view,p._79O=Ke()),Fd(p._79O,p._27I=Ke()),Fd(p._79O,p._28I=Ke())):(ws(p._79O),delete p._79O,delete p._27I,delete p._28I),p.fp("scrollBarVisible",!G,G))},getDebugTip:function(){return""},showScrollBar:function(){var e=this;e._79O&&(e._85I||(vc(function(){e._86I()},us),e.iv()),e._85I=new Date)},_86I:function(){var v=this;if(v._85I){var A=new Date,Y=A.getTime();Y-v._85I.getTime()>=us?(delete v._85I,v.iv()):vc(function(){v._86I()},us)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var a=this,X=this._27I,$=this._28I;if(a._79O){if(a._autoHideScrollBar&&!a._85I)return X.style.visibility=de,$.style.visibility=de,void 0;var i=a.getScrollBarColor(),N=a._zoom,T=a.getScrollBarSize(),y=a.getViewRect(),p=a.getScrollRect(),c=y.height*N,W=p.height*N,J=y.width*N-T-2,d=c*((y.y-p.y)*N/W),m=c*(c/W),O=X.style;W-.5>c?(le>m&&(d=d+m/2-le/2,0>d&&(d=0),d+le>c&&(d=c-le),m=le),Rf(X,J,d,T,m),O.visibility=mb,O.background=i,O.borderRadius=T/2+sj):O.visibility=de;var w=y.width*N,L=p.width*N,d=y.height*N-T-2,J=w*((y.x-p.x)*N/L),G=w*(w/L),O=$.style;L-.5>w?(le>G&&(J=J+G/2-le/2,0>J&&(J=0),J+le>w&&(J=w-le),G=le),Rf($,J,d,G,T),O.visibility=mb,O.background=i,O.borderRadius=T/2+sj):O.visibility=de}},setDataModel:function($){var w=this,H=w._dataModel,Y=w._selectionModel;H!==$&&(H&&(H.ump(w.handleDataModelPropertyChange,w),H.umm(w.handleDataModelChange,w),H.umd(w.handleDataPropertyChange,w),H.removeIndexChangeListener(w._75O,w),H.removeHierarchyChangeListener(w.handleHierarchyChange,w),Y||H.sm().ums(w.handleSelectionChange,w)),w._dataModel=$,$.mp(w.handleDataModelPropertyChange,w),$.mm(w.handleDataModelChange,w),$.md(w.handleDataPropertyChange,w),$.addIndexChangeListener(w._75O,w),$.addHierarchyChangeListener(w.handleHierarchyChange,w),Y?Y._21I($):$.sm().ms(w.handleSelectionChange,w),w.invalidateAll(!0),w.fp(vi,H,$),w.updateBackground())},getLayersInfo:function(){if(this._layersInfo===c){var S=this.getLayers();S?(this._layersInfo={},S.forEach(function(G){var i=Ue(G)?G.name:G;this._layersInfo[i]=G},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(k,s,G){var l,P,O=this,b=O.getDataUI(k),m=Qq(b),y=Of(s,function(i){return ib(m,100*i)},100,.001),h=ib(m,100*y);if(!G){var f=jk(b),z=new xg(h.x,h.y),W=49/(O._zoom*O._zoom);for(l=0,P=f.length;P>l;l++)if(z.distanceToSquared(f[l])<W)return{index:l,point:f[l],distance:Math.sqrt((f[l].x-s.x)*(f[l].x-s.x)+(f[l].y-s.y)*(f[l].y-s.y))}}return{percent:y,point:h,distance:Math.sqrt((h.x-s.x)*(h.x-s.x)+(h.y-s.y)*(h.y-s.y))}},calculateAttachPoint:function(){var M=new xg,k=new xg,J=new xg;return function(S,w){var K=this.getAttachPoints(S);if(!K||!K.length)return null;J.set(w.x,w.y);for(var c,o,Q,m,j,P=1/0,u=0,Z=K.length;Z>u;u++)Q=K[u],k.x=Q.x,k.y=Q.y,M.x=Q.offsetX||0,M.y=Q.offsetY||0,m=dc(this,S,0,M.x,M.y,k.x,k.y),o=J.distanceToSquared(m),P>o&&(c=u,P=o,j=m);P=Math.sqrt(P);var h=this.getAttachStyle(S);if("close"===h){var E=S.s("attach.close.threshold")/this._zoom;if(P>E)return null}return{index:c,distance:P,info:K[c],point:j}}}(),getAttachPoints:function(F){var z=F.s("attach.points");if(z)return z;var K=qh(F._image);return K?sn(K.attachPoints,F,this)||null:void 0},getAttachStyle:function(X){var s=X.s("attach.style");if(s)return s;var k=qh(X._image);return k?sn(k.attachStyle,X,this)||"close":void 0},updateLayers:function(){this._layersInfo=c,this.invalidateSelection(),this.redraw()},updateBackground:function(){var E=this.dm().a("width"),C=this.dm().a("height");this._canvas.style.background=E>0&&C>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function($){if("background"===$.property){var f=this._canvas.style.background,b=$.newValue||"";this.updateBackground(),this.fp("canvasBackground",f,b),this.redraw()}else"a:width"===$.property||"a:height"===$.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===$.property?this.updateLayers():"hierarchicalRendering"===$.property&&this.redraw()},handleDataPropertyChange:function(W){this.dm().isHierarchicalRendering()&&"parent"===W.property&&W.data.hasChildren()&&this.redraw(),this.invalidateData(W.data)},onPropertyChanged:function(B){var k=this,C=B.property;if(k.redraw(),"zoom"===C){var T=k.sm().getSelection();T.size()&&T.each(function(O){O.invalidate()})}else"dataModel"===C&&(k._83I=1);th[C]?k.showScrollBar():C===dr&&k.onCurrentSubGraphChanged(B)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(r){var b=this,$=r.kind,O=r.data;if(b._83I=1,"add"===$)b.invalidateData(O),El(O)&&O.getEdgeGroup()&&O.getEdgeGroup().eachSiblingEdge(b.invalidateData,b),O.getHost&&O.getHost()&&O.getHost().updateLayoutAttaches();else if($===Ri){b._21Q(O);var Q=O._id,S=b._25I[Q];if(S){if(b._56I[Q]){var E=S._79o();E&&b.redraw(E)}S.dispose(),delete b._25I[Q],delete b._24I[Q],delete b._56I[Q]}O===b._currentSubGraph&&b.setCurrentSubGraph(Z)}else $===cr&&(b.invalidateAll(!0),b.setCurrentSubGraph(Z))},_75O:function(O){this.invalidateData(O.data)},handleHierarchyChange:function(B){this.dm().isHierarchicalRendering()&&B.data.hasChildren()&&this.redraw(),this.invalidateData(B.data)},adjustIndex:function(U){var e=this;if(e.isVisible(U)){e.dm().beginTransaction();for(var D=U;D._parent&&e.isVisible(D._parent);)D=D._parent;D&&D!==U&&e._dataModel.adjustIndex(D),e._dataModel.adjustIndex(U),e.dm().endTransaction()}},getImage:function(y){return y.getImage?y.getImage():c},getSelectWidth:function($){var n=qh(this.getImage($));return n&&sn(n.disableSelectedBorder,$,this)?0:$.s("select.width")},getSelectColor:function(c){return c.s("select.color")},isSelectable:function(z,g){if(this.isSelected(z))return!0;if(!g&&z.getParent()instanceof Tb&&this.isSelectable(z.getParent(),!0)&&z.getParent().isSyncSize())return!1;var t=this.getLayersInfo();if(t){var s=t[z._layer];if(s&&s.selectable===!1)return!1}return z.s("2d.selectable")&&this.sm().isSelectable(z)},isMovable:function(J){var w=this;if(El(J)&&J.getStyle(Qe)!==Eb)return!1;var V=this.getLayersInfo();if(V){var f=V[J._layer];if(f&&f.movable===!1)return!1}return J.s("2d.movable")?w._movableFunc?w._movableFunc(J):!0:!1},isEditable:function(u){var p=this;if(T._uiSerializing)return p._uieditable;if(!p._editInteractor||!p.isSelected(u))return!1;if(rj(u)){var N=p.getDataUI(u);if(!N||N._88I)return!1}if(El(u)&&u.getStyle(Qe)!==Eb)return!1;var I=this.getLayersInfo();if(I){var _=I[u._layer];if(_&&_.editable===!1)return!1}return u.s("2d.editable")?p._editableFunc?p._editableFunc(u):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(W){return lm(W)&&0!==W.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(W):!0},isRectEditable:function(h){return this._rectEditableFunc?this._rectEditableFunc(h):!0},isAnchorEditable:function(n){return this._anchorEditableFunc?this._anchorEditableFunc(n):!0},isRotationEditable:function(M){return M.setRotation&&M.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(M):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(Q){var o=Q.getAnchor(),D=Q.getScale(),G=this._zoom,w=rl(Q.getRotation(),0,-Q.getHeight()*D.y*o.y-(D.y<0?-1:1)*(Km?32:16)/G),u=Q.p();return w.x+=u.x,w.y+=u.y,w},getLogicalPoint:function(I){var E=this;return we(I,E._canvas,E.tx(),E.ty(),E._zoom,E._zoom)},getScreenPoint:function(M,I){var P,A=this;return"object"==typeof M?M.x!==c?(P=M.x,I=M.y):(P=M[0],I=M[1]):P=M,hf(P,I,A._canvas,A.tx(),A.ty(),A._zoom,A._zoom)},getSelectedDataAt:function(l){var i=this;return this.getDataAt(l,function(Q){return i.isSelected(Q)})},getDataInfoAt:function(c,l,A){var I,S=this.lp(c),U=this.getDataAt(S,l,A);if(U){var p=this.getDataUI(U);I={data:U,ui:p,point:S};var r=p._38o;if(r){var T=r.icons;for(var w in T){var i=T[w],h=r.rects[w];if(h)for(var n=sn(i.names,U,this),K=n?n.length:0,E=h.rotation,j=K-1;j>=0;j--){var t=n[j],z=h[j];if(Gb(z,S,E))return I.part="icons",I.name=w,I.icon=t,I.rect=z,I.index=j,I.rotation=E,I}}}if(this.isNoteVisible(U)){if(p.note2Info&&Gb(p.note2Info.clickRect,S,Z,p.note2Info.scale))return I.part="note2",I;if(p.noteInfo&&Gb(p.noteInfo.clickRect,S,Z,p.noteInfo.scale))return I.part="note",I}if(this.isLabelVisible(U)){if(p.label2Info&&Gb(p.label2Info.rect,S,p.label2Info.rotation,p.label2Info.scale))return I.part="label2",I;if(p.labelInfo&&Gb(p.labelInfo.rect,S,p.labelInfo.rotation,p.labelInfo.scale))return I.part="label",I}if(U.isInRect&&U.isInRect(S))return I.part="body",I}return I},getDataAt:function(C,H,K){C.target&&(C=this.lp(C));var N,L=this._zoom;return this.reverseEach(function(M){return(H?H(M):this.isSelectable(M))&&this.rectIntersects(M,fn(C.x,C.y,K,L))?(N=M,!1):void 0},this),N},getIconInfoAt:function(V,h){var Y=this;if(V.target&&(V=Y.lp(V)),h||(h=Y.getDataAt(V)),h){var n=Y.getDataUI(h);if(n&&n._38o){var o,x=n._38o,p=new Dd;for(o in x.icons)p.add(o);for(var t=p.size()-1;t>=0;t--){o=p.get(t);for(var b=x.rects[o],G=b.rotation,O=b.length-1;O>=0;O--){var U=b[O],C=U.width,s=U.height,F={x:V.x-U.x-C/2,y:V.y-U.y-s/2};G!=Z&&(F=rl(-G,F.x,F.y));var U={x:-C/2,y:-s/2,width:C,height:s};if(Gb(U,F))return{key:o,index:O,name:x.icons[o].names[O],rect:b[O],point:V,rotation:G,relativeRect:U,relativePoint:F,data:h}}}}}return Z},getDatasInRect:function($,Y,r){r===c&&(r=1);var V=this,u=new Dd;return V.reverseEach(function(e){r&&!V.isSelectable(e)||(Y?V.rectIntersects(e,$):V.rectContains(e,$))&&u.add(e)}),u},moveSelection:function(E,I){var A=this;A.dm().beginTransaction(),Lb(A.sm().toSelection(A.isMovable,A),E,I),A.dm().endTransaction()},moveDatas:function(v,l,O){var r=this;r.dm().beginTransaction(),v instanceof Dd||(v=new Dd(v)),Lb(v,l,O),r.dm().endTransaction()
},getDataUIBounds:function(U){var D=this.getDataUI(U);return D?D._79o():Z},drawData:function(R,w,K){var n=this.getDataUI(w);if(n){var Y=n._79o();(!K||Fg(K,Y))&&(n._42(R),w instanceof T.Block&&w.eachChild(function(F){this.isVisible(F)&&this.drawData(R,F,K)},this))}},getBoundsForGroup:function(y){return y.s(wg)?this.getDataUIBounds(y):Z},isPixelPerfect:function(w){return w.s("pixelPerfect")},rectIntersects:function(w,G){this.validate();var V=Z;if(this._56I[w._id]){var B=this._25I[w._id];if(B){var I=B._79o();if(pg(G,I))V=!0;else if((G=vr(G,I))&&(B.rectIntersects&&(V=B.rectIntersects(G)),V==Z)){if(!this.isPixelPerfect(w))return!0;var H=G.x,g=G.y,b=G.width,W=G.height,e=this._zoom,d=L.hitMaxArea,y=b*W*e*e;if(y>d){var a=Math.sqrt(d/y);e*=a}b*=e,W*=e,2>b&&(b=2),2>W&&(W=2),H*=e,g*=e;var R=ul(b,W);Kn(R,-H,-g),R.scale(e,e),this._drawForChecking=!0,this.drawData(R,w,G),this._drawForChecking=!1;try{for(var o=0,Q=R.getImageData(0,0,b,W).data;o<Q.length;o+=4)if(0!==Q[o+3]){V=!0;break}R.restore()}catch(m){tq=Z,V=!1}}}}return V?!0:!1},rectContains:function(U,N){if(this._56I[U._id]){var s=this._25I[U._id];if(s)return pg(N,s._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(w){if(!L.isInput(w.target)){var i=this,K=i._focusData,Y=K&&i._25I[K._id],H=0,E=i._dataModel._datas;if(!(K&&K._enabled&&K._editable&&Y&&Y.onKeyDown&&Y.onKeyDown(w)===!0))if(9===w.keyCode&&(K&&(H=E.indexOf(K),Ji(w)?-1===--H&&(H=0):++H===E.size()&&(H=0)),i._focusData=K=E.get(H),i.sm().setSelection(K)),Vi(w)?i.selectAll():Zh(w)&&i.isResettable()&&i.reset(),i.sm().isEmpty()){if(i._editing)return;var c=i.tx(),Q=i.ty(),J=!1,u=Ji()?100:10;uj(w)&&(c-=u,J=!0),np(w)&&(Q-=u,J=!0),Wn(w)&&(c+=u,J=!0),ob(w)&&(Q+=u,J=!0),J&&i.setTranslate(c,Q)}else{Tr(w)&&i.handleDelete(w);var n=Ji()?10:1;uj(w)&&(i.moveSelection(-n,0),i.fi({kind:"moveLeft"})),np(w)&&(i.moveSelection(0,-n),i.fi({kind:"moveUp"})),Wn(w)&&(i.moveSelection(n,0),i.fi({kind:"moveRight"})),ob(w)&&(i.moveSelection(0,n),i.fi({kind:"moveDown"}))}}},handleScroll:function(w,d){if(_m(w),this.isZoomable()){if(!this.getEditInteractor()){var m=this.getDataAt(w);if(m){var f=qh(this.getImage(m));if(f&&sn(f.scrollable,m,this))return}}var s=this.lp(w);d>0?this.scrollZoomIn(s):0>d&&this.scrollZoomOut(s)}},handlePinch:function(y,S,U){this.isZoomable()&&(Math.abs(S-U)<L.pinchZoomThreshold||(S>U?this.pinchZoomIn(y):this.pinchZoomOut(y)))},checkDoubleClickOnNote:function(l,y){var P=this,U=P.lp(l),L=P.getDataUI(y),Y=L.note2Info;return Y&&y.s("note2.toggleable")&&Gb(Y.clickRect,U)?(y.s(Xq,!y.s(Xq)),P.fi({kind:"toggleNote2",event:l,data:y}),!0):(Y=L.noteInfo,Y&&y.s("note.toggleable")&&Gb(Y.clickRect,U)?(y.s(eq,!y.s(eq)),P.fi({kind:"toggleNote",event:l,data:y}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(L,K){var k=this,y=k.getAutoScrollZone(),f=y/k.getZoom(),_=y/4,A=k._29I,u=k.lp(L),Y={x:k.tx(),y:k.ty()};return u&&y>0&&A&&(u.x-A.x<f?k.translate(_,0):A.x+A.width-u.x<f&&k.translate(-_,0),u.y-A.y<f?k.translate(0,_):A.y+A.height-u.y<f&&k.translate(0,-_)),Y.x=k.tx()-Y.x,Y.y=k.ty()-Y.y,K&&(K.x+=Y.x,K.y+=Y.y),Y},getMoveMode:function(H,$){var P=$.s("2d.move.mode");return P?P:Pm["88"]?"x":Pm["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(q,L,A){var w=this;return"currentSubGraph"===L?{__i:q.getId()}:A.serializeProperty(q,L,w)},deserializeProperty:function(r,Y,q){var V=this;if("currentSubGraph"===Y){var L=V.dm(),B=L.__idMap;return B[r.__i]}return q.deserializeProperty(r,Y,V)},setDefaultCursor:function(B,Q){this._defaultCursor=B,Q!==!1&&this.setCursor(B)},setCursor:function(X){"default"===X&&(X=this._defaultCursor||X);var G=this.getView().style;G.cursor=X,G.cursor="-webkit-"+X,G.cursor="-moz-"+X},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(P){return P===Z||L.getConnectAction(null,P)?(this._currentActionType=P,this.redraw(),!0):!1},getEditStyle:function(W){var T=this.getEditInteractor();return T?T.getStyle(W):c},setEditStyle:function(i,f,$){var I=this.getEditInteractor();return I?(I.setStyle(i,f,$),!0):!1},isConnectActionVisible:function(m){var f=L.getConnectAction(this);if(!f)return!1;var x=f.visible;return ik(x)&&(x=x(this,m)),x},isInteractive:function(G){if(this._drawForChecking)return!1;var e=qh(this.getImage(G));return e&&sn(e.interactive,G,this)?!0:G.s("interactive")},appendHTML:function(q,X){var W=this.getView();if(!(X||q&&q.parentNode!==W))return!1;var z=q.getView&&q.getView(),g=q.beforeCanvas;if(!X&&z&&z.parentNode===W)return!1;(q.getView||q.isSelfViewEvent)&&(q=q.getView());var G=this.getEditInteractor();return g?W.insertBefore(q,this.getCanvas()):G&&G._canvas?W.insertBefore(q,G._canvas):this.isScrollBarVisible()?W.insertBefore(q,this.getView().lastChild):Fd(W,q),!0},_layoutHTMLImpl:function(Z,A,m){if(arguments.length>1){var Q,X=this,N=X._zoom;if(A.getView&&(Q=A,A=A.getView()),A.style.position="absolute",m){var E=Z.getRect();Rf(Q||A,X.tx()+E.x*N,X.ty()+E.y*N,E.width*N,E.height*N)}else{var J=new Uh,E=Z.getAnchorRect(),S=Z.getPosition(),w=Z.getScale(),I=A.style;Rf(Q||A,E),J.appendTranslate(X.tx(),X.ty()),J.appendScale(N,N),J.append(new Uh(Z.getRotation(),S.x,S.y,w.x,w.y)),he(I,"transform","matrix("+J.a.toFixed(5)+", "+J.b.toFixed(5)+", "+J.c.toFixed(5)+",\n    "+J.d.toFixed(5)+", "+J.tx.toFixed(5)+", "+J.ty.toFixed(5)+")"),he(I,"transformOrigin",(-E.x).toFixed(5)+"px "+(-E.y).toFixed(5)+"px"),A.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(b){return b instanceof rr?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(t){var L="state",s=t.s(L);if(s)return s;var N=qh(t._image);return N?sn(N[L],t,this)||null:void 0},getShape:function(N){return N.getStyle(Gd)}}),i.defineProperties(si.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(d){this._layoutHTML=d}}});var pd=function($,G){var N=this;N.gv=$,N.s=function(I){return G.getStyle(I)},N._data=G,N._87I=new Dd};hk(pd,i,{_6I:Z,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var G=this,z=G.gv.isSelected(G._data);return!z||G.isShadowed()?0:G.gv.getSelectWidth(G._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(l){var A=this._data,X=this.gv.getBodyColor(A);return X?X:l?A.getStyle(l):Z},_2Q:function(Z){return this.s(Z)},_1Q:function(N,h,d,m){var n=this.s,G=n("2d.gray"),Y=n(h+".dash.color");if(G&&(Y=L.toGrayColor(Y)),N.strokeStyle=Y,N.lineWidth=d,N.stroke(),n(h+".dash.3d")){var f=n(h+".dash.3d.color");qd(N,Y,G?L.toGrayColor(f):f,d,this.gv._zoom,n(h+".dash.3d.accuracy"))}bh(N,m)},invalidate:function(){this._6I=Z},_79o:function(){var o=this;if(!o._6I){var D=o._data,w=o.gv;o.labelInfo=o.label2Info=o.noteInfo=o.note2Info=o._38o=Z,o._87I.clear(),o.interactiveInfo=w.isInteractive(D)?{}:Z,o._3O(),o._55O=w.isEditable(D)?{_42O:w.isRectEditable(D),_43O:w.isPointEditable(D),_56O:w.isRotationEditable(D)}:Z,o._6I=o._81o()}return o._6I},_3O:function(){},getPosition:function(){return Cp},_68o:function(z,W){z&&this._87I.add(gb(z,W))},_81o:function(){var J=this,N=J.s;J._24O(Tp,"getLabel"),J._24O(Mj,"getLabel2"),J._26O(Bl,"getNote"),J._26O(re,"getNote2"),J._15O(),J._55O&&J._48O();var m;if(J._87I.each(function(_){m=ge(m,_)}),m){var t=J.isShadowed(),p=N("shadow2"),k=zl(m);p?(k.x+=N("shadow2.offset.x"),k.y+=N("shadow2.offset.y"),Aq(k,N("shadow2.blur"))):t&&(k.x+=N("shadow.offset.x"),k.y+=N("shadow.offset.y"),Aq(k,N("shadow.blur"))),m=ge(m,k)}return J._87I.clear(),m},_42:function(J){var x=this,Y=x._data,u=x.gv,w=x.s,d=w("opacity"),G=this.isShadowed(),$=w("shadow2");if(G||$){var A=J.shadowOffsetX,W=J.shadowOffsetY,I=J.shadowBlur,H=J.shadowColor,p=u.getZoom()*L.devicePixelRatio,S=G?"shadow":"shadow2";J.shadowOffsetX=w(S+".offset.x")*p,J.shadowOffsetY=w(S+".offset.y")*p,J.shadowBlur=w(S+".blur")*p,J.shadowColor=G?x.getSelectColor():w(S+".color")}if(d!=Z){var X=J.globalAlpha;J.globalAlpha=d}x._80o(J),u.isLabelVisible(Y)&&((!u._drawForChecking||w("label.selectable"))&&$n(J,x.labelInfo),(!u._drawForChecking||w("label2.selectable"))&&$n(J,x.label2Info)),u.isNoteVisible(Y)&&(Qk(J,x.noteInfo),Qk(J,x.note2Info)),x._99O(J),d!=Z&&(J.globalAlpha=X),(G||$)&&(J.shadowOffsetX=A,J.shadowOffsetY=W,J.shadowBlur=I,J.shadowColor=H)},_80o:function(){},_47O:function(){},_24O:function(C,M){var V=this,A=V._data,J=V.gv,i=V.s,c=J[M](A);if(c!=Z){var B=i(C+".scale"),R=i(C+".max"),m=i(C+".position"),$=V[C+"Info"]={label:c,scale:B,color:J[M+"Color"](A),font:i(C+".font"),opacity:i(C+".opacity"),align:i(C+".align"),rotation:V.getRotation(i(C+".rotation"),!1,m),background:J[M+"Background"](A)},F=Yr($,c);R>0&&R<F.width&&($.labelWidth=F.width,F.width=R),1!==B&&(F.width*=B,F.height*=B);var K=V.getPosition(m,i(C+".offset.x"),i(C+".offset.y"),F,i(C+".position.fixed"));if(F.x=K.x-F.width/2,F.y=K.y-F.height/2,V._68o($.rect=F,$.rotation),1!==B){var w=F.width/B,_=F.height/B;$.rect={x:K.x-w/2,y:K.y-_/2,width:w,height:_}}}},_26O:function($,z){var R=this,h=R.gv,l=R._data,K=R.s,I=h[z](l);if(I!=Z){var X,G,b=K($+".scale"),w=R[$+"Info"]={note:I,scale:b,data:l,view:h,expanded:K($+".expanded"),font:K($+".font"),color:K($+".color"),opacity:K($+".opacity"),align:K($+".align"),icon:K($+".icon"),backgroundImage:K($+".backgroundImage"),borderWidth:K($+".border.width"),borderColor:K($+".border.color"),background:h[z+"Background"](l)},n=R.getPosition(K($+".position"),K($+".offset.x"),K($+".offset.y")),D=n.x,V=n.y;if(w.expanded){var M,u=K($+".max"),q=K($+".backgroundImage");q?(q=qh(q),M={width:Vk(q,l),height:xl(q,l)}):M=Yr(w,I),M.width+=6,M.height+=2,u>0&&u<M.width&&(w.labelWidth=M.width,M.width=u),X=M.width,G=M.height+8,w.clickRect={x:D-X*b/2,y:V-G*b,width:X*b,height:G*b*M.height/G}}else{var y=K($+".icon");y?(y=qh(y),X=Vk(y,l),G=xl(y,l)):(X=12,G=18),w.clickRect={x:D-X*b/2,y:V-G*b,width:X*b,height:G*b}}w.rect={x:D-X/2,y:V-G*b/2-G/2,width:X,height:G};var J=N(w.borderWidth/2)*b;R._68o({x:D-X*b/2-J,y:V-G*b-J,width:X*b+2*J,height:G*b+2*J})}},_48O:function(){},_99O:function(v){var y=this,S=y._38o;if(S){var H=y.gv,R=y._data,m=S.icons,l=y.interactiveInfo;l&&(l._38o={});for(var i in m){var W=m[i],F=S.rects[i];if(F){l&&(l._38o[i]=[]);var $=sn(W.opacity,R,H),b=sn(W.names,R,H),_=b?b.length:0,e=F.rotation;if($!=Z){var n=v.globalAlpha;v.globalAlpha*=$}for(var N=0;_>N;N++){var o=b[N],p=qh(o),V=F[N];if(e){var h=V.x+V.width/2,x=V.y+V.height/2;v.save(),Kn(v,h,x),Uo(v,e),Kn(v,-h,-x)}l&&l._38o[i].push(v.interactiveInfo={compInfos:[],matrix:e?new Uh(e,h,x).appendTranslate(-h,-x):new Uh}),_r(v,p,sn(W.stretch,R,H),V.x,V.y,V.width,V.height,y._data,y.gv),v.interactiveInfo=Z,e&&v.restore()}$!=Z&&(v.globalAlpha=n)}}}}});var Mp=function(c,n){to(Mp,this,[c,n])};hk(Mp,pd,{_checkEmptyRect:!0,_40O:function(k,s){var w=this,_=w.s,S=k.rect;(k.borderColor=w.gv.getBorderColor(w._data))&&(k.borderType=_("border.type"),k.borderWidth=_("border.width"),k.borderPadding=_("border.padding"),s=$(s,k.borderPadding+k.borderWidth/2));var X=w._data.getScale(),L=$(1,$(C(X.x),C(X.y)));if(k.selectWidth=w.getSelectWidth()){var Y=w.gv._zoom;k.selectType=_("select.type"),k._97o=w.getSelectColor(),k.selectPadding=_("select.padding"),s=$(s,(k.selectPadding+k.selectWidth/2/Y)/L)}s>0&&(s*=L,S=zl(S),Aq(S,s)),w._68o(S)},_39O:function(r,F){var z,w=this,$=F.rect;if(F.borderWidth>0&&(z=F.borderPadding,r.strokeStyle=F.borderColor,r.lineWidth=F.borderWidth,Up(r,F.borderType,{x:$.x-z,y:$.y-z,width:$.width+2*z,height:$.height+2*z}),r.stroke()),F.selectWidth>0){var L=w.gv._zoom;if(z=F.selectPadding,r.strokeStyle=F._97o,r.lineWidth=F.selectWidth/L,F.rotation!=Z){r.save(),r.translate(F.position.x,F.position.y),r.rotate(F.rotation);var u=w._data,c=u.getWidth(),O=u.getHeight(),_=F.scale,q=F.anchor;$={x:_.x*-c*q.x,y:_.y*-O*q.y,width:_.x*c,height:_.y*O}}Up(r,F.selectType,{x:$.x-z,y:$.y-z,width:$.width+2*z,height:$.height+2*z}),F.rotation!=Z&&r.restore(),r.stroke()}},dispose:function(){var X=this,I=X._htmlView;Mp.superClass._3O.call(X),I&&(I.onHTMLRemoved&&I.onHTMLRemoved(),ws(I))},_3O:function(){var G,V=this,F=V.s,X=V._data,r=V.gv,U=r.getShape(X),S=V.getBodyColor(),A=F("shape.border.color"),i=V._83o=U?{shape:U,_53o:V.getBodyColor("shape.background"),_27Q:qh(F("shape.repeat.image"),S),shapeGradientPack:F("shape.gradient.pack"),_54o:F("shape.border.width"),_55o:A,shapeBorderRepeatImage:qh(F("shape.border.repeat.image"),A),_56o:F("shape.border.3d"),_57o:F("shape.border.3d.color"),_58o:F("shape.border.3d.accuracy"),shapeGradient:F("shape.gradient"),_59o:F("shape.gradient.color"),_60o:F("shape.border.pattern"),_61o:F("shape.border.cap"),_62o:F("shape.border.join"),shapeForeground:F("shape.foreground"),bodyColor:S,gray:F("2d.gray")}:{img:qh(r.getImage(X),S),bodyColor:S,gray:F("2d.gray"),stretch:F("image.stretch")},t=i.img;t&&t.renderHTML?(V._htmlInfo&&V._htmlInfo.img!==t&&(V._htmlInfo=Z),V._htmlInfo||(V._htmlInfo={img:t,cache:{}}),G=t.renderHTML(X,r,V._htmlInfo.cache)):V._htmlInfo=Z,V._htmlView&&V._htmlView!==G&&(V._htmlView.onHTMLRemoved&&V._htmlView.onHTMLRemoved(),ws(V._htmlView.getView?V._htmlView.getView():V._htmlView)),(V._htmlView=G)&&r.appendHTML(G)&&(G.onHTMLAddedSync&&G.onHTMLAddedSync(),G.onHTMLAdded&&jf(G.onHTMLAdded)),i.rect=X.getRect(),i.position=X.p(),i.scale=X.getScale(),i.anchor=X.getAnchor(),i.rotation=X.getRotation(),U===ug&&(i._63o=F("shape.depth"));var j=0;if(U)j=fo(Z,i._54o/2,i._62o),V.s("shape.dash")&&(j=$(j,(V.s("shape.dash.width")||i._54o)/2));else if(t&&t.boundExtend)if(j=sn(t.boundExtend,X,r),t.boundExtendAbsolute){var m=X.getScale();j/=r._zoom*$(1,$(C(m.x),C(m.y)))}else if(!sn(t.fitSize,X,r)){var W=sn(t.width,X,r),w=sn(t.height,X,r);j*=$(X.getWidth()/W,X.getHeight()/w)}V._40O(i,j);var y=Sd(X,r.isSelected(X)),d=F("clip.percentage");if(1>d&&(0>d&&(d=0),i.clipRect=To(X.getAnchorRect(),F("clip.direction"),d,y)),U){var e=F("shape.fill.clip.percentage");1>e&&(0>e&&(e=0),i.shapeClipRect=To(X.getAnchorRect(),F("shape.fill.clip.direction"),e,y));var u=F("shape.foreground.clip.percentage");1>u&&(0>u&&(u=0),i.shapeForegroundClipRect=To(X.getAnchorRect(),F("shape.foreground.clip.direction"),u,y))}},getPosition:function(Q,l,F,u){var g=Gh(Q,this._83o.rect,u);return g.x+=l,g.y+=F,g},_80o:function(S){var y=this,m=y.s,j=y.gv,J=y._data,O=y._83o,P=O.rect,M=O.position,W=O.rotation,b=O.anchor,u=O.scale,A=O.shape,e=O.clipRect;if(!y._checkEmptyRect||P.width>0&&P.height>0){var i=J.getSize();if(i.x=-i.width*b.x,i.y=-i.height*b.y,og&&!jj&&Kn(S,i.width,i.height),S.save(),Kn(S,M.x,M.y),Uo(S,W),Pn(S,u.x,u.y),e&&(S.beginPath(),S.rect(e.x,e.y,e.width,e.height),S.clip()),j._drawForChecking&&O.img&&sn(O.img.pixelPerfect,J,j)===!1)Ki(S,i.x,i.y,i.width,i.height,"#888888");else if(y.freeDraw)y.freeDraw(S,i,O);else if(A){var l,s,K,N,V=O._60o,U=Ui(S,V),D=O._27Q,p=O._54o,a=O.shapeGradientPack,I=O.gray,$=S.lineJoin,R=S.lineCap,E=function(V){return I?L.toGrayColor(V):V};"roundRect"===A?l=m("shape.corner.radius"):"polygon"===A?l=m("shape.polygon.side"):"arc"===A&&(l=m("shape.arc.from"),s=m("shape.arc.to"),K=m("shape.arc.close"),N=m("shape.arc.oval")),S.lineJoin=O._62o,S.lineCap=O._61o;var T=E(O._53o);if(T||D||a){var C=O.shapeClipRect;C&&(S.save(),S.beginPath(),S.rect(C.x,C.y,C.width,C.height),S.clip()),Up(S,A,i,l,s,K,N),a?Lh(S,a,function(K){return Ip(K,O.bodyColor)}):D?yq(S,D,E(O.bodyColor),null,J,j):$d(S,T,O.shapeGradient,E(O._59o),i),S.fill(),a&&S.restore(),C&&S.restore(),S!==U&&Up(U,A,i,l,s,K,N)}else Up(U,A,i,l,s,K,N);var t=O.shapeForeground;if(t){S.save();var n=O.shapeForegroundClipRect;n&&(S.beginPath(),S.rect(n.x,n.y,n.width,n.height),S.clip()),Up(S,A,i,l,s,K,N),$d(S,t,m("shape.foreground.gradient"),E(m("shape.foreground.gradient.color")),i),S.fill(),S.restore()}if(p>0){var _=m("shape.border.width.absolute");_&&(S.save(),S.setTransform(1,0,0,1,0,0)),S.lineWidth=p;var X=E(O._55o);O.shapeBorderRepeatImage?ci(S,O.shapeBorderRepeatImage,X,null,J,j):S.strokeStyle=X,S.stroke(),_&&S.restore(),O._56o&&qd(S,X,E(O._57o),p,j._zoom,O._58o)}if(bh(S,V),m("shape.dash")){var H=m("shape.dash.width")||p;if(H>0){V=m("shape.dash.pattern");var U=Ui(S,V,y._2Q("shape.dash.offset"));U!==S&&Up(U,A,i,l,s,K,N),y._1Q(S,"shape",H,V)}}yn(S,T,O._63o,i),S.lineJoin=$,S.lineCap=R}else{var g=y.interactiveInfo;g&&(S.interactiveInfo=g.bodyInfo={compInfos:[],matrix:new Uh(W,M.x,M.y,u.x,u.y)}),O.gray&&(S.compGray=!0);var k=O.img;k&&k.cacheRule!=Z&&(k=Yp(S,k,O.stretch,i.width,i.height,J,j,O.bodyColor)),_r(S,k,O.stretch,i.x,i.y,i.width,i.height,J,j,O.bodyColor),S.compGray=!1,S.interactiveInfo=Z}S.restore()}y._39O(S,O)},_48O:function(){},_47O:function(){}});var Zq=function(P,N){to(Zq,this,[P,N])},pk=function(m,j,F,y){var B=Yf(m,j);return F=y?S(F,B):xc(F,B),B?F/=B:F=0,{x:m.x+(j.x-m.x)*F,y:m.y+(j.y-m.y)*F}};hk(Zq,pd,{_3O:function(){var B,K=this,J=K._data,k=K.gv,V=K.s,o=V(Qe),O=J.isLooped(),W=V("edge.width"),m=K.getBodyColor("edge.color"),l=V("edge.center"),u=V("edge.offset"),d=k.getBorderColor(J),y=d?V("border.width"):0,X=K.getSelectWidth(),Y=J._40I,s=J._41I,r=K._78o=Y&&s?{looped:O,type:o,width:W,center:l,color:m,repeatImage:qh(V("edge.repeat.image"),m),borderColor:d,borderWidth:y,_97o:X?K.getSelectColor():Z,selectWidth:X,pattern:V("edge.pattern"),cap:V("edge.cap"),join:V("edge.join"),is3d:V("edge.3d"),_67o:V("edge.3d.color"),_66o:V("edge.3d.accuracy"),gray:V("2d.gray")}:Z;if(r){var I=L.getEdgeType(o);if(I){var z=I(J,qj(K,k,J,O,o),k,K._19Q);z.points&&z.points.size()>1?(r.edgeTypeInfo=z,B=An(r.edgeTypeInfo.points)):z[Yh]&&z.rect&&(r.edgeTypeInfo=z,B=z.rect)}else{var D=V("edge.source.anchor.x"),C=V("edge.source.anchor.y"),R=V("edge.target.anchor.x"),n=V("edge.target.anchor.y"),P=dl(k,J,"source"),w=dl(k,J,"target");if(o===Eb){var G=r.points=V(xi)||jr,g=G.size();r.segments=V("edge.segments");var A=D!==c||C!==c||El(Y),j=R!==c||n!==c||El(s);if(!l)if(u)A||(P=pk(P,g?G.get(0):w,u,g)),j||(w=pk(w,g?G.get(g-1):P,u,g));else{var i;A||(i=ln(P,g?G.get(0):w,aj(k,Y)),i&&(P={x:i[0],y:i[1]})),j||(i=ln(g?G.get(g-1):P,w,aj(k,s)),i&&(w={x:i[0],y:i[1]}))}B=ge(An(r.points),An(P,w))}else{var S=qj(K,k,J,O,o);if(K._19Q||(S=-S),O)P=zl(P),P.x=k.getNodeRect(Y).x,r.radius=S,B={x:P.x-S,y:P.y-S,width:2*S,height:2*S};else{var Q=Yf(P,w),E=xc(u,Q),_={x:E,y:S},b={x:Q-E,y:S},T=Nh(w.y-P.y,w.x-P.x),t=r.mat=new qe(T);if(r.orienAngle=T,r.angle=w.x<P.x?T+v:T,r.rect={x:_.x,y:_.y,width:b.x-_.x,height:0},r.origin=P,_=t.tf(_),_.x+=P.x,_.y+=P.y,b=t.tf(b),b.x+=P.x,b.y+=P.y,l){var e={x:Q,y:0};e=t.tf(e),e.x+=P.x,e.y+=P.y,B=An([P,_,b,e]),r.c1=P,r.c2=e}else B=An(_,b);P=_,w=b}}r.sourcePoint=P,r.targetPoint=w,J._lastSourcePoint=P,J._lastTargetPoint=w}var q=0;V("edge.dash")&&(q=V("edge.dash.width")||W);var U="square"===r.cap?.71:.5;fo(B,$(q*U,W*U+y+X),r.join),K._68o(B)}},getRotation:function(y,C,h){y=y||0;var v=this._78o;if(v){var n,r=v.angle,S=v.points,e=v.edgeTypeInfo;if(r!=Z)return C?v.orienAngle+y:r+y;if(e&&e[Yh])return e.getRotation?e.getRotation(this,y,C,h):0;if(e&&e.points){var N=e.points;return n=N.size(),Zi[h]?n&&0===n%2?Mm(N.get(n/2-1),N.get(n/2),C,y):y:No[h]?Mm(N.get(0),N.get(1),C,y):Mm(N.get(n-2),N.get(n-1),C,y)}if(S)return n=S.size(),Zi[h]?n&&0===n%2?Mm(S.get(n/2-1),S.get(n/2),C,y):y:No[h]?Mm(v.sourcePoint,n?S.get(0):v.targetPoint,C,y):Mm(n?S.get(n-1):v.sourcePoint,v.targetPoint,C,y)}return y},getPosition:function(B,V,O,I,H){var j=this._78o;if(j){var D,G=j.type,n=j.points,M=j.edgeTypeInfo,$=j.sourcePoint,Y=j.targetPoint;if(!G)return j.looped?{x:$.x-j.radius+V,y:$.y+O}:(H&&$&&Y&&($.x>Y.x||$.x===Y.x&&$.y>Y.y)&&(B=Wd[B],O=-O),D=Gh(B,j.rect,I),D.x+=V,D.y+=O,D=j.mat.tf(D),D.x+=j.origin.x,D.y+=j.origin.y,D);if(M&&M[Yh])return M.getPosition?M.getPosition(this,B,V,O,I,H):{x:($.x+Y.x)/2,y:($.y+Y.y)/2};if(n){var D,d=n.size();if(Zi[B]){if(d){var K=d%2;if(0===K)return kf(n.get(d/2-1),n.get(d/2),B,V,O,I,H);D=n.get((d-K)/2)}else D={x:($.x+Y.x)/2,y:($.y+Y.y)/2};return D=Gh(B,{x:D.x,y:D.y,width:0,height:0},I),D.x+=V,D.y+=O,D}return No[B]?kf($,d?n.get(0):Y,B,V,O,I,H):kf(d?n.get(d-1):$,Y,B,V,O,I,H)}if(M){var i=M.points,d=i.size();if(Zi[B]){var K=d%2;return 0===K?kf(i.get(d/2-1),i.get(d/2),B,V,O,I,H):(D=i.get((d-K)/2),D=Gh(B,{x:D.x,y:D.y,width:0,height:0},I),D.x+=V,D.y+=O,D)}return No[B]?kf(i.get(0),i.get(1),B,V,O,I,H):kf(i.get(d-2),i.get(d-1),B,V,O,I,H)}}return Cp},_42:function(e){this._78o&&Zq.superClass._42.call(this,e)},drawPath:function(c,M){c.beginPath();var g=M.type,K=M.points,L=M.segments,Y=M.edgeTypeInfo;if(!g||K){var y=M.sourcePoint,S=y.x,P=y.y,e=M.targetPoint,A=e.x,x=e.y;if(g)if(L){var r=new Dd({x:S,y:P});r.addAll(K),r.add({x:A,y:x}),Eh(c,r,L)}else c.moveTo(S,P),K.each(function(l){c.lineTo(l.x,l.y)}),c.lineTo(A,x);else M.looped?c.arc(S,P,M.radius,0,s,!0):M.center?(c.moveTo(M.c1.x,M.c1.y),c.lineTo(S,P),c.lineTo(A,x),c.lineTo(M.c2.x,M.c2.y)):(c.moveTo(S,P),c.lineTo(A,x))}else Y&&(Y.points?Eh(c,Y.points,Y.segments):Y[Yh]&&Y[Yh](c,Y))},_80o:function(c){var k=this,e=k.s,f=k._78o,D=f.width,$=f.selectWidth,v=f.borderWidth,p=f.repeatImage,X=c.lineJoin,M=c.lineCap,R=f.gray,q=f.pattern;c.lineJoin=f.join,c.lineCap=f.cap,k.drawPath(Ui(c,q),f);var A=e("edge.width.absolute");A&&(c.save(),c.setTransform(1,0,0,1,0,0)),$&&(c.strokeStyle=f._97o,c.lineWidth=D+2*(v+$),c.stroke()),v&&(c.strokeStyle=R?L.toGrayColor(f.borderColor):f.borderColor,c.lineWidth=D+2*v,c.stroke());var O=R?L.toGrayColor(f.color):f.color;if(p?ci(c,p,O,null,k._data,k.gv):c.strokeStyle=O,c.lineWidth=D,c.stroke(),f.is3d){var U=R?L.toGrayColor(f._67o):f._67o;qd(c,O,U,D,k.gv._zoom,f._66o)}if(bh(c,q),e("edge.dash")){q=e("edge.dash.pattern");var F=Ui(c,q,k._2Q("edge.dash.offset"));F!==c&&k.drawPath(F,f),k._1Q(c,"edge",e("edge.dash.width")||D,q)}A&&c.restore(),c.lineJoin=X,c.lineCap=M},_48O:function(){},_47O:function(){}});var ip=function(Z,J){to(ip,this,[Z,J])};hk(ip,Mp,{_3O:function(){var j,K,w=this,V=w.s,P=w._data,D=w.gv;if(w._88I=Z,P.isExpanded()&&P.eachChild(function(g){if(lm(g)){var x=D.getBoundsForGroup(g);x&&(K||(K=[]),K.push(x),j=ge(j,x))}}),j){var N=D.getLabel(P),h=V("group.type"),F=V("group.border.width")||0,e=V("group.border.width.absolute"),Y=F/2;e&&(F/=D._zoom),j=bo(h,K,j),Ig(j,P,"group.padding",1),Aq(j,F);var H=w._88I={type:h,rect:j,_64o:j};if(!h&&N!=Z){var l,U=w.labelInfo={label:N,color:V("group.title.color"),font:V("group.title.font"),align:V("group.title.align")},y=Yr(U,N),t=y.width+F,O=y.height+F,C=V("group.title.align"),k=V("group.title.orientation");if(k===Vl||k===mf?(j.height+=F,t>j.width&&(j.width=t)):(k===Cl||k===ij)&&(j.width+=F,t>j.height&&(j.height=t)),l=C===Cl?j.x:C===ij?j.x+j.width-t:j.x+j.width/2-t/2,k===mf)H.titleRect={x:j.x,y:j.y+j.height,width:j.width,height:O},H.rect={x:j.x,y:j.y,width:j.width,height:j.height+O},U.rect={x:l,y:j.y+j.height,width:t,height:O};else if(k===Cl){var c=H.titleRect={x:j.x-O,y:j.y,width:O,height:j.height};H.rect={x:j.x-O,y:j.y,width:j.width+O,height:j.height},U.rect={x:c.x+O/2-j.height/2,y:c.y+j.height/2-O/2,width:j.height,height:O},U.rotation=-Math.PI/2}else if(k===ij){var c=H.titleRect={x:j.x+j.width,y:j.y,width:O,height:j.height};H.rect={x:j.x,y:j.y,width:j.width+O,height:j.height},U.rect={x:c.x+O/2-j.height/2,y:c.y+j.height/2-O/2,width:j.height,height:O},U.rotation=Math.PI/2}else H.titleRect={x:j.x,y:j.y-O,width:j.width,height:O},H.rect={x:j.x,y:j.y-O,width:j.width,height:j.height+O},U.rect={x:l,y:j.y-O-Y,width:t,height:O+F}}w._40O(H,V("group.border.width")/2)}else ip.superClass._3O.call(w)},getPosition:function(C,E,B,i){var t=this._88I;if(t){var z=Gh(C,t.rect,i);return z.x+=E,z.y+=B,z}return ip.superClass.getPosition.apply(this,arguments)},_24O:function(g,X){var u=this._88I;(!u||u.type||"label2"===g)&&ip.superClass._24O.call(this,g,X)},_80o:function(s){var T=this,M=T._88I;if(M){var g=T._data,X=T.s,k=T.gv,n=M.type,C=M.rect,Z=M._64o,S=M.titleRect,L=T.getBodyColor(),A=qh(X("group.image"),L),f=X("group.image.stretch"),j=T.getBodyColor("group.background"),x=qh(X("group.repeat.image"),L),v=X("group.gradient.pack"),u=X("group.gradient"),c=X("group.gradient.color"),W=X("group.border.width"),t=X("group.border.color"),q=X("group.border.pattern"),w=X("group.title.orientation"),D=X("group.depth"),E=X("group.border.radius"),m=X("group.border.join"),V=X("group.border.cap"),U=X("group.border.width.absolute");U&&(W/=k._zoom);var R=t,O=X("group.border.repeat.image");if(O&&(O=qh(O,t))&&(R=Mf(s,O,t,null,g,k)),n){var H=s.lineJoin,p=s.lineCap;if(s.lineJoin=m,s.lineCap=V,A){if(s.save(),Up(s,n,C,E),s.clip(),_r(s,A,f,C.x,C.y,C.width,C.height,g,k,L),s.restore(),W>0){var $=Ui(s,q);Up($,n,C,E),s.lineWidth=W,s.strokeStyle=R,s.stroke(),bh(s,q)}}else{var $=Ui(s,q);j||x||v?(Up(s,n,C,E),v?Lh(s,v,function(f){return Ip(f,L)}):x?yq(s,x,L,null,g,k):$d(s,j,u,c,C),s.fill(),v&&s.restore(),s!==$&&Up($,n,C,E)):Up($,n,C,E),W>0&&(s.lineWidth=W,s.strokeStyle=R,s.stroke()),bh(s,q),n===ug&&yn(s,j,D,C)}s.lineJoin=H,s.lineCap=p}else{var l=X("group.title.background");if((!E||0>E)&&(E=0),A)_r(s,A,f,Z.x,Z.y,Z.width,Z.height,g,k,T.getBodyColor());else if(j||x)if(x?yq(s,x,L,null,g,k):$d(s,j,u,c,Z),0===W)Up(s,ug,Z),s.fill(),yn(s,j,D,Z);else{switch(s.beginPath(),w){case mf:Je(s,Z.x,Z.y,Z.width,Z.height,E,E,0,0);break;case Cl:Je(s,Z.x,Z.y,Z.width,Z.height,0,E,0,E);break;case ij:Je(s,Z.x,Z.y,Z.width,Z.height,E,0,E,0);break;case Vl:Je(s,Z.x,Z.y,Z.width,Z.height,0,0,E,E)}s.fill()}if(S&&l)if(0===W)Ki(s,S.x,S.y,S.width,S.height,l),yn(s,l,D,S);else{switch(s.beginPath(),s.fillStyle=l,w){case mf:Je(s,S.x,S.y,S.width,S.height,0,0,E,E);break;case Cl:Je(s,S.x,S.y,S.width,S.height,E,0,E,0);break;case ij:Je(s,S.x,S.y,S.width,S.height,0,E,0,E);break;case Vl:Je(s,S.x,S.y,S.width,S.height,E,E,0,0)}s.fill()}if(W>0){var $=Ui(s,q);if(Up($,"roundRect",C,E),s.save(),s.lineWidth=W,s.strokeStyle=R,s.lineJoin=m,s.lineCap=V,s.closePath(),s.stroke(),S&&X("group.splitLine")){var i=S.x,d=S.y,J=S.width,B=S.height;s.beginPath(),w===mf?(s.moveTo(i,d),s.lineTo(i+J,d)):w===Cl?(s.moveTo(i+J,d),s.lineTo(i+J,d+B)):w===ij?(s.moveTo(i,d),s.lineTo(i,d+B)):(s.moveTo(i,d+B),s.lineTo(i+J,d+B))}s.stroke(),s.restore(),bh($,q)}}T._39O(s,M)}else ip.superClass._80o.call(T,s)}});var gq=function(t,E){to(gq,this,[t,E])};hk(gq,Mp,{_80o:function(k){this._39O(k,this._83o)}});var qo=function(L,Y){to(qo,this,[L,Y])};hk(qo,Mp,{_3O:function(){var B=this,L=B._data,q=B.s,_=B.gv,X=L.getPoints(),O=_.getBorderColor(L),J=O?q("border.width"):0,r=B.getSelectWidth(),j=q("shape.border.width"),c=L.getRect(),y=L.getAnchorRect(),R=_.getBodyColor(L),o=q("shape.border.color"),s=B._99o=X.isEmpty()?Z:{rect:c,rotation:L.getRotation(),fillRule:q("shape.fill.rule"),scale:L.getScale(),position:L.p(),points:X,segments:L.getSegments(),bodyColor:R,borderColor:O,borderWidth:J,_94o:q("shape.border.3d"),_95o:q("shape.border.3d.color"),_96o:q("shape.border.3d.accuracy"),_97o:r?B.getSelectColor():Z,selectWidth:r,_53o:q("shape.background"),_27Q:qh(q("shape.repeat.image"),R),shapeGradientPack:q("shape.gradient.pack"),_54o:j,_55o:o,shapeBorderRepeatImage:qh(q("shape.border.repeat.image"),o),shapeGradient:q("shape.gradient"),_59o:q("shape.gradient.color"),_60o:q("shape.border.pattern"),_61o:q("shape.border.cap"),_62o:q("shape.border.join"),shapeForeground:q("shape.foreground"),gray:q("2d.gray")};if(s){y.x+=s.position.x,y.y+=s.position.y,s.gradientRect=y;var x=L.getScale(),l=$(1,$(C(x.x),C(x.y)));q("shape.dash")&&q("shape.dash.width")>j&&(j=q("shape.dash.width"));var h,I=q("shape.border.width.absolute");h=I?(j+J+r)/B.gv._zoom/l:j*("square"===s._61o?.71:.5)+J+r/B.gv._zoom/l,h&&(h*=l,c=zl(c),fo(c,h,s._62o)),B._68o(c);var z=Sd(L,_.isSelected(L)),S=q("clip.percentage");1>S&&(0>S&&(S=0),s.clipRect=To(L.getAnchorRect(),q("clip.direction"),S,z));var E=q("shape.fill.clip.percentage");1>E&&(0>E&&(E=0),s.shapeClipRect=To(L.getAnchorRect(),q("shape.fill.clip.direction"),E,z));var i=q("shape.foreground.clip.percentage");1>i&&(0>i&&(i=0),s.shapeForegroundClipRect=To(L.getAnchorRect(),q("shape.foreground.clip.direction"),i,z))}},getPosition:function(T,u,C,q){var B=this._99o;if(B){var v=Gh(T,B.rect,q);return v.x+=u,v.y+=C,v}return Cp},_42:function(D){this._99o&&qo.superClass._42.call(this,D)},_80o:function(u){var V,j=this,P=j.s,q=j._99o,z=q.position,W=q.scale,C=q.rotation,f=q.borderWidth,Y=q.selectWidth/j.gv._zoom,E=q._27Q,b=q.shapeGradientPack,t=q._54o,U=q.clipRect,S=q.shapeClipRect,w=q.points,D=q.segments,N=j._data.isClosePath(),B=q.fillRule,e=q.gray,m=function(T){return e?L.toGrayColor(T):T},a=m(q._53o),M=a||E||b;u.save(),Kn(u,z.x,z.y),Uo(u,C),Pn(u,W.x,W.y),U&&(u.beginPath(),u.rect(U.x,U.y,U.width,U.height),u.clip()),M&&S&&(u.save(),u.beginPath(),u.rect(S.x,S.y,S.width,S.height),u.clip()),Kn(u,-z.x,-z.y);var n=q._60o,p=Ui(u,n),Z=u.lineJoin,R=u.lineCap;u.lineJoin=q._62o,u.lineCap=q._61o;var g=m(q.bodyColor);M?(Eh(u,w,D,N),b?Lh(u,b,function(Y){return Ip(Y,q.bodyColor)}):E?yq(u,E,g,null,j._data,j.gv):(V=g?g:a,$d(u,V,q.shapeGradient,m(q._59o),q.gradientRect)),u.fill(B),b&&u.restore(),S&&(u.restore(),Kn(u,-z.x,-z.y)),p!==u&&Eh(p,w,D,N)):Eh(p,w,D,N);var h=q.shapeForeground;if(h){u.save();var i=q.shapeForegroundClipRect;i&&(Kn(u,z.x,z.y),u.beginPath(),u.rect(i.x,i.y,i.width,i.height),u.clip(),Kn(u,-z.x,-z.y)),Eh(u,w,D,N),$d(u,h,P("shape.foreground.gradient"),m(P("shape.foreground.gradient.color")),q.gradientRect),u.fill(B),u.restore()}var o=P("shape.border.width.absolute");if(o&&(u.save(),u.setTransform(1,0,0,1,0,0)),Y&&(u.strokeStyle=q._97o,u.lineWidth=t+2*(f+Y),u.stroke()),f&&(u.strokeStyle=m(q.borderColor),u.lineWidth=t+2*f,u.stroke()),t&&(V=m(q._55o),q.shapeBorderRepeatImage?ci(u,q.shapeBorderRepeatImage,V,null,j._data,j.gv):(!a&&g&&(V=g),u.strokeStyle=V),u.lineWidth=t,u.stroke(),q._94o&&qd(u,V,m(q._95o),t,j.gv._zoom,q._96o)),bh(u,n),P("shape.dash")){var K=P("shape.dash.width")||t;if(K>0){n=P("shape.dash.pattern");var p=Ui(u,n,j._2Q("shape.dash.offset"));p!==u&&Eh(p,w,D,N),j._1Q(u,"shape",K,n)}}o&&u.restore(),u.lineJoin=Z,u.lineCap=R,u.restore()},_48O:function(){},_47O:function(){}});var zb=function(I,x){to(zb,this,[I,x])};hk(zb,qo,{getRotation:function(C,P,O){C=C||0;var Z=this._data.getPoints(),v=Z.size();return v>1?Zi[O]?v&&0===v%2?Mm(Z.get(v/2-1),Z.get(v/2),P,C):C:No[O]?Mm(Z.get(0),Z.get(1),P,C):Mm(Z.get(v-2),Z.get(v-1),P,C):C},getPosition:function(c,i,S,x,O){var J=this._data.getPoints(),t=J.size();if(t>1){if(Zi[c]){var j=t%2;if(0===j)return kf(J.get(t/2-1),J.get(t/2),c,i,S,x,O);var s=J.get((t-j)/2),f={x:s.x,y:s.y,width:0,height:0};return s=Gh(c,f,x),s.x+=i,s.y+=S,s}return No[c]?kf(J.get(0),J.get(1),c,i,S,x,O):kf(J.get(t-2),J.get(t-1),c,i,S,x,O)}return Cp}});var ak=function(F,s){to(ak,this,[F,s])};hk(ak,Mp,{_3O:function(){var s=this;ak.superClass._3O.call(s);var b=s.s,P=s._83o;s._82o=P.img||P.shape?Z:{background:s.getBodyColor("grid.background"),depth:b("grid.depth"),rect:P.rect,_88o:b("grid.cell.depth"),cellBorderColor:b("grid.cell.border.color"),_89o:b("grid.row.count"),_90o:b("grid.column.count"),block:b("grid.block"),_91o:b("grid.block.color"),_92o:b("grid.block.padding"),_93o:b("grid.block.width")}},_80o:function(W){var u=this,A=u._82o;if(!A)return ak.superClass._80o.call(u,W),void 0;var I,L,m=u._data,O=A.background,o=A.rect,P=A.block,n=A._91o,Q=A._92o,k=A._93o,g=A._88o,i=A.cellBorderColor,$=A._89o,q=A._90o;if(O)if(Ki(W,o.x,o.y,o.width,o.height,O),yn(W,O,A.depth,o),g)for(I=0;$>I;I++)for(L=0;q>L;L++)o=m.getCellRect(I,L),o&&yn(W,O,g,o);else if(i){for(W.beginPath(),I=0;$>I;I++)for(L=0;q>L;L++)o=m.getCellRect(I,L),o&&W.rect(o.x,o.y,o.width,o.height);W.strokeStyle=i,W.lineWidth=1,W.stroke()
}if("h"===P)for(I=0;$>I;I++)o=ge(m.getCellRect(I,0),m.getCellRect(I,q-1)),Aq(o,Q),hj(W,n,o.x,o.y,o.width,o.height,k);else if("v"===P)for(L=0;q>L;L++)o=ge(m.getCellRect(0,L),m.getCellRect($-1,L)),Aq(o,Q),hj(W,n,o.x,o.y,o.width,o.height,k);u._39O(W,u._83o)}});var xp=function(_,O){to(xp,this,[_,O])};hk(xp,Mp,{_checkEmptyRect:!1,_81o:function(){var i=this._data,d=xp.superClass._81o.call(this),N=i.s("text");if(N!=Z){var J,r,b=i.s("text.font"),k=i.s("text.align"),$=i.s("text.vAlign"),c=dd(b,N),h=c.width,x=c.height,C=i.getAnchor(),I=i.getWidth(),y=i.getHeight();"left"===k?J=-I*C.x:"center"===k?J=-I*C.x+(I-h)/2:"right"===k&&(J=I*(1-C.x)-c.width),"top"===$?r=-y*C.y:"middle"===$?r=-y*C.y+(y-x)/2:"bottom"===$&&(r=y*(1-C.y)-c.height);var j,w=i.getMatrix();if(j=An([w.tf(J,r),w.tf(J+h,r),w.tf(J+h,r+x),w.tf(J,r+x)]),d=ge(d,j),d&&i.s("text.shadow")){var q=zl(d);q.x+=i.s("text.shadow.offset.x"),q.y+=i.s("text.shadow.offset.y"),Aq(q,i.s("text.shadow.blur")),d=ge(d,q)}}return d}});var uq=si.Interactor=function(I){this.gv=this._graphView=I};ej("Interactor",i,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(I){this.gv.fi(I)},setCursor:function(K){Km||this.gv.setCursor(K)},startDragging:function(d){var Q=this;Q._lastClientPoint=Nq(d),Q._lastLogicalPoint=Q.gv.lp(d),co(Q,d)},clearDragging:function(){var R=this;R._lastClientPoint=R._lastLogicalPoint=R._logicalPoint=Z},autoScroll:function(M){return this.gv.autoScroll(M,this._lastClientPoint)}});var vb=Z,kd=function(h){vb.handleWindowTouchMove(h)},ll=function(r){vb.handleWindowTouchEnd(r),M(j,ad,kd),M(j,Ah,ll),vb=Z},kk=function(v){vb.handleWindowMouseMove(v)},gp=function(y){vb.handleWindowMouseUp(y),M(j,Cn,kk),M(j,fr,gp),vb=Z},mo=function(i,V){if(i!==vb){var P=wf(V);vb?P?vb.handleWindowTouchEnd(V):vb.handleWindowMouseUp(V):P?(n(j,ad,kd),n(j,Ah,ll)):(n(j,Cn,kk),n(j,fr,gp)),vb=i}},Lj=function(X){var q=this;q.gv=X,q._is2d=X instanceof si.GraphView,q._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",ni,"wheel"].forEach(function($){q.addListener($)}),q.initImageResource()};hk(Lj,uq,{enableVR:function(c){var z=this;!!z._vrEnable!==c&&(z._vrEnable=c,c?z.gv.vr.mp(z.onVRControllerChange,z):z.gv.vr.ump(z.onVRControllerChange,z))},onVRControllerChange:function(t){var u=this,q=t.property,U=t.newValue,Y=U.id,C=u.gv.vr.getController(Y),W=C.getRay();if(W){W.controllerId=Y;var V=u.gv.vr.getRayEventType(W,q,U._62O);switch(V){case"down":u.handle_mousedown(W);break;case"up":vb&&gp(W);break;case"move":u.handle_mousemove(W),vb&&u.handleWindowMouseMove(W)}}},setPreventEventDefault:function(Z,o){var t=this,K=t._eventListeners[Z];K?K._prevent=o:t._eventListeners[Z]=K={_removal:c,_prevent:o}},removeListener:function(y){var B=this,$=B._eventListeners[y];$&&$._removal&&($._removal(),$._removal=c)},addListener:function(S){var y=this,w=y._eventListeners[S];if(w||(y._eventListeners[S]=w={_removal:c,_prevent:!0}),!w||!w._removal){var Y=function(U){w._prevent&&L.preventDefault(U),y.disabled||("wheel"===S?ng(y,U):y["handle_"+S](U))};n(y.gv.getView(),S,Y),w._removal=function(){M(y.gv.getView(),S,Y)}}},handleWindowTouchMove:function(T){this.handleWindowMouseMove(T)},handleWindowMouseMove:function(v){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",v):(this.handleDownInfo("onBeginDrag",v),this.isDragging=!0))},handleWindowTouchEnd:function(o){this.handleWindowMouseUp(o)},handleWindowMouseUp:function(D){if(this.isDragging&&(this.handleDownInfo("onEndDrag",D),this.isDragging=!1),this.downInfo){var c=this.handle("onUp",D);if(c&&c.data===this.downInfo.data){this.handleMissingUp(D);var j=this,a=2===D.button?"onContextMenu":"onClick";if(!j._dbclickTimer)return j._dbclickTimer=vc(function(){delete j._dbclickTimer,j.handleClick(D,a,c),this.downInfo=Z},L.clickDelay),void 0;ki(j._dbclickTimer),delete j._dbclickTimer,a="onDoubleClick",j.handleClick(D,a,c)}else this.handleDownInfo("onUp",D);this.downInfo=Z,this.downComps=Z}},handle_mouseleave:function(F){var q=this,c=q.gv;q._hoverTimer&&(ki(q._hoverTimer),delete q._hoverTimer);var u=q.currentInfo?q.currentInfo.data:Z;if(u){u.s("onLeave")&&u.s("onLeave")(F,u,c),q.fire("data","onLeave",F,u);var l=q.currentInfo?q.currentInfo.hits:Z;if(l)for(var Q in l)q.handleLeave(F,Q);q.currentInfo=Z}},handle_mousewheel:function(n){n.scrollDelta=n.wheelDelta/40,this.handle("onScroll",n)},handle_DOMMouseScroll:function(T){T.scrollDelta=2===T.axis?-T.detail:0,this.handle("onScroll",T)},handle_touchstart:function(X){this.handle_mousedown(X)},handle_touchmove:function(K){this.handle("onMove",K)},handle_mousedown:function(A){this.isDragging&&(this.handleDownInfo("onEndDrag",A),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",A),this.downInfo&&mo(this,A)},handle_mousemove:function(H){var m=this,a=m.gv;if(m._hoverTimer&&(ki(m._hoverTimer),delete m._hoverTimer),!a._panning&&!a._moving){var j,f,J,p=m.handle("onMove",H),$=this.currentInfo?this.currentInfo.data:Z,n=this.currentInfo?this.currentInfo.hits:Z;if(p&&(f=p.data,J=p.hits,m._hoverTimer=vc(function(){ki(m._hoverTimer),delete m._hoverTimer,m.handle("onHover",H,p)},a.getHoverDelay()||L.hoverDelay)),f!==$){if($&&($.s("onLeave")&&$.s("onLeave")(H,$,a),this.fire("data","onLeave",H,$)),f&&(f.s("onEnter")&&f.s("onEnter")(H,f,a),this.fire("data","onEnter",H,f)),n)for(j in n)this.handleLeave(H,j);if(J)for(j in J){var G=J[j],A=f._interactPrefix=G.prefix,M=A&&f.a(A+"onEnter")||G.target.onEnter;M&&M.call(G.target,H,f,a,G.point,G.width,G.height),this.fire(G.type,"onEnter",G.event,G.data,G.image,G.comp,G.point,G),f._interactPrefix=null}}else{if(n)for(j in n)J&&J[j]||this.handleLeave(H,j);if(J)for(j in J)if(!n||!n[j]){var G=J[j],A=f._interactPrefix=G.prefix,M=A&&f.a(A+"onEnter")||G.target.onEnter;M&&M.call(G.target,H,f,a,G.point,G.width,G.height),this.fire(G.type,"onEnter",G.event,G.data,G.image,G.comp,G.point,G),f._interactPrefix=null}}this.currentInfo=p}},handle:function(c,S,e){var z,g=this,s=g.gv;if(g._is2d){if(e=e||s.getDataInfoAt(S),!e||!s.isInteractive(e.data))return;if(z=e.ui.interactiveInfo){var n,j=e.data;if(j.s(c)&&j.s(c)(S,j,s),this.fire("data",c,S,j),"body"===e.part&&z.bodyInfo)n="body",e.hits=this.handleImage(n,s.getImage(j),c,S,j,e.point,z.bodyInfo);else if("icons"===e.part&&z._38o){var i=z._38o[e.name];i&&i[e.index]&&(n="icons|"+e.name+"|"+e.index,e.hits=this.handleImage(n,e.icon,c,S,j,e.point,i[e.index]))}}return e}var j,A;if(!e)if(S&&S instanceof T.Math.Ray&&s.isVREnabled()){var I=s.vr.intersectWorld(S);if(j=I.data,A=I.intersect,s.vr.renderRayDuringInteraction(S,j,A),!j)return;var F=s.getData3dUI(j);if(z=F.interactiveInfo,!z)return;e={data:j,part:A.part,ui:F}}else{if(e=s.getDataInfoAt(S),!e)return;e&&(e={data:e.data,part:e.part})}if(s.isInteractive(e.data)){if(!A){j=e.data;var F=s.getData3dUI(j);if(e.ui=F,z=F.interactiveInfo,!z)return e;if(A=s.intersectObject(S,j),!A)return}j.s(c)&&j.s(c)(S,j,s),this.fire("data",c,S,j);var x,_=A.part;return"body"!==_&&(x=j.s(_+".image")||j.s("shape3d."+_+".image")),x||(x=j.s("all.image")||j.s("shape3d.image")),x?(z="object"==typeof x?z[x.uuid]:z[x],z&&z.bodyInfo?(e.part="body",e.interactiveInfo=z,e.point=this._convertUVToPoint(A.uv,z),e.image=x,e.hits=this.handleImage("body",x,c,S,j,e.point,z.bodyInfo),e):e):e}},_handleLeaveOrMissing:function(q,F,N){var B="leave"===q?this.currentInfo:this.downInfo;if(B){var c=B.interactiveInfo||B.ui.interactiveInfo;if(c){var L,I,P=B.data;if(this._is2d){if(I=this.gv.lp(F),"body"===B.part&&c.bodyInfo)L="body","leave"===q?this.handleLeaveImage(N,L,this.gv.getImage(P),F,P,I,c.bodyInfo):this.handleMissingUpImage(L,this.gv.getImage(P),F,P,I,c.bodyInfo);else if("icons"===B.part&&c._38o){var J=c._38o[B.name];J&&J[B.index]&&(L="icons|"+B.name+"|"+B.index,"leave"===q?this.handleLeaveImage(N,L,B.icon,F,P,I,J[B.index]):this.handleMissingUpImage(L,B.icon,F,P,I,J[B.index]))}}else{if(!c.bodyInfo)return;var U=this.gv.intersectObject(F,P);I=U&&U.uv?this._convertUVToPoint(U.uv,c):{x:1/0,y:1/0},"leave"===q?this.handleLeaveImage(N,"body",B.image,F,P,I,c.bodyInfo):this.handleMissingUpImage("body",B.image,F,P,I,c.bodyInfo)}}}},handleClick:function(B,L,N){var Z=this,P=this.downInfo;if(P&&N){var l,f=N.interactiveInfo||N.ui.interactiveInfo,q=N.data,X=this.gv;if(q.s(L)&&q.s(L)(B,q,X),Z.fire("data",L,B,q),f)if(this._is2d){if(P.part===N.part){var T=X.lp(B);"body"===N.part&&f.bodyInfo&&(l="body",this.handleClickImage(l,X.getImage(q),L,B,q,T,f.bodyInfo,N))}}else{if(!f.bodyInfo)return;var G=X.intersectObject(B,q);if(!G)return;T=this._convertUVToPoint(G.uv,f),this.handleClickImage("body",P.image,L,B,q,T,f.bodyInfo,N)}}},handleDownInfo:function(I,s){if(this.downInfo){var c=this.downInfo,G=this.gv,x=c.interactiveInfo||c.ui.interactiveInfo;if(x){var p,r=c.data;if(r.s(I)&&r.s(I)(s,r,G),this.fire("data",I,s,r),this._is2d){var f=G.lp(s);if("body"===c.part&&x.bodyInfo)p="body",this.handleDownInfoImage(p,G.getImage(r),I,s,r,f,x.bodyInfo);else if("icons"===c.part&&x._38o){var F=x._38o[c.name];F&&F[c.index]&&(p="icons|"+c.name+"|"+c.index,this.handleDownInfoImage(p,c.icon,I,s,r,f,F[c.index]))}}else{if(!x.bodyInfo)return;var h=G.intersectObject(s,r);if(!h)return;f=this._convertUVToPoint(h.uv,x),this.handleDownInfoImage("body",c.image,I,s,r,f,x.bodyInfo)}}}},fire:function(E,X,T,s,Z,C,b,v){this.gv.fi({kind:X,type:E,event:T,data:s,image:Z,comp:C,view:this.gv,point:b,width:v?v.width:c,height:v?v.height:c})},handleImage:function(Y,N,U,D,w,v,P){var T={};if(N&&(N=qh(N))){var A=this.gv,e=P.rect,Q=this.convertPoint(v,P);Q.inRect&&(N[U]&&N[U](D,w,A,Q,e.width,e.height),this.fire("image",U,D,w,N,c,Q,e),T[Y+"|image"]={target:N,type:"image",image:N,data:w,event:D,point:Q,width:e.width,height:e.height});for(var L,F=P.compInfos,m=N,V=F.length-1;V>=0;V--){var d=F[V],S=d.comp;if(Q=this.convertPoint(v,d,m,S,A,w),Q.inRect){e=d.rect;var u=w._interactPrefix=d.prefix,R=u&&w.a(u+U)||S[U];if(R&&(L=R.call(S,D,w,A,Q,e.width,e.height)),this.fire("comp",U,D,w,N,S,Q,e),L!==!0&&(N=e.image)&&(N[U]&&(L=N[U](D,w,A,Q,e.width,e.height)),this.fire("image",U,D,w,N,c,Q,e)),w._interactPrefix=null,T[Y+"|"+V]={target:S,type:"comp",comp:S,image:N,data:w,event:D,point:Q,width:e.width,height:e.height,prefix:u},this.downComps&&this.downComps.push(S),N&&(T[Y+"|"+V+"|image"]={target:N,type:"image",image:N,data:w,event:D,point:Q,width:e.width,height:e.height,prefix:u}),L===!0)break}}}return T},handleLeave:function(R,v){return this._handleLeaveOrMissing("leave",R,v)},handleMissingUp:function(M){return this._handleLeaveOrMissing("missing",M)},handleLeaveImage:function(F,z,U,Z,G,T,V){if(U&&(U=qh(U))){var v=this.gv,_=V.rect,i=this.convertPoint(T,V);F===z+"|image"&&(U.onLeave&&U.onLeave(Z,G,v,i,_.width,_.height),this.fire("image","onLeave",Z,G,U,c,i,_));for(var B,t=V.compInfos,H=U,b=t.length-1;b>=0;b--){var r=t[b],S=r.comp;i=this.convertPoint(T,r,H,S,v,G),_=r.rect;var h=G._interactPrefix=r.prefix;if(F===z+"|"+b){var K=h&&G.a(h+"onLeave")||S.onLeave;K&&(B=K.call(S,Z,G,v,i,_.width,_.height)),this.fire("comp","onLeave",Z,G,U,S,i,_)}if(B!==!0&&(U=_.image)&&F===z+"|"+b+"|image"&&(U.onLeave&&(B=U.onLeave(Z,G,v,i,_.width,_.height)),this.fire("image","onLeave",Z,G,U,c,i,_)),G._interactPrefix=null,B===!0)break}}},handleMissingUpImage:function(t,V,z,A,i,P){var I="onUp",f=this.downInfo.hits;if(f&&V&&(V=qh(V))){var n=this.gv,N=P.rect,g=this.convertPoint(i,P);!g.inRect&&f[t+"|image"]&&(V[I]&&V[I](z,A,n,g,N.width,N.height),this.fire("image",I,z,A,V,c,g,N));for(var x,E=P.compInfos,p=V,v=E.length-1;v>=0;v--){var d=E[v],k=d.comp;if(g=this.convertPoint(i,d,p,k,n,A),!g.inRect){N=d.rect;var w=A._interactPrefix=d.prefix;if(f[t+"|"+v]){var b=w&&A.a(w+I)||k[I];b&&(x=b.call(k,z,A,n,g,N.width,N.height)),this.fire("comp",I,z,A,V,k,g,N)}if(x!==!0&&(V=N.image)&&f[t+"|"+v+"|image"]&&(V[I]&&(x=V[I](z,A,n,g,N.width,N.height)),this.fire("image",I,z,A,V,c,g,N)),A._interactPrefix=null,x===!0)break}}}},handleDownInfoImage:function(B,p,I,G,s,n,q){var U=this.downInfo.hits;if(U&&p&&(p=qh(p))){var P=this.gv,$=q.rect,v=this.convertPoint(n,q);U[B+"|image"]&&(p[I]&&p[I](G,s,P,v,$.width,$.height),this.fire("image",I,G,s,p,c,v,$));for(var z,Q=q.compInfos,L=p,W=Q.length-1;W>=0;W--){var u=Q[W],J=u.comp;v=this.convertPoint(n,u,L,J,P,s),$=u.rect;var w=s._interactPrefix=u.prefix,N=["onDrag","onEndDrag"].indexOf(I)>=0;if(!N&&U[B+"|"+W]||N&&this.downComps&&this.downComps.indexOf(J)>=0){var Y=w&&s.a(w+I)||J[I];Y&&(z=Y.call(J,G,s,P,v,$.width,$.height)),this.fire("comp",I,G,s,p,J,v,$)}if(z!==!0&&(p=$.image)&&U[B+"|"+W+"|image"]&&(p[I]&&(z=p[I](G,s,P,v,$.width,$.height)),this.fire("image",I,G,s,p,c,v,$)),s._interactPrefix=null,z===!0)break}}},handleClickImage:function(H,V,U,j,C,k,w,L){var u=this.downInfo.hits,x=L.hits;if(u&&V&&(V=qh(V))){var r=this.gv,R=w.rect,S=this.convertPoint(k,w);u[H+"|image"]&&(V[U]&&V[U](j,C,r,S,R.width,R.height),this.fire("image",U,j,C,V,c,S,R));for(var D,g=w.compInfos,q=V,z=g.length-1;z>=0;z--){var F=g[z],G=F.comp;S=this.convertPoint(k,F,q,G,r,C),R=F.rect;var f=C._interactPrefix=F.prefix;if(u[H+"|"+z]&&x[H+"|"+z]){var K=f&&C.a(f+U)||G[U];K&&(D=K.call(G,j,C,r,S,R.width,R.height)),this.fire("comp",U,j,C,V,G,S,R)}if(D!==!0&&(V=R.image)&&u[H+"|"+z+"|image"]&&(V[U]&&(D=V[U](j,C,r,S,R.width,R.height)),this.fire("image",U,j,C,V,c,S,R)),C._interactPrefix=null,D===!0)break}}},initImageResource:function(){L.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(m,M){if(!m)return{x:1/0,y:1/0};var X=M.bodyInfo.rect,d=m.clone(),y=m.multiply({x:X.width,y:X.height});return y.local=d,y},convertPoint:function(q,z,Q,r,h,f){var B=z.rect,Y=z.matrix.applyInverse(q).sub(B),x=Y.x>=0&&Y.y>=0&&Y.x<=B.width&&Y.y<=B.height;if(!x)return Y;if(r&&sn(r.pixelPerfect,f,h)){var B,t=1;this._is2d?(t=h.getZoom(),B=fn(q.x,q.y,c,t)):B=fn(q.x,q.y);var M=!1,n=B.x,A=B.y,e=B.width,$=B.height,X=L.hitMaxArea,_=e*$*t*t;if(_>X){var i=Math.sqrt(X/_);t*=i}e*=t,$*=t,2>e&&(e=2),2>$&&($=2),n*=t,A*=t;var V=ul(e,$),W=new Uh(0,-n,-A,t,t);W.append(z.matrix),h._drawForChecking=!0,r.transform=W,z.refRect&&z.refRect.fitSize&&(r.refRect=z.refRect);var T=Q.comps;Q.comps=[r],Ce(V,Q,0,0,e,$,f,self),Q.comps=T,delete r.refRect,delete r.transform,h._drawForChecking=!1;try{for(var O=0,v=V.getImageData(0,0,e,$).data;O<v.length;O+=4)if(0!==v[O+3]){M=!0;break}V.restore()}catch(U){tq=Z,M=!1}Y.inRect=M}else Y.inRect=!0;return Y}});var pr=si.DefaultInteractor=function(z){to(pr,this,[z])};ej("DefaultInteractor",uq,{handle_mousedown:function(p){_m(p);var o=this,v=o.gv,A=v.getDataAt(p);if(v.setFocus(p)&&!v._editing&&!v._scrolling){_c(p)?v.handleDoubleClick(p,A):v.handleClick(p,A);var X=_h(p);!Zh()&&!X&&A&&(v.isMovable(A)||v._39Q(A))||!v.isPannable()||!tp(p)&&!X||ig(p)||(o._tx=v.tx(),o._ty=v.ty(),o.startDragging(p))}},handleWindowMouseUp:function(U){var G=this,n=G.gv;n._panning&&(delete n._panning,n.onPanEnded(),G.fi({kind:"endPan",event:U})),delete G._tx,delete G._ty,G.clearDragging()},handle_mousemove:function(b){var c=this,V=c.gv;c._hoverTimer&&(ki(c._hoverTimer),delete c._hoverTimer),c._hoverTimer=vc(function(){c.fi({kind:"hover",event:b}),ki(c._hoverTimer),delete c._hoverTimer},V.getHoverDelay()||L.hoverDelay)},handle_mouseleave:function(){var I=this;I._hoverTimer&&(ki(I._hoverTimer),delete I._hoverTimer)},handle_touchmove:function(o){this.handle_mousemove(o)},handleWindowMouseMove:function(i){var y=this,q=y.gv;y.fi({kind:q._panning?"betweenPan":"beginPan",event:i}),q._panning=1;var H=Zm(q,i,y._lastClientPoint);q.setTranslate(y._tx+H.x,y._ty+H.y)},handle_mousewheel:function(y){this.gv.handleScroll(y,y.wheelDelta)},handle_DOMMouseScroll:function(T){2===T.axis&&this.gv.handleScroll(T,-T.detail)},handle_keydown:function(c){this.gv.handleKeyDown(c)}});var Zg=si.SelectInteractor=function(o){to(Zg,this,[o])};ej("SelectInteractor",uq,{_42:function(){var Z=this,z=Z.gv,K=z.getZoom(),k=Z.mark,p=Z.div;p||(p=Z.div=Ke(),Fd(Z.getView(),p));var G={};G.x=k.x*K+z.tx(),G.y=k.y*K+z.ty(),G.width=k.width*K,G.height=k.height*K,Rf(p,G),this.intersects()?(p.style.border="",p.style.background=z.getRectSelectBackground()):(p.style.background="",p.style.border="1px solid "+z.getRectSelectBorderColor())},handle_mousedown:function(U){var E=this,P=E.gv;if(E._57I=Z,E.pendingClickThrough=Z,!(P._editing||P._scrolling||Zh()||_h(U))){var B=P.getDataAt(U),t=P.sm();B?ig(U)?t.co(B)?t.rs(B):t.as(B):t.co(B)?B instanceof Tb&&B.isClickThroughEnabled()&&tp(U)&&(E.pendingClickThrough=Nq(U)):t.ss(B):ig(U)||!P.isPannable()?tp(U)&&(ig(U)||t.cs(),P.isRectSelectable()&&(E.startDragging(U),P._77O=1)):tp(U)&&(E._57I=Nq(U))}},handle_mouseup:function(q){var u=this,B=u.gv,$=u._57I;if($&&(Yf($,Nq(q))<=1&&B.sm().cs(),u._57I=Z),u.pendingClickThrough){if(Yf(u.pendingClickThrough,Nq(q))<=1){var L=B.getDataAt(q);if(L instanceof Tb&&L.isClickThroughEnabled()){var c=B.getDataAt(q,function(g){var z=g.getParent()===L&&B.isSelectable(g,!0);return z});c&&(q.clickThrough=!0,B.sm().ss(c))}}u.pendingClickThrough=Z}},handleWindowMouseUp:function(c){this.clear(c)},handleWindowMouseMove:function(G){var c=this,X=c.gv;c._logicalPoint=X.lp(G),c.mark?(c.fi({kind:"betweenRectSelect",event:G}),X.isPannable()&&c.autoScroll(G),c.redraw()):c.fi({kind:"beginRectSelect",event:G}),c.mark=An(c._lastLogicalPoint,c._logicalPoint),c.redraw()},intersects:function(){var K=this,e=K._lastLogicalPoint,S=K._logicalPoint;return e.x>S.x||e.y>S.y},clear:function(M){var h=this,A=h.gv,e=h.mark;if(h._57I=Z,h.pendingClickThrough=Z,h._lastLogicalPoint){if(e){if(0!==e.width&&0!==e.height){var g=A.getDatasInRect(e,h.intersects());if(!g.isEmpty()){var c=A.sm(),V=c.toSelection();g.each(function(E){c.co(E)?V.remove(E):V.add(E)}),c.ss(V)}}ws(h.div),delete h.div,delete h.mark,h.redraw(),h.fi({kind:"endRectSelect",event:M}),A.onRectSelectEnded()}h.clearDragging(),delete A._77O}},redraw:function(){var B=this;B._draw||(B._draw=1,vc(function(){B.mark&&B._42(),delete B._draw},16))}});var Dj=si.MoveInteractor=function(g){to(Dj,this,[g])};ej("MoveInteractor",uq,{handle_mousedown:function(S){var p=this,v=p.gv;if(tp(S)&&!v._editing&&!v._scrolling&&!Zh()){var O=v.getSelectedDataAt(S);!O||v._39Q(O)&&!v.isMovable(O)?v._focusData=Z:(p._data=O,v.handleMouseDown&&v.handleMouseDown(S,O),p.startDragging(S),v.isMovable(O)&&(v._moving=1))}},handleWindowMouseUp:function(h){var W=this,w=W.gv;w.handleMouseUp&&w.handleMouseUp(h,W._data),W.clear(h)},handleWindowMouseMove:function(e){var v=this,V=v._data,j=v.gv;if((!j._93O||!j._93O(e,V))&&j._moving){v._logicalPoint||v.fi({kind:"prepareMove",event:e});var P=v._logicalPoint?"betweenMove":"beginMove",g={kind:P,event:e},D=v._logicalPoint=j.lp(e);"beginMove"!==P||v._alreadyBeginTransaction||(v._alreadyBeginTransaction=!0,j.getDataModel().beginTransaction());var C=v._calcShift(P,e),p=C.x,R=C.y,x=v.gv.getMoveMode(e,V);x&&("x"===x?R=0:"y"===x?p=0:"xy"!==x&&(p=R=0)),j.moveSelection(p,R),v._lastLogicalPoint=D,v.autoScroll(e),v.fi(g)}},_calcShift:function(){var g=this,J=g._logicalPoint,E=g._lastLogicalPoint,p=J.x-E.x,r=J.y-E.y;return{x:p,y:r}},clear:function(G){var V=this,f=V.gv;V._lastLogicalPoint&&(V._lastLogicalPoint=V._data=f._moving=Z,V._logicalPoint&&(V.fi({kind:"endMove",event:G}),f.onMoveEnded()),V.clearDragging()),V._alreadyBeginTransaction&&(V._alreadyBeginTransaction=!1,f.getDataModel().endTransaction())}});var pm=si.TextEditInteractor=function(t){to(pm,this,[t]),this.init()};ej("TextEditInteractor",uq,{init:function(){var N=this,y=this.input=t.createElement("input"),g=y.style;y.text="text",g.border="1px solid #d8d8d8",g.position="absolute",g.padding="2px 3px",g.outline="none",g.marginLeft="-90px",g.marginTop="-16px",g.backgroundColor="rgba(255,255,255, 0.9)",g.fontSize="14px",g.width="180px",g.height="32px",g.boxShadow="0 0 13px rgba(16,142,233, 0.5)",g.textAlign="center",g.boxSizing="border-box",n(y,"keyup",function(Q){Pp(Q)&&N.endTextEdit()}),n(y,"focus",function(){y.select()});var B=this.textarea=t.createElement("textarea"),s=this.wrap=t.createElement("div");s.appendChild(B),g=B.style,g.margin=0,g.padding="4px",g.overflow="hidden",g.boxSizing="border-box",g.position="absolute",g.outline="none",g.backgroundColor="transparent",g.resize="none",g.textAlign="center",g.fontSize="14px",g.border="none",g.borderWidth=0,g.width="100%",g.top="50%",g=s.style,g.boxSizing="border-box",g.margin=0,g.padding=0,g.position="absolute",g.boxShadow="0 0 13px rgba(16,142,233, 0.5)",g.border="1px solid #d8d8d8",g.backgroundColor="rgba(255,255,255, 0.9)",g.width="180px",g.marginLeft="-90px",n(B,"keydown",function(l){return(Ji()||ig())&&Pp(l)?(N.endTextEdit(),void 0):(N.calculateTextareaHeight(String.fromCharCode(l.keyCode)),void 0)}),n(B,"focus",function(){B.select()});var T=function(v){v.stopPropagation()};n(y,"mousedown",T),n(y,"touchstart",T),n(B,"mousedown",T),n(B,"touchstart",T),N.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],N.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",N.handleWindowClick=function(J){var x=N._editingDOM;if(x){var g=x.getBoundingClientRect(),f=Nq(J);Gb(g,f)||N.endTextEdit()}}},handle_mousedown:function(n){var B=this,G=B.gv;if(_c(n)&&!G._editing){var p=G.getDataAt(n);if(p){var w=G.getTextEditInfo(p);w&&(this._editInfo=w,this._editTarget=p,G._editing=!0,w.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var s=this,f=s.gv,P=s._editTarget,Z=s.getTargetValue(),S=s.textarea,g=s.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===Z||Z===c)&&(Z=""),S.value=Z,s._editingDOM=S,f.getView().appendChild(g),this.layoutHTML(g,P),this.calculateTextareaHeight(),vc(function(){S.focus(),n(j,"mousedown",s.handleWindowClick),n(j,"touchstart",s.handleWindowClick)},10)},handleTextEdit:function(){var S=this,O=S.gv,x=S._editTarget,A=S.getTargetValue(),X=S.input;(null===A||A===c)&&(A=""),X.value=A,S._editingDOM=X,O.getView().appendChild(X),this.layoutHTML(X,x),vc(function(){X.focus(),n(j,"mousedown",S.handleWindowClick),n(j,"touchstart",S.handleWindowClick)},10)},layoutHTML:function(J,q){var u=this.gv,y=u.getZoom();if(q instanceof T.Node){var H=q.getRect();J.style.left=(H.x+H.width/2)*y+u.tx()+"px",J.style.top=(H.y+H.height/2)*y+u.ty()+"px"}else if(q instanceof T.Edge){var M=u.getDataUI(q),H=M._6I;J.style.left=(H.x+H.width/2)*y+u.tx()+"px",J.style.top=(H.y+H.height/2)*y+u.ty()+"px"}},endTextEdit:function(){var o=this,s=o._editInfo.isMultiline?o.wrap:o.input,I=o._editInfo.isMultiline?o.textarea:o.input;o.setTargetValue(I.value),o.gv.getView().removeChild(s),o.gv._editing=!1,delete o._editingDOM,M(j,"mousedown",o.handlelick),M(j,"touchstart",o.handleWindowClick)},setTargetValue:function(S){var y=this,x=y._editTarget,U=y._editInfo,z=U.accessType,O=U.name;if(O&&z||(z="p",O="name"),"p"===z){var R=T.Default.setter(O);x[R](S)}else"a"===z?x.a(O,S):x.s(O,S)},getTargetValue:function(){var b=this,M=b._editTarget,t=b._editInfo,r=t.accessType,W=t.name;if(W&&r||(r="p",W="name"),"p"===r){var V=T.Default.getter(W);return M[V]()}return"a"===r?M.a(W):M.s(W)},createHiddenTextarea:function(){this.hiddenTextarea=t.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(Z,N){if(N&&this.computedStyleCache)return this.computedStyleCache;var J=this,z=j.getComputedStyle(Z),t=z.getPropertyValue("box-sizing")||z.getPropertyValue("-moz-box-sizing")||z.getPropertyValue("-webkit-box-sizing"),k=parseFloat(z.getPropertyValue("padding-bottom"))+parseFloat(z.getPropertyValue("padding-top")),X=parseFloat(z.getPropertyValue("border-bottom-width"))+parseFloat(z.getPropertyValue("border-top-width")),s=J.SIZING_STYLE.map(function(Y){return Y+":"+z.getPropertyValue(Y)}).join(";"),W={sizingStyle:s,paddingSize:k,borderSize:X,boxSizing:t};return N&&(this.computedStyleCache=W),W},calculateTextareaHeight:function(B){B=B||"";var q=this,m=q.textarea,d=q.hiddenTextarea,K=q.wrap,g=32,v=q.calculateHTMLStyle(m,!1),p=v.paddingSize,f=v.borderSize,J=v.boxSizing,H=v.sizingStyle;d.setAttribute("style",H+";"+q.HIDDEN_TEXTAREA_STYLE),d.value=m.value+B;var X=d.scrollHeight;"border-box"===J?X+=f:"content-box"===J&&(X-=p),m.style.height=X+"px",m.style.marginTop=0-.5*X+"px",K.style.height=Math.max(X,g)+"px",K.style.marginTop=X*-.5+"px"}});var nq=si.ScrollBarInteractor=function(z){to(nq,this,[z])};ej("ScrollBarInteractor",uq,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(J){var T=this.gv.getViewRect();return this._41o()&&(T.x+T.width-this.gv.lp(J).x)*this.gv.getZoom()<ts},isH:function(e){var F=this.gv.getViewRect();return this._40o()&&(F.y+F.height-this.gv.lp(e).y)*this.gv.getZoom()<ts},handle_mousemove:function(m){this.handle_touchmove(m)},handle_touchmove:function(O){if(!ei&&tp(O)&&this.gv.isScrollBarVisible()){var t=this,K=t.isV(O),i=t.isH(O);(K||i)&&t.gv.showScrollBar(),t.gv._scrolling=K||i}},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(Y){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=Z,this.fi({kind:"endScroll",event:Y})},handle_mousedown:function(d){this.handle_touchstart(d)},handle_touchstart:function(H){var c=this;if(c.gv.setFocus(H),_m(H),c.handle_touchmove(H),!(hr(H)>1)&&c.gv._scrolling&&c.gv.isScrollBarVisible()){c._cp=Nq(H),c._tx=c.gv.tx(),c._ty=c.gv.ty();var A=c.isV(H);c._state=A?"vScroll":"hScroll",co(c,H),c.fi({kind:"beginScroll",event:H})}},handleWindowMouseMove:function(z){this.handleWindowTouchMove(z)},handleWindowTouchMove:function(t){var I=Nq(t),v=this.gv.getViewRect(),M=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-I.y)*M.height/v.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-I.x)*M.width/v.width),this.fi({kind:"betweenScroll",event:t})}});var Md=si.TouchInteractor=function(P,r){r=r||{},r.selectable===c&&(r.selectable=!0),r.movable===c&&(r.movable=!0),r.pannable===c&&(r.pannable=!0),r.pinchable===c&&(r.pinchable=!0),r.editable===c&&(r.editable=!0),this.params=r,to(Md,this,[P])};ej("TouchInteractor",uq,{ms_edit:1,setUp:function(){var l=this;Md.superClass.setUp.call(l),Km&&l.params.editable&&l.gv.setEditInteractor(l)},tearDown:function(){var N=this;Md.superClass.tearDown.call(N),Km&&N.params.editable&&N.gv.setEditInteractor(Z)},clear:function(R){var Y=this,z=Y.gv;z._moving&&(Y.fi({kind:"endMove",event:R}),delete z._moving,z.onMoveEnded(),z.dm().endTransaction()),z._panning&&(Y.fi({kind:"endPan",event:R}),delete z._panning,z.onPanEnded()),z._pinching&&(Y.fi({kind:"endPinch",event:R}),delete z._pinching,z.onPinchEnded()),z._editing&&(Y._46O(R),Y._77I=Y._node=Y._edge=Y._shape=Y._rect=Y._89I=Y._index=z._editing=Z),Y.pendingClickThrough=Y._moving=Y._panning=Y._pinching=Y._editing=Y._57I=Y._data=Y._beginHistory=Z,Y.clearDragging()},handle_touchstart:function(e){var x=this;if(!x.gv._editing){_m(e),x._57I=Z,x.pendingClickThrough=Z;var O=x.params,n=x.gv,l=n.sm(),p=n.getDataAt(e),T=hr(e);if(1===T){if(_c(e))return n.handleDoubleClick(e,p),void 0;n.handleClick(e,p),p&&(n.handleMouseDown&&n.handleMouseDown(e,p),x._data=p),O.selectable||(p=Z),p&&(l.co(p)?p instanceof Tb&&p.isClickThroughEnabled()&&(x.pendingClickThrough=Nq(e)):l.ss(p),O.editable&&n.isEditable(p)&&x._79I(e,p,!0)?(x._editing=1,x.startDragging(e)):O.movable&&n.isMovable(p)&&(x._moving=1,x.startDragging(e))),p&&n.isMovable(p)||(x._57I=Nq(e),O.pannable&&n.isPannable()&&(x._panning=1,x.startDragging(e),x._translate={x:n.tx(),y:n.ty()}))}else if(O.pinchable&&2===T){if(p&&n._39Q(p))return;x._pinching=1,x.startDragging(e);var V=n.getView(),X=n.getZoom(),Q=V.getBoundingClientRect(),B=e.touches[0],G=e.touches[1],k={x:(B.clientX+G.clientX)/2-Q.left,y:(B.clientY+G.clientY)/2-Q.top};k.x-=n.tx(),k.y-=n.ty(),k.x/=X,k.y/=X,x._p=k,x._d=Ub(e)}}},handle_touchend:function(H){var y=this,e=y.gv,D=y._57I,Y=y._data;if(D&&(Yf(D,Nq(H))<=1&&!e.getDataAt(H)&&e.sm().cs(),y._57I=Z),Y&&e.handleMouseUp&&e.handleMouseUp(H,Y),y.pendingClickThrough){if(Yf(y.pendingClickThrough,Nq(H))<=1){var Y=e.getDataAt(H);if(Y instanceof Tb&&Y.isClickThroughEnabled()){var X=e.getDataAt(H,function(O){var y=O.getParent()===Y&&e.isSelectable(O,!0);return y});X&&(H.clickThrough=!0,e.sm().ss(X))}}y.pendingClickThrough=Z}},handleWindowTouchEnd:function(F){this.clear(F)},handleWindowTouchMove:function(i){var Y=this,T=Y.gv,d=hr(i);if(1===d){var o=Nq(i),B=Zm(T,o,Y._lastClientPoint),x=Yf({x:0,y:0},B);if(Y._editing&&(Y._beginHistory||(Y._beginHistory=1,T.dm().beginTransaction()),T._editing=1,Y._78I(i)),Y._moving){if(!T._moving&&x<L.touchMoveThreshold)return;Y._beginHistory||(Y._beginHistory=1,T.dm().beginTransaction()),Y.handleMove(i)}else if(Y._panning){if(!T._panning&&x<L.touchMoveThreshold)return;T.setTranslate(Y._translate.x+B.x,Y._translate.y+B.y),Y.fi({kind:T._panning?"betweenPan":"beginPan",event:i}),T._panning=1}}else if(2===d&&Y._pinching){var h=Ub(i);T.handlePinch(Y._p,h,Y._d),Y._d=h,Y.fi({kind:T._pinching?"betweenPinch":"beginPinch",event:i}),T._pinching=1}},handleMove:function(l){var U=this,w=U.gv,r=w.lp(l);w._93O&&w._93O(l,U._data)||(w.moveSelection(r.x-U._lastLogicalPoint.x,r.y-U._lastLogicalPoint.y),U._lastLogicalPoint=r,U.autoScroll(l),U.fi({kind:w._moving?"betweenMove":"beginMove",event:l}),w._moving=1)}});var T=j.ht,nc=T.graph._editor={Math:T.Math,Guide:{}};nc.getStyle=function(d){var A,L=nc.StyleMap;return L&&(A=L[d],A!==c)?A:nc.DefaultStyleMap[d]},nc.setStyle=function(M,Q){var S=nc.StyleMap;S||(S=nc.StyleMap={}),S[M]=Q},nc.inEdit=function(a){return a._inXEdit===!0},nc.startEdit=function(n){n._inXEdit=!0,nc.Inject.doInject(n)},nc._46O=function(C){C._inXEdit=!1,nc.Inject.undoInject(C)},nc.toScreenPosition=function(s,u){var U=s.tx(),B=s.ty(),v=s._zoom;return new nc.Math.Vector2(u.x*v+U,u.y*v+B)},nc.checkHit=function(J,f,i){return J.distanceTo(f)<i?!0:!1},nc.toWorldPosition=function(f,y){var W=f.tx(),a=f.ty(),G=f._zoom;return{x:(y.x-W)/G,y:(y.y-a)/G}},nc.setAntialias=function(e,_){for(var R,L=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],n=0,u=L.length;u>n&&(R=L[n],!(R in e));n++);e[R],e[R]=_},nc.getTargetCornersOnScreen=function(Z,N){if(!N)return null;var m,h=[];if(lq(N,Z)){var o=aj(Z,N);m=[{x:o.x,y:o.y},{x:o.x+o.width,y:o.y},{x:o.x+o.width,y:o.y+o.height},{x:o.x,y:o.y+o.height}]}else{if(!N.getCorners)return null;m=N.getCorners()}return m.forEach(function(z){var N=nc.toScreenPosition(Z,z);h.push(N.x,N.y)}),h},nc.log=function(){};var Ve=nc.Inject={_modules:[]};Ve.registAsModule=function(y,S){var q={},E={};for(var p in y){var H=S.prototype[p];q[p]=H}y.getBackup=function(J){return q[J]},y.getBackups=function(){return q},E.doInject=function(){for(var d in y)"getBackup"!==d&&(S.prototype[d]=y[d])},E.undoInject=function(){for(var M in y)"getBackup"!==M&&(S.prototype[M]=q[M])},Ve._modules.push(E)},Ve.doInject=function(a){for(var R,v=Ve._modules,H=0,L=v.length;L>H;H++)R=v[H],R.doInject(a)},Ve.undoInject=function(K){for(var N,V=Ve._modules,g=0,b=V.length;b>g;g++)N=V[g],N.undoInject(K)};var uq=T.graph.EditInteractor=function(d){var I=this,V=t.createElement("canvas");V.className="editCanvas",V.style.position="absolute",I._uuid=T.Math.generateUUID(),I._styleMap={},I._canvas=V,I._context=V.getContext("2d"),uq.superClass.constructor.call(I,d),this._editDetail=!1,nc.setAntialias(I._context,!1),I._subModules=[new nc.Anchor(I),new nc.RotateX(I),new nc.MoveDummy(I),new nc.Rect(I),new nc.Curve(I),new nc.MoveHelper(I)],I._gridGuide=new nc.Guide.Grid(I),I._rectGuide=new nc.Guide.Rect(I),I._hoverGuide=new nc.Guide.Hover(I)
},Pi=uq;T.Default.def(uq,T.graph.Interactor,{ms_edit:1,ms_fire:1}),i.defineProperties(uq.prototype,{editDetail:{get:function(){var n=!!this._editDetail;return n},set:function(T){var Q=this,u=Q._editDetail;u!==T&&(Q._editDetail=T,Q.gv._editing=T,Q.fp("editDetail",u,T),Q.fp("pointsEditingMode",u,T),Q.fi({kind:T?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(c){(!this._editDetail||c)&&(this.gv._editing=c,c||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(f){this._editing=f,this.gvEditing=f}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(g){var u=this;u.editDetail!==g&&(g?u._tryEnterEditDetailMode():u._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var E=this._gridEnabled;if(!E)return!1;var T=this.gv;return T?!0:!0},set:function(c){c!==this._gridEnabled&&(this._gridEnabled=c,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(Y){Y!==this._agEnabled&&(this._agEnabled=Y,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),uq.prototype.getSubModule=function(c){var m,W,G,Y=this._subModules;for(W=0,G=Y.length;G>W;W++)if(m=Y[W],m.catalog===c)return m},uq.prototype.invokeSubModule=function(x,W){for(var t,i,O,z=this,u=z._subModules,L=Array.prototype.slice.call(arguments,2),R=0,n=u.length;n>R;R++)if(t=u[R],i=t[x],i&&(O=i.apply(t,L),O!=c&&W))return t},uq.prototype.invokeSubModuleInverse=function(H,w){var g=this,f=g._subModules;if(f)for(var t,x,M,m=Array.prototype.slice.call(arguments,2),R=f.length-1;R>=0;R--)if(t=f[R],x=t[H],x&&(M=x.apply(t,m),M!=c&&w))return t},uq.prototype.setUp=function(){nc.log("setUp");var A=this,g=A.gv,G=g.getView(),I=A._canvas;uq.superClass.setUp.call(A),g.setEditInteractor(A),g._79O?G.insertBefore(I,g._79O):G.appendChild(I),nc.startEdit(g),A.invokeSubModule("setUp"),g.dm().mm(A._onDataModelChanged,A),g.dm().md(A._onDataPropertyChanged,A)},uq.prototype.tearDown=function(){nc.log("tearDown");var B=this,M=B.gv,d=M.getView();B._resetCustomCursorStyle(),uq.superClass.tearDown.call(B),M.dm().umm(B._onDataModelChanged,B),M.dm().umd(B._onDataPropertyChanged,B),M.setEditInteractor(null),d.removeChild(B._canvas),B._drawTimer&&(ki(B._drawTimer),B._drawTimer=null),nc._46O(M),B.invokeSubModule("tearDown")},uq.prototype._onDataModelChanged=function(N){var T=this;("clear"===N.kind||"remove"===N.kind&&T.editDetail&&N.data===T.getSubModule("Curve").target)&&(T.editDetail=!1,T._42())},uq.prototype._onDataPropertyChanged=function(X){var G=this;if(G.editDetail){var B=G.getSubModule("Curve"),J=X.data;J===B.target&&(J._writing||B._handleDataChanged(X))}},uq.prototype.clear=function(){nc.log("clear")},uq.prototype.redraw=function(){this._42()},uq.prototype._42=function(){var i=this;i._drawTimer||(i._drawTimer=vc(function(){i._drawTimer=null,i.drawImpl()},0))},uq.prototype.drawImpl=function(){var Z;for(Z in{_42:!0})break;return function(){var A=this,C=A._canvas,n=A.gv,R=n.getWidth(),U=n.getHeight(),i=A._context,q=T.Default.getInternal(),h=L.devicePixelRatio;(C.width!==R||C.height!==U)&&q.setCanvas(C,R,U,h),i.clearRect(0,0,C.width,C.height);var $=A._getValidSelection();i.save(),i.scale(h,h),A._gridGuide._42(),A.invokeSubModuleInverse(Z,!1,i,n,$),A._rectGuide._42(),A._hoverGuide._42(),i.restore()}}(),uq.prototype._getValidSelection=function(){var I=this,n=I.gv,C=n.sm().getSelection(),U=[];return C.each(function(D){n.isVisible(D)&&n.isEditable(D)&&U.push(D)}),U},uq.prototype.handle_touchmove=function(r){return this.handle_mousemove(r)},uq.prototype.handle_mousemove=function(S){if(!T.Default.isDragging()){var I=this;if((I.editDetail||!Zh()&&!_h(S))&&!I.gv._externalEditing)if(I.gvEditing=!1,I._checkEdit(S))I.gvEditing=!0;else{if(!I.getStyle("hoverGuideVisible"))return;I.hoverData=I.gv.getDataAt(S),I._42()}}},uq.prototype.handle_touchstart=function(c){return this.handle_mousedown(c)},uq.prototype.handle_mousedown=function(Y){_m(Y);var w=this;if((w.editDetail||!Zh()&&!_h(Y))&&!w.gv._externalEditing){if(_c(Y)&&!Y.clickThrough){if(w.editDetail){if(w._tryQuitEditDetailMode(Y))return}else if(w._tryEnterEditDetailMode())return;w.gv.dm().beginTransaction();var M=w.invokeSubModule("handleDoubleClick",!0,Y);if(w.gv.dm().endTransaction(),M)return}var i=w._checkEdit(Y);i&&(w._downPosition=w._getLogicalPoint(Y),w.gv.dm().beginTransaction(),i.startEdit(w,Y),w.editing=!0)}},uq.prototype._checkEdit=function(T){var z=this,r=z.gv,C=z._getLogicalPoint(T),k=z.invokeSubModule("check",!0,r,T,C)||null;return z._editMod=k,k},uq.prototype.handleWindowTouchMove=function(d){return this.handleWindowMouseMove(d)},uq.prototype.handleWindowMouseMove=function(F){var m=this,n=m._downPosition;if(n){var T=m._getLogicalPoint(F);if(T.distanceTo(n)<m.getStyle("moveSensitivity"))return;delete m._downPosition}var f=m._editMod;f&&f.handleEdit(m.gv,F)},uq.prototype._getLogicalPoint=function(y){var X=this,Y=T.Default.getLogicalPoint(y,X._canvas);return new nc.Math.Vector2(Y)},uq.prototype.handleWindowTouchEnd=function($){return this.handleWindowMouseUp($)},uq.prototype.handleWindowMouseUp=function(){var d;for(d in{_46O:!0})break;return function(i){var k=this;k.editing=!1,k.setCursor("default"),k.invokeSubModule(d,!1,i),k._42(),k.gv.dm().endTransaction()}}(),uq.prototype.handle_mousewheel=function(b){var P=this;_m(b),P.invokeSubModule("preHandleScroll",!0)||P.gv.handleScroll(b,b.wheelDelta)},uq.prototype.handleDelete=function(){var c=this;if(!c.editDetail){c.gv.dm().beginTransaction();var x=c.invokeSubModule("handleNormalStateDelete",!0);return c.gv.dm().endTransaction(),x||c.gv.removeSelection(),void 0}c.gv.dm().beginTransaction(),c.invokeSubModule("handleDelete",!0),c.gv.dm().endTransaction(),c._42()},uq.prototype.handle_keydown=function(A){var a=this;if((A.metaKey||A.ctrlKey)&&a._42(),Zh(A)&&!a.editing)return a.gvEditing=!1,a.setCursor("default"),a._42(),void 0;var u=Pp(A);return a.editDetail?((u||bf(A))&&(a.editDetail=!1,a._42()),a.gv.dm().beginTransaction(),a.invokeSubModule("handle_keydown",!0,A),a.gv.dm().endTransaction(),void 0):(a.gv.dm().beginTransaction(),a.invokeSubModule("handleNormalStateKeyDown",!0,A),a.gv.dm().endTransaction(),u&&a._tryEnterEditDetailMode(),void 0)},uq.prototype.handle_keyup=function(E){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,E),this.gv.dm().endTransaction()},uq.prototype._tryEnterEditDetailMode=function(){var w=this;return!w.editDetail&&w.invokeSubModule("canEnterEditDetailMode",!0)&&1===w._getValidSelection().length?(w.editDetail=!0,w._42(),!0):void 0},uq.prototype._tryQuitEditDetailMode=function(J){var d=this;return d.editDetail?!J||d.invokeSubModule("canQuitEditDetailMode",!0,J)?(d.editDetail=!1,d._42(),!0):!1:!1},uq.prototype.setStyle=function(k,Q,S){var f=this;S?nc.setStyle(k,Q):f._styleMap[k]=Q,"baseColor"===k&&(Xp=Q),f.fp("styleChanged",null,{key:k,value:Q,base:S}),f._42()},uq.prototype.getStyle=function(f){var y=this,I=y._styleMap[f];return I!==c?I:nc.getStyle(f)},uq.prototype.setCursor=function(J){this._resetCustomCursorStyle(),T.graph.EditInteractor.superClass.setCursor.call(this,J)},uq.prototype._drawHostGuide=function(Z){var E=this,w=E._context,V=E.gv;nc.Icons.DrawIcon(E,w,nc.Icons.NodeHoverGuide,Z.corners);var F=Z.host;if(F){var i=V.getAttachPoints(F);if(i&&i.length)for(var N=0,a=i.length;a>N;N++){var C=i[N],Q=dc(V,F,0,C.offsetX||0,C.offsetY||0,C.x,C.y);Q=nc.toScreenPosition(V,Q),Q.isAttach=Z.attach===N,nc.Icons.DrawIcon(E,w,nc.Icons.AttachPoint,Q)}}},uq.prototype._resetCustomCursorStyle=function(){var r=this;if(r._customStyle){var o=this.gv.getView();o.classList&&o.classList.remove&&o.classList.remove(r._customStyle),r._customStyle=null}},uq.prototype._setRotateCursor=function(X){var W=this,p=W._cursorFactory;p||(p=W._cursorFactory=new nc.CursorFactory(W));var J=p.getRotateCursor(X),j=W.gv.getView();W._resetCustomCursorStyle(),W._customStyle=J,j.classList&&j.classList.add&&j.classList.add(J)};var Kh=nc.Group=function(k){var M=this;M._entities=k,M._64O=0,M._position={x:0,y:0},M._scale={x:1,y:1},M._anchor={x:.5,y:.5},M._anchor2={x:.5,y:.5}};Kh.prototype={},Kh.prototype.constructor=Kh;var cj=null,qr=null;Kh.findOrCreateGroup=function(p,C){if(qr===C&&cj&&cj.checkIsMe(p))return cj;qr=C;var y=new nc.Group(p);return y.getKeyOb()?(cj=y,y):void 0},Kh.prototype.checkIsMe=function(u){var v=this._entities;if(v.length!==u.length)return!1;var Y,R={},B=u.length;for(Y=0;B>Y;Y++)R[u[Y]._id]=!0;for(Y=0;B>Y;Y++)if(!R[v[Y]._id])return!1;return!0},Kh.prototype.getRotation=function(){return this._64O},Kh.prototype.getPosition=function(){return this._position},Kh.prototype.getAnchor=function(){return this._anchor},Kh.prototype.getWidth=function(){return this._width},Kh.prototype.getScale=function(){return this._scale},Kh.prototype.getSize=function(){return{width:this._width,height:this._height}},Kh.prototype.getHeight=function(){return this._height},Kh.prototype.getKeyOb=function(){for(var F=this._entities,D=F.length-1;D>=0;D--){var v=F[D];if(this.isNode(v))return v}},Kh.prototype.getAnchor2=function(){var N=this,z=N.rotateCenter;if(z)return z;var l=N.getKeyOb();if(!l)return N._anchor;var u=N._anchor2,I=l.getMatrix();return I.tf({x:l.getWidth()*(u.x-l.getAnchor().x),y:l.getHeight()*(u.y-l.getAnchor().y)})},Kh.prototype.setAnchor2=function(t,B){var d=this,h=d.getKeyOb();if(h){var i,M=h.getMatrix();i="number"==typeof t?{x:t,y:B}:t;var S=M.tfi(i);d._anchor2={x:h.getAnchor().x+S.x/h.getWidth(),y:h.getAnchor().y+S.y/h.getHeight()}}},Kh.prototype.setRotation=function(){},Kh.prototype.beginRotate=function(N){this.rotateCenter=N.pos,this.rotateMode=N.groupRotateMode},Kh.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Kh.prototype.addRotation=function(X,C,Y){return"batch"===C?this._addRotationInBatchMode(X,Y):"block"===C?this._addRotationInBlockMode(X,Y):void 0},Kh.prototype._addRotationInBlockMode=function(e,_){var G=this,U=G.rotateCenter||G.getPosition();G._entities.forEach(function(R){if(G.isNode(R)&&(!_||_(R))){var g=R.getMatrix();g.translate(-U.x,-U.y),g.rotate(e),g.translate(U.x,U.y);var j=Math.sign(R.getScale().x);R.setRotation(Nh(g.b*j,g.a*j)),R.setPosition(g.tx,g.ty)}})},Kh.prototype._addRotationInBatchMode=function(x,v){var J=this,w=J._anchor2;J._entities.forEach(function($){if(J.isNode($)&&(!v||v($))){var Q=$.getAnchor(),s=$.getMatrix(),L=s.tf({x:$.getWidth()*(w.x-Q.x),y:$.getHeight()*(w.y-Q.y)}),I=new nc.Math.Matrix2d;I.set(s.a,s.b,s.c,s.d,s.tx,s.ty),I.translate(-L.x,-L.y),I.rotate(x),I.translate(L.x,L.y);var l=Math.sign($.getScale().x);$.setRotation(Nh(I.b*l,I.a*l)),$.setPosition(I.tx,I.ty)}})},Kh.prototype.setPosition=function(x){var h,I,k,R,S=this,t=S._position,E=x.x-t.x,Q=x.y-t.y,M=S._entities;for(I=0,k=M.length;k>I;I++)h=M[I],lm(h)&&(R=h.getPosition(),h.setPosition(R.x+E,R.y+Q));S._position=x},Kh.prototype.setScale=function(O,Z){var a=this,w=O/a._scale.x,t=Z/a._scale.y;a._adjustChildScaleOrSize(w,t,"size"),a._scale={x:O,y:Z}},Kh.prototype.getRect=function(){var R=this,C=R._position,j=R._width,r=R._height;return{x:C.x-j/2,y:C.y-r/2,width:j,height:r}},Kh.prototype.setSize=function(u,v){var g=this,u=Math.max(1,u),v=Math.max(1,v),L=u/g._width,b=v/g._height;g._adjustChildScaleOrSize(L,b,"size"),g._width=u,g._height=v},Kh.prototype._adjustChildScaleOrSize=function(w,K,E){var u,r,C,I,c,M,o,g,Y,j,t,F,U,y,q=this,J=q._position,T=q._entities,x=new nc.Math.Matrix2d;for(r=0,C=T.length;C>r;r++)if(u=T[r],q.isNode(u)){if(I=u.getPosition(),c=u.getRotation(),M=u.getWidth(),o=u.getHeight(),g=u.getScale(),t=g.x*M,F=g.y*o,x.identity().scale(t,F).rotate(c).translate(I.x,I.y).translate(-J.x,-J.y).rotate(-q._64O),c=Nh(x.b*Math.sign(t),x.a*Math.sign(t)),x.scale(w,K),Y=Math.cos(c),j=Math.sin(c),Math.abs(Y)<.001?(U=x.b/j,y=-x.c/j):(U=x.a/Y,y=x.d/Y),"scale"===E)u.setScale(U/M,y/o);else if("size"===E){var X=U/g.x,l=y/g.y;u.setScale(ns(U)*Math.abs(g.x),ns(y)*Math.abs(g.y)),u.setSize(Math.max(.1,Math.abs(X)),Math.max(.1,Math.abs(l)))}x.rotate(q._64O).translate(J.x,J.y),u.setPosition(x.tx,x.ty)}},Kh.prototype.getMatrix=function(){var E=this,F=E._position,d=T.Default.getInternal(),I=E._scale;return new d.Mat(E._64O,F.x,F.y,I.x,I.y)},Kh.prototype.toGlobal=function(f){return this.getMatrix().tf(f)},Kh.prototype.getCorners=function(){var X=this,i=X._width,V=X._height,R=X._anchor,t=-i*R.x,w=-V*R.y,b=X.getMatrix();return[b.tf(t,w),b.tf(t,w+V),b.tf(t+i,w+V),b.tf(t+i,w)]},Kh.prototype.calcInfo=function(){var g,I,i,j,V,D,e=this,S=[],X=e._entities,G=e._64O;for(j=0,V=X.length;V>j;j++)D=X[j],e.isNode(D)&&D.getCorners&&S.push.apply(S,D.getCorners());if(S.length){var M=Math.cos(-G),$=Math.sin(-G),O=1/0,A=-1/0,w=1/0,n=-1/0;for(j=0,V=S.length;V>j;j++)i=S[j],g=i.x,I=i.y,i.x=M*g-$*I,i.y=$*g+M*I,O=Math.min(O,i.x),A=Math.max(A,i.x),w=Math.min(w,i.y),n=Math.max(n,i.y);e._width=(A-O)/e._scale.x,e._height=(n-w)/e._scale.y,M=Math.cos(G),$=Math.sin(G);var T=e._anchor;g=O+(A-O)*T.x,I=w+(n-w)*T.y,e._position={x:M*g-$*I,y:$*g+M*I}}},Kh.prototype.isNode=function(F){return lm(F)?lq(F)?F.size()?!1:!0:!0:!1},Kh.prototype._42=function(J,b,g){var X,N,o,A,y,q,j,F,H=this,Q=H._entities,k=H.rotateMode;for("batch"===k&&(F=H.getKeyOb()),X=0,N=Q.length;N>X;X++)o=Q[X],H.isNode(o)&&(q=o.getRect(),A=nc.toScreenPosition(g,{x:q.x,y:q.y}),y=nc.toScreenPosition(g,{x:q.x+q.width,y:q.y+q.height}),j={min:A,max:y},o===F&&(j.isKeyOb=!0),nc.Icons.DrawIcon(J,b,nc.Icons.GroupSubEntityRect,j))};var ds=nc.CurveActiving=function(A,D){this._curve=A,this._interactor=A._interactor,this.silent=!0;for(var x in D)this[x]=D[x];delete this.silent};ds.prototype={},ds.prototype.constructor=ds,i.defineProperties(ds.prototype,{point:{get:function(){return this._point},set:function(R){var m=this;m._point=R,m.editingCtrl||m.silent||m._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(N){var I=this;I._pairs=N,I.editingCtrl&&!I.silent&&I._firePointChange()}}}),ds.prototype._firePointChange=function(){var W=this,d=W.getCurrentEditingPoint(),g=W._interactor;if(!d)return g.fi({kind:"selectPoint"}),void 0;var M=this._curve.target;if(M){var R=nc.getDataMatrix(M).invert(),m=d.e;d=R.apply(nc.toWorldPosition(g.gv,d)),d.e=m;var w=W._lastFirePoint;w&&Math.abs(d.x-w.x)<1e-5&&Math.abs(d.y-w.y)<1e-5&&(d.e==c&&w.e==c||Math.abs(d.e-w.e)<1e-5)||(W._lastFirePoint=d,g.fi({kind:"selectPoint",x:d.x,y:d.y,e:d.e}))}},ds.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},ds.prototype.getCurrentEditingPoint=function(){var v=this,N=v.editingCtrl;if(N){var u=v.pairs;if(u){var D=u[N.pairId];if(D){var m=D[N.type];if(m)return m}}}return v._point};var Xl=nc.CursorFactory=function(L){var c=this;c._interactor=L,c._rotateCursorStyles={}};Xl.prototype={},Xl.prototype.constructor=Xl,Xl.prototype.getRotateCursor=function(V){var q=this;0>V&&(V+=2*Math.PI);var b=q._interactor,Z=b.getStyle("rotateCursorSize"),W=b.getStyle("rotateCursorRound"),Y=Math.round(180*(V/Math.PI)/W);Y*W>=360&&(Y=0);var u=q._rotateCursorStyles,B="htCustomRotateStyle_"+Z+"_"+W+"_"+Y;return u[B]||(q._produceRotateCursor(B,Z,W,Y),u[B]=!0),B},Xl.prototype._produceRotateCursor=function(I,x,E,s){var o=this;o._interactor;var C=o._canvas;C||(C=o._canvas=t.createElement("canvas"));var M=L.devicePixelRatio;C.width=C.height=x*M,C.style.width=C.style.height=x+" px";var F=C.getContext("2d");nc.setAntialias(F,!1),F.scale(M,M);var X,g,R,y,w,f=Math.round(x/2),m=""+f+" "+f+",auto !important;",i=4;X=Math.PI/180*s*E,F.clearRect(0,0,x,x),F.save(),F.scale(x/32,x/32),F.translate(16,15),F.rotate(X+Math.PI/2),F.beginPath(),F.moveTo(-8,0),F.lineTo(-8,i),F.lineTo(-8+i,i),F.moveTo(8,0),F.lineTo(8,i),F.lineTo(8-i,i),F.moveTo(-8,i),F.quadraticCurveTo(0,-6,8,i),F.restore(),F.lineCap="round",F.lineJoin="miter",F.strokeStyle="white",F.lineWidth=4,F.stroke(),F.strokeStyle="black",F.lineWidth=2,F.stroke(),g=JSON.stringify(C.toDataURL()),y="cursor:url("+g+")"+m,1!==M&&(R='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+x+'px" height="'+x+'px"><image xlink:href='+g+' width="'+x+'" height="'+x+'"/></svg>',y+="cursor:url(data:image/svg+xml;base64,"+btoa(R)+")"+m,y+="cursor:-webkit-image-set(url("+g+")"+M+"x,url("+g+")1x)"+m),w=t.createElement("style"),w.textContent="body."+I+" *, ."+I+"{"+y+"}",t.head.appendChild(w)};var ql=nc.Guide.Grid=function(i){var m=this;m._interactor=i,m._alignmentGuideId=0,m._xAlignmentGuide=[],m._yAlignmentGuide=[]};ql.prototype={},ql.prototype.constructor=ql,i.defineProperties(ql.prototype,{gridBlockSize:{get:function(){var Q=this;return Q._gridBlockSize||Q._interactor.getStyle("gridBlockSize")},set:function(Q){this._gridBlockSize=Q,this._interactor._42()}},gridThickLinesEvery:{get:function(){var k=this;return k._gridThickLinesEvery||k._interactor.getStyle("gridThickLinesEvery")},set:function(c){this._gridThickLinesEvery=c,this._interactor._42()}},gridEnabled:{get:function(){var Z=this,$=Z._interactor;return $.gridEnabled&&Z.isValidGrid()}}}),ql.prototype._42=function(){var Y=this,O=Y._interactor;Y.gridEnabled&&Y.drawGrid(),O.alignmentGuideEnabled&&Y.drawAlignmentGuide()},ql.prototype.makeMatrix=function(){var S=this,E=S._interactor.getStyle("gridAngle"),D=S._interactor.getStyle("gridRotation"),a=new nc.Math.Matrix2d,Y=Math.sin(E),d=Math.cos(E);return a.set(1,0,d,Y,0,0),a.rotate(D),a},ql.prototype.isValidGrid=function(){var O=this,p=Math.PI,I=O._interactor,v=I.gv;if(v._zoom<I.getStyle("gridZoomThreshold"))return!1;var V=I.getStyle("gridAngle"),w=Math.abs(180*(V%p/p)),K=1-1e-8;return K>w||w>180-K?!1:!0},ql.prototype.drawAlignmentGuide=function(){var m=this,q=m._interactor,h=q.gv,G=q._canvas,X=q._context,T=G.width,r=G.height,E=h.tx(),f=h.ty(),$=h._zoom;X.beginPath(),X.strokeStyle=q.getStyle("gridAlignmentGuideColor"),X.lineWidth=1,m._xAlignmentGuide.forEach(function(H){var g=H.p*$+E;X.moveTo(g,0),X.lineTo(g,r)}),m._yAlignmentGuide.forEach(function(e){var q=e.p*$+f;X.moveTo(0,q),X.lineTo(T,q)}),X.stroke()},ql.prototype.drawGrid=function(){function P(G,B,v,P){var F=nc.toScreenPosition(i,I.apply({x:G,y:B})),s=nc.toScreenPosition(i,I.apply({x:v,y:P}));J.moveTo(F.x,F.y),J.lineTo(s.x,s.y)}var x=this,U=x._interactor,W=x.gridBlockSize,b=x.gridThickLinesEvery,S=U.getStyle("gridThickColor"),B=U.getStyle("gridLightColor"),i=U.gv,K=U._canvas,J=U._context,H=K.width,l=K.height,I=x.makeMatrix(),p=I.applyInverse(nc.toWorldPosition(i,{x:0,y:0})),A=I.applyInverse(nc.toWorldPosition(i,{x:H,y:0})),C=I.applyInverse(nc.toWorldPosition(i,{x:0,y:l})),D=I.applyInverse(nc.toWorldPosition(i,{x:H,y:l})),Q=Math.min(p.x,A.x,C.x,D.x),j=Math.max(p.x,A.x,C.x,D.x),M=Math.min(p.y,A.y,C.y,D.y),c=Math.max(p.y,A.y,C.y,D.y);H=j-Q,l=c-M;var L=Math.ceil(Q/W),E=Math.floor(j/W),s=Math.ceil(M/W),N=Math.floor(c/W);i.tx(),i.ty(),i._zoom;var X,$,F;for(J.save(),J.lineWidth=1,J.beginPath(),J.strokeStyle=S,F=Math.ceil(L/b)*b;E>=F;F+=b)X=F*W,P(X,M,X,c);for(F=Math.ceil(s/b)*b;N>=F;F+=b)$=F*W,P(Q,$,j,$);for(J.stroke(),J.beginPath(),J.strokeStyle=B,F=L;E>=F;F++)0!==F%b&&(X=F*W,P(X,M,X,c));for(F=s;N>=F;F++)0!==F%b&&($=F*W,P(Q,$,j,$));J.stroke(),J.restore()},ql.prototype.getAlignmentGuides=function(){var w=this;return{x:w._xAlignmentGuide,y:w._yAlignmentGuide}},ql.prototype.addAlignmentGuide=function(K,x,B){var Y=this,c="x"===K?Y._xAlignmentGuide:Y._yAlignmentGuide,B=B?B:++Y._alignmentGuideId,C={p:x,id:B};if(c.length){var a=Y._findClosestAlignmentGuide(C.p,c);a.dis<0?c.splice(a.index+1,0,C):c.splice(a.index,0,C)}else c.push(C);return Y._interactor._42(),B},ql.prototype.findClosest=function(x,L,k){var Q=this,f=Q._interactor,a=f.gv;k&&(x=nc.toWorldPosition(a,x));var Y,g,t,K=1/0,c=1/0,B=x.x,C=x.y;if(Q.gridEnabled){var r=Q.gridBlockSize,U=Q.makeMatrix(),D=U.applyInverse(x);D=U.apply({x:Math.round(D.x/r)*r,y:Math.round(D.y/r)*r}),K=D.x-B,c=D.y-C,t=!0}if(f.alignmentGuideEnabled&&(Y=Q._findClosestAlignmentGuide(B,Q._xAlignmentGuide).dis,g=Q._findClosestAlignmentGuide(C,Q._yAlignmentGuide).dis,Math.abs(Y)<Math.abs(K)&&(K=Y,t=!0),Math.abs(g)<Math.abs(c)&&(c=g,t=!0)),t){t=!1;var b=a._zoom,I=f.getStyle("smartGuideThreshold")/b,E={};if(Math.abs(K)<I&&"y"!==L&&(E.x=k?K*b:K,t=!0),Math.abs(c)<I&&"x"!==L&&(E.y=k?c*b:c,t=!0),t)return E}},ql.prototype._findClosestAlignmentGuide=function(Z,d){if(!d.length)return{dis:1/0};for(var D,H=0,m=d.length-1;m-H>1;)D=Math.floor((H+m)/2),d[D].p<Z?H=D:m=D;var e=d[H].p-Z,l=d[m].p-Z;return Math.abs(e)<=Math.abs(l)?{line:d[H],dis:e,index:H}:{line:d[m],dis:l,index:m}},ql.prototype.removeAllAlignmentGuide=function(c){var O=this;"y"!==c&&(O._xAlignmentGuide=[]),"x"!==c&&(O._yAlignmentGuide=[]),O._interactor._42()},ql.prototype.removeAlignmentGuide=function(G){for(var L,V,J,U=this,_=U._xAlignmentGuide,W=0;2>W;W++)for(_=0===W?U._xAlignmentGuide:U._yAlignmentGuide,L=0,V=_.length;V>L;L++)if(J=_[L],J.id===G)return _.splice(L,1),U._interactor._42(),{axis:0===W?"x":"y",position:J.p};return!1},ql.prototype.adjustAlignmentGuide=function(c,M){var q=this,A=q.removeAlignmentGuide(c);return A?(q.addAlignmentGuide(A.axis,M,c),!0):!1};var Ic=nc.Guide.Rect=function(Z){var k=this;k._interactor=Z};Ic.prototype={},Ic.prototype.constructor=Ic,Ic.prototype.gatherRects=function(){var z,s,d,W,T=this,$=T._interactor.gv,F=[],L=[],J={x:F,y:L},U={},k=$.getDataModel(),D=k.a("width"),e=k.a("height");D&&e&&(z=0,s=0,d=D,W=e,F.push({node:k,type:0,p:z},{node:k,type:1,p:z+d/2},{node:k,type:2,p:z+d}),L.push({node:k,type:0,p:s},{node:k,type:1,p:s+W/2},{node:k,type:2,p:s+W}),U[k._id||0]={x:z,y:s,width:d,height:W}),k.each(function(J){if(lm(J)&&!$.isSelected(J)&&$.isVisible(J)&&$.isValidGuideLineSource(J)){var M=!1;if($.sm().getSelection().each(function(e){M||(J.isHostOn(e)?M=!0:J.isDescendantOf(e)&&(M=!0))}),!M){var p=J.getRect();z=p.x,s=p.y,d=p.width,W=p.height,F.push({node:J,type:0,p:z},{node:J,type:1,p:z+d/2},{node:J,type:2,p:z+d}),L.push({node:J,type:0,p:s},{node:J,type:1,p:s+W/2},{node:J,type:2,p:s+W}),U[J._id]=p}}}),F.sort(function(u,o){return u.p-o.p}),L.sort(function(D,Q){return D.p-Q.p}),T._grid=J,T._87I=U},Ic.prototype.gatherLines=function(S,$,b){var G,D,n,O,h,f,o,K,A,t,R,U,u=this,E=[u.findClosest({x:S.x,y:S.y},$),u.findClosest({x:S.x+S.w/2,y:S.y+S.h/2},$),u.findClosest({x:S.x+S.w,y:S.y+S.h},$)],d={},J=u._87I;b=b||255;var m,N;for(u._guideLine=[],G=0;2>G;G++)for(d={},0===G?(O="y",K=S.x,A=K+S.w):(O="x",K=S.y,A=K+S.h),D=0;3>D;D++)h=E[D],h&&isFinite(h[O])&&(m=1<<3*G+D,b&m&&(f=h[O+"Line"],o=f.node,N=o._id||0,d[N]||(d[N]=!0,U=J[N],"y"===O?(t=U.x,R=U.x+U.width):(t=U.y,R=U.y+U.height),n=f.p,u._guideLine.push({type:O,a:K,b:A,c:t,d:R,p:n,center:1===f.type}))))},Ic.prototype._binarySearchClosest=function(W,T){if(!T.length)return{dis:1/0};for(var q,X=0,F=T.length-1;F-X>1;)q=Math.floor((X+F)/2),T[q].p<W?X=q:F=q;var b=T[X].p-W,$=T[F].p-W;return Math.abs(b)<=Math.abs($)?{line:T[X],dis:b}:{line:T[F],dis:$}},Ic.prototype.findClosest=function(L,a,m){var C=this,x=C._interactor,B=x.gv,N=C._grid;m&&(L=nc.toWorldPosition(B,L));var H,J=C._binarySearchClosest(L.x,N.x),S=C._binarySearchClosest(L.y,N.y),n=J.dis,r=S.dis,g=B._zoom,l=x.getStyle("smartGuideThreshold")/g,T={};return Math.abs(n)<l&&"y"!==a&&(T.x=m?n*g:n,T.xLine=J.line,H=!0),Math.abs(r)<l&&"x"!==a&&(T.y=m?r*g:r,T.yLine=S.line,H=!0),H?T:void 0},Ic.prototype._42=function(){var Z=this,r=Z._guideLine;if(r&&!T.Default.isCtrlDown()){var a=Z._interactor;if(a.getStyle("guideLineVisible")){var e,D,j,$,s,P,Q,E,H,R,x,K,t,Y,O,g,v,V=a.gv,B=a._context,o=V.tx(),d=V.ty(),w=V._zoom,m=a.getStyle("guideLineTextSpacing");for(e=0,D=r.length;D>e;e++)j=r[e],E=j.type,H=j.p,R=j.a,x=j.b,K=j.c,t=j.d,Y=Math.min(R,K),O=Math.max(x,t),"x"===E?($=H*w+o,s=Y*w+d,P=$,Q=O*w+d):($=Y*w+o,s=H*w+d,P=O*w+o,Q=s),nc.Icons.DrawIcon(a,B,nc.Icons.MoveLineGuide,{rect:[$,s,P,Q],center:j.center}),t>=R&&x>=K||(Y=R>t?t:x,O=R>t?R:K,v=O-Y,"x"===E?(j.center2center||($-=m,P=$),s=Y*w+d,Q=O*w+d,g=nc.Icons.MoveLineGuideDistanceV):"y"===E&&(j.center2center||(s-=m,Q=s),$=Y*w+o,P=O*w+o,g=nc.Icons.MoveLineGuideDistanceH),nc.Icons.DrawIcon(a,B,g,{x0:$,y0:s,x1:P,y1:Q,dis:v}))}}},Ic.prototype.clear=function(){this._guideLine=null};var bp=nc.Guide.Hover=function(Q){var B=this;B._interactor=Q};bp.prototype={},bp.prototype.constructor=bp,i.defineProperties(bp.prototype,{}),bp.prototype._42=function(){var w=this._interactor;if(w.getStyle("hoverGuideVisible")&&!w.gvEditing){var _=w.hoverData,X=w.gv;if(!lm(_)||X.isSelected(_))return w.hoverData=null,void 0;var G=aj(X,_),D=nc.toScreenPosition(X,{x:G.x,y:G.y}),d=nc.toScreenPosition(X,{x:G.x+G.width,y:G.y+G.height});nc.Icons.DrawIcon(w,w._context,nc.Icons.HoverDataRect,{min:D,max:d,color:w.getStyle("hoverGuideColor")||w.getStyle("baseColor")})}},nc.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Fr=nc.Icons={},Lf=1e4,dk=null,Xp=nc.DefaultStyleMap.baseColor,Sb="rgb(183,232,135)",Op="rgb(255,204,153)",Fc=6;T.Default.setImage("Icons.RectPoint",{width:Fc,height:Fc,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Xp}},rect:[0,0,Fc,Fc]}]}),Fr.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var k=Fr.GroupSubEntityRect.data;if(!k)return[];var f=k.min,Q=k.max;return[f.x,f.y,f.x,Q.y,Q.x,Q.y,Q.x,f.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Fr.GroupSubEntityRect.data.isKeyOb?Xp:Xp}}}]};var vh=4;Fr.HoverDataRect={comps:[{type:"shape",points:{func:function(){var Z=Fr.HoverDataRect.data;if(!Z)return[];var j=Z.min,R=Z.max,F=vh;return j.x-=F,j.y-=F,R.x+=F,R.y+=F,[j.x,j.y,j.x,R.y,R.x,R.y,R.x,j.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Fr.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},Fr.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Fr.Line.data.P1.x,Fr.Line.data.P1.y],Fc,Fc]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Fr.Line.data.P2.x,Fr.Line.data.P2.y],Fc,Fc]}}}]},Fr.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Fr.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Fr.Rect={comps:[{type:"shape",points:{func:function(){var M=Fr.Rect.data;if(!M)return[];var L=M.LT,A=M.LB,P=M.RB,t=M.RT;return[L.x,L.y,A.x,A.y,P.x,P.y,t.x,t.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Xp}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fr.Rect.data.rotation}},rect:{func:function(){return[[Fr.Rect.data.LT.x,Fr.Rect.data.LT.y],Fc,Fc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fr.Rect.data.rotation}},rect:{func:function(){return[[Fr.Rect.data.LB.x,Fr.Rect.data.LB.y],Fc,Fc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fr.Rect.data.rotation}},rect:{func:function(){return[[Fr.Rect.data.RB.x,Fr.Rect.data.RB.y],Fc,Fc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fr.Rect.data.rotation}},rect:{func:function(){return[[Fr.Rect.data.RT.x,Fr.Rect.data.RT.y],Fc,Fc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fr.Rect.data.rotation}},visible:{func:function(){return Fr.Rect.data.L?!0:!1}},rect:{func:function(){return[[Fr.Rect.data.L.x,Fr.Rect.data.L.y],Fc,Fc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fr.Rect.data.rotation}},visible:{func:function(){return Fr.Rect.data.R?!0:!1}},rect:{func:function(){return[[Fr.Rect.data.R.x,Fr.Rect.data.R.y],Fc,Fc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fr.Rect.data.rotation}},visible:{func:function(){return Fr.Rect.data.T?!0:!1}},rect:{func:function(){return[[Fr.Rect.data.T.x,Fr.Rect.data.T.y],Fc,Fc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Fr.Rect.data.rotation}},visible:{func:function(){return Fr.Rect.data.B?!0:!1}},rect:{func:function(){return[[Fr.Rect.data.B.x,Fr.Rect.data.B.y],Fc,Fc]}}}]};var Ko=16;T.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Xp}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Xp}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Fr.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Fr.Anchor.data.POS.x,Fr.Anchor.data.POS.y],Ko,Ko]}}}]},Fr.TipShiftX=12,Fr.TipShiftY=12;var ri=[8,28];Fr.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Fr.TipHelper.data.helperPos.x,Fr.TipHelper.data.helperPos.y,ri[0]*Fr.TipHelper.data.size,ri[1]]}},background:{func:function(){return dk.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Fr.TipHelper.data.text}},rect:{func:function(){return[Fr.TipHelper.data.helperPos.x,Fr.TipHelper.data.helperPos.y,ri[0]*Fr.TipHelper.data.size,ri[1]]}},color:{func:function(){return dk.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Rn=7;Fr.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Fr.ShapePoint.data.dynamicVisible}},rect:{func:function(){var j=Fr.ShapePoint.data.point,L=Fr.ShapePoint.data.size||Rn;return[j,L+10,L+10]}},background:{func:function(){var i=Date.now(),N=Fr.ShapePoint.data.dynamicPeriod||1500,O=Math.sin(i%N/N*Math.PI);return"rgba(27,124,22,"+.5*O+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var n=Fr.ShapePoint.data.point,A=Fr.ShapePoint.data.size||Rn;return[n,A,A]}},background:{func:function(){var a=Fr.ShapePoint.data.isEnd;return a?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Fr.ShapePoint.data.color||Xp}}},{type:"rect",visible:{func:function(){return!!Fr.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Xp}},rect:{func:function(){var Z=5;return[Fr.ShapePoint.data.point,Z,Z]}}}]},Fr.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Fr.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Fr.ShapeBgCurve.data.P}},segments:{func:function(){return Fr.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var l=Date.now(),U=Fr.ShapeBgCurve.data.dynamicPeriod||1500,c=Math.sin(l%U/U*Math.PI);return"rgba(27,124,22,"+.3*c+")"
}}},{type:"shape",points:{func:function(){return Fr.ShapeBgCurve.data.P}},segments:{func:function(){return Fr.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Fr.ShapeBgCurve.data.color||Xp}}}]};var di=8;Fr.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var J=Fr.ShapeHighlighPoint.data;return[[J.x,J.y],di,di]}},background:{func:function(){return dk.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var er=10;Fr.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var _=Fr.ShapeHighlighRealPoint.data;return[[_.x,_.y],er,er]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Xp}}}]};var yi=8;Fr.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var k=Fr.ShapeHighlighCtrlPoint.data,B=k.x,$=k.y,p=yi/2;return[B-p,$-p,B-p,$+p,B+p,$+p,B+p,$-p]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return dk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return dk.getStyle("shapeCtrlPointBorderColor")||Xp}}}]};var ch=3;Fr.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Fr.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:ch,borderColor:{func:function(){return dk.getStyle("curveHighlightColor")}}}]},Fr.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Fr.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Fr.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Fr.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Fr.MoveLineGuide.data.center?Sb:Op}}}]};var Be=5;Fr.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var c=Fr.MoveLineGuideDistanceH.data,B=c.x0,X=c.y0;return[B,X-Be,B,X+Be]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Op},{type:"shape",points:{func:function(){var o=Fr.MoveLineGuideDistanceH.data,u=o.x1,t=o.y1;return[u,t-Be,u,t+Be]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Op},{type:"text",text:{func:function(){return Math.round(Fr.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var t=Fr.MoveLineGuideDistanceH.data;return[[(t.x0+t.x1)/2,t.y0-10],20,20]}},color:Op,font:"12px Arial",align:"center"}]},Fr.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var O=Fr.MoveLineGuideDistanceV.data,c=O.x0,f=O.y0;return[c-Be,f,c+Be,f]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Op},{type:"shape",points:{func:function(){var j=Fr.MoveLineGuideDistanceV.data,o=j.x1,m=j.y1;return[o-Be,m,o+Be,m]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Op},{type:"text",text:{func:function(){return Math.round(Fr.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var S=Fr.MoveLineGuideDistanceV.data;return[[S.x0-10,(S.y0+S.y1)/2],20,20]}},color:Op,font:"12px Arial",align:"center"}]},T.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Fr.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var i=Fr.EdgeElevationGuide.data,u=i.x,Q=i.y,o=dk.getStyle("curveElevationIntersectSize"),H=dk.getStyle("curveElevationGuideShift");return u+=H[0],Q+=H[1],[u-o,Q-o,2*o,2*o]}}}]},T.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),T.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Fr.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Fr.ConnectGuide.data.rotation}},rect:{func:function(){var m=Fr.ConnectGuide.data.connect;m.x,m.y;var c=dk.getStyle("connectGuideIntersectSize");return[[m.x,m.y],2*c,2*c]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var t=Fr.ConnectGuide.data.cursorPos||Fr.ConnectGuide.data.connect,E=dk.getStyle("connectGuideIntersectSize");return[[t.x,t.y],2*E-2,2*E-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var Z=Fr.ConnectGuide.data.connect,b=Fr.ConnectGuide.data.cursorPos||Z;return[Z.x,Z.y,Z.x+.5*(b.x-Z.x),Z.y,b.x+.5*(Z.x-b.x),b.y,b.x,b.y]}}}]},T.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),T.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Fr.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var K=Fr.ConnectGuideGarbage.data.hover;return K?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var P=Fr.ConnectGuideGarbage.data,i=dk.getStyle("connectGuideGarbageIntersectsize");return P.hover&&(i+=5),[[P.x,P.y],2*i,2*i]}}}]};var rd=6;Fr.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Fr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var Q=Fr.ShapeActivingCtrl.data;return[Q.point.x,Q.point.y,Q.c1.x,Q.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Xp}}},{type:"shape",visible:{func:function(){return Fr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var j=Fr.ShapeActivingCtrl.data;return[j.point.x,j.point.y,j.c2.x,j.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Xp}}},{type:"shape",visible:{func:function(){return Fr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var k=Fr.ShapeActivingCtrl.data.c1,U=k.x,f=k.y,X=rd/2;return"c1"===Fr.ShapeActivingCtrl.data.hl&&(X+=.5),[U-X,f-X,U-X,f+X,U+X,f+X,U+X,f-X]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return dk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Fr.ShapeActivingCtrl.data.hl?dk.getStyle("shapeCtrlPointHighlightBorder")||Xp:dk.getStyle("shapeCtrlPointBorderColor")||Xp}}},{type:"shape",visible:{func:function(){return Fr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var k=Fr.ShapeActivingCtrl.data.c2,Y=k.x,O=k.y,y=rd/2;return"c2"===Fr.ShapeActivingCtrl.data.hl&&(y+=.5),[Y-y,O-y,Y-y,O+y,Y+y,O+y,Y+y,O-y]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return dk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Fr.ShapeActivingCtrl.data.hl?dk.getStyle("shapeCtrlPointHighlightBorder")||Xp:dk.getStyle("shapeCtrlPointBorderColor")||Xp}}}]},Fr.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Xp}},rect:{func:function(){return[[Fr.RoundPoint.data.x,Fr.RoundPoint.data.y],Fc,Fc]}}}]},Fr.AttachPoint={comps:[{type:"rect",background:{func:function(){return Fr.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Xp}},rect:{func:function(){var H=Fr.AttachPoint.data.isAttach?Fc+4:Fc;return[[Fr.AttachPoint.data.x,Fr.AttachPoint.data.y],H,H]}}}]},Fr.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Fr.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Fr.SimpleRect.data.color||Xp}},rect:{func:function(){var _=Fr.SimpleRect.data;return[_.x,_.y,_.width,_.height]}}}]},T.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Fr.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var c=Fr.MoveDummy.data;return[[c.pos.x,c.pos.y],2*c.size,2*c.size]}}}]},nc.Icons.DrawIcon=function(R,H,F,P){F.width=F.height=Lf,F.data=P,dk=R,T.Default.drawImage(H,F,0,0,Lf,Lf)},nc.Icons.MapPoints=function(V,L){for(var Z=0,H=V.length;H>Z;Z++)V[Z]/=L},nc.roundTo=function(q,i,x){var k=Math.abs(q%i);return x>k||x>i-k?i*Math.round(q/i):q},nc.toFixed=function(c){return Math.round(100*c)/100},nc.getDataMatrix=function(A){if(A instanceof T.Shape){var $=new T.Math.Matrix2d,Z=A.getPosition();return $.translate(-Z.x,-Z.y).scale(A.getScale().x,A.getScale().y).rotate(A.getRotation()).translate(Z.x,Z.y),$}return A.getMatrix?A.getMatrix():new T.Math.Matrix2d};var Em=nc.Math.Curve=function(){this._curves=[]};Em.prototype={},Em.prototype.constructor=Em,Em.prototype.createFromHtShape=function(u,Q,v){Q instanceof T.List&&(Q=Q.toArray());var o,q,k,V,n,N,K,Z=this,x=null,i=null,U=0,t=nc.Math.Vector2,l=nc.Math.CubicBezier,C=function(M){return new t(u[M],u[M+1],v?v[M/2]:c)};for(q=0,k=Q.length;k>q;q++){switch(V=Q[q],n=null,V){case 1:i=C(U),x=i,U+=2;break;case 2:o=C(U),U+=2,n=new l(i,i.clone(),o.clone(),o),i=o;break;case 3:N=C(U),o=C(U+2),U+=4,n=new l(i,N.clone().sub(i).multiplyScalar(2/3).add(i),N.clone().sub(o).multiplyScalar(2/3).add(o),o),i=o;break;case 4:N=C(U),K=C(U+2),o=C(U+4),U+=6,n=new l(i,N,K,o),i=o;break;case 5:if(!x)break;n=new l(i,i.clone(),x.clone(),x),i=null,x=null}n&&(n._index=Z._curves.length,Z._curves.push(n))}},Em.prototype.checkPoint=function(r,Y){var u,$,l,F,g,d=this,B=d._curves;for(u=0,$=B.length;$>u;u++)if(F=B[u],g=F.intersectRect(r,Y,Y),g.length)return l=0,g.forEach(function(S){l+=S.t}),l/=g.length,r=F.getPointAt(l),r.t=l,{bezier:F,intersection:r}},Em.prototype.insertKnot=function(y,L){var X=y.insertKnot(L),m=this,M=m._curves;M.splice(y._index,1,X[0],X[1])},Em.prototype._isCloseEnough=function(l,D){return Math.abs(l.x-D.x)<1e-6&&Math.abs(l.y-D.y)<1e-6},Em.prototype._isSamePoint=function(M,s){return M===s},Em.prototype.moveRealPoint=function($,T){var G=this,n=G._curves,A=T.clone().sub($);n.forEach(function(v){var k=v._p1;v._p2,v._p3;var H=v._p4;G._isSamePoint(k,$)&&(v._p2.add(A),v._p1=T),G._isSamePoint(H,$)&&(v._p3.add(A),v._p4=T)})},Em.prototype.moveCtrlDueToRealPointMovement=function(L,k){var b=this,c=b._curves,p=function(Q){Q.add(k),Q.e&&k.e&&(Q.e+=k.e)};c.forEach(function(Q){var B=Q._p1;Q._p2,Q._p3;var x=Q._p4;b._isSamePoint(B,L)&&p(Q._p2),b._isSamePoint(x,L)&&p(Q._p3)})},Em.prototype.moveCtrlPoint=function(v,T,F){var U=v[F];if(U){U.e!==c&&(T.e=U.e);var J=this,f=J._curves;T.clone().sub(U),f.forEach(function(f){var b;"c2"===F?b="_p2":"c1"===F&&(b="_p3"),J._isSamePoint(f[b],U)&&(f[b]=T)}),v[F]=T}},Em.prototype.deleteRealPoint=function(h,k){var F,v,m,S,w,j,H,g=this,e=g._curves,M={},L=[],o=nc.Math.CubicBezier;for(v=0,m=e.length;m>v;v++)F=e[v],S=F._p1,w=F._p2,j=F._p3,H=F._p4,(M[v]||!g._isSamePoint(S,h))&&(g._isSamePoint(H,h)?m>v+1&&g._isSamePoint(e[v+1]._p1,h)&&(k||L.push(new o(S,w,e[v+1]._p3,e[v+1]._p4))):L.push(F));g._curves=L},Em.prototype.findPairs=function(J,v){var $,B,W,A,i,a,D,r,u=this,h=u._curves,t={},z=[];for(B=0,W=h.length;W>B;B++)$=h[B],A=$._p1,i=$._p2,a=$._p3,D=$._p4,!t[B]&&u._isSamePoint(A,J)&&(v?z.push({point:A,r2:D}):z.push({point:A,c2:i})),u._isSamePoint(D,J)&&(r=v?{point:D,r1:A}:{point:D,c1:a},W>B+1&&u._isSamePoint(h[B+1]._p1,J)&&(v?r.r2=h[B+1]._p4:r.c2=h[B+1]._p2,t[B+1]=!0),z.push(r));return z},Em.prototype.toHtShape=function(){var g=this,k=g._curves,v=[],M=[],F={x:1/0,y:1/0};return k.forEach(function(l){var X=l._p1,a=l._p2,H=l._p3,y=l._p4;return g._isCloseEnough(X,F)||(v.push(1),M.push(X.clone())),F=y,g._isCloseEnough(X,a)&&g._isCloseEnough(H,y)?(v.push(2),M.push(y.clone()),void 0):(v.push(4),M.push(a.clone(),H.clone(),y.clone()),void 0)}),{segments:v,points:M}};var ao=nc.Math.CubicBezier=function(U,N,T,v){var t=this;t._id=nc.Math.CubicBezier._globalId++,t._p1=U,t._p2=N,t._p3=T,t._p4=v};ao._globalId=1,ao.prototype={},ao.prototype.constructor=ao,ao.prototype.toString=function(){return this._id},ao.prototype.intersectRect=function(K,c,s){var S=c/2,J=s/2,H=K.x,r=K.y,z=nc.Math.Vector2,m=new z(-S+H,-J+r),T=new z(S+H,J+r),W=new z(T.x,m.y),G=new z(m.x,T.y),l=this,d=l.intersectLine(m,W),n=l.intersectLine(W,T),Z=l.intersectLine(T,G),y=l.intersectLine(G,m),j=d.concat(n).concat(Z).concat(y);return j},ao.prototype.intersectLine=function(M,X){var w,N,T,I,u,S,d,v,U,V,H,A,x,P=this,_=M.clone().min(X),z=M.clone().max(X);I=P._p1,u=P._p2,S=P._p3,d=P._p4,w=I.clone().multiplyScalar(-1),N=u.clone().multiplyScalar(3),T=S.clone().multiplyScalar(-3),H=w.add(N).add(T).add(d),w=I.clone().multiplyScalar(3),N=u.clone().multiplyScalar(-6),T=S.clone().multiplyScalar(3),V=w.add(N).add(T),w=I.clone().multiplyScalar(-3),N=u.clone().multiplyScalar(3),U=w.add(N),v=I.clone(),x=new nc.Math.Vector2(M.y-X.y,X.x-M.x),A=M.x*X.y-X.x*M.y;for(var R=P.getRoots(x.dot(H),x.dot(V),x.dot(U),x.dot(v)+A),c=new Array,D=0,Y=R.length;Y>D;D++){var E=R[D];if(!(0>E||E>1)){var K=P.getPointAt(E);K.t=E,M.x==X.x?_.y<=K.y&&K.y<=z.y&&c.push(K):M.y==X.y?_.x<=K.x&&K.x<=z.x&&c.push(K):K.x>=_.x&&K.y>=_.y&&K.x<=z.x&&K.y<=z.y&&c.push(K)}}return c},ao.prototype.solveTForPoint=function(v){var t,w,b,I,G=this;t=G._p1.x-v.x,w=G._p2.x-v.x,b=G._p3.x-v.x,I=G._p4.x-v.x;for(var g=G.getRoots(I-3*b+3*w-t,3*b-6*w+3*t,3*w-3*t,t),l=c,N=1/0,q=0,m=g.length;m>q;q++){var $=g[q];if(!(0>$||$>1)){var L=G.getPointAt($);L.t=$;var F=Math.abs(L.y-v.y);N>F&&(N=F,l=L)}}return l},ao.prototype.getPointAt=function(F){var B=this,s=B._p1,u=B._p2,p=B._p3,C=B._p4,I=s.clone().lerp(u,F),G=u.clone().lerp(p,F),R=p.clone().lerp(C,F),j=I.lerp(G,F),W=G.lerp(R,F);return j.lerp(W,F)},ao.prototype.getPointByPercentage=function(u){var x=this.length*u,D=this._cacheLength,f=D.length;if(0===x)return D[0].point;if(u>=1)return D[f-1].point;for(var t=0;f>t;t++){var W=D[t];if(!(W.len<x)){var q=D[t-1];return W.point.clone().sub(q.point).setLength(x-q.len).add(q.point)}}},ao.prototype.getTByPercentage=function(L){var p=this.length*L,Q=this._cacheLength,K=Q.length;if(0===p||0>=L)return Q[0].t;if(L>=1)return Q[K-1].t;for(var r=0;K>r;r++){var m=Q[r];if(!(m.len<p)){var k=Q[r-1];return(p-k.len)/(m.len-k.len)*(m.t-k.t)+k.t}}},ao.prototype.getRoots=function(O,P,Q,p){var e,Z,o,q,N,E=new Array;if(Math.abs(O)<1e-6){var e=P,Z=Q/e,o=p/e,q=Z*Z-4*o;if(q>0){var N=Math.sqrt(q);E.push(.5*(-Z+N)),E.push(.5*(-Z-N))}else 0==q&&E.push(.5*-Z)}P/=O,Q/=O,p/=O,e=(3*Q-P*P)/3,Z=(2*P*P*P-9*Q*P+27*p)/27;var s=P/3,k=Z*Z/4+e*e*e/27,U=Z/2;if(Math.abs(k)<=1e-6&&(k=0),k>0){var r,c,N=Math.sqrt(k);r=-U+N,c=r>=0?Math.pow(r,1/3):-Math.pow(-r,1/3),r=-U-N,r>=0?c+=Math.pow(r,1/3):c-=Math.pow(-r,1/3),E.push(c-s)}else if(0>k){var T=Math.sqrt(-e/3),d=Math.atan2(Math.sqrt(-k),-U)/3,g=Math.cos(d),a=Math.sin(d),B=Math.sqrt(3);E.push(2*T*g-s),E.push(-T*(g+B*a)-s),E.push(-T*(g-B*a)-s)}else{var r;r=U>=0?-Math.pow(U,1/3):Math.pow(-U,1/3),E.push(2*r-s),E.push(-r-s)}return E},ao.prototype._70I=function(){var u=this;return u._p1.distanceToSquared(u._p2)<1e-10&&u._p3.distanceToSquared(u._p4)<1e-10},ao.prototype.insertKnot=function(C){var x=this,P=x._p1,b=x._p2,R=x._p3,j=x._p4,d=P.clone().lerp(b,C),O=b.clone().lerp(R,C),I=R.clone().lerp(j,C),Y=d.clone().lerp(O,C),t=O.clone().lerp(I,C),y=Y.clone().lerp(t,C);return x._70I()?(P.clone().lerp(j,C),[new nc.Math.CubicBezier(P,P.clone(),y.clone(),y),new nc.Math.CubicBezier(y,y.clone(),j.clone(),j)]):[new nc.Math.CubicBezier(P,d,Y,y),new nc.Math.CubicBezier(y,t,I,j)]},i.defineProperties(ao.prototype,{length:{get:function(){var c=this._cacheLength;if(!c){c=this._cacheLength=[];for(var N=this._p1,u=0,s=0;1>=u;){var I=this.getPointAt(u+=.001);s+=I.clone().sub(N).length(),N=I,c.push({len:s,t:u,point:I.clone()})}}return c[c.length-1].len}},p1:{get:function(){return this._p1},set:function(H){this._p1=H,this._cacheLength=c}},p2:{get:function(){return this._p2},set:function(s){this._p2=s,this._cacheLength=c}},p3:{get:function(){return this._p3},set:function(m){this._p3=m,this._cacheLength=c}},p4:{get:function(){return this._p4},set:function(y){this._p4=y,this._cacheLength=c}}});var Zq=T.Default.getInternal().ui().EdgeUI,ar={_47O:function(t){var _=this,S=ar.getBackups()._47O;nc.inEdit(_.gv)||S.call(_,t)}};nc.Inject.registAsModule(ar,Zq);var Mp=T.Default.getInternal().ui().NodeUI,ne={_47O:function(k){var E=this,u=ne.getBackups()._47O;nc.inEdit(E.gv)||u.call(E,k)},getSelectWidth:function(){var H=this,N=H.gv,A=H._data;if(N.isEditable(A)&&nc.inEdit(N))return 0;var e=ne.getBackup("getSelectWidth");return e.call(H)}};nc.Inject.registAsModule(ne,Mp);var cl=T.graph.GraphView,kl={_editPointSize:function(){var y=T.Default.isTouchable,O=nc.getStyle("pointSize");return O[y?0:1]}(),isPointEditable:function(c){var C=this;if(nc.inEdit(C))return C._pointEditableFunc?C._pointEditableFunc(c):!0;var q=kl.getBackup("isPointEditable");q.call(C,c)},isEditable:function(c){var y,K=this,o=kl.getBackup("isEditable");if(y=c instanceof nc.Group?!0:o.call(K,c),!nc.inEdit(K))return y;if(!(c instanceof T.Edge))return y;if(!c.s("2d.editable"))return!1;var x=K.getEditableFunc();return x?x(c):!0},_42:function(k,j){var t=this,Y=kl.getBackups()._42;if(Y.call(t,k,j),nc.inEdit(t)){var L=t.getEditInteractor();L.drawImpl()}}};nc.Inject.registAsModule(kl,cl);var qo=T.Default.getInternal().ui().ShapeUI,vd={_47O:function(u){var B=this,r=vd.getBackups()._47O;nc.inEdit(B.gv)||r.call(B,u)}};nc.Inject.registAsModule(vd,qo);var pr=T.graph.DefaultInteractor,fh={handle_mousewheel:function(S){var M=this,E=fh.getBackup("handle_mousewheel");nc.inEdit(M.gv)||E.call(M,S)}};nc.Inject.registAsModule(fh,pr);var Dj=T.graph.MoveInteractor,Wo={_calcShift:function(G,o){var T=this,u=Wo.getBackup("_calcShift"),C=T.gv;if(!nc.inEdit(C))return u.call(T,G,o);var r=C.getEditInteractor(),_=r.getSubModule("Move").calcShift(G,o,T);return _||u.call(T,G,o)},clear:function(e){var h=this,l=Wo.getBackup("clear");l.call(h,e);var s=h.gv;if(nc.inEdit(s)){var v=s.getEditInteractor();v.getSubModule("Move").clear(e)}}};nc.Inject.registAsModule(Wo,Dj);var Ic=nc.Rect=function(c){this.catalog="Rect",this._interactor=c};Ic.prototype={},Ic.prototype.constructor=Ic,Ic.prototype.gatherInfo=function(I,p){var h=this;if(1===p.length){var r=p[0];return r instanceof T.Shape&&r._70I()?h.gatherLine(I,r):lq(r,I)?!1:h.gatherSingleTarget(I,r)}return p.length>1?h.gatherMultiTargets(I,p):!1},Ic.prototype.gatherSingleTarget=function(k,l){if(l.getCorners){var D,q=this,Q=q.info;q.target=l,D=q.screenInfo={};var V=l.getCorners();Q.LT=new nc.Math.Vector2(V[0]),Q.LB=new nc.Math.Vector2(V[1]),Q.RB=new nc.Math.Vector2(V[2]),Q.RT=new nc.Math.Vector2(V[3]),Q.T=Q.LT.clone().add(Q.RT).divideScalar(2),Q.B=Q.LB.clone().add(Q.RB).divideScalar(2),Q.L=Q.LT.clone().add(Q.LB).divideScalar(2),Q.R=Q.RT.clone().add(Q.RB).divideScalar(2);for(var K in Q)D[K]=nc.toScreenPosition(k,Q[K]);var L=q._interactor,M=L.getStyle("checkSize"),P=function(g,E,B){var o=E.clone().sub(g).setLength(-M),r=B.clone().sub(g).setLength(-M),S=o.add(r).add(g);return S};return D.rotLT=P(D.LT,D.RT,D.LB),D.rotLB=P(D.LB,D.LT,D.RB),D.rotRB=P(D.RB,D.LB,D.RT),D.rotRT=P(D.RT,D.LT,D.RB),D.rotT=D.rotLT.clone().add(D.rotRT).divideScalar(2),D.rotB=D.rotLB.clone().add(D.rotRB).divideScalar(2),D.rotL=D.rotLT.clone().add(D.rotLB).divideScalar(2),D.rotR=D.rotRT.clone().add(D.rotRB).divideScalar(2),D.rotation=l.getRotation(),q.gatherConnectInfo(),!0}},Ic.prototype.gatherConnectInfo=function(){var b=this,N=b.target,R=b._interactor,M=b.screenInfo,V=R.gv;if(V.isConnectActionVisible(N)&&R.getStyle("connectGuideVisible")){var m;N.s&&(m=N.s("connectGuideShift")),m||(m=R.getStyle("connectGuideShift"));var W=N.getAnchor(),I=N.getSize(),a=N.toGlobal({x:I.width*(m[0]-W.x),y:I.height*(m[1]-W.y)});a=nc.toScreenPosition(V,a),M.P1?a.add(M.P2.clone().sub(M.P1).setLength(m[2])):(a.add(M.RT.clone().sub(M.LT).setLength(m[2])),a.add(M.LB.clone().sub(M.LT).setLength(m[3]))),M.connect=a}},Ic.prototype.gatherMultiTargets=function(F,B){var c=nc.Group.findOrCreateGroup(B,this._interactor._uuid);if(!c)return!1;var f=this;return f.editing&&"rotate"!==f.editing.mode||c.calcInfo(),f.gatherSingleTarget(F,c)},Ic.prototype.gatherLine=function(V,i){this.target=i;var S=this.screenInfo={},k=i.getPoints(),H=nc.getDataMatrix(i);return S.P1=nc.toScreenPosition(V,H.apply(k.get(0))),S.P2=nc.toScreenPosition(V,H.apply(k.get(1))),this.gatherConnectInfo(),!0},Ic.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Ic.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Ic.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Ic.prototype.check=function(G,g,r){if(T.Default.isLeftButton(g)){var L=this;if(L.editing=null,L.tipInfo=null,L.screenInfo){var M=L.target,p=G.isEditable(M),P=L.screenInfo;if(p&&P.connect){var i=L._checkConnect(r);if(i)return i}if(P.P1)return L._checkLine(r);var c,B,V,O=null,f=L._interactor,X=f.getStyle("checkSize");if(p&&G.isRectEditable(M))for(B=0;B<nc.Rect.ResizeKeys.length;B++)if(V=nc.Rect.ResizeKeys[B],nc.checkHit(r,P[V],X)){O=V,c="resize";break}if(!O&&p&&G.isRotationEditable(M)&&!f.getStyle("rotateAsClock")){var d=f.getStyle("rotateCheckSize");for(B=0;B<nc.Rect.RotateKeys.length;B++)if(V=nc.Rect.RotateKeys[B],nc.checkHit(r,P[V],d)){O=V,c="rotate";break}}if(!O)return f.setCursor("default"),void 0;if("rotate"===c){var H,U=G.lp(g);if(M instanceof nc.Group){var S=f.getStyle("groupRotateModeKey");"string"==typeof S&&(S=[S]);for(var Q=!1,I=0,y=S.length;y>I;I++)if(g[S[I]]){Q=!0;break}var l=f.getStyle("groupRotateModeDefault");H=Q?"batch"===l?"block":"batch":l}var t="batch"===H?M.getAnchor2():M.getPosition(),J=Math.atan2(U.y-t.y,U.x-t.x);f._setRotateCursor(J),L.editing={mode:c,key:O,pos:t,flipY:M.getScale().y<0,rotation:M.getRotation(),hitRot:J},H&&(L.editing.groupRotateMode=H)}else{var v=nc.Rect.ResizeKeys.indexOf(O),k=nc.Rect.ResizeDirection[v],e=Math.cos(M.getRotation()),z=Math.sin(M.getRotation()),Z=k.x*Math.sign(M.getScale().x),o=k.y*Math.sign(M.getScale().y),m=Math.atan2(-z*Z-e*o,e*Z-z*o),E=(Math.round(m/(Math.PI/4))+8)%8,F=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][E];this._interactor.setCursor(F);var w=M.getWidth(),R=M.getHeight(),q=M.getAnchor();L.editing={mode:c,key:O,rect:{x:-w*q.x,y:-R*q.y,width:w,height:R},anchor:q,matrix:M.getMatrix()}}return O}}},Ic.prototype._checkLine=function(Y){var o=this;o.screenInfo;var m,D=o._interactor.getStyle("checkSize");if(nc.checkHit(Y,o.screenInfo.P1,D))m="P1";else{if(!nc.checkHit(Y,o.screenInfo.P2,D))return this._interactor.setCursor("default"),void 0;m="P2"}return o.editing={mode:"line",key:m},m},Ic.prototype._checkConnect=function(O){var x=this,h=x.screenInfo,o=x._interactor,R=o.getStyle("connectGuideIntersectSize"),D=h.connect,Z=O.x,t=D.x;if(t>Z&&R>t-Z&&Math.abs(D.y-O.y)<R||Z>=t&&nc.checkHit(O,D,R)){var E="connect",f=L.getConnectAction(o.gv);if(x.editing={mode:E},f&&f.delete)if(x.target instanceof nc.Group){var S=!0;o.gv.sm().getSelection().each(function(A){f.delete.visible.call(null,o.gv,A)||(S=!1)}),x.editing.hasDeleteAction=S}else f.delete.visible.call(null,o.gv,x.target)&&(x.editing.hasDeleteAction=!0);return o.setCursor("default"),E}},Ic.prototype._fireEditEvent=function(c,F){var p=this._interactor,A=this.editing;if(A){var f=A.mode;f="rotate"===f?"Rotation":"connect"===f?"Connection":"resize"===f?"Rect":f[0].toUpperCase()+f.slice(1),p.fi({kind:c+"Edit"+f,event:F})}},Ic.prototype.startEdit=function(w,G){w.startDragging(G);var _=this;_._interactor.fi({kind:"prepareEdit",event:G});var U=_.editing,P=_.target;if(U){if(_._fireEditEvent("begin",G),U.started=!0,"rotate"===U.mode)return U.groupRotateMode&&P.beginRotate(U),w._42(),void 0;if("connect"!==U.mode)("line"===U.mode||P&&0===P.getRotation())&&(_._inSmartGuide=!0,_._interactor.rectGuide.gatherRects());else if(U.hasDeleteAction){var V=w.gv,I=_._interactor.getStyle("connectGuideGarbageShift");U.garbageInfo={x:V.getWidth()*I[0]+I[2],y:V.getHeight()*I[1]+I[3],size:_._interactor.getStyle("connectGuideGarbageIntersectsize")},w._42()}}},Ic.prototype._46O=function(M){var C,O,o=this,s=o.editing,E=o.target;if(s){if("connect"===s.mode&&!s.canceled&&!s.deleted)try{s.garbageInfo&&s.garbageInfo.hover?L.doDeleteConnectionAction(o._interactor.gv,E):L.doConnectAction(o._interactor.gv,E,s.target)}catch(Y){console.error(Y)}O=s.freezeFlag,C=o.editing.groupRotateMode,o._fireEditEvent("end",M),o.editing=null}o.tipInfo=null,o._inSmartGuide&&(o._interactor.rectGuide.clear(),o._inSmartGuide=!1),C&&E&&E.endRotate(),E instanceof T.Block&&(O===c?delete E._freezeSyncFromChildren:E._freezeSyncFromChildren=O,E.updateFromChildren())},Ic.prototype.handleNormalStateDelete=function(){var v=this,E=v.editing;if(E&&"connect"===E.mode&&!E.canceled&&!E.deleted){if(E.garbageInfo){try{L.doDeleteConnectionAction(v._interactor.gv,v.target)}catch(a){console.error(a)}E.garbageInfo=null}return E.cursorPos=null,E.targetCorners=null,E.deleted=!0,v._interactor._42(),!0}},Ic.prototype.handleNormalStateKeyDown=function(p){var e=this,J=e.editing;return!J||"connect"!==J.mode||J.canceled||J.deleted?void 0:T.Default.isEsc(p)?(J.cursorPos=null,J.targetCorners=null,J.canceled=!0,e._interactor._42(),!0):void 0},Ic.prototype.handleEdit=function(t,w){var e=this,F=e.editing;if(F){var P,S,c,d,L,r=e.target,Y=F.key,h=F.mode,o=t.lp(w),D=e._interactor;if("connect"===h){if(F.canceled)return;if(F.deleted)return;F.cursorPos=D._getLogicalPoint(w);var f=F.garbageInfo;return f&&nc.checkHit(F.cursorPos,f,f.size)?(f.hover=!0,F.target=null,F.targetCorners=null):(f&&(f.hover=!1),F.target=t.getDataAt(o,function(k){return t.isSelectable(k)?lm(k)?!0:!1:!1})||null,F.targetCorners=nc.getTargetCornersOnScreen(t,F.target)),D._42(),void 0}if("rotate"===h){var H,W,b=F.pos,a=Math.atan2(o.y-b.y,o.x-b.x);if(F.groupRotateMode?W=a-F.hitRot:(H=a-F.hitRot,W=F.rotation+H),W%=2*Math.PI,0>W&&(W+=2*Math.PI),!T.Default.isCtrlDown(w)){var X,I;Ji(w)?(X=D.getStyle("shiftRotateRound"),I=X/2):(X=D.getStyle("rotateRound"),I=D.getStyle("rotateSensitivity")),W=nc.roundTo(W,X,I)}F.groupRotateMode?(H=W-(F.lastRotation||0),0!==H&&(r.addRotation(H,F.groupRotateMode,function(g){return t.isRotationEditable(g)}),F.lastRotation=W)):r.setRotation(W),D._setRotateCursor(a),W>Math.PI&&(W-=2*Math.PI);var G=180*(W/Math.PI);G=G.toFixed(2),P=""+G+""}else if("resize"===h){var U=F.rect;c=U.x,d=U.y;var V,_=U.width,J=U.height,N=F.anchor,n=F.matrix,i=r.s&&r.s("keepAspectRatio")||D.getStyle("keepAspectRatio");Ji(w)&&(i=!i);var C=e._unionPointMode1,Q=e._unionPointMode2;if(e._inSmartGuide&&!T.Default.isCtrlDown(w)&&!i){var u;"L"===Y||"R"===Y?u="x":("T"===Y||"B"===Y)&&(u="y"),e._adsorbedToClosest(o,u),L=!0}V=n.tfi(o);var v;"LT"===Y?(U=C(V,{x:c+_,y:d+J},_,J,i),v=9):"T"===Y?(U=Q({x:c,y:V.y},{x:c+_,y:d+J},_,J,i,"v"),v=1):"RT"===Y?(U=C(V,{x:c,y:d+J},_,J,i),v=33):"L"===Y?(U=Q({x:V.x,y:d},{x:c+_,y:d+J},_,J,i,"h"),v=8):"R"===Y?(U=Q({x:c,y:d},{x:V.x,y:d+J},_,J,i,"h"),v=32):"LB"===Y?(U=C(V,{x:c+_,y:d},_,J,i),v=12):"B"===Y?(U=Q({x:c,y:d},{x:c+_,y:V.y},_,J,i,"v"),v=4):"RB"===Y&&(U=C(V,{x:c,y:d},_,J,i),v=36);var s=n.tf(U.x+U.width*N.x,U.y+U.height*N.y);r instanceof T.Block&&(F.hasOwnProperty("freezeFlag")||(F.freezeFlag=r._freezeSyncFromChildren,r._freezeSyncFromChildren=!0)),r.setPosition(s),r.setSize(U.width,U.height),L&&(S=r.getRect(),D.rectGuide.gatherLines({node:r,x:S.x,y:S.y,w:S.width,h:S.height},u,v)),P=""+Math.round(U.width)+" * "+Math.round(U.height)}else if("line"===h){if(Ji(w)){var m=r.getPoints(),q="P1"===Y?m.get(1):m.get(0),E={x:o.x-q.x,y:o.y-q.y},R=D.getStyle("shiftLineRotateRound"),p=e._shiftDirList;
if(!p||e._shiftRotateRound!==R){e._shiftRotateRound=R,e._shiftDirList=p=[];for(var O=0;O<Math.PI;O+=R)p.push({x:z(O),y:K(O)})}for(var B,M=0,x=0,A=p.length;A>x;x++){var l=p[x],Z=l.x*E.x+l.y*E.y;Math.abs(Z)>Math.abs(M)&&(M=Z,B=l)}o={x:q.x+B.x*M,y:q.y+B.y*M},D.rectGuide.clear()}else e._inSmartGuide&&!T.Default.isCtrlDown(w)&&(e._adsorbedToClosest(o),L=!0);var y=nc.getDataMatrix(r).applyInverse(o);r.setPoint("P1"===Y?0:1,y,!0);var k=r.getPoints(),g=k.get(0),$=k.get(1);c=g.x-$.x,d=g.y-$.y,P=" "+Math.round(Math.sqrt(c*c+d*d))+" ",L&&(S=r.getRect(),D.rectGuide.gatherLines({node:r,x:S.x,y:S.y,w:S.width,h:S.height}))}if(P){var j=T.Default.getLogicalPoint(w,D._canvas);j.x+=nc.Icons.TipShiftX,j.y+=nc.Icons.TipShiftY,e.tipInfo={helperPos:j,text:P,size:P.length}}e._fireEditEvent("between",w)}},Ic.prototype._unionPointMode1=function(V,b,Q,h,o){if(o&&Q&&h){var I=V.x-b.x,F=V.y-b.y;Math.abs(I*h)<Math.abs(F*Q)?(F=Math.sign(F)*Math.abs(I*h/Q),V.y=b.y+F):(I=Math.sign(I)*Math.abs(F*Q/h),V.x=b.x+I)}return T.Default.unionPoint(V,b)},Ic.prototype._unionPointMode2=function(p,K,z,i,w,D){var d=T.Default.unionPoint(p,K);if(w&&z&&i){var e;"v"===D?(e=d.x+d.width/2,d.width=z*d.height/i,d.x=e-d.width/2):(e=d.y+d.height/2,d.height=i*d.width/z,d.y=e-d.height/2)}return d},Ic.prototype._adsorbedToClosest=function(C,t){var F=this,u=F._interactor,e=u.rectGuide.findClosest(C,t),Z=u.gridGuide.findClosest(C,t),V=1/0,g=1/0;e&&(isFinite(e.x)&&(V=e.x),isFinite(e.y)&&(g=e.y)),Z&&(isFinite(Z.x)&&Math.abs(Z.x)<Math.abs(V)&&(V=Z.x),isFinite(Z.y)&&Math.abs(Z.y)<Math.abs(g)&&(g=Z.y)),isFinite(V)&&(C.x+=V),isFinite(g)&&(C.y+=g)},Ic.prototype._42=function(w,i,z){var X=this;X.info={},X.screenInfo=null;var C=X._interactor;if(!C.editDetail&&X.gatherInfo(i,z)){var O=X.editing,K=O?O.groupRotateMode:null,r=X.screenInfo;if("block"!==K||!O||!O.started){if(r.P1?nc.Icons.DrawIcon(C,w,nc.Icons.Line,r):nc.Icons.DrawIcon(C,w,nc.Icons.Rect,r),r.connect&&(nc.Icons.DrawIcon(C,w,nc.Icons.ConnectGuide,{rotation:r.rotation,connect:r.connect,cursorPos:O?O.cursorPos:null}),O)){if(O.targetCorners){for(var h={x:1/0,y:1/0},U={x:-1/0,y:-1/0},u=0,l=O.targetCorners.length;l>u;u+=2)h.x=Math.min(h.x,O.targetCorners[u]),U.x=Math.max(U.x,O.targetCorners[u]),h.y=Math.min(h.y,O.targetCorners[u+1]),U.y=Math.max(U.y,O.targetCorners[u+1]);nc.Icons.DrawIcon(C,w,nc.Icons.HoverDataRect,{min:h,max:U,color:C.getStyle("hoverGuideColor")||C.getStyle("baseColor")})}O.garbageInfo&&nc.Icons.DrawIcon(C,w,nc.Icons.ConnectGuideGarbage,O.garbageInfo)}C.getStyle("rotateTipVisible")&&X.tipInfo&&nc.Icons.DrawIcon(C,w,nc.Icons.TipHelper,X.tipInfo)}X.target instanceof nc.Group&&X.target._42(C,w,i)}};var mh=nc.Anchor=function(P){this.catalog="Anchor",this._interactor=P};mh.prototype={},mh.prototype.constructor=mh,mh.prototype.gatherInfo=function(b,O){var v=this;if(1===O.length){var h=O[0];if(!h.getAnchor)return;if(h instanceof T.Shape&&h._70I())return;if(lq(h,b))return;return v.gatherSingleTarget(b,O[0])}return O.length>1?v.gatherMultiTargets(b,O):!1},mh.prototype.gatherSingleTarget=function(h,J){var L=this;return L.info.POS=J.getPosition(),L.screenInfo.POS=nc.toScreenPosition(h,L.info.POS),L.target=J,!0},mh.prototype.gatherMultiTargets=function(S,r){var j=this,h=nc.Group.findOrCreateGroup(r,this._interactor._uuid);return h?(j.screenInfo.POS=nc.toScreenPosition(S,h.getAnchor2()),j.target=h,!0):!1},mh.prototype.isVisible=function(){var s=this,H=s._interactor;if(H.getStyle("anchorVisible")===!1)return!1;var v=s.target;if(v){if(this.editing)return!0;var W=v.getAnchor(),Y=H.getStyle("anchorOutsideVisibleThreshold");if(W.x<-Y||W.x>1+Y||W.y<-Y||W.y>1+Y)return!0;var C=v.getSize(),g=v.getScale(),f=Math.min(Math.abs(C.width*g.x),Math.abs(C.height*g.y));if(f*H.gv._zoom<H.getStyle("anchorHideThreshold"))return!1}return!0},mh.prototype.check=function(p,r,J){if(T.Default.isLeftButton(r)){var W=this,A=W._interactor;if(W.isVisible()&&A.getStyle("anchorMovable")!==!1){W.editing=null,W.tipInfo=null;var I=W.target;if(I&&p.isAnchorEditable(I)&&p.isEditable(I)){var s;if(W.screenInfo&&(s=W.screenInfo.POS)&&nc.checkHit(J,new nc.Math.Vector2(s),A.getStyle("checkSize"))){if(I instanceof nc.Group)return W.editing={},!0;var E=I.getWidth(),_=I.getHeight(),i=I.getAnchor();return W.editing={rect:{x:-E*i.x,y:-_*i.y,width:E,height:_},anchor:i,matrix:I.getMatrix()},!0}}}}},mh.prototype.startEdit=function(W,y){W.startDragging(y),W.fi({kind:"beginEditAnchor",event:y})},mh.prototype._46O=function(d){var I=this;I.editing&&(I.editing=null,I._interactor.fi({kind:"endEditAnchor",event:d})),I.tipInfo=null},mh.prototype.handleEdit=function(O,X){var o=this,x=o.target;if(x){var Y=o.editing;if(Y){var J=O.lp(X),W=o._interactor;if(x instanceof nc.Group)return x.setAnchor2(J),W._42(),void 0;var d=Y.matrix,R=d.tfi(J),P=Y.rect,B=(R.x-P.x)/P.width,S=(R.y-P.y)/P.height;if(!T.Default.isCtrlDown(X)){var H=W.getStyle("anchorRound"),k=W.getStyle("anchorSensitivity");B=nc.roundTo(B,H,k),S=nc.roundTo(S,H,k)}x.setAnchor(B,S,!0);var D=T.Default.getLogicalPoint(X,W._canvas);D.x+=nc.Icons.TipShiftX,D.y+=nc.Icons.TipShiftY;var y=""+B.toFixed(2)+", "+S.toFixed(2);o.tipInfo={helperPos:D,text:y,size:y.length},W.fi({kind:"betweenEditAnchor",event:X})}}},mh.prototype._42=function(L,P,u){var r=this;r.info={},r.screenInfo={};var R=r._interactor;R.editDetail||r.gatherInfo(P,u)&&r.isVisible()&&(nc.Icons.DrawIcon(R,L,nc.Icons.Anchor,r.screenInfo),r.tipInfo&&nc.Icons.DrawIcon(R,L,nc.Icons.TipHelper,r.tipInfo))};var js=nc.MoveDummy=function(E){this.catalog="MoveDummy",this._interactor=E};js.prototype={},js.prototype.constructor=js,js.prototype.gatherInfo=function(){var g=this,A=this._interactor.getSubModule("Rect");if(A){var d=A.screenInfo;if(d){var K=g._interactor,B=g.getMovableTarget(A.target);if(B){var y=K.getStyle("moveDummyThreshold");if(y!==!1){var S=d.LT||d.P1,$=d.RT||d.P2,s=d.LB||S;if(S){var e=d.P1,Q=Math.min(S.distanceTo(s),S.distanceTo($));if(!(y!==!0&&Q>y)){var k=K.getStyle("moveDummyPosition"),q=$.clone().sub(S),v=s.clone().sub(S),n=k[2],F=k[3];if(e){var D=K.getStyle("moveDummyLineExtraShift");D&&(n+=D[0],F+=D[1])}var L=S.clone().add(q.clone().multiplyScalar(k[0])).add(q.setLength(n)).add(v.clone().multiplyScalar(k[1])).add(v.setLength(F));return g.screenInfo.pos=L,g.screenInfo.size=K.getStyle("moveDummySensitivity"),!0}}}}}}},js.prototype.getMovableTarget=function(p){var C=this._interactor.gv;if(lm(p)){if(C.isMovable(p))return p}else if(p instanceof nc.Group)for(var j=p._entities,c=j.length-1;c>=0;c--){var z=j[c];if(lm(z)&&C.isMovable(z))return z}return null},js.prototype.getMoveInteractor=function(){for(var b,t,Q,J=this._interactor.gv,i=J.getInteractors(),b=0,t=i.length;t>b;b++)if(Q=i.get(b),Q instanceof Dj)return Q},js.prototype.startEdit=function(d,E){d.startDragging(E);var m=this.getMoveInteractor();if(m){var P=this.selectedTarget,e=d.gv;e._moving=1,m._data=P,e.handleMouseDown&&e.handleMouseDown(E,P)}},js.prototype._46O=function(Z){var X=this,r=X.getMoveInteractor();r&&(r.handleWindowMouseUp(Z),X.selectedTarget=null)},js.prototype.handleEdit=function(G,_){var o=this.getMoveInteractor();o&&o.handleWindowMouseMove(_)},js.prototype.check=function(f,y,g){if(this.selectedTarget=null,T.Default.isLeftButton(y)&&!f._scrolling&&!Zh()){var M=this;if(M.screenInfo){var W=M.screenInfo.pos;if(W&&!(g.distanceTo(W)>M.screenInfo.size)){var i=M._interactor;return M.selectedTarget=M.getMovableTarget(i.getSubModule("Rect").target),i.setCursor("default"),!0}}}},js.prototype._42=function(n,l,I){var a=this;a.screenInfo={};var h=a._interactor;h.editDetail||a.gatherInfo(l,I)&&(!h.editing||a.selectedTarget)&&nc.Icons.DrawIcon(h,n,nc.Icons.MoveDummy,a.screenInfo)};var Fj=nc.RotateX=function(B){this.catalog="RotateX",this._interactor=B};Fj.prototype={},Fj.prototype.constructor=Fj,Fj.prototype.gatherInfo=function(n,G){var A=this;if(1===G.length){var i=G[0];return i instanceof T.Shape&&i._70I()||lq(i,n)?!1:A.gatherSingleTarget(n,i)}return G.length>1?A.gatherMultiTargets(n,G):!1},Fj.prototype.gatherSingleTarget=function(){var g=new T.Math.Vector2,R=new T.Math.Vector2,c=new T.Math.Vector2,N=new T.Math.Vector2,h=function(O,p){var w=O.x-p.x,E=O.y-p.y;return w*w+E*E};return function(H,k){if(k.getCorners){var O=this,Y=k.getCorners(),G=15,W=k.getPosition();g.copy(Y[0]),c.copy(Y[1]),N.copy(Y[3]),R.copy(g).add(N).divideScalar(2).add(g.sub(c).setLength(G/H.getZoom()));var v=Math.max(h(W,Y[0]),h(W,Y[1]),h(W,Y[2]),h(W,Y[3]));return O.info.POS=R.clone(),O.screenInfo.POS=nc.toScreenPosition(H,O.info.POS),O.screenInfo.LEN=Math.sqrt(v)*H.getZoom()+G,O.screenInfo.CENTER=nc.toScreenPosition(H,W),O.target=k,!0}}}(),Fj.prototype.gatherMultiTargets=function(f,b){var x=this,t=nc.Group.findOrCreateGroup(b,this._interactor._uuid);if(!t)return!1;var x=this;return x.gatherSingleTarget(f,t)},Fj.prototype.isVisible=function(){var o=this._interactor;if(!o.getStyle("rotateAsClock"))return!1;var t=this.target;if(!t)return!0;var s=o.gv;return s.isEditable(t)&&s.isRotationEditable(t)?!0:!1},Fj.prototype.check=function(z,M,q){var S=this,s=S._checkImpl(z,M,q);return(s||S._clockPainted)&&S._interactor._42(),s},Fj.prototype._checkImpl=function(b,c,E){if(T.Default.isLeftButton(c)){var k=this;k.editing=null,k.tipInfo=null;var p;if(k.screenInfo&&(p=k.screenInfo.POS)&&k.isVisible()){var x=k._interactor;if(nc.checkHit(E,p,x.getStyle("checkSize"))){var B=k.target,m=b.lp(c),U=B.getPosition(),o=Math.atan2(m.y-U.y,m.x-U.x);return x._setRotateCursor(o),k.editing={pos:U,rotation:B.getRotation(),hitRot:o,groupRotateMode:"block",screenInfo:{CENTER:k.screenInfo.CENTER,LEN:k.screenInfo.LEN}},!0}}}},Fj.prototype.startEdit=function(F,X){F.startDragging(X),F.fi({kind:"beginEditRotation",event:X}),this.target instanceof nc.Group&&this.target.beginRotate(this.editing)},Fj.prototype._46O=function(p){var m=this;m.editing&&(m.editing=null,m._interactor.fi({kind:"endEditRotation",event:p})),m.target instanceof nc.Group&&m.target.endRotate(),m.tipInfo=null},Fj.prototype.handleEdit=function(O,C){var i=this,a=i.editing;if(a){var d,L,W=i.target,E=O.lp(C),k=i._interactor,e=a.pos,j=Math.atan2(E.y-e.y,E.x-e.x),V=W instanceof nc.Group;if(V?L=j-a.hitRot:(d=j-a.hitRot,L=a.rotation+d),L%=2*Math.PI,0>L&&(L+=2*Math.PI),!T.Default.isCtrlDown(C)){var _,f;Ji(C)?(_=k.getStyle("shiftRotateRound"),f=_/2):(_=k.getStyle("rotateRound"),f=k.getStyle("rotateSensitivity")),L=nc.roundTo(L,_,f)}V?(d=L-(a.lastRotation||0),0!==d&&(W.addRotation(d,a.groupRotateMode,function(A){return O.isRotationEditable(A)}),a.lastRotation=L)):W.setRotation(L),k._setRotateCursor(j),L>Math.PI&&(L-=2*Math.PI);var I=180*(L/Math.PI),v=""+I.toFixed(2)+"",R=T.Default.getLogicalPoint(C,k._canvas);R.x+=nc.Icons.TipShiftX,R.y+=nc.Icons.TipShiftY,i.tipInfo={helperPos:R,text:v,size:v.length},k.fi({kind:"betweenEditRotation",event:C})}},Fj.prototype._42=function(I,w,u){var y=this;y._clockPainted=!1,y.info={},y.screenInfo={};var R=y._interactor;R.editDetail||y.gatherInfo(w,u)&&y.isVisible()&&(nc.Icons.DrawIcon(R,I,nc.Icons.RoundPoint,y.screenInfo.POS),R.getStyle("rotateTipVisible")&&y.tipInfo&&nc.Icons.DrawIcon(R,I,nc.Icons.TipHelper,y.tipInfo),y.editing&&y.drawClock(I))},Fj.prototype.drawClock=function(W){W.save();var s=this;s._clockPainted=!0;var u=s.editing||{},q=u.screenInfo||s.screenInfo,i=q.LEN,p=i+8,S=i+18;W.save(),W.translate(q.CENTER.x,q.CENTER.y),W.beginPath(),W.strokeStyle="rgb(150, 150, 150)";for(var _,A,Y,c,k,P=0;360>P;P++)_=P*Math.PI/180,0===P%5&&(A=K(_)*i,Y=z(_)*i,c=K(_)*p,k=z(_)*p,W.moveTo(A,Y),W.lineTo(c,k)),0===P%45&&(A=K(_)*i,Y=z(_)*i,c=K(_)*S,k=z(_)*S,W.moveTo(A,Y),W.lineTo(c,k));W.stroke(),W.rotate(-So);var y=u.lastRotation||s.target.getRotation();W.beginPath(),W.fillStyle="rgba(255, 0, 0, 0.1)",W.strokeStyle="rgb(157, 157, 157)",W.moveTo(0,0),W.arc(0,0,S,0,y,!1),W.fill(),W.beginPath(),W.moveTo(0+S,0),W.arc(0,0,S,0,y,!1),W.stroke(),W.restore()};var Em=nc.Curve=function(n){this.catalog="Curve",this._interactor=n};Em.prototype={},Em.prototype.constructor=Em,i.defineProperties(Em.prototype,{activing:{get:function(){return this._activing},set:function(k){var E=this;if(k)E._activing=new nc.CurveActiving(this,k),E._activing._firePointChange();else{var O=E._activing;O&&O.dispose(),E._activing=null}}}}),Em.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Em.prototype.setUp=function(){var Q=this,s=Q._interactor;s&&s.gv.mp(Q._onGraphviewPropertyChanged,Q)},Em.prototype._onGraphviewPropertyChanged=function(Z){("zoom"===Z.property||"translateX"===Z.property||"translateY"===Z.property)&&this._handleDataChanged()},Em.prototype.tearDown=function(){var K=this,s=K._interactor;s&&s.gv.ump(K._onGraphviewPropertyChanged,K)},Em.prototype.canEnterEditDetailMode=function(){var D=_i(this._interactor);return D?this.target=D:void 0},Em.prototype.canQuitEditDetailMode=function(W){var U=this,R=U._interactor._getLogicalPoint(W);return U._checkEditRealPoint(R)?void 0:U._interactor.gv.getDataAt(W)!==U.target?!0:void 0},Em.prototype.preHandleScroll=function(){var h=this.editing;return h&&h.inEdit?!0:void 0},Em.prototype.getCurrentSelectintStatus=function(){var O=this;if(O.activing&&!O.activing.selections){if(O.activing.status!=c)return O.activing.status;var N=function(p){var C=O.activing.status;O.activing.status=p,O._interactor.fp("shapePointStatus",C,p)},E=nc.Curve.PointType,C=O.activing.point,K=O.activing.pairs;if(!K||1!==K.length)return N(E.Mirrored);var X=K[0],V=X.c1&&X.c1.isNearEnough(C),j=X.c2&&X.c2.isNearEnough(C);if(!X.c1||!X.c2)return V||j?N(E.Straight):N(E.Disconnected);if(V&&j)return N(E.Straight);if(V||j)return N(E.Asymmetric);var e=X.c1.clone().sub(C),i=X.c2.clone().sub(C);return Math.abs(e.x*i.y-e.y*i.x)>1e-5||e.x*i.x>0?N(E.Disconnected):Math.abs(e.length()-i.length())>1e-5?N(E.Asymmetric):N(E.Mirrored)}},Em.prototype.handle_keydown=function(d){var k=this;if(k._interactor.editDetail){var x=nc.Curve.PointType;"1"===d.key?k._setCurrentSelectionStatus(x.Straight):"2"===d.key?k._setCurrentSelectionStatus(x.Mirrored):"3"===d.key?k._setCurrentSelectionStatus(x.Disconnected):"4"===d.key&&k._setCurrentSelectionStatus(x.Asymmetric)}},Em.prototype.setCurrentSelectionStatus=function(v){var P=this,s=P._interactor;if(s){var h=s.gv;h.dm().beginTransaction(),this._setCurrentSelectionStatus(v),h.dm().endTransaction()}},Em.prototype._setCurrentSelectionStatus=function(F){var B=this,V=B.activing;if(V){var X=B.getCurrentSelectintStatus();if(null!==X&&X!==F){V.status=F;var C=B.activing.point,G=B.activing.pairs;if(G&&1===G.length){var n=G[0],r=B.screenInfo.curve,m=nc.Curve.PointType,A=B._interactor,t=function(){B._writeToHt(),A.fp("shapePointStatus",X,F),B.check(A.gv,null,new nc.Math.Vector2(A._lastLogicalPoint))};if(F===m.Straight)return r.moveCtrlPoint(n,C,"c1"),r.moveCtrlPoint(n,C,"c2"),t(),void 0;if(X===m.Straight){var e=r.findPairs(C,!0),f=e[0],T=f.r1||C,H=f.r2||C,b=H.clone().sub(T).multiplyScalar(.25);return r.moveCtrlPoint(n,C.clone().sub(b),"c1"),r.moveCtrlPoint(n,C.clone().add(b),"c2"),t(),void 0}var a=n.c1,y=n.c2;if(a&&y){if(F===m.Mirrored)return r.moveCtrlPoint(n,C.clone().multiplyScalar(2).sub(y),"c1"),t(),void 0;if(F===m.Asymmetric&&X===m.Disconnected){var $=a.clone().sub(C).length(),b=C.clone().sub(y).setLength($).add(C);return r.moveCtrlPoint(n,b,"c1"),t(),void 0}}V._firePointChange(),A.fp("shapePointStatus",X,F),B.check(A.gv,null,new nc.Math.Vector2(A._lastLogicalPoint))}}}},Em.prototype._handleDataChanged=function(){var Q="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(v){var D=this;if(D.screenInfo&&D.target){if(v&&Q.indexOf(v.property)<0)return;var d=D._interactor;D.gatherSingleTarget(d.gv,D.target,!0),D.check(d.gv,null,new nc.Math.Vector2(d._lastLogicalPoint)),d._42()}}}(),Em.prototype.gatherSingleTarget=function(m,Z,v){var i,y,j=this;j.screenInfo&&j.screenInfo.curve&&(y=j.screenInfo.curve._curves);var r=j.editing;i=r?j.screenInfo:j.screenInfo={};var o,P,l=Z instanceof T.Edge;l?(o=Z.s("edge.segments"),P=Z.s("edge.points")||new T.List):(o=Z._58O,P=Z._59O),i.S=o;var n,V=i.P=[],L=nc.getDataMatrix(Z);if(Z instanceof T.Polyline||Z instanceof T.Edge&&j._interactor.getStyle("edgeElevationEditable"))n=Z.getElevation&&Z.getElevation()||0,i.E=[];else{var s=!1;P.each(function(V){V.e!==c&&(s=!0)}),s&&(i.E=[])}if(P.each(function(_){i.E&&i.E.push(_.e!=c?_.e:n),_=L.apply(_);var W=nc.toScreenPosition(m,_);V.push(W.x,W.y)}),l){var $=V.length,b=nc.toScreenPosition(m,Z._lastSourcePoint||($?{x:V[0],y:V[1]}:{x:0,y:0})),E=nc.toScreenPosition(m,Z._lastTargetPoint||($?{x:V[$-2],y:V[$-1]}:{x:0,y:0}));if(V.splice(0,0,b.x,b.y),V.push(E.x,E.y),i.E){var H=Z.getSource(),D=Z.getTarget();i.E.splice(0,0,((Z.s("edge.source.anchor.elevation")||.5)-.5)*H.getTall()+H.getElevation()),i.E.push(((Z.s("edge.target.anchor.elevation")||.5)-.5)*D.getTall()+D.getElevation())}}if(!i.S||!i.S.size()){i.S=new T.List,i.S.add(1);for(var d=0;d<V.length/2-1;d++)i.S.add(2)}if((!r||v)&&j.convertToCubicBezier(y),j.activing&&(v||!j.editing||"realPoint"===j.editing.type)){var I=i.curve.findPairs(j.activing.point);j.activing.pairs=I}},Em.prototype._convertToNewPoint=function(g,y,q,S){var P,J,v;for(P=0,J=y.length;J>P;P++){if(v=y[P],v._p1.isNearEnough(g)&&(!S||S.indexOf(v._p1)<0))return v._p1;if(v._p4.isNearEnough(g)&&(!S||S.indexOf(v._p4)<0))return v._p4}if(q)for(P=0,J=Math.min(q.length,J);J>P;P++){if(v=q[P],v._p1===g&&(!S||S.indexOf(y[P]._p1)<0))return y[P]._p1;if(v._p4===g&&(!S||S.indexOf(y[P]._p4)<0))return y[P]._p4}},Em.prototype.convertToCubicBezier=function(I){var v,b,M=this,Y=new nc.Math.Curve,D=M.screenInfo;if(Y.createFromHtShape(D.P,D.S,D.E),D.curve=Y,M.activing){var A=Y._curves;v=M.activing.point,b=M._convertToNewPoint(v,A,I);var r=[];if(b&&(M.activing.point=b,r.push(b)),M.activing.selections){var j=-1,h=M.activing.selections;h.forEach(function(F){j++,b=M._convertToNewPoint(F,A,I,r),b&&(h[j]=b,r.push(b))})}}},Em.prototype.check=function(u,s,G){if(!s||tp(s)||_h(s)){var r=this;if(r._interactor.setCursor("default"),r.editing=null,r.highlight=null,r.tipInfo=null,r.edgeEditResult=null,r.screenInfo){if(Zh()||s&&_h(s))return r._interactor._42(),!0;if(r._checkEditCtrlPoint(G))return r._interactor._42(),!0;if(r._checkEditRealPoint(G))return r._interactor._42(),!0;if(r._checkEditElevation(G))return r._interactor._42(),!0;var h=r.screenInfo.curve,S=h.checkPoint(G,r._interactor.getStyle("curveIntersectSize"));if(S){var U=r.highlight={};U.type="insertKnot",U.bezier=S.bezier,U.point=S.intersection}return r._interactor._42(),!0}}},Em.prototype.getAdjacentBeziers=function(E){var G=this.screenInfo;if(G){var q,D,O,S=G.curve._curves,e=[],l=c;for(q=0,D=S.length;D>q;q++)if(O=S[q],l===c){if(O._p4.isNearEnough(E)){e.push(O),l=q;continue}}else{if(O._p1.isNearEnough(E))return e.push(O),e;if(O._p4.isNearEnough(E)){e[0]=O,l=q;continue}}}},Em.prototype.roundCorner=function(H){if(this.activing&&this.screenInfo){var A=this.screenInfo.curve,R=A._curves,F=this.getAdjacentBeziers(this.activing.point),V=F[1],X=V._index;V=V.insertKnot(V.getTByPercentage(H/V.length))[1],R[X]=V;var v=V.p1,j=F[0],a=j._index;j=j.insertKnot(j.getTByPercentage(1-H/j.length))[0],R[a]=j;var z=j.p4,J=this.activing.point,h=new nc.Math.CubicBezier(z,J.clone().sub(z).multiplyScalar(2/3).add(z),J.clone().sub(v).multiplyScalar(2/3).add(v),v);R.splice(X,0,h),this._writeToHt(),this.activing=null,this._interactor._42()}},Em.prototype._checkEditRealPoint=function(S){var G,J,U,Z,g,y,Y=this,I=Y.screenInfo.curve._curves,c=Y._interactor.getStyle("curvePointIntersectSize"),q=1/0;for(c*=c,U=0,Z=I.length;Z>U;U++)G=I[U],g=G._p1,y=S.distanceToSquared(g),q>y&&(q=y,J=g),g=G._p4,y=S.distanceToSquared(g),q>y&&(q=y,J=g);if(q>c)return!1;var $=Y.highlight={};return $.type="changeRealPoint",$.point=J,Y.editing={type:"realPoint",point:J,shiftGuide:{point:J.clone(),dir:"x",limit:0}},Y._interactor.setCursor("crosshair"),!0},Em.prototype._checkEditElevation=function(B){var I=this;if(!I._interactor.getStyle("curveElevationVisible"))return!1;var v=I.target;if(v instanceof T.Edge&&!I._interactor.getStyle("edgeElevationEditable"))return!1;var H=I.activing;if(!H)return!1;var N=H.getCurrentEditingPoint();if(!N)return!1;var l=I._interactor,j=l.getStyle("curveElevationGuideShift"),Q=l.getStyle("curveElevationIntersectSize"),q=B.distanceToSquared({x:N.x+j[0],y:N.y+j[1]});if(!(q>Q*Q)){var y=I.highlight={};y.type="elevation";var w=new nc.Math.Vector2(B.x,B.y,N.e);return I.editing={type:"elevation",startPoint:w},I._interactor.setCursor("crosshair"),!0}},Em.prototype._checkEditCtrlPoint=function(R){var f=this;if(f.activing&&!f.activing.selections){var j=f.getCurrentSelectintStatus();if(j!==nc.Curve.PointType.Straight){var X=f.activing.pairs;if(X){var r=f._interactor.getStyle("curvePointIntersectSize");r*=r;var o,O,k,U,Y,G,H,c,z,$=1/0;for(H=0,z=X.length;z>H;H++)for(U=X[H],c=0;2>c;c++)Y=0===c?"c1":"c2",U[Y]&&(G=R.distanceToSquared(U[Y]),$>G&&($=G,o=U,O=H,k=Y));if($>r)return!1;f.activing.hlpair=o,f.activing.hltype=k;var e=f.highlight={};return e.type="changeCtrlPoint",e.point=o[k],f.editing={type:"ctrlPoint",pair:o,pairId:O,ctrlType:k,direction:o[k].clone().sub(f.activing.point).normalize()},f._interactor.setCursor("crosshair"),!0}}}},Em.prototype.startEdit=function(F,E){F.startDragging(E);var N=this;N.highlight&&"insertKnot"===N.highlight.type&&(N.insertKnot(),N.gatherSingleTarget(N._interactor.gv,N.target),N.activing=null,N._checkEditRealPoint(N._interactor._getLogicalPoint(E)));var K=N._activing;if(K){var B=N.editing?N.editing.type:null;"ctrlPoint"===B?K.editingCtrl={pairId:N.editing.pairId,type:K.hltype}:"realPoint"===B&&(K.editingCtrl=!1)}var Q=N.highlight,I=T.Default.isCtrlDown(E);if(!Q||Zh()||_h(E)){var d=N._interactor.gv;if(!d.setFocus(E)||d._scrolling)return;return I?N._multiSelect={startPoint:d.lp(E)}:d.isPannable()&&(tp(E)||_h(E))&&(N._pan={tx:d.tx(),ty:d.ty()},F.fi({kind:"beginPan",event:E})),void 0}if("changeRealPoint"===Q.type){var w,S=N.activing?N.activing.point:null,h=N.activing?N.activing.selections:null;if(I&&N.activing)S===Q.point?(h?(N.activing={point:h[0]},h.length>1&&(h.splice(0,1),N.activing.selections=h)):N.activing=null,N.editing=null):h&&(w=h.indexOf(Q.point))>=0?(h.length>1?h.splice(w,1):delete N.activing.selections,N.editing=null):h?(h.push(S),N.activing={point:Q.point,selections:h}):N.activing={point:Q.point,selections:[S]};else if(h)S===Q.point||((w=h.indexOf(Q.point))>=0?(h.splice(w,1,S),N.activing={point:Q.point,selections:h}):N.activing={point:Q.point});else{var M;S===Q.point&&(M=N.activing.status),N.activing={point:Q.point},M&&(N.activing.status=M)}F.fi({kind:"beginEditPoint",event:E})}},Em.prototype.insertKnot=function(){var V=this,N=V.highlight,P=V.screenInfo.curve;P.insertKnot(N.bezier,N.point.t),V._writeToHt()},Em.prototype._writeToHt=function(){var G,z,Z=this,f=Z.screenInfo.curve,O=f.toHtShape(),x=O.points,c=[],A=O.segments,L=Z._interactor.gv;L.dm().beginTransaction();var S,s,v=Z.target,e=v instanceof T.Edge,o=nc.getDataMatrix(v).invert();s=v instanceof T.Polyline||e&&Z._interactor.getStyle("edgeElevationEditable"),s&&(S=v.getElevation&&v.getElevation()||0);for(var g=0,$=x.length;$>g;g++)G=x[g],z=nc.toWorldPosition(L,G),z=o.apply(z),isFinite(G.e)&&G.e!==S&&(z.e=G.e),c.push(z);if(v._writing=!0,e){v.s("edge.type","points"),v.setStyle("edge.segments",A),v.setStyle("edge.points",c.slice(1,c.length-1)),v.setStyle("edge.source.offset.x",0),v.setStyle("edge.source.offset.y",0),v.setStyle("edge.target.offset.x",0),v.setStyle("edge.target.offset.y",0);var P=Z._nextChangeEdgeHost;delete Z._nextChangeEdgeHost,P&&("source"===P.type?v.setSource(P.host):v.setTarget(P.host)),Z._writeEdgeHostAnchor("source",c[0]),Z._writeEdgeHostAnchor("target",c[c.length-1])}else c.length?(v.setSegments(A),v.setPoints(c,!0)):v.removeFromDataModel();L.dm().endTransaction(),delete v._writing},Em.prototype._writeEdgeHostAnchor=function(f,D){var B=this,J=B.target,b=B._calcHostAnchor(J,f,D);b.index!==c?(J.setStyle("edge."+f+".index",b.index),J.setStyle("edge."+f+".percent",c),J.setStyle("edge."+f+".anchor.x",c),J.setStyle("edge."+f+".anchor.y",c)):b.percent!==c?(J.setStyle("edge."+f+".percent",b.percent),J.setStyle("edge."+f+".index",c),J.setStyle("edge."+f+".anchor.x",c),J.setStyle("edge."+f+".anchor.y",c)):(J.s("edge."+f+".anchor.x",b.x),J.s("edge."+f+".anchor.y",b.y),J.s("edge."+f+".anchor.elevation",b.e),b.offsetX||b.offsetY?(J.s("edge."+f+".offset.x",b.offsetX),J.s("edge."+f+".offset.y",b.offsetY),J.s("edge."+f+".offset.elevation",b.offsetElevation)):(J.s("edge."+f+".offset.x",0),J.s("edge."+f+".offset.y",0),J.s("edge."+f+".offset.elevation",0)))},Em.prototype._calcHostAnchor=function(W,O,L,N){N||(N="source"===O?W.getSource():W.getTarget());var X=this._interactor.gv,U=X.calculateAttachPoint(N,L);if(U)return U.info;if(El(N)){var u=X.calculateEdgePosition(N,L);return u}var I=N.getRotation(),v=N.getAnchor();lq(N,X)&&(I=0);var P=N.getElevation(),C=N.getTall();P=((L.e||0)-P)/C+.5;var l=N.getScale();if(I||l.x<0||l.y<0){var k=N.getMatrix(),o=k.tfi(L),w=N.getSize();return{x:o.x/w.width+v.x,y:o.y/w.height+v.y,e:P}}var b=aj(X,N),Z={x:(L.x-b.x)/b.width,y:(L.y-b.y)/b.height,e:P};return Z},Em.prototype._handlePanning=function(_){var v=this,e=v._pan;if(e){e.started=!0;var X=v._interactor,y=X.gv,l=X._lastClientPoint,L=Nq(_),C=Zm(y,L,l);y.setTranslate(e.tx+C.x,e.ty+C.y),v.gatherSingleTarget(X.gv,v.target),X._42(),X.fi({kind:"betweenPan",event:_})}},Em.prototype.handleEdit=function(V,Q){var y=this,E=y.editing;if(y._pan)return y._handlePanning(Q),void 0;if(y._multiSelect)return y._multiSelect.endPoint=V.lp(Q),y._interactor.redraw(),void 0;if(E){E.inEdit=!0;var m,B,K,f=y._interactor._getLogicalPoint(Q),e=T.Default.isCtrlDown(Q),o=T.Default.isShiftDown(Q),n=E.type,j=y.activing;if(y._guideInfo=null,"ctrlPoint"===n&&o){var h=y.editing.direction.clone();m=j.point;var x=h.dot(f.clone().sub(m));f=h.setLength(x).add(m)}else if("ctrlPoint"===n||"realPoint"===n){var h;if("realPoint"===n&&o){var k=y.editing.shiftGuide;B=k.point;var W=Math.abs(f.x-B.x),C=Math.abs(f.y-B.y);W>C&&W>k.limit&&"y"===k.dir&&(k.dir="x"),C>W&&C>k.limit&&"x"===k.dir&&(k.dir="y"),h=k.dir,"x"===h?(f.y=B.y,k.limit=Math.max(k.limit,W)):"y"===h&&(f.x=B.x,k.limit=Math.max(k.limit,C))}var H=y._isEditEdgeSourceTarget();if(H){var D=y._editEdgeSourceTarget(H,f,e);D&&(y.edgeEditResult=D,K=D.tipText)}else if(!e){var w=y._guidingToEdit(f,h),l="realPoint"===n?y._interactor.gridGuide.findClosest(f,h,!0):null,z=1/0,J=1/0;l&&(l.x&&(z=l.x),l.y&&(J=l.y));var i=!1;w&&(w.xList&&(Math.abs(w.x)<=Math.abs(z)?(i=!0,z=w.x):delete w.xList),w.yList&&(Math.abs(w.y)<=Math.abs(J)?(i=!0,J=w.y):delete w.yList),i&&(y._guideInfo=w)),isFinite(z)&&(f.x+=z),isFinite(J)&&(f.y+=J),i&&(w.v=f)}}var a=y.screenInfo.curve;if("realPoint"===E.type){m=E.point,m.e!==c&&(f.e=m.e),a.moveRealPoint(m,f),E.point=f,y.highlight.point=f;var G=j.status,p=j.selections;if(y.activing={point:f,status:G},p){var v=f.clone().sub(m),I=0;p.forEach(function(o){var N=o.clone().add(v);a.moveRealPoint(o,N),p[I++]=N}),y.activing.selections=p}}else if("ctrlPoint"===E.type){var g=j.pairs,$=g[E.pairId];a.moveCtrlPoint($,f,E.ctrlType);var d=j.status,F=nc.Curve.PointType;if((d===F.Mirrored||d===F.Asymmetric)&&$.c1&&$.c2){var m=new nc.Math.Vector2(j.point),O="c1"===E.ctrlType?"c2":"c1";if(d===nc.Curve.PointType.Mirrored)a.moveCtrlPoint($,m.clone().multiplyScalar(2).sub(f),O);else if(d===F.Asymmetric){var x=$[O].clone().sub(m).length(),S=m.clone().sub($[E.ctrlType]).setLength(x).add(m);isNaN(S.x)||a.moveCtrlPoint($,S,O)}}j._firePointChange()}else if("elevation"===E.type){B=E.startPoint;var A=B.e+(B.y-f.y)/V._zoom;y._setCurrentPointImpl("e",A),j._firePointChange(),K="E: "+nc.toFixed(A)}var Y=T.Default.getLogicalPoint(Q,y._interactor._canvas);if(Y.x+=nc.Icons.TipShiftX,Y.y+=nc.Icons.TipShiftY,!K){var r=nc.toWorldPosition(V,f);K=""+nc.toFixed(r.x)+", "+nc.toFixed(r.y)}y.tipInfo={helperPos:Y,text:K,size:K.length},y._writeToHt(),y._interactor.fi({kind:"betweenEditPoint",event:Q})}},Em.prototype._setCurrentPointImpl=function(f,n){var j=this,C=j._activing;if(!C)return!1;var u=j.target;if(!u)return!1;var K=C.getCurrentEditingPoint();if(!K)return!1;var l=C.editingCtrl;if(!l)var B=K.clone();if("e"===f)K.e=n;else{var y;if("x"===f||"y"===f){var x=C._lastFirePoint;y="x"===f?{x:n,y:x?x.y:0}:{x:x?x.x:0,y:n}}else"object"==typeof f?(y=f,f.e!==c&&(K.e=f.e)):(y={x:arguments[0],y:arguments[1]},arguments[2]!==c&&(K.e=arguments[2]));var D=nc.getDataMatrix(u);y=nc.toScreenPosition(j._interactor.gv,D.apply(y)),K.x=y.x,K.y=y.y}if(!l){var k=B.multiplyScalar(-1).add(K);K.e&&B.e&&(k.e=K.e-B.e);var N=j.screenInfo.curve;N.moveCtrlDueToRealPointMovement(K,k);var G=C.selections;if(G){var L=0;G.forEach(function(r){var B=r.clone().add(k);isFinite(k.e)&&(B.e=(isFinite(r.e)?r.e:u.getElevation()||0)+k.e),N.moveRealPoint(r,B),G[L++]=B}),C.selections=G}}return!0},Em.prototype.setCurrentPoint=function(D,T){return this._setCurrentPointImpl(D,T)?(this._writeToHt(),!0):!1},Em.prototype._isEditEdgeSourceTarget=function(){var b=this,L=b.target;if(!(L instanceof T.Edge))return!1;var O=b.editing.point,e=b.screenInfo.curve._curves;return O===e[0]._p1?"source":O===e[e.length-1]._p4?"target":!1},Em.prototype._editEdgeSourceTarget=function(e,d,i){var V,r=this,M=r.target;if(V="source"===e?M.getSource():M.getTarget()){var f,j=r._interactor.gv,A=nc.toWorldPosition(j,d),z=r._calcHostAnchor(M,e,A,V);if(f=z.index!==c||z.percent!==c?z.distance*j.getZoom()>r._interactor.getStyle("edgeHostEdgeMaxDistance"):r._interactor.getStyle("edgeHostDetectPerFrame")?!0:z.x<0||z.x>1||z.y<0||z.y>1?!0:!1){var p=j.getDataAt(A,function(_){return j.isSelectable(_)?j.isSourceTargetEditable(M,_,e)?M.canSetSourceTarget(_,e)?!0:!1:!1:!1});if(p){var S=r._calcHostAnchor(M,e,A,p);V=p,r._nextChangeEdgeHost={type:e,host:p},z=S}}var B,Q,R;if(i||z.x===c)(z.percent!==c||z.index!==c)&&(Q=z.point);else{var $=r._interactor.getStyle("anchorRound"),g=r._interactor.getStyle("anchorSensitivity");B=j.calculateAttachPoint(V,A),B?z=B.info:(z.x=nc.roundTo(z.x,$,g),z.y=nc.roundTo(z.y,$,g)),Q=dc(j,V,0,z.offsetX||0,z.offsetY||0,z.x,z.y)}Q&&(R=nc.toScreenPosition(j,Q),d.x=R.x,d.y=R.y),r._edgeHostGuideInfo={corners:nc.getTargetCornersOnScreen(j,V),attach:B?B.index:-1,host:V};var o;return z.percent!==c?o="percent: "+z.percent.toFixed(2):z.index!==c?o="index: "+z.index:(o=""+z.x.toFixed(2)+", "+z.y.toFixed(2),(z.offsetX||z.offsetY)&&(o+=" offset: "+z.offsetX.toFixed(2)+", "+z.offsetY.toFixed(2))),{host:V,anchor:z,tipText:o}}},Em.prototype._guidingToEdit=function(Y,B){var Q,s,b=this;if(Q=b.screenInfo.curve){s=Q._curves;var G,c,y,R,_,w,Z,u,l=1/0,k=1/0,t=[];for(b.editing&&"realPoint"===b.editing.type&&(u=b.editing.point),_=0,w=2*s.length;w>_;_++)Z=s[Math.floor(_/2)][_%2?"_p4":"_p1"],t.indexOf(Z)>=0||(t.push(Z),u&&u===Z||(y=Z.x-Y.x,R=Z.y-Y.y,Math.abs(y)<Math.abs(l)?(l=y,G=[Z]):y===l&&G.push(Z),Math.abs(R)<Math.abs(k)?(k=R,c=[Z]):R===k&&c.push(Z)));var m=b._interactor.getStyle("smartGuideThreshold");if((Math.abs(l)>m||"y"===B)&&(G=null),(Math.abs(k)>m||"x"===B)&&(c=null),G||c){var W=!1,E={};if(G&&(W=!0,E.xList=G,E.x=l),c&&(W=!0,E.yList=c,E.y=k),W)return E}}},Em.prototype._46O=function(C){var o=this;o.editing&&(o.editing=null,o._interactor.fi({kind:"endEditPoint",event:C})),o._guideInfo=null,o._edgeHostGuideInfo=null,o._pan&&(o._pan=null,o._interactor.fi({kind:"endPan",event:C})),o._multiSelect&&(o._handleMultiSelect(o._multiSelect),o._multiSelect=null),o.tipInfo=null,o.edgeEditResult=null},Em.prototype._handleMultiSelect=function(x){if(x.startPoint&&x.endPoint){var D,n,p,C,G,H=this,E=H._interactor,e=E.gv,_=nc.toScreenPosition(e,x.startPoint),d=nc.toScreenPosition(e,x.endPoint),q=T.Default.unionPoint(_,d),Q=H.screenInfo.curve._curves,Y=[],U=function(b){b.x>=q.x&&b.y>=q.y&&b.x<=q.x+q.width&&b.y<=q.y+q.height&&Y.indexOf(b)<0&&Y.push(b)};for(D=0,n=Q.length;n>D;D++)G=Q[D],U(G._p1),U(G._p4);if(Y.length){var y=H.activing||{},M=y.selections||[];for(y.point&&M.push(y.point),D=0,n=M.length;n>D;D++)p=M[D],C=Y.indexOf(p),C>=0?Y[C]=c:Y.push(p);var P=Y;for(Y=[],D=0,n=P.length;n>D;D++)P[D]&&Y.push(P[D]);n=Y.length,0===n?H.activing=null:1===n?H.activing={point:Y[0]}:(p=Y[n-1],H.activing={point:p,selections:Y.splice(0,n-1)}),E.redraw()
}}},Em.prototype._canDeletePoint=function(M,F){var A=this.target;if(!(A instanceof T.Edge))return!0;var o=M._curves[0],S=M._curves[M._curves.length-1];return o._p1===F||S._p4===F?!1:!0},Em.prototype.handleDelete=function(){var W=this;if(W.activing&&W.screenInfo){var v=T.Default.isShiftDown(),X=W.screenInfo.curve;W._canDeletePoint(X,W.activing.point)&&X.deleteRealPoint(W.activing.point,v),W.activing.selections&&W.activing.selections.forEach(function(V){W._canDeletePoint(X,V)&&X.deleteRealPoint(V,v)}),W.activing=null,delete W.editing,delete W.tipInfo,delete W.edgeEditResult,delete W._pan,delete W._multiSelect,W._writeToHt(),W._interactor.fp("deleteShapePoint",!1,!0)}},Em.prototype.handleDoubleClick=function(Z){var b=this,t=b._interactor._getLogicalPoint(Z);if(b.screenInfo&&b._checkEditRealPoint(t)){var U=b.getCurrentSelectintStatus(),X=nc.Curve.PointType;return U=U===X.Mirrored?X.Straight:X.Mirrored,b._setCurrentSelectionStatus(U),b._interactor._42(),!0}},Em.prototype._drawHighlight=function(V){var u=this,W=u.highlight;if(W){var y=W.bezier,Z=u._interactor;y&&nc.Icons.DrawIcon(Z,V,nc.Icons.ShapeHighlightCurve,[y._p1.x,y._p1.y,y._p2.x,y._p2.y,y._p3.x,y._p3.y,y._p4.x,y._p4.y]);var F=W.point;F&&"insertKnot"===W.type&&nc.Icons.DrawIcon(Z,V,nc.Icons.ShapeHighlighPoint,F)}},Em.prototype._drawGuide=function(r){var U=this,z=U._guideInfo;if(z){var M,A,u,Z,j=z.v;for(M=0;2>M;M++)if(Z=0===M?z.xList:z.yList)for(A=0,u=Z.length;u>A;A++)nc.Icons.DrawIcon(U._interactor,r,nc.Icons.ShapeGuideLine,[j.x,j.y,Z[A].x,Z[A].y])}},Em.prototype._drawCurrentPoint=function(x){var E=this;if(E.activing){var R=E.activing,C=E.getCurrentSelectintStatus(),l=E._interactor;if(C!==nc.Curve.PointType.Straight){var e=R.pairs;R.hlpair,R.hltype;var Y=R.selections,D=R.editingCtrl;if(e&&!Y){var w,J,d;for(J=0,d=e.length;d>J;J++)w=e[J],D&&J===D.pairId&&w[D.type]?nc.Icons.DrawIcon(l,x,nc.Icons.ShapeActivingCtrl,{point:w.point,c1:w.c1,c2:w.c2,hl:D.type}):nc.Icons.DrawIcon(l,x,nc.Icons.ShapeActivingCtrl,w)}}nc.Icons.DrawIcon(l,x,nc.Icons.ShapeHighlighRealPoint,E.activing.point),Y&&Y.forEach(function($){nc.Icons.DrawIcon(l,x,nc.Icons.ShapeHighlighRealPoint,$)})}},Em.prototype.clear=function(){var M=this;M.editing=null,M._guideInfo=null,M.activing=null,M.highlight=null},Em.prototype._42=function(z){var B=this;B.info={},B.editing||(B.screenInfo=null);var r=B._interactor;if(!r.editDetail)return B.clear(),void 0;var x=r.gv;if(!B.target||!x.isSelected(B.target)||!x.isVisible(B.target))return r.editDetail=!1,B.clear(),void 0;if(B.gatherSingleTarget(x,B.target),nc.Icons.DrawIcon(r,z,nc.Icons.ShapeBgCurve,B.screenInfo),B._interactor.getStyle("curveElevationVisible")&&(B.target instanceof T.Polyline||B.target instanceof T.Edge&&B._interactor.getStyle("edgeElevationEditable"))&&B.activing){var q=B.activing.getCurrentEditingPoint();q&&"string"!=typeof q.e&&nc.Icons.DrawIcon(r,z,nc.Icons.EdgeElevationGuide,q)}if(B._drawHighlight(z),B._drawCurrentPoint(z),B._getRealPoint().forEach(function(Z){nc.Icons.DrawIcon(r,z,nc.Icons.ShapePoint,Z)}),B._drawGuide(z),B.tipInfo&&B._interactor.getStyle("curveTipVisible")&&nc.Icons.DrawIcon(r,z,nc.Icons.TipHelper,B.tipInfo),B._edgeHostGuideInfo&&r._drawHostGuide(B._edgeHostGuideInfo),B.edgeEditResult&&B._drawEdgeHostHighlight(z,B.edgeEditResult.host,B.edgeEditResult.anchor),B._multiSelect&&B._multiSelect.endPoint){var N=T.Default.unionPoint(nc.toScreenPosition(x,B._multiSelect.startPoint),nc.toScreenPosition(x,B._multiSelect.endPoint));N.color=x.getRectSelectBorderColor(),z.save(),z.setTransform(1,0,0,1,0,0);var f=L.devicePixelRatio,X=N.borderWidth=Math.round(f);X/=2,N.x=Math.round(N.x*f)+X,N.y=Math.round(N.y*f)+X,N.width=Math.round(N.width*f),N.height=Math.round(N.height*f),nc.Icons.DrawIcon(r,z,nc.Icons.SimpleRect,N),z.restore()}},Em.prototype._drawEdgeHostHighlight=function(y,K,D){this.drawEdgeHostHighlight(y,K,D),this._interactor.redraw()},Em.prototype.drawEdgeHostHighlight=function(d,B,w){if(El(B)){var b,L,$,e,m=this,v=m._interactor,J=v.gv,W=J.getDataUI(B),s=Zp(W),F=[];for($=0,e=s.points.length;e>$;$++)L=nc.toScreenPosition(J,s.points.get($)),F.push(L.x,L.y);s.segments&&(b=s.segments.toArray());var U=v.getStyle("edgeHostHighlighPeriod"),f=v.getStyle("edgeHostEdgeHighlighColor");nc.Icons.DrawIcon(v,d,nc.Icons.ShapeBgCurve,{P:F,S:b,color:f,dynamicVisible:w.index===c,dynamicPeriod:U}),f=v.getStyle("edgeHostPointHighlighColor");var T=jk(W);for($=0,e=T.length;e>$;$++){var h=T[$],Q=nc.toScreenPosition(J,h);nc.Icons.DrawIcon(v,d,nc.Icons.ShapePoint,{point:{x:Q.x,y:Q.y},color:f,size:12,dynamicVisible:$===w.index,dynamicPeriod:U})}}},Em.prototype._getRealPoint=function(){var C,w=this.screenInfo,B=w.P,X=w.S,S=-1,K=[],e=-1,b=X.length;return X.each(function(R){e++;var W=1;if(3===R)W=2;else if(4===R)W=3;else if(5===R)return;S+=W,C=e+1>=b?!0:1===X.get(e+1)?!0:!1,K.push({point:{x:B[2*S],y:B[2*S+1]},segmentIndex:e,pointIndex:S,isEnd:C})}),K},Em.prototype.getEditingPointsInfo=function(m){var z=this,P=z.activing;if(!P)return!1;var k=P.point;if(!k)return!1;var h=this._getRealPoint(),Q=[{screen:k}];P.selections&&P.selections.forEach(function(H){Q.push({screen:H})});var n,c,e=h.length;return Q.forEach(function(x){for(n=0;e>n;n++)if(c=h[n],x.screen.isNearEnough(c.point)){x.segmentIndex=c.segmentIndex,x.pointIndex=c.pointIndex,x.point=z.target.getPoints().get(c.pointIndex);break}}),m&&Q.sort(function(V,w){return V.segmentIndex-w.segmentIndex}),Q};var mr=nc.MoveHelper=function(u){var c=this;c.catalog="Move",c._interactor=u};mr.prototype={},mr.prototype.constructor=mr,mr.prototype.calcShift=function(m,x,w){var F,K,c=this,V=c._interactor.gv,I=V.lp(x);if("beginMove"===m&&c._gatherGridInfo(w._lastLogicalPoint||I),F=c._target){var H=F.downPosition;if(H){var J=c._interactor.getStyle("moveSensitivity")/V._zoom;if(H.distanceTo(I)<J)return{x:0,y:0};delete F.downPosition}var z;K=T.Default.isShiftDown(x),K&&(I=c._dealShiftDown(I),z=F.shiftGuide.dir);var v,u=F.rawPos={x:F.pos.x+I.x-F.lp.x,y:F.pos.y+I.y-F.lp.y};if(T.Default.isCtrlDown(x)){if(v=c._calcShiftByAddon(),c._target.node instanceof nc.Group){var k=c._target.node;k._position.x+=v.x,k._position.y+=v.y}return v}var j=c._interactor.rectGuide;if(F.node instanceof T.Data&&F.node.s("2d.attachable")){var N=c._calcAttachNodeShift(F.node,u);if(j.clear(),N)return N}for(var P,Y=F.x+u.x,M=F.y+u.y,$={x:Y,y:M},D={x:Y+F.w/2,y:M+F.h/2},i={x:Y+F.w,y:M+F.h},e=c._interactor.gridGuide,Q=[j.findClosest($,z),j.findClosest(D,z),j.findClosest(i,z),e.findClosest($,z),e.findClosest(D,z),e.findClosest(i,z)],E=1/0,A=1/0,W=0,U=Q.length;U>W;W++)P=Q[W],P&&(Y=P.x,M=P.y,isFinite(Y)&&Math.abs(Y)<Math.abs(E)&&(E=Y),isFinite(M)&&Math.abs(M)<Math.abs(A)&&(A=M));if(isFinite(E)||(E=0),isFinite(A)||(A=0),v=c._calcShiftByAddon(E,A),c._target.node instanceof nc.Group){var k=c._target.node;k._position.x+=v.x,k._position.y+=v.y}var s=F.node;if(!lq(s,V)){var b=u.x+E,R=u.y+A;c._interactor.rectGuide.gatherLines({node:s,x:F.x+b,y:F.y+R,w:F.w,h:F.h},z)}return v}},mr.prototype._calcShiftByAddon=function(G,I){var k=this._target,q=k.rawPos,i=k.node.getPosition();return G=G||0,I=I||0,{x:q.x-i.x+G,y:q.y-i.y+I}},mr.prototype._dealShiftDown=function(w){var N=this,Y=N._target.shiftGuide,q=N._target.lp,m=Math.abs(w.x-q.x),P=Math.abs(w.y-q.y);m>P&&m>Y.limit&&"y"===Y.dir&&(Y.dir="x"),P>m&&P>Y.limit&&"x"===Y.dir&&(Y.dir="y");var g=Y.dir;return"x"===g?(w.y=q.y,Y.limit=Math.max(Y.limit,m)):"y"===g&&(w.x=q.x,Y.limit=Math.max(Y.limit,P)),w},mr.prototype._isAttachableLineShape=function(K){if(!K.getSegments)return!1;var v=K.getSegments();if(!v)return!0;v instanceof T.List&&(v=v.getArray());for(var S=1,I=v.length;I>S;S++)if(2!==v[S])return!1;return!0},mr.prototype._calcAttachNodeShift=function(){var e=new xg,m=new xg,I=new xg,T=new xg;return function(a,D){var p=this._interactor.gv,o=a.getHost(),v=p.getDataAt(D,function(i){return i.s("2d.hostable")?!0:!1});if(v&&o!==v&&a.setHost(v),!v)return this._edgeHostGuideInfo=null,a.setHost(null);var $=this._edgeHostGuideInfo={corners:nc.getTargetCornersOnScreen(p,v),host:v,attach:-1};if(this._isAttachableLineShape(v)){for(var c,U,i,C,Z,h,H=v.getPoints(),N=H.size(),L=v.getPointsMatrix2d(),S=1/0,R=0;N>R&&(R!==N-1||v.isClosePath());R++)0!==R?m.copy(I):L.apply(H.get(R),m),L.apply(R===N-1?H.get(0):H.get(R+1),I),e.copy(D).sub(m),T.copy(I).sub(m),c=T.length(),T.divideScalar(c),U=e.dot(T),0>U?U=0:U>c&&(U=c),T.multiplyScalar(U).add(m),i=e.copy(D).sub(T).lengthSq(),S>i&&(S=i,h=R,C=U,Z=c);return Math.sqrt(S)*p.getZoom()>this._interactor.getStyle("attachThreshold")?(a.s({"attach.index":-1}),a.setHost(null),void 0):(a.s("attach.offset.opposite")&&(C=Z-C),a.s({"attach.index":h,"attach.offset":a.s("attach.offset.relative")?C/Z:C}),{x:0,y:0})}var Q=p.calculateAttachPoint(v,D);if(Q){var u=Q.point;return $.attach=Q.index,this._calcShiftByAddon(u.x-D.x,u.y-D.y)}}}(),mr.prototype._gatherGridInfo=function(i){var b,s=this,V=s._interactor,h=V._getValidSelection();if(h.length){if(1===h.length){if(b=h[0],!b.getRect)return s._target=null,void 0}else if(b=nc.Group.findOrCreateGroup(h,V._uuid),!b)return s._target=null,void 0}else{var h=V.gv.sm().getSelection();if(h.length&&(b=h.get(0),!b.getRect))return s._target=null,void 0}if(b){var p=b.getPosition(),P=b.getRect();s._target={node:b,x:P.x-p.x,y:P.y-p.y,w:P.width,h:P.height,lp:{x:i.x,y:i.y},pos:{x:p.x,y:p.y},shiftGuide:{dir:"x",limit:0},downPosition:new nc.Math.Vector2(i)},V.rectGuide.gatherRects()}},mr.prototype.clear=function(){var X=this;X._edgeHostGuideInfo=null,X._interactor.rectGuide.clear(),X._interactor._42()},mr.prototype._42=function(){var T=this._edgeHostGuideInfo;T&&this._interactor._drawHostGuide(T)};var zm=i.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),rf=function(){function F(I,n){var l=c;return function(){return l||(l=I.getExtension(n)),l}}function e(a,q){q==c&&(q={}),q.version=B&&(a instanceof WebGL2RenderingContext||i.prototype.toString.call(a)===w)?2:1,q.extensions=function(){for(var X={},D=a.getSupportedExtensions(),E=D.length;E--;)X[name]=F(a,D[E]);return X}();for(var Q=i.keys(d),I=0,n=Q.length;n>I;++I){var t=Q[I];q[t]=a.getParameter(d[t])}if(q.version>1){Q=i.keys(s);for(var I=0,n=Q.length;n>I;++I){var t=Q[I];q[t]=a.getParameter(s[t])}}return q}var B="undefined"!=typeof WebGL2RenderingContext,w="[object WebGL2RenderingContext]",d={aliasedLineWidthRange:zm.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:zm.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:zm.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:zm.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:zm.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:zm.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:zm.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:zm.MAX_TEXTURE_SIZE,maxVaryingVectors:zm.MAX_VARYING_VECTORS,maxVertexAttribs:zm.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:zm.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:zm.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:zm.MAX_VIEWPORT_DIMS},s={max3DTextureSize:zm.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:zm.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:zm.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:zm.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:zm.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:zm.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:zm.MAX_DRAW_BUFFERS,maxElementIndex:zm.MAX_ELEMENT_INDEX,maxElementsIndices:zm.MAX_ELEMENTS_INDICES,maxElementsVertices:zm.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:zm.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:zm.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:zm.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:zm.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:zm.MAX_SAMPLES,maxTextureLODBias:zm.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:zm.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:zm.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:zm.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:zm.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:zm.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:zm.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:zm.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:zm.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:zm.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:zm.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(T){var j=T._info;return j||(T._info=j=e(T,j)),j}}}(),zr=function(){function a(g,S,Q){return{def:g,getter:Q?function(Y){var O=rf.for(Y);return O.version>1?Y.getParameter(S):g}:function(w){return w.getParameter(S)},setter:Q?function(c,g){var V=rf.for(c);V.version>1&&c.pixelStorei(S,g)}:function(m,H){m.pixelStorei(S,H)}}}function n(V){return"string"==typeof V?sc(V):V.r!==c?(X[0]=V.r,X[1]=V.g,X[2]=V.b,X[3]=V.a,X):V.red!==c?(X[0]=V.red,X[1]=V.green,X[2]=V.blue,X[3]=V.alpha,X):V}function T(h){return B(h)?Array.prototype.slice.call(h,0):h}function s(H,G,O){this.gl=G,this._record=O||{},this._branches={},this._leafSync={},this._struct=H;for(var Y=H.children,V=Y.length;V--;){var q=Y[V],f=q.name;q.isLeaf?(this._leafSync[f]=!1,this._record[f]=T(q.desc.def)):this._record[f]={}}}function p(T){function w(d,g){s.call(this,T,d,g);for(var u=U.length;u--;){var j=U[u];this._branches[j._name]=new j._type(d,this._record[j._name])}}function C(O,T){function f(G,e){for(var M=z,L=!1;M--;)G[M]!==e[M]&&(G[M]=e[M],L=!0);return L}var r=O.name,J=B(O.desc.def),z=J&&O.desc.def.length;if(O.isLeaf){var j=O.desc.setter,V=O.desc.parse;i.defineProperty(T,r,{configurable:!1,enumerable:!0,get:function(){return this._record[r]},set:J?function(h){V&&(h=V(h)),(f(this._record[r],h)||!this._leafSync[r])&&(j(this.gl,this._record[r]),this._leafSync[r]=!0)}:function(y){this._record[r]===y&&this._leafSync[r]||(j(this.gl,y),this._record[r]=y,this._leafSync[r]=!0)}})}else U.push({_name:r,_type:p(O)}),i.defineProperty(T,r,{configurable:!1,enumerable:!0,get:function(){return this._branches[r]},set:function(X){this._branches[r].apply(X)}})}var U=[];return b(w,s),T.forEach(C,w.prototype),w}var X="undefined"!=typeof Float32Array&&new Float32Array(4),M={viewport:{def:[0,0,0/0,0/0],getter:function(T){return T.getParameter(T.VIEWPORT)},setter:function(A,g){var e=g[2]!==g[2]?A.drawingBufferWidth-g[0]:g[2],Z=g[3]!==g[3]?A.drawingBufferHeight-g[1]:g[3];A.viewport(g[0],g[1],e,Z)}},dither:{def:!1,getter:function(H){return H.isEnabled(H.DITHER)},setter:function(H,T){T?H.enable(H.DITHER):H.disable(H.DITHER)}},rasterizerDiscard:{def:!1,getter:function(B){var z=rf.for(B);return z.version>1&&B.isEnabled(B.RASTERIZER_DISCARD)},setter:function(c,Y){var v=rf.for(c);1!==v.version&&(Y?c.enable(c.RASTERIZER_DISCARD):c.disable(c.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(f){return f.lineWidth?f.getParameter(f.LINE_WIDTH):1},setter:function(V,i){V.lineWidth&&V.lineWidth(i)}},color:{clear:{def:[0,0,0,0],getter:function(Y){return Y.getParameter(Y.COLOR_CLEAR_VALUE)},setter:function(K,i){K.clearColor(i[0],i[1],i[2],i[3])},parse:n},mask:{def:[!0,!0,!0,!0],getter:function(D){return D.getParameter(D.COLOR_WRITEMASK)},setter:function(t,p){t.colorMask(p[0],p[1],p[2],p[3])}}},blend:{enabled:{def:!1,getter:function(T){return T.isEnabled(T.BLEND)},setter:function(L,l){l?L.enable(L.BLEND):L.disable(L.BLEND)}},color:{def:[0,0,0,0],getter:function(F){return F.getParameter(F.BLEND_COLOR)},setter:function(t,j){t.blendColor(j[0],j[1],j[2],j[3])},parse:n},equation:{def:[zm.FUNC_ADD,zm.FUNC_ADD],getter:function(J){return[J.getParameter(J.BLEND_EQUATION_RGB),J.getParameter(J.BLEND_EQUATION_ALPHA)]},setter:function(G,K){G.blendEquationSeparate(K[0],K[1])},parse:function(l){var S=l.length;return S>1?l:1===S?(X[1]=X[0]=l[0],X):(X[1]=X[0]=l,X)}},func:{def:[zm.ONE,zm.ZERO,zm.ONE,zm.ZERO],getter:function(O){return[O.getParameter(O.BLEND_SRC_RGB),O.getParameter(O.BLEND_DST_RGB),O.getParameter(O.BLEND_SRC_ALPHA),O.getParameter(O.BLEND_DST_ALPHA)]},setter:function(C,A){C.blendFuncSeparate(A[0],A[1],A[2],A[3])},parse:function(J){var c=J.length;return c>3?J:(X[2]=X[0]=J[0],X[3]=X[1]=J[1],X)}}},cullFace:{enabled:{def:!1,getter:function(R){return R.isEnabled(R.CULL_FACE)},setter:function(Z,O){O?Z.enable(Z.CULL_FACE):Z.disable(Z.CULL_FACE)}},mode:{def:zm.BACK,getter:function(U){return U.getParameter(U.CULL_FACE_MODE)},setter:function(X,s){X.cullFace(s)}},frontFace:{def:zm.CCW,getter:function(i){return i.getParameter(i.FRONT_FACE)},setter:function(Z,p){Z.frontFace(p)}}},scissor:{enabled:{def:!1,getter:function(k){return k.isEnabled(k.SCISSOR_TEST)},setter:function(s,C){C?s.enable(s.SCISSOR_TEST):s.disable(s.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(i){return i.getParameter(i.SCISSOR_BOX)},setter:function(l,M){var y=M[2]!==M[2]?l.drawingBufferWidth-M[0]:M[2],i=M[3]!==M[3]?l.drawingBufferHeight-M[1]:M[3];l.scissor(M[0],M[1],y,i)}}},depth:{enabled:{def:!1,getter:function(Y){return Y.isEnabled(Y.DEPTH_TEST)},setter:function(J,b){b?J.enable(J.DEPTH_TEST):J.disable(J.DEPTH_TEST)}},clear:{def:1,getter:function(u){return u.getParameter(u.DEPTH_CLEAR_VALUE)},setter:function(H,B){H.clearDepth(B)}},mask:{def:!0,getter:function(H){return H.getParameter(H.DEPTH_WRITEMASK)},setter:function(g,I){g.depthMask(I)}},range:{def:[-1,1],getter:function(G){return G.getParameter(G.DEPTH_RANGE)},setter:function(C,u){C.depthRange(u[0],u[1])}},func:{def:zm.LESS,getter:function(M){return M.getParameter(M.DEPTH_FUNC)},setter:function(P,K){P.depthFunc(K)}}},stencil:{enabled:{def:!1,getter:function(l){return l.isEnabled(l.STENCIL_TEST)},setter:function(K,m){m?K.enable(K.STENCIL_TEST):K.disable(K.STENCIL_TEST)}},clear:{def:0,getter:function(I){return I.getParameter(I.STENCIL_CLEAR_VALUE)},setter:function(y,S){y.clearStencil(S)}},frontMask:{def:255,getter:function(s){return s.getParameter(s.STENCIL_WRITEMASK)},setter:function(m,h){m.stencilMaskSeparate(m.FRONT,h)}},frontOp:{def:[zm.KEEP,zm.KEEP,zm.KEEP],getter:function(b){return[b.getParameter(b.STENCIL_FAIL),b.getParameter(b.STENCIL_PASS_DEPTH_FAIL),b.getParameter(b.STENCIL_PASS_DEPTH_PASS)]},setter:function(f,x){f.stencilOpSeparate(f.FRONT,x[0],x[1],x[2])}},frontFunc:{def:[zm.ALWAYS,0,255],getter:function(b){return[b.getParameter(b.STENCIL_FUNC),b.getParameter(b.STENCIL_REF),b.getParameter(b.STENCIL_VALUE_MASK)]},setter:function(W,I){W.stencilFuncSeparate(W.FRONT,I[0],I[1],I[2])}},backMask:{def:255,getter:function(V){return V.getParameter(V.STENCIL_BACK_WRITEMASK)},setter:function(A,P){A.stencilMaskSeparate(A.BACK,P)}},backOp:{def:[zm.KEEP,zm.KEEP,zm.KEEP],getter:function(V){return[V.getParameter(V.STENCIL_BACK_FAIL),V.getParameter(V.STENCIL_BACK_PASS_DEPTH_FAIL),V.getParameter(V.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(Y,G){Y.stencilOpSeparate(Y.BACK,G[0],G[1],G[2])}},backFunc:{def:[zm.ALWAYS,0,255],getter:function(M){return[M.getParameter(M.STENCIL_BACK_FUNC),M.getParameter(M.STENCIL_BACK_REF),M.getParameter(M.STENCIL_BACK_VALUE_MASK)]
},setter:function(N,h){N.stencilFuncSeparate(N.BACK,h[0],h[1],h[2])}}},hint:{generateMipmap:{def:zm.DONT_CARE,getter:function(g){return g.getParameter(g.GENERATE_MIPMAP_HINT)},setter:function(y,D){y.hint(y.GENERATE_MIPMAP_HINT,D)}},fragmentShaderDerivative:{def:zm.DONT_CARE,getter:function(p){var U=rf.for(p);return 1!==U.version||U.extensions.OES_standard_derivatives?p.getParameter(zm.FRAGMENT_SHADER_DERIVATIVE_HINT):zm.DONT_CARE},setter:function(X,E){var V=rf.for(X);return V.version>1||V.extensions.OES_standard_derivatives?(X.hint(zm.FRAGMENT_SHADER_DERIVATIVE_HINT,E),void 0):void 0}}},pixelStore:{packAlignment:a(4,zm.PACK_ALIGNMENT,!1),unpackAlignment:a(4,zm.UNPACK_ALIGNMENT,!1),unpackFlipY:a(!1,zm.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:a(!1,zm.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:a(zm.BROWSER_DEFAULT_WEBGL,zm.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:a(0,zm.PACK_ROW_LENGTH,!0),packSkipPixels:a(0,zm.PACK_SKIP_PIXELS,!0),packSkipRows:a(0,zm.PACK_SKIP_ROWS,!0),unpackRowLength:a(0,zm.UNPACK_ROW_LENGTH,!0),unpackImageHeight:a(0,zm.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:a(0,zm.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:a(0,zm.UNPACK_SKIP_ROWS,!0),unpackSkipImages:a(0,zm.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(d){return d.isEnabled(d.POLYGON_OFFSET_FILL)},setter:function(k,d){d?k.enable(k.POLYGON_OFFSET_FILL):k.disable(k.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(R){return[R.getParameter(R.POLYGON_OFFSET_FACTOR),R.getParameter(R.POLYGON_OFFSET_UNITS)]},setter:function(X,$){X.polygonOffset($[0],$[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(O){return O.isEnabled(O.SAMPLE_COVERAGE)},setter:function(g,U){U?g.enable(g.SAMPLE_COVERAGE):g.disable(g.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(T){return T.isEnabled(T.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(y,i){i?y.enable(y.SAMPLE_ALPHA_TO_COVERAGE):y.disable(y.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(W){return[W.getParameter(W.SAMPLE_COVERAGE_VALUE),W.getParameter(W.SAMPLE_COVERAGE_INVERT)]},setter:function(h,s){h.sampleCoverage(s[0],s[1])}}}},k=Ir.create(M,function(K){return"def"in K});s.prototype.reset=function(){for(var j=this._struct.children,b=j.length;b--;){var k=j[b],X=k.name;k.isLeaf?this[X]=k.desc.def:this._branches[X].reset()}},s.prototype.save=function(u){u==c&&(u={});for(var A=this._struct.children,g=A.length;g--;){var q=A[g],X=q.name;if(q.isLeaf)u[X]=T(this._record[X]);else{var m=u[X];m==c&&(u[X]=m={}),this._branches[X].save(m)}}return u},s.prototype.sync=function(h,R){for(var u=this._struct.children,Z=u.length;Z--;){var P=u[Z],c=P.name;P.isLeaf?(R||!this._leafSync[c])&&(h?(this._record[c]=P.desc.getter(this.gl),this._leafSync[c]=!0):(P.desc.setter(this.gl,this._record[c]),this._leafSync[c]=!0)):this._branches[c].sync(h,R)}},s.prototype.syncLoss=function(){for(var g=this._struct.children,B=g.length;B--;){var $=g[B];$.isLeaf?this._leafSync[$.name]=!1:this._branches[$.name].syncLoss()}},s.prototype.apply=function(e){for(var E=this._struct.children,V=E.length;V--;){var k=E[V],s=k.name;s in e&&(k.isLeaf?this[s]=e[s]:this._branches[s].apply(e[s]))}},s.prototype.append=function(h){var I=this._struct.childMap;for(var L in h){var n=I[L];n&&(n.isLeaf?this[L]=h[L]:this._branches[L].append(h[L]))}};var F=p(k);return function(k){var _=k._state;return _||(k._state=_=new F(k)),_}}(),pi=function(){function y(K,A,E,U){if(K){var S=K.length;if(S!=c)for(var $=0;U>$;++$)A[E+$]=K[$];else K.toArray&&K.toArray(A,E)}else for(var $=0;U>$;++$)A[E+$]=0}function D(z,w,f){var H=z[0];if(0>=H||H>0)return z;var e=w*f,F=j[e];if(F==c&&(j[e]=new Float32Array(e)),0!==w){y(H,F,0,f);for(var l=1,r=0;l!==w;++l)r+=f,y(z[l],F,r,f)}return F}function m(T,B){T.uniform1f(this.addr,B)}function Z(w,G){w.uniform1fv(this.addr,G)}function h(M,s){if(s.x!=c)M.uniform2f(this.addr,s.x,s.y);else{var z=j[2];z.set(s,0),M.uniform2fv(this.addr,z)}}function f(n,u){n.uniform2fv(this.addr,D(u,this.size,2))}function I(v,L){if(L.x!=c)v.uniform3f(this.addr,L.x,L.y,L.z);else if(L.r!=c)v.uniform3f(this.addr,L.r,L.g,L.b);else if(L.red!=c)v.uniform3f(this.addr,L.red,L.green,L.blue);else{var p=j[3];p.set(L,0),v.uniform3fv(this.addr,p)}}function W(G,V){G.uniform3fv(this.addr,D(V,this.size,3))}function K(B,H){if("string"==typeof H&&(H=sc(H)),H.x!=c)B.uniform4f(this.addr,H.x,H.y,H.z,H.w);else if(H.r!=c)B.uniform4f(this.addr,H.r,H.g,H.b,H.a);else if(H.red!=c)B.uniform4f(this.addr,H.red,H.green,H.blue,H.alpha);else{var p=j[4];p.set(H,0),B.uniform4fv(this.addr,p)}}function M(S,H){S.uniform4fv(this.addr,D(H,this.size,4))}function N(z,Y){z.uniform1i(this.addr,Y)}function s(O,Z){O.uniform1iv(this.addr,Z)}function V(P,t){P.uniform2iv(this.addr,t)}function p(h,f){h.uniform3iv(this.addr,f)}function S(j,R){j.uniform4iv(this.addr,R)}function R(f,K){f.uniform1i(this.addr,H[K?1:0])}function o(v,h){var Q=j[4];Q.set(h,0),v.uniformMatrix2fv(this.addr,!1,Q)}function A(r,O){r.uniformMatrix2fv(this.addr,!1,D(O,this.size,4))}function d(f,U){var B=j[9];B.set(U,0),f.uniformMatrix3fv(this.addr,!1,B)}function F(a,k){a.uniformMatrix3fv(this.addr,!1,D(k,this.size,9))}function L(l,R){var B=j[16];B.set(R,0),l.uniformMatrix4fv(this.addr,!1,B)}function T(k,X){k.uniformMatrix4fv(this.addr,!1,D(X,this.size,16))}function n(R,h){R.uniform1i(this.addr,this.slots[0]),R.activeTexture(R.TEXTURE0+this.slots[0]),R.bindTexture(R.TEXTURE_2D,h||R._emptyTexture)}function t(X,B){X.uniform1iv(this.addr,this.slots);for(var t=this.slots.length;t--;)X.activeTexture(X.TEXTURE0+this.slots[t]),X.bindTexture(X.TEXTURE_2D,B[t]||X._emptyTexture)}function g(v,p){v.uniform1i(this.addr,this.slots[0]),v.activeTexture(v.TEXTURE0+this.slots[0]),v.bindTexture(v.TEXTURE_CUBE_MAP,p||v._emptyCubeTexture)}function J(Q,L){Q.uniform1iv(this.addr,this.slots);for(var R=this.slots.length;R--;)Q.activeTexture(Q.TEXTURE0+this.slots[R]),Q.bindTexture(Q.TEXTURE_CUBE_MAP,L[R]||Q._emptyCubeTexture)}function X(v,J,u){P[v]=[J,u]}function E(g,K,i){switch(g.type){case 35678:case 35680:if("uSampler"===i)return[0];if("uBlendSampler"===i)return[1];for(var a=g.size,e=new Int32Array(a),X=0;a>X;++X)e[X]=K.usedTextureSlot++;return e}return c}function O(l,C,t,Y,f){this.name=l,this.addr=C,this.size=Y?t.size:0,this.activeInfo=t,this.setter=P[t.type][Y?1:0],this.slots=E(t,f,l),Af(this)}function r(_,Y,l,N){var W=_.name,a=W.length;for(w.lastIndex=0;;){var D=w.exec(W),i=w.lastIndex,S=D[1],e="]"===D[2],r=D[3];if(e&&(S=0|S),r===c||"["===r&&i+2===a){l[S]=new O(S,Y,_,r!==c,N);break}var L=l[S];L==c&&(l[S]=L={}),l=L}}function x(M,E,h){this.gl=E,this._program=h,this._leaves={},this._branches={},this._struct=M}function C(s){function M(L,z){x.call(this,s,L,z);for(var y=m.length;y--;){var R=m[y];this._branches[R._name]=new R._type(L,z)}}function p(b,c){var _=b.name;if(b.isLeaf){var w=e("d.setter(this.gl, v);",["v"],["d"],[b.desc]);i.defineProperty(c,_,{configurable:!1,enumerable:!0,get:function(){return w},set:w})}else m.push({_name:_,_type:C(b)}),i.defineProperty(c,_,{configurable:!1,enumerable:!0,get:function(){return this._branches[_]},set:function(e){this._branches[_].apply(e)}})}var m=[];return b(M,x),s.forEach(p,M.prototype),M}function v(I,V){for(var A=I.getProgramParameter(V,I.ACTIVE_UNIFORMS),F={},h={usedTextureSlot:2};A--;){var G=I.getActiveUniform(V,A),x=G.name,Z=I.getUniformLocation(V,x);r(G,Z,F,h)}var $=Ir.create(F,function(I){return"addr"in I}),Q=C($);return i.defineProperty(Q.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:h.usedTextureSlot}),new Q(I,V)}var j=[];if("function"==typeof Float32Array)for(var Y=1;17>Y;++Y)j[Y]=new Float32Array(Y);var H=[0,1],P=[];X(zm.FLOAT,m,Z),X(zm.FLOAT_VEC2,h,f),X(zm.FLOAT_VEC3,I,W),X(zm.FLOAT_VEC4,K,M),X(zm.INT,N,s),X(zm.INT_VEC2,V,V),X(zm.INT_VEC3,p,p),X(zm.INT_VEC4,S,S),X(zm.BOOL,R,s),X(zm.BOOL_VEC2,V,V),X(zm.BOOL_VEC3,p,p),X(zm.BOOL_VEC4,S,S),X(zm.FLOAT_MAT2,o,A),X(zm.FLOAT_MAT3,d,F),X(zm.FLOAT_MAT4,L,T),X(zm.SAMPLER_2D,n,t),X(zm.SAMPLER_CUBE,g,J);var w=/([\w\d_]+)(\])?(\[|\.)?/g;return x.prototype.apply=function(R){for(var C=this._struct.children,P=C.length;P--;){var w=C[P],Z=w.name;Z in R&&(w.isLeaf?this[Z]=R[Z]:this._branches[Z].apply(R[Z]))}},x.prototype.append=function(b){var D=this._struct.childMap;for(var i in b){var j=D[i];j&&(j.isLeaf?this[i]=b[i]:this._branches[i].append(b[i]))}},function(s,J){var j=J._uniforms;return j||(J._uniforms=j=v(s,J)),j}}(),Kb=function(){function V(w,y,p){y.vertexAttrib1f(w.addr,p)}function J(M,U,H){if(H.x!=c)U.vertexAttrib2f(M.addr,H.x,H.y);else{var p=W[2];p.set(H,0),U.vertexAttrib2fv(M.addr,p)}}function K(Z,N,D){if(D.x!=c)N.vertexAttrib3f(Z.addr,D.x,D.y,D.z);else if(D.r!=c)N.vertexAttrib3f(Z.addr,D.r,D.g,D.b);else if(D.red!=c)N.vertexAttrib3f(Z.addr,D.red,D.green,D.blue);else{var x=W[3];x.set(D,0),N.vertexAttrib3fv(Z.addr,x)}}function k(K,R,o){if("string"==typeof o&&(o=sc(o)),o.x!=c)R.vertexAttrib4f(K.addr,o.x,o.y,o.z,o.w);else if(o.r!=c)R.vertexAttrib4f(K.addr,o.r,o.g,o.b,o.a);else if(o.red!=c)R.vertexAttrib4f(K.addr,o.red,o.green,o.blue,o.alpha);else{var g=W[4];g.set(o,0),R.vertexAttrib4fv(K.addr,g)}}function j(d,D,t){t=t.el||t;for(var R=0,Z=0;2>R;++R)D.vertexAttrib2f(d.addr,t[Z++],t[Z++])}function p(r,F,M){M=M.el||M;for(var W=0,e=0;3>W;++W)F.vertexAttrib3f(r.addr,M[e++],M[e++],M[e++])}function G(j,r,k){k=k.el||k;for(var i=0,L=0;4>i;++i)r.vertexAttrib4f(j.addr,k[L++],k[L++],k[L++],k[L++])}function A(O,G,e,l,F,i,s){G.bindBuffer(G.ARRAY_BUFFER,e),G.vertexAttribPointer(O.addr,1,l||G.FLOAT,!!F,i||0,s||0),G.bindBuffer(G.ARRAY_BUFFER,null)}function E(S,Y,q,O,t,e,c){Y.bindBuffer(Y.ARRAY_BUFFER,q),Y.vertexAttribPointer(S.addr,2,O||Y.FLOAT,!!t,e||0,c||0),Y.bindBuffer(Y.ARRAY_BUFFER,null)}function X(m,O,D,P,x,h,T){O.bindBuffer(O.ARRAY_BUFFER,D),O.vertexAttribPointer(m.addr,3,P||O.FLOAT,!!x,h||0,T||0),O.bindBuffer(O.ARRAY_BUFFER,null)}function N(b,L,S,c,$,y,X){L.bindBuffer(L.ARRAY_BUFFER,S),L.vertexAttribPointer(b.addr,4,c||L.FLOAT,!!$,y||0,X||0),L.bindBuffer(L.ARRAY_BUFFER,null)}function z(n,j,K,m,g,y,_){var y=y||4,_=_||0;j.bindBuffer(j.ARRAY_BUFFER,K),j.vertexAttribPointer(n.addr,2,m||j.FLOAT,!!g,y,_),j.vertexAttribPointer(n.addr+1,2,m||j.FLOAT,!!g,y,_+2),j.bindBuffer(j.ARRAY_BUFFER,null)}function Q(Y,g,b,p,k,z,N){var z=z||9,N=N||0;g.bindBuffer(g.ARRAY_BUFFER,b),g.vertexAttribPointer(Y.addr,3,p||g.FLOAT,!!k,z,N),g.vertexAttribPointer(Y.addr+1,3,p||g.FLOAT,!!k,z,N+3),g.vertexAttribPointer(Y.addr+2,3,p||g.FLOAT,!!k,z,N+6),g.bindBuffer(g.ARRAY_BUFFER,null)}function r(w,j,c,n,S,h,$){var h=h||16,$=$||0;j.bindBuffer(j.ARRAY_BUFFER,c),j.vertexAttribPointer(w.addr,4,n||j.FLOAT,!!S,h,$),j.vertexAttribPointer(w.addr+1,4,n||j.FLOAT,!!S,h,$+4),j.vertexAttribPointer(w.addr+2,4,n||j.FLOAT,!!S,h,$+8),j.vertexAttribPointer(w.addr+3,4,n||j.FLOAT,!!S,h,$+12),j.bindBuffer(j.ARRAY_BUFFER,null)}function O(V,G,P){q[V]=function(Q,e,T,z,$,g){this.addr==c||this.addr<0||(e==c||e===!1?Q.disableVertexAttribArray(this.addr):_b(e)===w?(Q.enableVertexAttribArray(this.addr),P(this,Q,e,T,z,$,g)):(Q.disableVertexAttribArray(this.addr),G(this,Q,e)))}}function n(N,X,b){this.name=N,this.addr=X,this.activeInfo=b,this.setter=q[b.type],Af(this)}function B(M,B,b){this.gl=B,this.program=b,this._branches={},this._struct=M}function Z(g){function j(N,T){B.call(this,g,N,T);for(var D=n.length;D--;){var W=n[D];this._branches[W._name]=new W._type(N,T)}}function E(x,u){var w=x.name;if(x.isLeaf){var $=e("d.setter(this.gl, v);",["v"],["d"],[x.desc]);i.defineProperty(u,w,{configurable:!1,enumerable:!0,get:function(){return $},set:$})}else n.push({_name:w,_type:Z(x)}),i.defineProperty(u,w,{configurable:!1,enumerable:!0,get:function(){return this._branches[w]},set:function(B){this._branches[w].apply(B)}})}var n=[];return b(j,B),g.forEach(E,j.prototype),j}function I(d,B){for(var y=d.getProgramParameter(B,d.ACTIVE_ATTRIBUTES),I={};y--;){var T=d.getActiveAttrib(B,y),a=T.name,S=d.getAttribLocation(B,a);I[a]=new n(a,S,T)}var O=Ir.create(I,function(d){return"addr"in d}),L=Z(O);return new L(d,B)}for(var W=[],D=1;17>D;++D)W[D]=new Sf(D);var q=[],w="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return O(zm.FLOAT,V,A),O(zm.FLOAT_VEC2,J,E),O(zm.FLOAT_VEC3,K,X),O(zm.FLOAT_VEC4,k,N),O(zm.FLOAT_MAT2,j,z),O(zm.FLOAT_MAT3,p,Q),O(zm.FLOAT_MAT4,G,r),B.prototype.disable=function(){for(var S=this._struct.children,i=S.length;i--;){var O=S[i],p=O.name;O.isLeaf?this.gl.disableVertexAttribArray(O.desc.addr):this._branches[p].disable()}},B.prototype.apply=function(G){for(var k=this._struct.children,N=k.length;N--;){var T=k[N],$=T.name;$ in G&&(T.isLeaf?this[$]=G[$]:this._branches[$].apply(G[$]))}},B.prototype.append=function(W){var e=this._struct.childMap;for(var A in W){var $=e[A];$&&($.isLeaf?this[A]=W[A]:this._branches[A].append(W[A]))}},function(L,j){var G=j._attribs;return G||(j._attribs=G=I(L,j)),G}}(),ep=function(E){var K=this;i.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:E,writable:!1},glState:{configurable:!1,enumerable:!1,value:zr(E),writable:!1}}),K._currProgram=c,K._currUniforms=c,K._currAttribs=c,K._sync=!0};i.defineProperties(ep.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(L){var P=this;P._sync&&L===P._currProgram||(P.gl.useProgram(L),P._currProgram=L,P._currUniforms=pi(P.gl,L),P._currAttribs=Kb(P.gl,L),P._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var y=this;return y._currProgram&&!y._sync&&(y.gl.useProgram(y._currProgram),y._sync=!0),y._currUniforms},set:function(p){var u=this;u._currUniforms&&(u._currProgram&&!u._sync&&(u.gl.useProgram(u._currProgram),this._sync=!0),u._currUniforms.apply(p))}},attribs:{configurable:!1,enumerable:!1,get:function(){var M=this;return M._currProgram&&!M._sync&&(M.gl.useProgram(M._currProgram),M._sync=!0),M._currAttribs},set:function(o){var Q=this;Q._currUniforms&&(Q._currProgram&&!Q._sync&&(Q.gl.useProgram(Q._currProgram),this._sync=!0),Q._currAttribs.apply(o))}}}),ep.prototype.useProgram=function(V){var G=this;G._sync&&V===G._currProgram||(G.gl.useProgram(V),G._currProgram=V,G._currUniforms=pi(G.gl,V),G._currAttribs=Kb(G.gl,V),G._sync=!0)},ep.prototype.directState=function(){return this.glState},ep.prototype.directUniforms=function(){return this._currUniforms},ep.prototype.directAttribs=function(){return this._currAttribs},ep.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},ep.for=function(Q){var T=Q._renderState;return T||(Q._renderState=T=new ep(Q)),T};var as="directional",Tj="point",Fo="spot",Lr="light.color",Hm={},Cg=[],dg=0,vo=function(b,P){em(P)&&xk.test(P)?ih(b,P):Ue(P)&&P.modelType?Li(b,P):P===c?delete vf[b]:vf[b]=P},Er=function(H){return H},Xh=function(g){g=L.convertShape3dModelName(g);var Y;if(Ue(g)){if(g.modelType){if(g.uuid){if(Y=vf[g.uuid])return Y}else g.uuid=T.Math.generateUUID();return Y===c&&(Oc&&Oc[g.uuid]||Li(g.uuid,g)),c}return g}return Y=vf[g],g&&Y===c&&xk.test(g)&&(Oc&&Oc[g]||ih(g,g)),Y},io=function(N,Q){N.frameStack?N.frameStack.push(Q):N.frameStack=[Q],N.bindFramebuffer(N.FRAMEBUFFER,Q)},lo=function(O){var S=O.frameStack;if(S){if(S.pop(),S.length)return O.bindFramebuffer(O.FRAMEBUFFER,S[S.length-1]),void 0;O.frameStack=null}O.bindFramebuffer(O.FRAMEBUFFER,null)};kp(L,{graph3dViewAttributes:Z,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:v/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Ee,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:v,graph3dViewRotateMinPhi:0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:v/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:vo,getShape3dModel:Xh,convertShape3dModelName:Er,getShape3dModelMap:function(){return vf},getCachedShape3dModelMap:function(){return sk},createMatrix:function(_,J){tj(_)||(_=[_]);for(var S=_.length-1;S>=0;S--){var s=_[S];J=Vh(s.mat,s.s3,s.r3,s.rotationMode,s.t3,J)}return J},transformVec:function(B,g){return oi(B,g)},glBindFrame:io,glUnbindFrame:lo,createBoxModel:function(){return{vs:ur,ns:ye,uv:me,is:Zo}},createRoundRectModel:function(r,E){return go.roundRect(r,E)},createStarModel:function(u,f){return go.star(u,f)},createRectModel:function(y,p){return go.rect(y,p)},createTriangleModel:function(t,Z){return go.triangle(t,Z)},createRightTriangleModel:function(U,q){return go.rightTriangle(U,q)},createParallelogramModel:function(z,A){return go.parallelogram(z,A)},createTrapezoidModel:function(F,j){return go.trapezoid(F,j)},createSmoothSphereModel:function(m,P,p,t,d,Y,q){return nk(new jn(m,P,p,t,d,Y,q))},createSphereModel:function(Z,r,i,X,G,T,p){return Z?fs(Z,r,i,X,G,T,p):L.createSmoothSphereModel()},createSmoothConeModel:function(p,G,r,c,$){return nn(p,G,r,c,$)},createConeModel:function($,X,S,s,G,K,r,C){return $?Dh($,X,S,s,G,K,r,C):nn(K)},createSmoothCylinderModel:function(m,M,v,k,Q,o,x,U){return nk(new Yo(m,M,v,k,Q,o,x,U))},createCylinderModel:function(J,f,P,d,D,b,g,B){return J?oq(J,f,P,d,D,b,g,B):ji(b,g)},createSmoothTorusModel:function(H,h,x,e,F,z){return nk(new pj(H,h,x,e,F,z))},createTorusModel:function(z,X,y,W,n,e,r,J){return z?Hh(z,X,y,W,n,e,r,J):Rb(e,r)},createExtrusionModel:function(E,U,a,P,b,h,D,C){return Re(E,U,a,P,b,h,D,C)},createSmoothRingModel:function(w,t,n,h,V,E){for(var W=[],l=0;l<w.length-1;l+=2)W.push({x:w[l],y:w[l+1]});for(w=ac(W,t,n)[0],W=[],l=0;l<w.length;l++){var _=w[l];W.push(new $k(_.x,0,_.y))}return nk(new Um(W,E,h,V))},createTextGeometry:function(Z,$){return nk(new Qm(Z,$))},loadFontFace:function(i,r){L.xhrLoad(i,function(c){if(!c)return r();var Y;try{Y=JSON.parse(c)}catch(a){Y=JSON.parse(c.substring(65,c.length-2))}Lq.loadFace(Y),r&&r(Y.familyName.toLowerCase())},r?null:{sync:!0})},getShaderErrorLog:function(){return Cg.join("\n")},createRingModel:function(m,Y,I,s,c,f,$,X,B,q){for(var y=[],J=0;J<m.length-1;J+=2)y.push({x:m[J],y:m[J+1]});f=f||L.shapeSide,$=$||0,X=X||f;var l,G,o,E,j,D,H,p,C,V,J,N,g,a,n,R,k,Q,W=[],i=[],F=B?[]:Z,w=B?[]:Z,U=q?[]:Z,b=q?[]:Z,u=s?[]:Z,h=s?[]:Z,A=c?[]:Z,v=c?[]:Z,m=ac(y,Y,I),O=xf(m),x=0,P=2*Math.PI/f;return m.forEach(function(m){if(o=m.length,o>1){if(E=m[0],s)for(D=E.x,p=E.y,J=$;X>J;J++)N=J+1,g=J*P,a=N*P,n=K(g),R=z(g),k=K(a),Q=z(a),u.push(n*D,p,-R*D,k*D,p,-Q*D,0,p,0),h.push(.5-.5*n,.5-.5*R,.5-.5*k,.5-.5*Q,.5,.5);for(V=0;o>V;V++){for(j=m[V],D=E.x,H=j.x,p=E.y,C=j.y,l=x/O,x+=Yf(E,j),G=x/O,J=$;X>J;J++)N=J+1,g=J*P,a=N*P,n=K(g),R=z(g),k=K(a),Q=z(a),W.push(n*H,C,-R*H,k*H,C,-Q*H,n*D,p,-R*D,k*H,C,-Q*H,k*D,p,-Q*D,n*D,p,-R*D),i.push(J/f,G,N/f,G,J/f,l,N/f,G,N/f,l,J/f,l),B&&J===$&&(F.push(0,p,0,0,C,0,n*H,C,-R*H,n*H,C,-R*H,n*D,p,-R*D,0,p,0),w.push(0,.5-p,0,.5-C,2*H,.5-C,2*H,.5-C,2*D,.5-p,0,.5-p)),q&&N===X&&(U.push(0,p,0,k*H,C,-Q*H,0,C,0,k*H,C,-Q*H,0,p,0,k*D,p,-Q*D),b.push(1,.5-p,1-2*H,.5-C,1,.5-C,1-2*H,.5-C,1,.5-p,1-2*D,.5-p));E=j}if(c)for(D=E.x,p=E.y,J=$;X>J;J++)N=J+1,g=J*P,a=N*P,n=K(g),R=z(g),k=K(a),Q=z(a),A.push(k*D,p,-Q*D,n*D,p,-R*D,0,p,0),v.push(.5-.5*k,.5+.5*Q,.5-.5*n,.5+.5*R,.5,.5)}}),{vs:W,uv:i,bottom_vs:A,bottom_uv:v,top_vs:u,top_uv:h,from_vs:F,from_uv:w,to_vs:U,to_uv:b}}},!0),kp(X,{"3d.move.mode":c,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":c,"edge.gradient.color":c,"edge.source.t3":c,"edge.target.t3":c,"light.type":Tj,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":v/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":zd,"wf.short":!1,"wf.mat":c,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:c,"transparent.mask":!1,brightness:c,"select.brightness":.7,"repeat.uv.length":c,"shadow.cast":!0,"shadow.receive":!0,bloom:!1,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":c,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":qn,"label.t3":c,"label.r3":c,"label.texture.scale":2,"label.rotationMode":uk,"label.light":!1,"label.blend":c,"label.reverse.flip":!1,"label.reverse.color":$p,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":qn,"label2.t3":c,"label2.r3":c,"label2.texture.scale":2,"label2.rotationMode":uk,"label2.light":!1,"label2.blend":c,"label2.reverse.flip":!1,"label2.reverse.color":$p,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":qn,"note.t3":c,"note.r3":c,"note.texture.scale":2,"note.rotationMode":uk,"note.light":!1,"note.blend":c,"note.reverse.flip":!1,"note.reverse.color":$p,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":qn,"note2.t3":c,"note2.r3":c,"note2.texture.scale":2,"note2.rotationMode":uk,"note2.light":!1,"note2.blend":c,"note2.reverse.flip":!1,"note2.reverse.color":$p,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:c,"shape3d.color":Xg,"shape3d.top.color":c,"shape3d.bottom.color":c,"shape3d.from.color":c,"shape3d.to.color":c,"shape3d.image":c,"shape3d.image.projection":c,"shape3d.top.image":c,"shape3d.bottom.image":c,"shape3d.from.image":c,"shape3d.to.image":c,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":c,"shape3d.side.to":c,"shape3d.smooth":c,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":c,"shape3d.opacity":c,"shape3d.reverse.flip":!1,"shape3d.reverse.color":$p,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":c,"shape3d.uv.scale":c,"shape3d.uv.rotation":c,"shape3d.top.uv.offset":c,"shape3d.top.uv.scale":c,"shape3d.top.uv.rotation":c,"shape3d.bottom.uv.offset":c,"shape3d.bottom.uv.scale":c,"shape3d.bottom.uv.rotation":c,"shape3d.from.uv.offset":c,"shape3d.from.uv.scale":c,"shape3d.from.uv.rotation":c,"shape3d.to.uv.offset":c,"shape3d.to.uv.scale":c,"shape3d.to.uv.rotation":c,"shape3d.top.cap":c,"shape3d.bottom.cap":c,"shape3d.start.angle":0,"shape3d.sweep.angle":s,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"texture.mipmap.max":c,"texture.filter":c,"texture.filter.min":c,"texture.filter.mag":c,"texture.wrap":c,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":Xg,"all.image":c,"all.blend":c,"all.opacity":c,"all.reverse.flip":!1,"all.reverse.color":$p,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":c,"all.uv.offset":c,"all.uv.scale":c,"all.uv.rotation":c,"all.discard.selectable":!0,mat:c,"left.mat":c,"right.mat":c,"top.mat":c,"bottom.mat":c,"front.mat":c,"back.mat":c,"edge.source.anchor.elevation":c,"edge.target.anchor.elevation":c},!0);var Co,Im=!1,ck=[0,0,0,0],vk=function(t){return t instanceof df},rq=function(X){return[X.x,X.e||0,X.y]},nf=function(V,G,L){for(var G=sc(G||0),f=G[0],Y=G[1],C=G[2];L--;)V.push(f,Y,C)},Db=function(q,L,v){for(var L=sc(L||0),Z=L[0],w=L[1],z=L[2],a=L[3];v--;)q.push(Z,w,z,a)},_k=function(H,f,P){if(f)for(var n,S,o,Y=f[0],g=f[1],X=f[2],O=f[4],r=f[5],y=f[6],K=f[8],N=f[9],G=f[10],B=f[12],E=f[13],A=f[14],D=P.length,h=0,h=0;D>h;h+=3)n=P[h],S=P[h+1],o=P[h+2],H.push(Y*n+O*S+K*o+B,g*n+r*S+N*o+E,X*n+y*S+G*o+A);else Ff(H,P)},qf=function(f,I){var h=I.s("light.intensity"),M=sc(I.s(Lr)),F=M[0],z=M[1],x=M[2];1!==h&&(F*=h,z*=h,x*=h),f.push(F,z,x,I.s("light.disabled")?1:0)},Zl=function(l,i){var I=ep.for(i),m=I.directUniforms();m.uHeadlightRange=l._headlightRange,m.uHeadlightAmbientIntensity=l._headlightAmbientIntensity;var Q=l._headlightIntensity,k=sc(l._headlightColor);1!==Q&&(k=[k[0]*Q,k[1]*Q,k[2]*Q]),m.uHeadlightColor=[k[0],k[1],k[2],l._headlightDisabled?1:0];var C=l._59O,r=l._spots,A=l._dirs;if(C.length){var N=[],H=[],L=[];C.forEach(function(E){qf(N,E),Ff(H,l._transformPointToViewSpace(E.p3())),L.push(E.s("light.range"))}),m.uPointColor=N,m.uPointRange=L,m.uPointPosition=H}if(r.length){var X=[],z=[],p=[],P=[],y=[],G=[];r.forEach(function(c){qf(X,c),Ff(z,l._transformPointToViewSpace(c.p3())),Ff(y,l._transformDirectionToViewSpace(c.p3(),c.s("light.center"))),p.push(c.s("light.range")),P.push(K(c.s("light.angle")/2)),G.push(c.s("light.exponent"))}),m.uSpotColor=X,m.uSpotRange=p,m.uSpotAngle=P,m.uSpotExponent=G,m.uSpotPosition=z,m.uSpotDirection=y}if(A.length){var E=[],U=[];A.forEach(function(Q){qf(E,Q),Ff(U,l._transformDirectionToViewSpace(Q.p3()))}),m.uDirColor=E,m.uDirDirection=U}},Nf=function(y,b){return Math.max(y.getRotateMinPhi()+wi,Math.min(y.getRotateMaxPhi()-wi,b))},Dg=function(){return.05+Rr()/2},pn=function(t,l,q,Y){var X,g=t.getEye();return t.isOrtho()?(X=$i(t.getCenter(),g),X[0]+=Y[0],X[1]+=Y[1],X[2]+=Y[2]):X=g,wm(l,q,Y,X)},wm=function(V,n,G,L){var K=Wh(V,n),f=$i(L,G,!0),b=Wh(f,n);if(C(b)<wi)return Z;var P=(K-Wh(G,n))/b;return[G[0]+f[0]*P,G[1]+f[1]*P,G[2]+f[2]*P]},zo=function(t,W){return{x:2*t.x-W.x,y:2*t.y-W.y}},Ab=function(t,O,G,w){var X,Y;if(!t)return X=Nh(O.y-G.y,G.x-O.x),{x:O.x+w*z(X),y:O.y+w*K(X)};if(!G)return X=Nh(t.y-O.y,O.x-t.x),{x:O.x+w*z(X),y:O.y+w*K(X)};var v=$i([t.x,t.y,0],[O.x,O.y,0],!0),i=$i([G.x,G.y,0],[O.x,O.y,0],!0),b=-(v[0]+i[0])/2,m=-(v[1]+i[1])/2,n=V(b*b+m*m);if(wi>n)return X=Nh(t.y-O.y,O.x-t.x),{x:O.x+w*z(X),y:O.y+w*K(X)};var J=t.x-O.x,x=t.y-O.y,A=G.x-O.x,U=G.y-O.y,T=V(J*J+x*x),g=V(A*A+U*U);X=l(Wh(v,i))/2,Y=v[1]*i[0]-v[0]*i[1]>0?-1:1,b/=n,m/=n;var j=w/z(X),D=$(T,g)/K(X);n=Math.min(j,D);var I={x:O.x+Y*n*b,y:O.y+Y*n*m};return G.b&&j>g/K(X)&&(I.adjust=!0),I},xm=function(H){var w=H[1],T=H[2],E=H[3],s=H[6],O=H[7],M=H[11];H[1]=H[4],H[2]=H[8],H[3]=H[12],H[4]=w,H[6]=H[9],H[7]=H[13],H[8]=T,H[9]=s,H[11]=H[14],H[12]=E,H[13]=O,H[14]=M},ce=function(M){var o=M[0],Q=M[1],L=M[2],R=M[3],z=M[4],I=M[5],H=M[6],F=M[7],f=M[8],b=M[9],q=M[10],A=M[11],B=M[12],g=M[13],Y=M[14],u=M[15],$=o*I-Q*z,v=o*H-L*z,U=o*F-R*z,j=Q*H-L*I,x=Q*F-R*I,i=L*F-R*H,e=f*g-b*B,C=f*Y-q*B,X=f*u-A*B,W=b*Y-q*g,P=b*u-A*g,S=q*u-A*Y,O=$*S-v*P+U*W+j*X-x*C+i*e;return O?(O=1/O,M[0]=(I*S-H*P+F*W)*O,M[1]=(L*P-Q*S-R*W)*O,M[2]=(g*i-Y*x+u*j)*O,M[3]=(q*x-b*i-A*j)*O,M[4]=(H*X-z*S-F*C)*O,M[5]=(o*S-L*X+R*C)*O,M[6]=(Y*U-B*i-u*v)*O,M[7]=(f*i-q*U+A*v)*O,M[8]=(z*P-I*X+F*e)*O,M[9]=(Q*X-o*P-R*e)*O,M[10]=(B*x-g*U+u*$)*O,M[11]=(b*U-f*x-A*$)*O,M[12]=(I*C-z*W-H*e)*O,M[13]=(o*W-Q*C+L*e)*O,M[14]=(g*v-B*j-Y*$)*O,M[15]=(f*j-b*v+q*$)*O,void 0):Z},Kl=function(A,k){if(k){var N=k[0],i=k[1],M=k[2];A[12]=A[0]*N+A[4]*i+A[8]*M+A[12],A[13]=A[1]*N+A[5]*i+A[9]*M+A[13],A[14]=A[2]*N+A[6]*i+A[10]*M+A[14],A[15]=A[3]*N+A[7]*i+A[11]*M+A[15]}},rk=function(V,e){if(e){var D=e[0],w=e[1],Y=e[2];V[0]=V[0]*D,V[1]=V[1]*D,V[2]=V[2]*D,V[3]=V[3]*D,V[4]=V[4]*w,V[5]=V[5]*w,V[6]=V[6]*w,V[7]=V[7]*w,V[8]=V[8]*Y,V[9]=V[9]*Y,V[10]=V[10]*Y,V[11]=V[11]*Y}},Pf=function(q,A,t){var g=A[0],E=A[1],e=A[2],$=A[3],Z=A[4],h=A[5],v=A[6],k=A[7],d=A[8],I=A[9],n=A[10],c=A[11],O=A[12],B=A[13],Y=A[14],m=A[15],s=t[0],i=t[1],w=t[2],o=t[3];return q[0]=s*g+i*Z+w*d+o*O,q[1]=s*E+i*h+w*I+o*B,q[2]=s*e+i*v+w*n+o*Y,q[3]=s*$+i*k+w*c+o*m,s=t[4],i=t[5],w=t[6],o=t[7],q[4]=s*g+i*Z+w*d+o*O,q[5]=s*E+i*h+w*I+o*B,q[6]=s*e+i*v+w*n+o*Y,q[7]=s*$+i*k+w*c+o*m,s=t[8],i=t[9],w=t[10],o=t[11],q[8]=s*g+i*Z+w*d+o*O,q[9]=s*E+i*h+w*I+o*B,q[10]=s*e+i*v+w*n+o*Y,q[11]=s*$+i*k+w*c+o*m,s=t[12],i=t[13],w=t[14],o=t[15],q[12]=s*g+i*Z+w*d+o*O,q[13]=s*E+i*h+w*I+o*B,q[14]=s*e+i*v+w*n+o*Y,q[15]=s*$+i*k+w*c+o*m,q},or=function(G,c,e,A){var f,j,g,h,k,z,o,Y,L,x,s=c[0],H=c[1],i=c[2],$=A[0],M=A[1],B=A[2],U=e[0],O=e[1],w=e[2];return C(s-U)<wi&&C(H-O)<wi&&C(i-w)<wi?tc(G):(o=s-U,Y=H-O,L=i-w,x=1/V(o*o+Y*Y+L*L),o*=x,Y*=x,L*=x,f=M*L-B*Y,j=B*o-$*L,g=$*Y-M*o,x=V(f*f+j*j+g*g),x?(x=1/x,f*=x,j*=x,g*=x):(f=0,j=0,g=0),h=Y*g-L*j,k=L*f-o*g,z=o*j-Y*f,x=V(h*h+k*k+z*z),x?(x=1/x,h*=x,k*=x,z*=x):(h=0,k=0,z=0),G[0]=f,G[1]=h,G[2]=o,G[3]=0,G[4]=j,G[5]=k,G[6]=Y,G[7]=0,G[8]=g,G[9]=z,G[10]=L,G[11]=0,G[12]=-(f*s+j*H+g*i),G[13]=-(h*s+k*H+z*i),G[14]=-(o*s+Y*H+L*i),G[15]=1,G)},ah=function(F,$,E,A,k){var Z=1/Lp($/2),j=1/(A-k);return F[0]=Z/E,F[1]=0,F[2]=0,F[3]=0,F[4]=0,F[5]=Z,F[6]=0,F[7]=0,F[8]=0,F[9]=0,F[10]=(k+A)*j,F[11]=-1,F[12]=0,F[13]=0,F[14]=2*k*A*j,F[15]=0,F},Xm=function(n,w,O,I,T,s,B){var F=1/(w-O),A=1/(I-T),d=1/(s-B);return n[0]=-2*F,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*A,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*d,n[11]=0,n[12]=(w+O)*F,n[13]=(T+I)*A,n[14]=(B+s)*d,n[15]=1,n},ls=function(r,n){var B=n[0],H=n[1],d=n[2],_=n[3],o=B*B+H*H+d*d+_*_,v=o?1/o:0;return r[0]=-B*v,r[1]=-H*v,r[2]=-d*v,r[3]=_*v,r},$b=function(s,T){var h=T[0]+T[5]+T[10],e=0;return h>0?(e=2*Math.sqrt(h+1),s[3]=.25*e,s[0]=(T[6]-T[9])/e,s[1]=(T[8]-T[2])/e,s[2]=(T[1]-T[4])/e):T[0]>T[5]&T[0]>T[10]?(e=2*Math.sqrt(1+T[0]-T[5]-T[10]),s[3]=(T[6]-T[9])/e,s[0]=.25*e,s[1]=(T[1]+T[4])/e,s[2]=(T[8]+T[2])/e):T[5]>T[10]?(e=2*Math.sqrt(1+T[5]-T[0]-T[10]),s[3]=(T[8]-T[2])/e,s[0]=(T[1]+T[4])/e,s[1]=.25*e,s[2]=(T[6]+T[9])/e):(e=2*Math.sqrt(1+T[10]-T[0]-T[5]),s[3]=(T[1]-T[4])/e,s[0]=(T[8]+T[2])/e,s[1]=(T[6]+T[9])/e,s[2]=.25*e),s},rb=function(P,U,b){var N=U[0],a=U[1],T=U[2],Q=U[3],z=N+N,d=a+a,k=T+T,V=N*z,A=N*d,M=N*k,j=a*d,r=a*k,E=T*k,g=Q*z,O=Q*d,v=Q*k;return P[0]=1-(j+E),P[1]=A+v,P[2]=M-O,P[3]=0,P[4]=A-v,P[5]=1-(V+E),P[6]=r+g,P[7]=0,P[8]=M+O,P[9]=r-g,P[10]=1-(V+j),P[11]=0,P[12]=b[0],P[13]=b[1],P[14]=b[2],P[15]=1,P},ee=function(O,p){if(O.isVREnabled()){var A=O.vr.getViewMatrix(p);if(A)return A}return or(p?p:Bf(),O._eye,O._center,O._up)},Mb=function(A,l){if(A.isVREnabled()){var s=A.vr.getProjectMatrix();if(s)return s}if(!l&&A._computedProjectMatrix)return Di(A._computedProjectMatrix);var e=A.getAspect(),U=A._near,b=A._far,R=Bf();if(A._ortho){var i=A._orthoWidth/2,V=i/e;Xm(R,-i,i,-V,V,U,b)}else ah(R,A._fovy,e,U,b);return R},$j=function(x,E){if(!x)return Z;var c=0,l=1,o=2,k=[],m=0,L=x.length,R=L/3;if(E){for(;L>m;m++)k[m]=0;for(m=0;m<E.length;m+=3){var r=[],F=[],s=[];r[c]=x[3*E[m+1]+c]-x[3*E[m]+c],r[l]=x[3*E[m+1]+l]-x[3*E[m]+l],r[o]=x[3*E[m+1]+o]-x[3*E[m]+o],F[c]=x[3*E[m+2]+c]-x[3*E[m+1]+c],F[l]=x[3*E[m+2]+l]-x[3*E[m+1]+l],F[o]=x[3*E[m+2]+o]-x[3*E[m+1]+o],s[c]=r[l]*F[o]-r[o]*F[l],s[l]=r[o]*F[c]-r[c]*F[o],s[o]=r[c]*F[l]-r[l]*F[c];for(var K=0;3>K;K++)k[3*E[m+K]+c]+=s[c],k[3*E[m+K]+l]+=s[l],k[3*E[m+K]+o]+=s[o]}}else for(m=0;R>m;m+=3){var r=[],F=[],s=[];r[c]=x[3*(m+1)+c]-x[3*m+c],r[l]=x[3*(m+1)+l]-x[3*m+l],r[o]=x[3*(m+1)+o]-x[3*m+o],F[c]=x[3*(m+2)+c]-x[3*(m+1)+c],F[l]=x[3*(m+2)+l]-x[3*(m+1)+l],F[o]=x[3*(m+2)+o]-x[3*(m+1)+o],s[c]=r[l]*F[o]-r[o]*F[l],s[l]=r[o]*F[c]-r[c]*F[o],s[o]=r[c]*F[l]-r[l]*F[c];
for(var K=0;3>K;K++)k[3*(m+K)+c]=s[c],k[3*(m+K)+l]=s[l],k[3*(m+K)+o]=s[o]}for(m=0;L>m;m+=3){var H=[];H[c]=k[m+c],H[l]=k[m+l],H[o]=k[m+o];var z=V(H[c]*H[c]+H[l]*H[l]+H[o]*H[o]);0===z&&(z=wi),H[c]=H[c]/z,H[l]=H[l]/z,H[o]=H[o]/z,k[m+c]=H[c],k[m+l]=H[l],k[m+o]=H[o]}return new Sf(k)},db=function(B,G,O,n){if(O||(O=B.createTexture()),G){var A=B.TEXTURE_2D,y=B.REPEAT,I=B.CLAMP_TO_EDGE,m=B.TEXTURE_MIN_FILTER;n=n||je;var r=n.minFilter||n.filter||B.LINEAR,U=n.magFilter||n.filter||B.LINEAR;B.activeTexture(B.TEXTURE0),zk(B,O),B.texImage2D(A,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,G),Ad(B,B.TEXTURE_MAG_FILTER,U);var k=G.naturalWidth||G.width,Y=G.naturalHeight||G.height;gi.isPOT(k)&&gi.isPOT(Y)&&!n.clampToEdge&&!G.clampToEdge?(Ad(B,B.TEXTURE_WRAP_S,y),Ad(B,B.TEXTURE_WRAP_T,y),Ad(B,m,r===B.NEAREST?B.NEAREST_MIPMAP_NEAREST:B.LINEAR_MIPMAP_LINEAR),n.mipmapMaxLevel!==c&&Ad(B,B.TEXTURE_MAX_LEVEL,n.mipmapMaxLevel),B.generateMipmap(A)):(Ad(B,B.TEXTURE_WRAP_S,I),Ad(B,B.TEXTURE_WRAP_T,I),Ad(B,m,r)),zk(B,Z)}return O},Jd=function(N,R){var d=new Uint8Array(4);return R=R||N.createTexture(),N.activeTexture(N.TEXTURE0),zk(N,R),Ad(N,N.TEXTURE_MIN_FILTER,N.LINEAR),N.texImage2D(N.TEXTURE_2D,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,d),R},Sc=function(_,r){var s=new Uint8Array(4);return r=r||_.createTexture(),_.activeTexture(_.TEXTURE0),_.bindTexture(_.TEXTURE_CUBE_MAP,r),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,_.RGBA,1,1,0,_.RGBA,_.UNSIGNED_BYTE,s),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,_.RGBA,1,1,0,_.RGBA,_.UNSIGNED_BYTE,s),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,_.RGBA,1,1,0,_.RGBA,_.UNSIGNED_BYTE,s),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,_.RGBA,1,1,0,_.RGBA,_.UNSIGNED_BYTE,s),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,_.RGBA,1,1,0,_.RGBA,_.UNSIGNED_BYTE,s),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,_.RGBA,1,1,0,_.RGBA,_.UNSIGNED_BYTE,s),r},Wr=function(D){D._26I&&D._prg&&(D._26I.deleteProgram(D._prg),D._prg=Z)},mq=function(N,Q,H,P){var V=N.createShader(H);return N.shaderSource(V,P),N.compileShader(V),N.attachShader(Q,V),V},ml=function(V){return V.createBuffer()},zk=function(z,X){z.bindTexture(z.TEXTURE_2D,X||z._emptyTexture)},Ad=function(u,x,X){u.texParameteri(u.TEXTURE_2D,x,X)},ef=function(q,L){var T=ep.for(q).directState();T.polygonOffset.enabled=!0,T.polygonOffset.value=L},Aj=function(t){var G=ep.for(t).directState();G.polygonOffset.enabled=!1},fb=function(j,D){if(D){var q=ep.for(j).directState();q.color.clear=sc(D)}},Sh=function(y){var w=ep.for(y),Y=w.directUniforms(),B=w.directAttribs();Y.uFix=!0,B.aNormal=!1},Dq=function(t){var S=ep.for(t),W=S.directUniforms();S.directAttribs(),W.uFix=!1},Me=function(d,f,A,g,F,R,N,E){var S=ep.for(d),J=S.directState(),h=S.directUniforms();d._picking||(A?(h.uBlend=!0,h.uBlendColor=A):h.uBlend=!1,h.uLight=g==Z?!0:g,km(F)&&1!==F&&(h.uPartOpacity=F),h.uReverseFlip=R==Z?!1:R,h.uFixPickReverseColor=N||$p),J.cullFace.enabled=E?!0:!1},Qc=function(r){if(!r._picking){var i=ep.for(r),k=i.directUniforms();k.uPartOpacity=1}},zc=function(){var l=new T.Math.Matrix2d,N=[1,0,0,0,1,0,0,0,0];return function(k,F,L,E,W,H,m,n,f,P){var G=ep.for(k),X=G.directUniforms(),J=G.directAttribs();return L?(X.uTexture=!0,X.uDiscardSelectable=Xe(E)?E:!0,J.aUv=cg(k,W,H,Z,2),P?(X.uBlendTexture=!0,X.uBlendSampler=P):(X.uBlendTexture=!1,X.uBlendSampler=k._emptyBlendTexture),X.uSampler=L,X.uUvMatrix=m||n||f?gl(f,m,n,l).toArray9():N,void 0):(X.uSampler=k._emptyTexture,X.uBlendSampler=k._emptyBlendTexture,void 0)}}(),ui=function(f,H,y){var c=ep.for(f),z=c.directUniforms(),M=c.directAttribs();f.activeTexture(f.TEXTURE0),zk(f,Z),f.activeTexture(f.TEXTURE1),zk(f,Z),y&&(M.aUv=!1,z.uTexture=!1,z.uSampler=f._emptyTexture,z.uBlendTexture=!1,z.uBlendSampler=f._emptyBlendTexture)},qp=function($,N,P,x,u,y){var T=ep.for($),e=T.directUniforms(),I=T.directAttribs();!P||wk||yb||$.lineWidth(P),x&&!$._picking&&(e.uFixPickReverseColor=x),u&&(I.aPosition=cg($,u,y,Z))},Ae=function(w,c,e,v){Co&&(v=w[Co]),w.drawArrays(v==Z?w.TRIANGLES:v,c,e);var A=w._renderInfo;A&&(A.calls++,A.vertices+=e,(v==Z||v===w.TRIANGLES)&&(A.faces+=e/3),v===w.LINES&&(A.lines+=e/2),v===w.POINTS&&(A.points+=e))},nh=function(j,l,E,I,h){Co&&(I=j[Co]),j.drawElements(I==Z?j.TRIANGLES:I,E,h==Z?j.UNSIGNED_SHORT:h,l==Z?0:2*l);var Q=j._renderInfo;Q&&(Q.calls++,Q.vertices+=E,(I==Z||I===j.TRIANGLES)&&(Q.faces+=E/3),I===j.LINES&&(Q.lines+=E/2),I===j.POINTS&&(Q.points+=E))},Xi=function(l,J,N){var n=l.ARRAY_BUFFER;return l.bindBuffer(n,J),N&&l.bufferData(n,N,l.STATIC_DRAW),J},cg=function(N,G,Z,D,z){return Z?wn(N,N.ARRAY_BUFFER,G,Z):Xi(N,G,Z,D,z)},Vg=function(V,B,$){var i=V.ELEMENT_ARRAY_BUFFER;V.bindBuffer(i,B),$&&V.bufferData(i,$,V.STATIC_DRAW)},Yc=function(V,c,u){wn(V,V.ELEMENT_ARRAY_BUFFER,c,u)},wn=function(P,b,a,e){var h=e._bufId;h||(h=e._bufId=T.Math.generateIncreasingID());var a,N=P._bufPool;return(a=N[h])&&a._buf?P.bindBuffer(b,a._buf):(a=N[h]={_buf:ml(P)},P.bindBuffer(b,a._buf),P.bufferData(b,e,P.STATIC_DRAW)),a._fid=P._renderInfo.frame,a._buf},_n=function(x,p){p!=Z&&p>=0&&x.enableVertexAttribArray(p)},sg=function(P,H){H!=Z&&H>=0&&P.disableVertexAttribArray(H)},Wl=function(t,o){var $=t.getGL(),g=ep.for($),K=g.directUniforms();t._7O=t._8O.pop(),o&&(K.uMVMatrix=t._7O,t._6O=o,K.uNMatrix=o)},jp=function(c,j){return j||(j=Bf()),Om(j,c),ce(j),xm(j),j},Gr=function($,v){var Y=$.getGL(),D=$._7O,A=ep.for(Y),L=A.directUniforms();v?($._8O.push(Di(D)),L.uMMatrix=v,Pf(D,D,v),$._7O=D):L.uMMatrix=De,L.uMVMatrix=D,L.uNMatrix=jp(D,$._6O)},Wc={body:0,label:1,label2:2,note:3,note2:4,symbol:5},Fl=10,sf=function(R,N,A,g,k,b){var L;if(A){var c=g._pickId;c||(c=g._pickId=N._pickIdUsed,N._pickIdUsed+=Fl);var Q,M=Wc[k];if(null!=M)Q=c+M;else{var w=g._pickExtraPartMap;w||(w=g._pickExtraPartMap={}),(Q=w[k])||(Q=w[k]=N._pickIdUsed++)}N[Q]||(N[Q]={data:g,part:k}),L=mc(Q)}else L=ck;if(!b){var d=ep.for(R),v=d.directUniforms();v.uFixPickReverseColor=L}return L},Sj=sf,Or=function(F,p,Z){"target"!==Z&&(Z="source");var N="target"===Z?p.getTargetAgent():p.getSourceAgent(),K="edge."+Z+".";if(lm(N)){var n=p.s(K+"anchor.x"),D=p.s(K+"anchor.elevation"),f=p.s(K+"anchor.y"),v=$l(N,F.getMat(N)),L=N.getAnchor3d();return oi([(n===c?.5:n)-L.x,(D===c?.5:D)-L.y,(f===c?.5:f)-L.z],v)}var g=p.s(K+"index"),T=F.getData3dUI(N);if(!T.info||!T.info.list)return!1;if(g>=0){var d,E,j,y,l,G=T.info._lastPointsSegments,V=G.points,X=G.segments,z=-1,O=-1;for(j=0,y=X?X.length:V.length;y>j;j++){if(E=X?X.get(j):1,3===E)l=2;else if(4===E)l=3;else{if(5===E)continue;l=1}if(z+=l,O++,O===g){d=V.get(z);break}}return d||(d=V.get(V.length-1)),[d.x,d.e||0,d.y]}var o=p.s(K+"percent")||.5;if(o=Math.max(0,Math.min(o,1)),!T||!T.getCache)return!1;var R=T.getCache(),y=R[R.length-1].length,G=F.getLineOffset(N,o*y),S=G.point;return[S.x,S.y,S.z]},tf=function(){var A={center:function(j,f,Z,y,m){var A=-f[1]/2,W={x:-f[0]/2,y:A,width:f[0],height:f[1]},N=Gh(j,W,Z);return[N.x+y,-N.y-m,Dg()]},front:function(x,E,e,m,T){var j=-E[1]/2,i={x:-E[0]/2,y:j,width:E[0],height:E[1]},t=Gh(x,i,e);return[t.x+m,-t.y-T,E[2]/2+Dg()]},back:function(J,M,$,L,t){var V=-M[0]/2,y=-M[1]/2,q={x:V,y:y,width:M[0],height:M[1]},D=Gh(J,q,$);return[-D.x-L,-D.y-t,-M[2]/2-Dg()]},left:function(b,P,T,W,R){var n=-P[1]/2,h={x:-P[2]/2,y:n,width:P[2],height:P[1]},l=Gh(b,h,T);return[-P[0]/2-Dg(),-l.y-R,l.x+W]},right:function(f,d,K,I,k){var $=-d[2]/2,a=-d[1]/2,m={x:$,y:a,width:d[2],height:d[1]},j=Gh(f,m,K);return[d[0]/2+Dg(),-j.y-k,-j.x-I]},top:function(x,_,Q,o,w){var E={x:-_[0]/2,y:-_[2]/2,width:_[0],height:_[2]},j=Gh(x,E,Q);return[j.x+o,_[1]/2+Dg(),j.y+w]},bottom:function(V,R,s,b,j){var x=-R[2]/2,c={x:-R[0]/2,y:x,width:R[0],height:R[2]},t=Gh(V,c,s);return[t.x+b,-R[1]/2-Dg(),-t.y-j]}};return function(c,w,s,v,F,N){return A[v](c,w,s,F||0,N||0)}}(),yj=function(x,T,y,t,q,M,$,E,J,R){if(q&&(T[0]+=q[0],T[1]+=q[1],T[2]+=q[2]),Kl(x,y),E){var m=Bf();if(nm(m,J,R),oi(T,m),Kl(x,T),x.auto=E,x.pos=oi([0,0,0],x),M){var n=x.mat2=Bf();nm(n,M,$)}}else nm(x,J,R),Kl(x,T),t===Cl?Yn(x,-So):t===ij?Yn(x,So):t===Vl?xb(x,-So):t===mf?xb(x,So):t===Kf&&Yn(x,v),nm(x,M,$);return x},Jr=function(n,r){var y=r.auto,T=r.mat2,E=n.gv;if(y){var V,X=Bf(),v=[0,0,0,0];V="string"==typeof y?[y.indexOf("x")<0?E._eye[0]:E._center[0],y.indexOf("y")<0?E._eye[1]:E._center[1],y.indexOf("z")<0?E._eye[2]:E._center[2]]:E._eye,$b(v,or(Bf(),V,E._center,E._up)),rb(X,ls(v,v),r.pos),T&&Pf(X,X,T),Gr(E,X)}else Gr(E,r)},_o=function(A,U,S,F,G){var r=A.s,K=A.gv,q=K.getGL(),C=K._prg,i=K._buffer,t=K._1O,B=ep.for(q),Q=B.directAttribs();db(q,tq,t),Jr(A,S),Me(q,C,r(U+".blend"),r(U+".light"),r(U+".opacity"),r(U+".reverse.flip"),r(U+".reverse.color"),r(U+".reverse.cull")),zc(q,C,t,G,i.uv,Ai),Q.aPosition=cg(q,i.vs,F,Z),Q.aNormal=cg(q,i.ns,Kq,Z),Yc(q,i.is,yh),nh(q,0,yh.length),ui(q,C,t),Qc(q,C),Wl(K)},Qj=function(i,r,K){var q=i.gv,H=i.data,n=i[r]={blend:q.getBodyColor(H)||q.getFaceBlend(H,r),light:q.getFaceLight(H,r),color:q.getFaceColor(H,r),opacity:q.getFaceOpacity(H,r),transparent:q.getFaceTransparent(H,r),reverseFlip:q.getFaceReverseFlip(H,r),reverseColor:q.getFaceReverseColor(H,r),reverseCull:q.getFaceReverseCull(H,r),texture:q.getFaceImage(H,r),blendTexture:q.getFaceBlendImage(H,r),discardSelectable:q.getFaceDiscardSelectable(H,r)};if("csg"!==r){n.uv=q.getFaceUv(H,r)||K&&K[r+"Uv"],n.uvScale=q.getFaceUvScale(H,r)||K&&K[r+"UvScale"],n.uvOffset=q.getFaceUvOffset(H,r)||K&&K[r+"UvOffset"],n.uvRotation=q.getFaceUvRotation(H,r)||K&&K[r+"uvRotation"];var d=q.getFaceMat(H,r);if(d){var Q=$l(H,d);H.appendAnchorMatrix3d(Q),n.mat=Q}}return n},qb=function(u,k,t,c,q){var R=u[c];if(R){if(!q(R.transparent))return;var E=u.data,m=u.gv,U=m._buffer,Q=m.getTexture(R.texture,E,c),B=m.getTexture(R.blendTexture,E),f=ep.for(k),b=f.directUniforms(),g=f.directAttribs();zc(k,t,Q,R.discardSelectable,U.uv,R.tuv,R.uvOffset,R.uvScale,R.uvRotation,B),Me(k,t,R.blend,R.light,R.opacity,R.reverseFlip,R.reverseColor,R.reverseCull),R.cs&&!m._batchColorDisabled?(b.uBatchColor=!0,g.aBatchColor=cg(k,U.batchColor,R.cs,t.aBatchColor,4)):b.uDiffuse=R.color||X["color.empty"],g.aPosition=cg(k,U.vs,R.vs,Z),g.aNormal=cg(k,U.ns,R.ns,Z),Ae(k,0,R.vs.length/3),R.cs&&!m._batchColorDisabled&&(b.uBatchColor=!1,sg(k,t.aBatchColor)),Qc(k,t),ui(k,t,Q)}},li=function(F,G,b){tj(F)?F.forEach(function(R){li(R,G,b)}):em(F)?li(If(G,F),G,b):Ue(F)?F.shape3d?li(F.shape3d,G,b):b.push(F):b.push(F)},Ci=function(){for(var l=50,X=arguments.length,g=[],Q=0;X>Q;Q++)g[Q]=arguments[Q];Cg[dg]="Time : "+(new Date).toLocaleString()+", Info :"+g.join(", "),dg=(dg+1)%l,console.error("Failed to create shader.")},gl=function(){var z=new gi.Matrix2d;return function(n,s,L,b){b||(b=z);var p,W,X,R;return s?(p=s[0],W=s[1]):p=W=0,L?(X=L[0],R=L[1]):X=R=1,b.setFromTransform(n||0,p,W,X,R)}}(),br=function(z,H,R,g,o,B){var D,q,y,U,s,r,K,N,n,O,C,P=[g-H,o-R],t=z?z.length:0;for(y=0;t>y;y++){for(U=2,D=z[y],s=D[0],r=D[1];U+1<D.length;){if(K=D[U],N=D[U+1],q=He(H,R,g,o,s,r,K,N,!0)){n=[K-s,N-r],O=Yf(n),n[0]/=O,n[1]/=O,O=Wh(P,n),O=O>0?B:-B,C=[n[0]*O,n[1]*O];break}s=K,r=N,U+=2}if(C)break}if(C)for(g=H+C[0],o=R+C[1],y=0;t>y;y++)for(U=2,D=z[y],s=D[0],r=D[1];U+1<D.length;){if(K=D[U],N=D[U+1],q=He(H,R,g,o,s,r,K,N,!0))return[0,0];s=K,r=N,U+=2}return C?C:[g-H,o-R]},Ml=function(A){return"nearest"===A?zm.NEAREST:"linear"===A?zm.LINEAR:A},Ar=T.graph3d={},We=function(p,b,j){hk(R+".graph3d."+p,b,j)},Kj="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",wl="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit!)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!qe!-*!z/f{jTmfyfu!-yyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*!2!-2!.!)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!}}!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!<*!opjujtpQpUuihjm!)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*!sbfObsfnbDxpebit!.!sbGbsfnbDxpebit!)!0!*!sbfObsfnbDxpebit!.!*!opjujtpQpUuihjm!)iuhofm!)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<*!*!1/3!-1/5!)3dfw!+!f{jTqbNxpebit!)!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*!sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*!68/1!-684/1!)3dfw!,!sbobmq!+!*!63/1!-632/1!)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!z/w!)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!z/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!y/w!)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!y/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*!1/1!?!{/w!)!gj!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!{/Wtcb!)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*!Zf{jTmfyfu!+!1/3!.!1/2!)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<*!*!{/Wtcb!-z/Wtcb!)ybn!-y/Wtcb!)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*!w!)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*!Zf{jTmfyfu!ubpmg!-w!4dfw!)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!gjmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!|!*!utfUnvutvsg!)!gj!!!!!!!!!!!!<*!dfWutfUnvutvsg!)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*!1/2!>=!{/esppDxpebit!-nvutvsGoj!)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*!dfWnvutvsGoj!)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*!1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit!)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*!esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*!y/g!-c!-b!)yjn!>!d!ubpmg!!!!!!!!!!!!<*!z/g!-us!-cs!)yjn!>!c!ubpmg!!!!!!!!!!!!<*!z/g!-um!-cm!)yjn!>!b!ubpmg!!!!!!!!!!!!<*!6/1!,!f{jt!+!wv!)udbsg!>!g!3dfw!!!!!!!!!!!!<*!fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*!6/1!,!f{jt!+!wv!)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*!1/2!-1/1!)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt!)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!*!*!wv!-tiuqfe!)E3fsvuyfu!)iuqfEpUBCHSldbqov!-fsbqnpd!)qfut!osvufs!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt!)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!tspudbGldbqoV!-w!)upe!osvufs|!*!w!5dfw!oj!utopd!)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*!/2!-tspudbGldbQ!)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*!/763!!-/763!+!/763!-/763!+!/763!+!/763!)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";kp(L,{setBatchInfo:function(w,k){Xn[w]=k},getBatchInfo:function(e){return Xn[e]},getBatchInfoMap:function(){return Xn},setBatchInfoMap:function(v){Xn=v}},!0);var lr=[1,1,1],Do=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ge=[1,0,0,0,0,1,0,1,1,1,1,0],Vd=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],$c=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Uq=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],gk=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Wp=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Fp=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],ic=function(i,m){var j=i._40Q;j.each(function(a){a.ivBatch(m)})},Sk=function(A,f,I){var O=I._id,L=f[O];if(L){var B=L.batch,U=A[B],J=U.ds,S=L.index;if(U.invalidate=!0,delete f[O],J.splice(S,1),lc(J))return delete A[B],void 0;for(var N=L.begin,c=L.size,V=3*N,F=3*c,n=4*N,v=4*c,Y=U.vs,Z=U.ps,Q=U.uv,X=U.cs,m=U.bs,w=U.rs,P=U.ns,C=U.ls;S<J.length;S++)L=f[J[S]._id],L.index--,L.begin-=c;Y.splice(V,F),Z.splice(n,v),Q&&Q.splice(2*N,2*c),X&&X.splice(n,v),m&&m.splice(V,F),w&&w.splice(N,c),P&&P.splice(V,F),C&&C.splice(N,c)}},Jp=function(S,o,G,A,D){if(!A)return Z;var z=o[A];if(!z){var E=D.getBatchInfo(A)||je,M=E.image?[]:Z;z=o[A]={vs:[],ns:[],uv:M,cs:M?Z:E.color?Z:[],bs:E.blend?[]:Z,ps:[],rs:E.brightness?[]:Z,ds:[]}}return z.invalidate=!0,S[G._id]={index:z.ds.length,begin:z.vs.length/3,batch:A},z.ds.push(G),z},wh=function(N,z){return z!=Z&&1!==z?[N[0]*z,N[1]*z,N[2]*z,N[3]]:N},Gj=function(w){var G=w.shapeModel;G||(G=If(w)),G&&(G._ctlineModel=[],G._lineModel=c)},Ii=function(){var R;return function(f,O,p){var U=f.getData3dUI(O),V=U.shapeModel;if(V||(V=If(U)),V||!U.shapeName){var L,b=O.s("wf.combineTriangle");if(p.geometry){if(!V&&(O instanceof T.Node&&!(O instanceof T.Shape)?(R||(R={vs:ur,is:Zo,uv:me}),V=R):V=[U.left,U.front,U.right,U.back,U.top,U.bottom],!V))return c;if(b){var y=O.s("wf.normEpsilon");isNaN(y)&&(y=2),b=0|Math.min(3,Math.max(1,isNaN(b)?1:b)),L=Ie[b-1](V,U,180/(Math.PI*y))}else L=Cf(V,U);if(!L||0===L.length)return}else L=p.short?zq:Ye;var m=f.getBrightness(O),S=O.s("bloom"),_=O.s("3d.reflectable"),N=sc(p.color||"white"),A=N[3]<1,H=Math.ceil(p.width)||1,g=(A?"T":"O")+(S?"_1":"_0")+(_?"1_":"0_")+H,Q=O.getRenderLayer(),Z=f._40Q.get(Q),n=Z.wireframeIndexMap,d=Z.wireframeModelMap,P=d[g];P||(P=d[g]={vs:[],cs:[],ps:[],ds:[],T:A,B:S,reflectable:!!_,W:H}),P.invalidate=!0;var s=P.vs,Y=P.cs,x=P.ds,w=n[O._id]={index:x.length,begin:s.length/3,batch:g};x.push(O);var e=U.mat;O instanceof T.Edge||!(!e||!p.geometry&&O instanceof T.Shape)||(e=$l(O,p.mat),O.appendAnchorMatrix3d(e)),_k(s,e,L);var z=w.size=s.length/3-w.begin;Db(Y,wh(N,m),z)}}}(),Uc=function($,u,O,s,V,l,j,d,E){var w=$.getBrightness(u);w==Z&&(w=1);var f=wh(sc(s),w),X=f[3]<1;l=Math.ceil(l)||1;var C=(X?"T":"O")+l;if(j){var A=j[0],R=(j[1]||A)+A;C+="-"+A+"-"+R,E&&(C+="-"+ue(E)+"-"+w,E=wh(sc(E),w))}var W=u.getRenderLayer(),n=$._40Q.get(W),D=n.polylineIndexMap,B=n.polylineModelMap,M=B[C];M||(M=B[C]={vs:[],cs:[],ps:[],ds:[],ls:j?[]:Z,T:X,W:l},j&&(M.D=A,M.G=R,M.A=E)),M.invalidate=!0;var o,L=M.vs,_=M.cs,g=M.ds,e=M.ls,Q=D[u._id]={index:g.length,begin:L.length/3,batch:C};g.push(u),Ff(L,O);var P,k=Q.size=L.length/3-Q.begin,H=O.length,S=0,U=[];if(j||V)for(o=0;H>o;o+=6)P=Yf([O[o],O[o+1],O[o+2]],[O[o+3],O[o+4],O[o+5]]),U.push(P),S+=P;if(S&&V){var N,b=wh(sc(V),w),r=[b[0]-f[0],b[1]-f[1],b[2]-f[2],b[3]-f[3]],h=0;for(o=0;H>o;o+=6)N=h/S,Db(_,[f[0]+r[0]*N,f[1]+r[1]*N,f[2]+r[2]*N,f[3]+r[3]*N],1),h+=U[o/6],N=h/S,Db(_,[f[0]+r[0]*N,f[1]+r[1]*N,f[2]+r[2]*N,f[3]+r[3]*N],1)}else Db(_,f,k);if(j)for(h=d||0,o=0;H>o;o+=6)e.push(h),h+=U[o/6],e.push(h)},eg=function(u,V,Z){if(V){var C=4*V.begin,A=Z[V.batch].ps;if(A[C]!==u[0]||A[C+1]!==u[1]||A[C+2]!==u[2]||A[C+3]!==u[3]){for(var b=0;b<V.size;b++)A[C++]=u[0],A[C++]=u[1],A[C++]=u[2],A[C++]=u[3];
A._invalidateThisFrame=!0}}},Hg=function(){var J=new T.Math.Vector3,x=new T.Math.Vector3;return function(D,M){var A=M+["32"],e=D[M],g=D[A];if(e){if(L.extractBatchTranslation&&"vs"===M){x.set(0,0,0);for(var E=e.length,y=0;E>y;y+=3)x.add(J.fromArray(e,y));x.divideScalar(E/3);for(var a=x.x,S=x.y,f=x.z,C=new Array(E),y=0;E>y;y+=3)C[y]=e[y]-a,C[y+1]=e[y+1]-S,C[y+2]=e[y+2]-f;e=C,D.translate=[a,S,f]}g&&g.length===e.length?(g.set(e),g._bufId=null):D[A]=new Sf(e)}else delete D[A]}}(),fe=function(R,S,n,d,G,U,c,X){if(tj(n))n.forEach(function(k){fe(R,S,k,d,G,U,c,X)});else if(em(n))fe(R,S,If(d,n),d,G,U,c,X);else if(Ue(n)){var i,K=sn(n.mat,S,R),h=sn(n.s3,S,R),M=sn(n.t3,S,R),W=sn(n.r3,S,R);if((h||W||M||K)&&(i=Vh(K,h,W,sn(n.rotationMode,S,R),M),U.push(i)),n.shape3d)fe(R,S,n.shape3d,d,G,U,c,n);else{var b=d.s;X=X||je;var T=U[0],s=U.length,k=b("shape3d.color",n.color,X.color);if(G||(G=b("shape3d.blend",n.blend,X.blend)),s>1){T=Di(T);for(var y=1;s>y;y++)Pf(T,T,U[y])}var l=T?jp(T):Z;n.vs&&b(Tl,n.visible,X.visible)&&_g(T,c,n.vs,n.uv,n.is,n.ns,l,G,k),n.top_vs&&b(sh,n.topVisible,X.topVisible)&&_g(T,c,n.top_vs,n.top_uv,n.top_is,n.top_ns,l,G,b("shape3d.top.color",n.topColor,X.topColor)||k),n.bottom_vs&&b(lj,n.bottomVisible,X.bottomVisible)&&_g(T,c,n.bottom_vs,n.bottom_uv,n.bottom_is,n.bottom_ns,l,G,b("shape3d.bottom.color",n.bottomColor,X.bottomColor)||k),n.from_vs&&b($g,n.fromVisible,X.fromVisible)&&_g(T,c,n.from_vs,n.from_uv,n.from_is,n.from_ns,l,G,b("shape3d.from.color",n.fromColor,X.fromColor)||k),n.to_vs&&b(Jf,n.toVisible,X.toVisible)&&_g(T,c,n.to_vs,n.to_uv,n.to_is,n.to_ns,l,G,b("shape3d.to.color",n.toColor,X.toColor)||k)}i&&U.pop()}},_g=function(P,O,K,l,o,m,M,Y,h){var E,N=O.cs,J=O.uv,z=O.bs,_=O.ns,A=O.vs;if(m&&0!==m.length||(m=$j(K,o)),o){E=o.length;for(var U=0;E>U;U++){var R=o[U],B=3*R;_k(A,P,[K[B],K[B+1],K[B+2]]),_k(_,M,[m[B],m[B+1],m[B+2]]),J&&Ff(J,[l[2*R],l[2*R+1]])}}else E=K.length/3,_k(A,P,K),_k(_,M,m),J&&Ff(J,l);N&&Db(N,h,E),z&&(Y?nf(z,Y,E):Ff(z,lr,E))},xs=function(_,B,f,D){D?fe(_.gv,_.data,D,_,_.getBodyColor(),[B],f):(Cb(_,Cl,B,f),Cb(_,ij,B,f),Cb(_,qn,B,f),Cb(_,Kf,B,f),Cb(_,Vl,B,f),Cb(_,mf,B,f),Cb(_,"csg",B,f))},Cb=function(k,N,s,I){var x=k[N];if(x){var f=x.tuv;if(f){var S=x.uvScale,_=x.uvOffset,m=x.uvRotation;if(S||_||m){var l,B,t,g=gl(m,_,S),d=g.a,C=g.b,p=g.c,V=g.d,A=g.tx,c=g.ty,h=f.length;for(t=0;h>t;t+=2)l=f[t],B=f[t+1],f[t]=d*l+p*B+A,f[t+1]=C*l+V*B+c}}_g(s,I,x.vs,f,Z,Z,s?jp(s):Z,x.blend,x.color)}},sq=function(q,m,O,Z,P,x,M,v){var t,f=O.cs,X=O.uv,S=O.bs,e=O.vs,W=O.ns,k=$j(v);if(q.getFaceVisible(m,M)){var u=q.getFaceMat(m,M);if(u&&(P=$l(m,u),x=jp(P)),_k(e,P,v),_k(W,x,k),f&&Db(f,q.getFaceColor(m,M),6),X){var Q=q.getFaceUv(m,M)||Z[M+"Uv"],V=q.getFaceUvScale(m,M)||Z[M+"UvScale"],g=q.getFaceUvOffset(m,M)||Z[M+"UvOffset"],j=q.getFaceUvRotation(m,M)||Z[M+"UvRotation"];Q=Q?[Q[6],Q[7],Q[0],Q[1],Q[2],Q[3],Q[2],Q[3],Q[4],Q[5],Q[6],Q[7]]:Ge;var J=Q[0],p=Q[1],L=Q[2],U=Q[3],G=Q[4],I=Q[5],B=Q[6],y=Q[7],E=Q[8],F=Q[9],s=Q[10],R=Q[11];if(V||g||j){var h=gl(j,g,V),a=h.a,d=h.b,i=h.c,K=h.d,N=h.tx,r=h.ty;J=a*J+i*p+N,p=d*J+K*p+r,L=a*L+i*U+N,U=d*L+K*U+r,G=a*G+i*I+N,I=d*G+K*I+r,B=a*B+i*y+N,y=d*B+K*y+r,E=a*E+i*F+N,F=d*E+K*F+r,s=a*s+i*R+N,R=d*s+K*R+r}X.push(J,p,L,U,G,I,B,y,E,F,s,R)}S&&(t=q.getBodyColor(m)||q.getFaceBlend(m,M),t?nf(S,t,6):Ff(S,lr,6))}},Qb=function(I,g,C,f){var C=I._picking?I.pickColorMap:null,i=I.getGL(),t=I._prg,l=I._buffer;if(!_j(g)){Gr(I,Do),Sh(i,t);for(var v in g){var S=g[v];if(!(f&&!S.T||!f&&S.T||I.isReflecting(i)&&S.reflectable===!1)){S.invalidate?(S.invalidate=!1,Hg(S,"vs"),Hg(S,"cs"),Hg(S,"ls"),Hg(S,"ps")):C&&S.ps&&S.ps._invalidateThisFrame&&(S.ps._invalidateThisFrame=!1,Hg(S,"ps"));var w=S.translate;w&&Gr(I,[1,0,0,0,0,1,0,0,0,0,1,0,w[0],w[1],w[2],1]);var A=S.vs32,E=C?S.ps32:S.cs32;qp(i,t,S.W,Z,l.vs,A);var q=ep.for(i),D=q.directUniforms(),d=q.directAttribs(),Y=S.D,s=!I._dashDisabled&&Y;D.uAlphaTest=X.alphaTest,i._blooming&&!S.B&&(D.blackout=!0),s&&(D.uDash=!0,D.uDashDistance=Y,D.uDashGapDistance=S.G,D.uDiffuse=S.A||X["color.empty"],d.aLineDistance=cg(i,l.lineDistance,S.ls32,Z,1));var V=!I._batchColorDisabled;V&&E.length?(D.uBatchColor=!0,d.aBatchColor=cg(i,l.batchColor,E,Z,4)):(D.uBatchColor=!1,d.aBatchColor=!1),zc(i),Ae(i,0,A.length/3,i.LINES),ui(i),V&&(D.uBatchColor=!1,d.aBatchColor=!1),s&&(D.uDash=!1,d.aLineDistance=!1),i._blooming&&!S.B&&(D.blackout=!1),w&&Wl(I)}}Dq(i,t),Wl(I)}},Oj=function(j){j.invalidate=!1,Hg(j,"vs"),Hg(j,"ns"),Hg(j,"cs"),Hg(j,"rs"),Hg(j,"ps"),Hg(j,"bs"),Hg(j,"uv")},$m=function(L,D,C,t,R){var $,J,W,N,m,U,T,f,P,o,M,p,C=L._picking?L.pickColorMap:null,Y=L.getGL(),i=L._prg,r=ep.for(Y),z=r.directUniforms(),F=r.directAttribs(),G=L._buffer;if(!_j(D)&&!L.drawFilter){Gr(L,Do);for($ in D)if(J=L.getBatchInfo($)||je,J.visible!==!1&&!(t&&!J.transparent||!t&&J.transparent||L.isReflecting(Y)&&J.reflectable===!1)){var V=J.renderLayerMask;if(V==Z&&(V=Oe),R==Z&&(R=Oe),rc(R,V)&&(W=D[$],C||!J.transparentMask)){var w=t&&J.autoSort===!0&&(L._33Q||W.invalidate);if(W.invalidate?Oj(W):C&&W.ps&&W.ps._invalidateThisFrame&&(W.ps._invalidateThisFrame=!1,Hg(W,"ps")),m=W.vs32,U=C?W.ps32:W.cs32,P=W.uv32,T=W.bs32,f=W.rs32,M=m.length/3,w){var K=kn(m,L.getEye(),L);K?(W.is=K.is,W.elementTypeUint=K.useUint32):(W.is=null,W.elementTypeUint=null)}if(M){p=W.translate,p&&Gr(L,[1,0,0,0,0,1,0,0,0,0,1,0,p[0],p[1],p[2],1]),N=J.light,o=L.getTexture(J.image),Me(Y,i,Z,J.light,J.opacity,J.reverseFlip,J.reverseColor,J.reverseCull),U?L._batchColorDisabled?(z.uBatchColor=!1,F.aBatchColor=!1):(z.uBatchColor=!0,F.aBatchColor=cg(Y,G.batchColor,U,Z,4)):(z.uBatchColor=!1,z.uDiffuse=J.color||X["color.empty"]);var x=J.alphaTest;z.uAlphaTest=x===c?X.alphaTest:x,z.shadowReceive=!C&&J.shadowReceive!==!1,Y._blooming&&!J.bloom&&(z.blackout=!0),J.envmap!==c?(z.uUseEnvMap=!0,z.uReflectivity=J.envmap):(z.uUseEnvMap=!1,z.uReflectivity=0);var e=T&&!L._batchBlendDisabled;e&&(z.uBatchBlend=!0,F.aBatchBlend=cg(Y,G.batchBlend,T,Z));var a=f&&!L._batchBrightnessDisabled;a&&(z.uBatchBrightness=!0,F.aBatchBrightness=cg(Y,G.batchBrightness,f,Z,1)),P?zc(Y,i,o,J.discardSelectable,G.uv,P,J.uvOffset,J.uvScale,J.uvRotation):zc(Y),F.aPosition=cg(Y,G.vs,m,Z),F.aNormal=cg(Y,G.ns,W.ns32,Z),W.is?(Vg(Y,G.is,W.is),nh(Y,0,M,null,W.elementTypeUint?Y.UNSIGNED_INT:null)):Ae(Y,0,M),P?ui(Y,i,o):ui(Y),U&&!L._batchColorDisabled&&(z.uBatchColor=!1,F.aBatchColor=!1),e&&(z.uBatchBlend=!1,F.aBatchBlend=!1),a&&(z.uBatchBrightness=!1,F.aBatchBrightness=!1),Y._blooming&&!J.bloom&&(z.blackout=!1),Qc(Y,i),p&&Wl(L)}}}Wl(L)}},kn=function(N,z,l){var B=N.length/3,q=B>65535,u=l._glCapabilities.elementTypeUint&&q;if(!u&&q)return null;for(var c=new Array(B),P=B/3,h=new Array(P),k=0;P>k;k++)h[k]=k;h.sort(function(U,n){var b=9*U,r=[(N[b]+N[b+3]+2*N[b+6])/4,(N[b+1]+N[b+4]+2*N[b+7])/4,(N[b+2]+N[b+5]+2*N[b+8])/4];b=9*n;var S=[(N[b]+N[b+3]+2*N[b+6])/4,(N[b+1]+N[b+4]+2*N[b+7])/4,(N[b+2]+N[b+5]+2*N[b+8])/4],B=Yf(z,r)-Yf(z,S);return B>0?-1:0>B?1:0});for(var k=0;P>k;k++){var O=3*k,K=3*h[k];c[O]=K,c[O+1]=K+1,c[O+2]=K+2}return{useUint32:u,is:u?new Uint32Array(c):new Vb(c)}},bq={obj:function(V,r){var e={mat:V.mat,s3:V.s3,r3:V.r3,rotationMode:V.rotationMode,t3:V.t3,cube:V.cube==Z?!0:V.cube,center:V.center==Z?!0:V.center,ignoreMtls:V.ignoreMtls,ignoreTransparent:V.ignoreTransparent,ignoreColor:V.ignoreColor,ignoreImage:V.ignoreImage,ignoreNormal:V.ignoreNormal,prefix:V.prefix,flipY:V.flipY,flipFace:V.flipFace,reverseFlipMtls:V.reverseFlipMtls,finishFunc:function(M,d){if(M){var d=[];for(var Y in M){var D=M[Y];d.rawS3=D.rawS3,D.center&&(d.center=D.center),d.push(D),V.eachModel&&V.eachModel(Y,D)}d.json=V,r(d)}else r()}};L.loadObj(V.obj,V.mtl,e)},bin:function(c,U){var k={finishFunc:function(g){g?U(g):U()}};L.loadBin(c.url,k)}};L.getModelTypeHandlers=function(){return bq},L.setModelTypeHandler=function(M,m){bq[M]=m},L.getModelTypeHandler=function(c){return bq[c]},L.handleModelLoaded=function(){},L.handleUnfoundModel=function(){};var Oc=Z,Pr=Z,bm=function(u){Oc&&!u._loadingModelView_&&(Pr||(Pr={}),Pr[u._loadingModelView_=Se()]=u)},ih=function(i,o){Oc||(Oc={});var O=Oc[i];if(O){if(O.url===o)return;O.request.onload=Ng,O.request.onerror=Ng}if(o.indexOf(".bin")===o.length-4)return Li(i,{modelType:"bin",url:o},o);if(o=L.beforeLoadURL(o),o.data){var D=L.parse(o.data);Li(i,D,o)}else{var A=new Hl;Oc[i]={request:A,url:o},A.onload=function(){if(200===this.status||0===this.status){delete Oc[i];var g=L.parse(A.getResponseText());Li(i,g,o)}else wd(i,L.handleUnfoundModel(i,o)||Z)},A.onerror=function(){wd(i,L.handleUnfoundModel(i,o)||Z)};var j={};j.url=encodeURI(o),j.sync=!1,A.send(j)}},Li=function(A,h,k){var z=h.modelType;if(!z)return wd(A,h),L.handleModelLoaded(A,h),void 0;var y=L.getModelTypeHandler(z);if(y){if(Oc||(Oc={}),Oc[A])return;Oc[A]=!0;var T=function(_){_?(wd(A,_),L.handleModelLoaded(A,_)):wd(A,L.handleUnfoundModel(A,k,h)||Z)};y(h,T)}else wd(A,L.handleUnfoundModel(A,k,h)||Z)},wd=function(v,z){if(delete Oc[v],em(z)&&xk.test(z))return ih(v,z),void 0;if(vf[v]=z,_j(Oc)&&(Oc=Z,Pr)){for(var m in Pr){var k=Pr[m];k.invalidateAll&&k.invalidateAll(c,"modelLoaded",v),k.redraw&&k.redraw(),k.iv(),delete k._loadingModelView_}Pr=Z}if(z&&Pr)for(var m in Pr){var k=Pr[m];k.invalidateAll&&k.invalidateAll(c,"modelLoading",v),k.redraw&&k.redraw(),k.iv()}},Ai=new Sf([0,0,0,1,1,1,1,0]),Kq=new Sf([0,0,1,0,0,1,0,0,1,0,0,1]),yh=new Vb([0,1,2,2,3,0]),ur=new Sf([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Zo=new Vb([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),me=new Sf([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),ye=$j(ur,Zo),Sl=(new Sf([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Vb([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Cl,qn,ij,Kf,Vl,mf]),Ye=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],zq=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],fs=function(Y,E,b,Z,n,q,w){q=q||16,Y=Y||16,E=E||0,b=b||Y;var M,d,R,e,J,o,y,f,g,h=.5,m=[],c=[],a=s/Y,l=v/q;for(M=0;q>M;M++)for(o=M+1,e=M*l,g=o*l,d=E;b>d;d++)y=d+1,R=d*a,f=y*a,m.push(h*z(e)*K(R),h*K(e),-h*z(e)*z(R),h*z(g)*K(f),h*K(g),-h*z(g)*z(f),h*z(e)*K(f),h*K(e),-h*z(e)*z(f),h*z(e)*K(R),h*K(e),-h*z(e)*z(R),h*z(g)*K(R),h*K(g),-h*z(g)*z(R),h*z(g)*K(f),h*K(g),-h*z(g)*z(f)),c.push(d/Y,M/q,y/Y,o/q,y/Y,M/q,d/Y,M/q,d/Y,o/q,y/Y,o/q);if(w){var j=[];for(M=0,J=m.length;J>M;M+=3)j.push(2*m[M],2*m[M+1],2*m[M+2])}if(Z){var U=[],B=[];for(R=E*a,M=0;q>M;M++)o=M+1,e=M*l,g=o*l,U.push(0,0,0,h*z(g)*K(R),h*K(g),-h*z(g)*z(R),h*z(e)*K(R),h*K(e),-h*z(e)*z(R)),B.push(0,.5,E/Y,o/q,E/Y,M/q)}if(n){var T=[],i=[];for(R=b*a,M=0;q>M;M++)o=M+1,e=M*l,g=o*l,T.push(0,0,0,h*z(e)*K(R),h*K(e),-h*z(e)*z(R),h*z(g)*K(R),h*K(g),-h*z(g)*z(R)),i.push(1,.5,b/Y,M/q,b/Y,o/q)}var I={vs:m,uv:c,from_vs:U,from_uv:B,to_vs:T,to_uv:i};return w&&(I.ns=j),I},Rb=function(F,y,x){F=F||.17,y=y||12,x=x||18,0>F?F=0:F>.25&&(F=.25);var R,c,Q,E,C,U,l,u=.5,e=[],H=[],M=[],P=s/x,r=s/y,a=u-F;for(c=0;y>=c;c++)for(E=-v+c*r,U=K(E),C=z(E),R=0;x>=R;R++)Q=R*P,l=a+F*U,e.push(K(Q)*l,C*F,-z(Q)*l),H.push(R/x,1-c/y);for(c=0;y>c;c++){var w=c*(x+1),n=(c+1)*(x+1);for(R=0;x>R;R++)M.push(w+R,n+R+1,n+R,w+R,w+R+1,n+R+1)}return{vs:e,uv:H,is:M}},Hh=function(Q,L,F,V,X,G,a,I){a=a||12,Q=Q||18,L=L||0,F=F||Q,G=G||.17,0>G?G=0:G>.25&&(G=.25);var j,S,r,p,y,o,D,h,C,u,A=.5,E=[],x=[],d=s/Q,l=s/a,f=A-G,w=I?[]:c;for(r=0;a>r;r++)for(p=r+1,D=-v+r*l,h=-v+p*l,j=L;F>j;j++)S=j+1,y=j*d,o=S*d,C=f+G*K(D),u=f+G*K(h),E.push(K(y)*C,z(D)*G,-z(y)*C,K(o)*C,z(D)*G,-z(o)*C,K(o)*u,z(h)*G,-z(o)*u,K(y)*C,z(D)*G,-z(y)*C,K(o)*u,z(h)*G,-z(o)*u,K(y)*u,z(h)*G,-z(y)*u),x.push(j/Q,1-r/a,S/Q,1-r/a,S/Q,1-p/a,j/Q,1-r/a,S/Q,1-p/a,j/Q,1-p/a),I&&w.push(K(y)*K(D),z(D),-z(y)*K(D),K(o)*K(D),z(D),-z(o)*K(D),K(o)*K(h),z(h),-z(o)*K(h),K(y)*K(D),z(D),-z(y)*K(D),K(o)*K(h),z(h),-z(o)*K(h),K(y)*K(h),z(h),-z(y)*K(h));if(V){var T=[],P=[];for(r=0;a>r;r++)p=r+1,D=-v+r*l,h=-v+p*l,y=L*d,C=f+G*K(D),u=f+G*K(h),T.push(K(y)*C,z(D)*G,-z(y)*C,K(y)*u,z(h)*G,-z(y)*u,K(y)*f,0,-z(y)*f),P.push(.5+.5*K(D),.5-.5*z(D),.5+.5*K(h),.5-.5*z(h),.5,.5)}if(X){var B=[],$=[];for(r=0;a>r;r++)p=r+1,D=-v+r*l,h=-v+p*l,y=F*d,C=f+G*K(D),u=f+G*K(h),B.push(K(y)*C,z(D)*G,-z(y)*C,K(y)*f,0,-z(y)*f,K(y)*u,z(h)*G,-z(y)*u),$.push(.5-.5*K(D),.5-.5*z(D),.5,.5,.5-.5*K(h),.5-.5*z(h))}var q={vs:E,uv:x,from_vs:T,from_uv:P,to_vs:B,to_uv:$};return I&&(q.ns=w),q},ji=function(o,Z){for(var i,U,S,h=.5,H=16,R=[],W=[],t=[],r=s/H,M=0;H>=M;M++)i=M*r,U=K(i)*h,S=z(i)*h,R.push(U,-h,S,U,h,S),W.push(1-M/H,1,1-M/H,0);for(M=0;H>M;M++)t.push(2*M,2*M+1,2*M+3,2*M,2*M+3,2*M+2);if(Z){var w=[],T=[],l=[];for(w.push(0,-h,0),T.push(.5,.5),M=0;H>=M;M++)i=M*r,U=K(i),S=z(i),w.push(U*h,-h,-S*h),T.push(.5+.5*U,.5+.5*S);for(M=0;H>M;M++)l.push(0,M+2,M+1)}if(o){var y=[],p=[],q=[];for(y.push(0,h,0),p.push(.5,.5),M=0;H>=M;M++)i=M*r,U=K(i),S=z(i),y.push(U*h,h,-S*h),p.push(.5+.5*U,.5-.5*S);for(M=0;H>M;M++)q.push(0,M+1,M+2)}return{vs:R,uv:W,is:t,bottom_vs:w,bottom_uv:T,bottom_is:l,top_vs:y,top_uv:p,top_is:q}},oq=function(k,v,b,e,T,Q,c,F){k=k||12,v=v||0,b=b||k;for(var d,E,D,j,Y,i,Z,a,W,g=.5,I=[],S=[],w=s/k,R=v;b>R;R++)d=R+1,E=R*w,D=d*w,j=K(E)*g,Y=z(E)*g,i=K(D)*g,Z=z(D)*g,I.push(j,-g,-Y,i,-g,-Z,j,g,-Y,i,-g,-Z,i,g,-Z,j,g,-Y),S.push(R/k,1,d/k,1,R/k,0,d/k,1,d/k,0,R/k,0);if(F){var h=[];for(R=0,W=I.length;W>R;R+=3)h.push(2*I[R],0,2*I[R+2])}if(c){var n=[],P=[];for(R=v;b>R;R++)E=w*R,D=w*(R+1),j=K(E),Y=z(E),i=K(D),Z=z(D),n.push(j*g,-g,-Y*g,0,-g,0,i*g,-g,-Z*g),P.push(.5+.5*j,.5+.5*Y,.5,.5,.5+.5*i,.5+.5*Z)}if(Q){var m=[],C=[];for(R=v;b>R;R++)E=w*R,D=w*(R+1),j=K(E),Y=z(E),i=K(D),Z=z(D),m.push(j*g,g,-Y*g,i*g,g,-Z*g,0,g,0),C.push(.5+.5*j,.5-.5*Y,.5+.5*i,.5-.5*Z,.5,.5)}if(e){var O=[],L=[];E=w*v,j=K(E)*g,Y=z(E)*g,a=v/k,O.push(0,g,0,0,-g,0,j,-g,-Y,j,-g,-Y,j,g,-Y,0,g,0),L.push(0,0,0,1,a,1,a,1,a,0,0,0)}if(T){var u=[],U=[];E=w*b,j=K(E)*g,Y=z(E)*g,a=b/k,u.push(0,-g,0,0,g,0,j,g,-Y,j,g,-Y,j,-g,-Y,0,-g,0),U.push(1,1,1,0,a,0,a,0,a,1,1,1)}var y={vs:I,uv:S,bottom_vs:n,bottom_uv:P,top_vs:m,top_uv:C,from_vs:O,from_uv:L,to_vs:u,to_uv:U};return F&&(y.ns=h),y},nn=function(_,$,j,D,n){$=$||18,j=j||0,D=D==Z?s:D,n=n==Z?.5:n;for(var A,I,b,W,f,i,X=[0,.5,.75,.875,.9375],g=[],M=[],p=[],Y=D/$,w=0;w<X.length;w++){var m=0===w%2?0:.5;for(A=0;$>=A;A++)I=(A+m)*Y+j,b=1-X[w],g.push(K(I)*n*b,-n+2*X[w]*n,-z(I)*n*b),M.push((A+m)/$,b)}for(w=0;w<X.length-1;w++){var e=w*($+1),u=(w+1)*($+1);for(A=0;$>A;A++)p.push(e+A,u+A+1,u+A,e+A,e+A+1,u+A+1)}for(i=g.length/3-($+1),A=0;$>A;A++)g.push(0,n,0),M.push((A+.5)/$,0);for(A=0;$>A;A++)p.push(i+A,i+A+1,i+($+1)+A);if(_){var c=[],V=[],y=[];for(c.push(0,-n,0),V.push(.5,.5),A=0;$>=A;A++)I=A*Y+j,W=K(I),f=z(I),c.push(W*n,-n,-f*n),V.push(.5+.5*W,.5+.5*f);for(A=0;$>A;A++)y.push(0,A+2,A+1)}return{vs:g,uv:M,is:p,bottom_vs:c,bottom_uv:V,bottom_is:y}},Dh=function(b,a,J,H,V,o,v,S){b=b||16,a=a||0,J=J||b,v=v||1;var T,d,n,x,Z,$,m,g=.5,N=[],P=[],k=s/b,B=a,U=1/v,d=new Xc,n=new Xc,r=new Xc,I=new Xc,G=new Xc,t=new Xc,u=new Xc;for(S&&(T=[],Z=new Xc,$=new Xc,m=new Xc);J>B;B++){var w=B+1,j=k*B,F=k*w;for(d.set(K(j)*g,-g,-z(j)*g),n.set(K(F)*g,-g,-z(F)*g),r.set(0,g,0),S&&(Z.set(K(j),.5,-z(j)).normalize(),$.set(K(F),.5,-z(F)).normalize(),m.copy(Z).add($).normalize()),I.lerpVectors(r,d,U),G.lerpVectors(r,n,U),N.push(I.x,I.y,I.z,G.x,G.y,G.z,r.x,r.y,r.z),P.push(B/b,U,w/b,U,(B+w)/2/b,0),S&&T.push(Z.x,Z.y,Z.z,$.x,$.y,$.z,m.x,m.y,m.z),x=1;v>x;x++)I.lerpVectors(r,d,U*(x+1)),G.lerpVectors(r,n,U*(x+1)),t.lerpVectors(r,d,U*x),u.lerpVectors(r,n,U*x),N.push(I.x,I.y,I.z,G.x,G.y,G.z,t.x,t.y,t.z,t.x,t.y,t.z,G.x,G.y,G.z,u.x,u.y,u.z),P.push(B/b,U*(x+1),w/b,U*(x+1),B/b,U*x,B/b,U*x,w/b,U*(x+1),w/b,U*x),S&&T.push(Z.x,Z.y,Z.z,$.x,$.y,$.z,Z.x,Z.y,Z.z,Z.x,Z.y,Z.z,$.x,$.y,$.z,$.x,$.y,$.z)}if(o){var L=[],e=[];for(B=a;J>B;B++){j=k*B,F=k*(B+1);var W=K(j),R=z(j),h=K(F),O=z(F);L.push(W*g,-g,-R*g,0,-g,0,h*g,-g,-O*g),e.push(.5+.5*W,.5+.5*R,.5,.5,.5+.5*h,.5+.5*O)}}if(H){var i=[],Q=[];j=k*a,i.push(0,g,0,0,-g,0,K(j)*g,-g,-z(j)*g),Q.push(0,0,0,1,a/b,1)}if(V){var f=[],p=[];j=k*J,f.push(0,-g,0,0,g,0,K(j)*g,-g,-z(j)*g),p.push(1,1,1,0,J/b,1)}var Y={vs:N,uv:P,bottom_vs:L,bottom_uv:e,from_vs:i,from_uv:Q,to_vs:f,to_uv:p};return S&&(Y.ns=T),Y},Re=function(j,R,z,v,a,Q,U,m){for(var o=[],w=0;w<j.length-1;w+=2)o.push({x:j[w],y:j[w+1]});return xh(o,R,z,v,a,Q,U,m,!1)},go={roundRect:function(s,Y){return Re([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],s,Y,3)},star:function(E,y){return Re([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],E,y)},rect:function(L,$){return Re([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],L,$)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(g,C){return Re([0,-.5,.5,.5,-.5,.5],[1,2,2,5],g,C)},rightTriangle:function(x,D){return Re([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],x,D)},parallelogram:function(S,I){return Re([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],S,I)},trapezoid:function(r,G){return Re([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],r,G)}},Tf={sphere:1,cylinder:1,cone:1,torus:1},Zf={torus:1,sphere:1,cone:1},ai=kp(zl(go),{cylinder:1}),Ib=kp(zl(go),{cylinder:1,cone:1}),Rq=function(I,r,$){var y,V=sn(I.anchor3d,$,r),B=sn(I.mat,$,r),D=sn(I.s3,$,r),e=sn(I.t3,$,r),q=sn(I.r3,$,r),Z=D||q||e||B;if(V||Z){y=Di(r._6O);var S=Z?Vh(B,D,q,sn(I.rotationMode,$,r),e):Bf();V&&Kl(S,[.5-V[0],.5-V[1],.5-V[2]]),Gr(r,S)}return y},$q=function(T,e,$,Y,k,t,l){if(tj($))$.forEach(function(H){$q(T,e,H,Y,k,t,l)});else if(em($))$q(T,e,If(Y,$),Y,k,t,l);else if(Ue($))if($.shape3d){var K=Rq($,T,e);$q(T,e,$.shape3d,Y,k,t,$),K&&Wl(T,K)}else Eo(T,e,$,Y.s,k,t,l)},Eo=function(C,B,_,W,Q,v,y){if(y=y||je,!v||v(W("shape3d.transparent",_.transparent,y.transparent))){var c=Rq(_,C,B);if(yc(_)){var d=C.getData3dUI(B);d.dispatchBoundingBoxChanged()}var K=C._26I,M=C._prg,R=C._buffer,L=W("shape3d.color",_.color,y.color);Q||(Q=W("shape3d.blend",_.blend,y.blend));var J,s=_.opacity==Z?y.opacity:_.opacity,r=W("shape3d.opacity");J=r!=Z&&s!=Z?s*r:s!=Z?s:r,Me(K,M,Q,W("shape3d.light",_.light,y.light),J,W("shape3d.reverse.flip",_.reverseFlip,y.reverseFlip),W("shape3d.reverse.color",_.reverseColor,y.reverseColor),W("shape3d.reverse.cull",_.reverseCull,y.reverseCull));var E=W("polygonOffset",_.polygonOffset,y.polygonOffset);_.vs&&W(Tl,_.visible,y.visible)&&$e(K,M,R,L,C.getTexture(W("shape3d.image",_.image,y.image),B),W("shape3d.discard.selectable",_.discardSelectable,y.discardSelectable),_.vs,_.uv,_.ns,_.is,W("shape3d.uv.offset",_.uvOffset,y.uvOffset),W("shape3d.uv.scale",_.uvScale,y.uvScale),W("shape3d.uv.rotation",_.uvRotation,y.uvRotation),E),_.top_vs&&W(sh,_.topVisible,y.topVisible)&&$e(K,M,R,W("shape3d.top.color",_.topColor,y.topColor)||L,C.getTexture(W("shape3d.top.image",_.topImage,y.topImage),B,"top"),W("shape3d.top.discard.selectable",_.topDiscardSelectable,y.topDiscardSelectable),_.top_vs,_.top_uv,_.top_ns,_.top_is,W("shape3d.top.uv.offset",_.topUvOffset,y.topUvOffset),W("shape3d.top.uv.scale",_.topUvScale,y.topUvScale),W("shape3d.top.uv.rotation",_.topUvRotation,y.topUvRotation),E),_.bottom_vs&&W(lj,_.bottomVisible,y.bottomVisible)&&$e(K,M,R,W("shape3d.bottom.color",_.bottomColor,y.bottomColor)||L,C.getTexture(W("shape3d.bottom.image",_.bottomImage,y.bottomImage),B,"bottom"),W("shape3d.bottom.discard.selectable",_.bottomDiscardSelectable,y.bottomDiscardSelectable),_.bottom_vs,_.bottom_uv,_.bottom_ns,_.bottom_is,W("shape3d.bottom.uv.offset",_.bottomUvOffset,y.bottomUvOffset),W("shape3d.bottom.uv.scale",_.bottomUvScale,y.bottomUvScale),W("shape3d.bottom.uv.rotation",_.bottomUvRotation,y.bottomUvRotation),E),_.from_vs&&W($g,_.fromVisible,y.fromVisible)&&$e(K,M,R,W("shape3d.from.color",_.fromColor,y.fromColor)||L,C.getTexture(W("shape3d.from.image",_.fromImage,y.fromImage),B,"from"),W("shape3d.from.discard.selectable",_.fromDiscardSelectable,y.fromDiscardSelectable),_.from_vs,_.from_uv,_.from_ns,_.from_is,W("shape3d.from.uv.offset",_.fromUvOffset,y.fromUvOffset),W("shape3d.from.uv.scale",_.fromUvScale,y.fromUvScale),W("shape3d.from.uv.rotation",_.fromUvRotation,y.fromUvRotation),E),_.to_vs&&W(Jf,_.toVisible,y.toVisible)&&$e(K,M,R,W("shape3d.to.color",_.toColor,y.toColor)||L,C.getTexture(W("shape3d.to.image",_.toImage,y.toImage),B,"to"),W("shape3d.to.discard.selectable",_.toDiscardSelectable,y.toDiscardSelectable),_.to_vs,_.to_uv,_.to_ns,_.to_is,W("shape3d.to.uv.offset",_.toUvOffset,y.toUvOffset),W("shape3d.to.uv.scale",_.toUvScale,y.toUvScale),W("shape3d.to.uv.rotation",_.toUvRotation,y.toUvRotation),E),Qc(K,M),c&&Wl(C,c)}},$e=function(L,o,D,h,u,b,k,v,m,F,x,y,w,l){if(k){l&&ef(L,l);var P=ep.for(L),G=P.directUniforms(),q=P.directAttribs();G.uDiffuse=h||X["color.empty"],v?zc(L,o,u,b,D.uv,v,x,y,w):zc(L),q.aPosition=cg(L,D.vs,k,Z),q.aNormal=cg(L,D.ns,m,Z),F?(Yc(L,D.is,F),nh(L,0,F.length,null,F instanceof Uint32Array?L.UNSIGNED_INT:null)):Ae(L,0,k.length/3),v?ui(L,o,u):ui(L),l&&Aj(L)}},If=function(v,n){var J=v.s;if(n||(n=J(lg)),!n)return Z;var i=Xh(n);if(i)return i;if("text"===n){var G={amount:J("shape3d.text.amount"),size:J("shape3d.text.size"),font:J("shape3d.text.font"),style:J("shape3d.text.style"),weight:J("shape3d.text.weight"),fill:J("shape3d.text.fill"),curveSegments:J("shape3d.text.curveSegments"),spacing:J("shape3d.text.spacing")},x=v.gv.getShape3dText(v.data),Y=x;for(var g in G)Y+="_"+(G[g]===c?"U":G[g]);return v._cachedTextKey===Y?v._cachedTextGeometry:(v._cachedTextKey=Y,v._cachedTextGeometry=L.createTextGeometry(x,G))}var g=n;if(Tf[n]){var P=J("shape3d.side"),f=J("shape3d.side.from"),F=J("shape3d.side.to"),t=J($g),z=J(Jf);3>P?(P=0,f=0,F=0,t=!1,z=!1):((f==Z||0>f)&&(f=0),(F==Z||F>P)&&(F=P),0===f&&F===P&&(t=!1,z=!1));var C=J("shape3d.smooth");g+="-"+P+"-"+f+"-"+F+"-"+t+"-"+z+(C?1:0)}if(ai[n]){var m=J(sh);g+="-"+m}if(Ib[n]){var e=J(lj);g+="-"+e}if("torus"===n){var d=J("shape3d.torus.radius");0>d?d=0:d>.25&&(d=.25),g+="-"+d}if(Zf[n]){var u=J(wo);g+="-"+u}return i=sk[g],i||("box"===n?i=L.createBoxModel():go[n]?i=go[n](m,e):"sphere"===n?i=L.createSphereModel(P,f,F,t,z,u,C):n===hm?i=L.createCylinderModel(P,f,F,t,z,m,e,C):"cone"===n?i=L.createConeModel(P,f,F,t,z,e,u,C):"torus"===n&&(i=L.createTorusModel(P,f,F,t,z,d,u,C)),sk[g]=i),i},yc=function(){var q=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],y=["is","top_is","bottom_is","from_is","to_is"];return H=Rk(Kj.substr(Kj.indexOf("^#")+2)),Rl(L[Hq(Bn+q[15]+"n"+q[16])]())&&Fh()?function(i){return i&&!i._complete_?(i._complete_=!0,i.vs&&lc(i.ns)&&(i.ns=$j(i.vs,i.is),i.boundingBox=c),i.top_vs&&lc(i.top_ns)&&(i.top_ns=$j(i.top_vs,i.top_is),i.top_boundingBox=c),i.bottom_vs&&lc(i.bottom_ns)&&(i.bottom_ns=$j(i.bottom_vs,i.bottom_is),i.bottom_boundingBox=c),i.from_vs&&lc(i.from_ns)&&(i.from_ns=$j(i.from_vs,i.from_is),i.from_boundingBox=c),i.to_vs&&lc(i.to_ns)&&(i.to_ns=$j(i.to_vs,i.to_is),i.to_boundingBox=c),q.forEach(function(D){var B=i[D];tj(B)&&(i[D]=new Sf(B))}),y.forEach(function(R){var w=i[R];tj(w)&&(i[R]=new Vb(w))}),!0):!1}:void 0}(),jq=function(P,O){var r=P[O];tj(r)&&(P[O]=new Sf(r))};kp(Jm,{_25Q:function(E){E._16O=function(o,O,Q,H,C,$,U,n,W){var P=this.info;if(P){var F,J,w,E,q,r,t=Bf();if(Zi[O]?(F=P.p3,J=P.c1,w=P.c2):No[O]?(J=P.s1||P.c1,w=P.s2||P.c2):(J=P.t1||P.c1,w=P.t2||P.c2),F)r=tf(O,nj,Q,H,n,W);else{var B=$i(w,J),N=Yf(J,w);E=[0,-Nh(B[2],B[0]),f(B[1]/N)],q="zyx",F=[(J[0]+w[0])/2,(J[1]+w[1])/2,(J[2]+w[2])/2],r=tf(O,[N,0,0],Q,H,n,W)}return yj(t,r,F,H,C,$,U,o,E,q)}return De},E._80o=function(V,v,G){var R=this,c=R.shapeModel;if(c){var x=R.gv;Gr(x),$q(x,R.data,c,R,R.getBodyColor(),G)}},E.createLineModel=function(B,D,m,x,$){var G=this,C=G.s,X=lb(B,D,C(wo)),c=C(x+".color");if(c){for(var P=[],q=0;q<X.length;q++){var b=X[q],j=b.length;if(j>1){var y=b[0];P.push(y.x,y.y,y.z);for(var Y=1;j-1>Y;Y++)y=b[Y],P.push(y.x,y.y,y.z),P.push(y.x,y.y,y.z);y=b[j-1],P.push(y.x,y.y,y.z)}}var T,E,u,p=C($),t=0;p&&(E=C($+".color"),T=C($+".pattern"),t=C($+".offset"),u=c),Uc(G.gv,G.data,P,E||c,u?Z:C(x+".gradient.color"),m,T||C(x+".pattern"),t,u)}return X},E.createTubeModel=function(G,i,x,j){for(var T=this,s=T.s,g=s("shape3d.side")||Kk,O=s("shape3d.start.angle"),p=s("shape3d.sweep.angle"),a=s(sh)?s("shape3d.top.cap"):Z,N=s(lj)?s("shape3d.bottom.cap"):Z,S="flat"===a,e="flat"===N,f=S&&(j?j.uv:s("shape3d.top.image")),E=e&&(j?j.uv:s("shape3d.bottom.image")),C=j?j.uv:s("shape3d.image"),c=s("shape3d.smooth"),q={vs:[],uv:C?[]:Z,ns:c?[]:Z,top_vs:S?[]:Z,top_uv:f?[]:Z,bottom_vs:e?[]:Z,bottom_uv:E?[]:Z},J=lb(G,i,s(wo),x),d=0,y=J.length;y>d;d++)Ec(q,J[d],s(Dp),x,g,O,p,a,N);return j?fe(T.gv,T.data,q,T,T.getBodyColor(),T.mat?[T.mat]:[],j):T.shapeModel=q,T.lineShapeModel=q,J},E.getCache=function(){var V=this.info;if(V){var l=V.list;if(l){var X=V.cache;return X||(X=V.cache=td(l)),X}}return Z}}});var Pk=function(L,b){for(var z,e=0,K=L.length,s=0,E=K-1;E>=s;)if(e=G(s+(E-s)/2),z=L[e].length-b,0>z)s=e+1;else{if(!(z>0)){E=e;break}E=e-1}e=E;var q=L[e],B=q.point;return e===K-1||q.length===b||(B=(new $k).subVectors(L[e+1].point,B).normalize().multiplyScalar(b-q.length).add(B)),{point:B,tangent:q.tangent}},td=function(a){for(var s,x,l=[],w=0,p=0;p<a.length;p++){for(var Y=a[p],q=0;q<Y.length;q++){s=Y[q],x&&(w+=x.distanceTo(s));var L=new $k,k=Y[q+1];k?L.subVectors(k,s):x?L.subVectors(s,x):L.x=1,L.normalize(),l.push({point:s,length:w,tangent:L}),x=s}x=null}return l},lb=function(p,O,w,l){w=w||pb;for(var B=[],v=0,Q=p.size();Q>v;v++){var o=p.get(v);B.push(new $k(o.x,o.e||0,o.y))}O&&(Nn(O)&&(O=O._as),O.length||(O=null));for(var z,I,E,W,t,$=[],x=[],u=0,f=0,G=O?O.length:Q;G>f;f++){if(t=O?O[f]:0===f?1:2,1===t)$.push(E=[]),E.push(B[u++]);else if(2===t||5===t)if(W=2===t?B[u++]:E[0],l){var s=O?O[f+1]:G>f+1?2:Z;if(2===s||5===s){var H=E[E.length-1],g=2===s?B[u]:E[0],d=(new $k).subVectors(H,W),Y=(new $k).subVectors(g,W),e=d.length(),M=Y.length();if(e&&M)if(l>e/2&&l>M/2)E.push(W);else for(d.multiplyScalar(S(l,e/2)/e).add(W),Y.multiplyScalar(S(l,M/2)/M).add(W),z=new tl(d,W,Y).getPoints(w),I=0;w>=I;I++)E.push(z[I])}else E.push(W)}else E.push(W);else if(3===t)for(z=new tl(E[E.length-1],B[u++],B[u++]).getPoints(w),I=1;w>=I;I++)E.push(z[I]);else if(4===t)for(z=new Zr(E[E.length-1],B[u++],B[u++],B[u++]).getPoints(w),I=1;w>=I;I++)E.push(z[I]);x.push($.length,E.length)}return $.indexMark=x,$},hp=function(W){for(var E,o,A=new $k,k=[],I=[],g=[],t=0,w=W.length;w>t;t++)E=W[t],o=W[t+1],o?A.subVectors(o,E):A.subVectors(E,W[t-1]),k.push(A.normalize().clone());var U,C=new $k,z=new $k,P=new ab,d=1e-4,p=k[0],J=I[0]=new $k,n=g[0]=new $k;for(Math.abs(Math.abs(p.y)-1)<d?C.set(1,0,0):C.set(0,1,0),z.crossVectors(p,C).normalize(),J.crossVectors(p,z),n.crossVectors(p,J),t=1;w>t;t++)I[t]=I[t-1].clone(),g[t]=g[t-1].clone(),z.crossVectors(k[t-1],k[t]),z.length()>d&&(z.normalize(),U=l(qg(k[t-1].dot(k[t]),-1,1)),I[t].applyMatrix4(P.makeRotationAxis(z,U))),g[t].crossVectors(k[t],I[t]);return{B:g,T:k,N:I}},Ec=function(){var u=function(T){for(var f=1;f<arguments.length;f++){var n=arguments[f];T.push(n.x,n.y,n.z)}},M=function(P){for(var D=1;D<arguments.length;D++){var C=arguments[D].uv;P.push(C[0],C[1])}},C=function(j){for(var Q=1;Q<arguments.length;Q++){var l=arguments[Q].ns;j.push(l[0],l[1],l[2])}},e=function(L,y,m,r,$){var O=-r*K($),h=r*z($);return new $k(L.x+O*m.x+h*y.x,L.y+O*m.y+h*y.y,L.z+O*m.z+h*y.z)},E=function(T,g,I,G,l,E,U,y,t){U=U||s;for(var n,A=[],K=U/l,n=t?new Xc:Z,O=0;l>=O;O++){var d=e(T,g,I,G,O*K+E);A.push(d),y!=Z&&(d.uv=[y,1-O/l]),t&&(d.ns=n.subVectors(d,T).normalize().toArray())}return A},y=function(m,j,E,L,N,T,p,y,V){V=V||s;var R=j?m.top_vs:m.bottom_vs;if(R)for(var o=j?m.top_uv:m.bottom_uv,b=V/p,w=0;p>w;w++){var h,t;j?(h=w*b+y,t=(w+1)*b+y):(t=w*b+y,h=(w+1)*b+y),u(R,e(E,L,N,T,h),e(E,L,N,T,t),E),o&&o.push(.5-.5*K(h),.5-.5*z(h),.5-.5*K(t),.5-.5*z(t),.5,.5)}};return function(B,Q,X,l,a,H,j,r,p){var W=Q.length;if(W>1){var Y,U,R,T,I,i,b,o=hp(Q),z=o.T,O=o.N,J=o.B;"flat"===r&&y(B,!0,Q[0],J[0],O[0],l,a,H,j),"flat"===p&&y(B,!1,Q[W-1],J[W-1],O[W-1],l,a,H,j);var G,A,e=[],v=N(a/2),L="round"===r,m="round"===p,d=Q[0],h=z[0],K=J[0],g=O[0],$=Q[W-1],t=z[W-1],P=J[W-1],D=O[W-1];if(L){for(R=1;v>=R;R++)O.splice(0,0,g),J.splice(0,0,K),z.splice(0,0,h),A=-R/v*l,Q.splice(0,0,h.clone().multiplyScalar(A).add(d)),e[v-R]=V(l*l-A*A);W+=v}if(m){for(R=1;v>=R;R++)O.push(D),J.push(P),z.push(t),A=R/v*l,Q.push(t.clone().multiplyScalar(A).add($)),e[Q.length-1]=V(l*l-A*A);W+=v}if(B.uv){var n=0,f=0,s=[];for(X&&(n=X),I=Q[0],s[0]=0,R=1;W>R;R++)T=Q[R],s[R]=I.distanceTo(T),I=T,X||(n+=s[R]);for(G=[],R=0;W>R;R++)f+=s[R],G[R]=n?f/n:0}var F=B.ns?!0:!1;for(R=0;W>R;R++){if(T=Q[R],i=J[R],b=O[R],Y=E(T,i,b,e[R]===c?l:e[R],a,H,j,G?G[R]:Z,F),U)for(var k=0;a>k;k++){var x=U[k],q=U[k+1]||U[0],w=Y[k],_=Y[k+1]||Y[0];u(B.vs,q,x,w,w,_,q),B.uv&&M(B.uv,q,x,w,w,_,q),F&&C(B.ns,q,x,w,w,_,q)}U=Y}}}}();kp(L,{getLineLength:function(r){return r[r.length-1].length},getLineOffset:function(z,V){return Pk(z,V)},getLineCacheInfo:function(d,r,O,S){return td(lb(d,r,O,S))}});var Pq=T.graph3d.RenderLite={},am=new Array(0),af=Pq.Buffer=function(H,R,j,b){this.gl=H,this.buffer=H.createBuffer(),this.type=R||H.ARRAY_BUFFER,this.drawType=b||H.STATIC_DRAW,this.data=am,j&&this.upload(j)};af.prototype.upload=function(c,X,l){l||this.bind();var M=this.gl;c=c||this.data,X=X||0,this.data.byteLength>=c.byteLength?M.bufferSubData(this.type,X,c):M.bufferData(this.type,c,this.drawType),this.data=c},af.prototype.bind=function(){var h=this.gl;h.bindBuffer(this.type,this.buffer)},af.createVertexBuffer=function(G,H,w){return new af(G,G.ARRAY_BUFFER,H,w)},af.createIndexBuffer=function(T,P,s){return new af(T,T.ELEMENT_ARRAY_BUFFER,P,s)},af.create=function(K,B,c,l){return new af(K,B,l)},af.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Xo=Pq.Shader=function(J,s,G){this.gl=J,this.program=Kr(J,s,G),this.attributes=cc(J,this.program);var v=Si(J,this.program);this.uniforms=Hc(J,v)};Xo.prototype.bind=function(){this.gl.useProgram(this.program)},Xo.prototype.destroy=function(){this.gl};var Kr=function(u,e,F){var p=bg(u,u.VERTEX_SHADER,e),E=bg(u,u.FRAGMENT_SHADER,F),a=u.createProgram();return u.attachShader(a,p),u.attachShader(a,E),u.linkProgram(a),u.getProgramParameter(a,u.LINK_STATUS)||(Ci("LINK","LITE",u.getProgramParameter(a,u.VALIDATE_STATUS),u.getError(),u.getProgramInfoLog(a)),u.deleteProgram(a),a=null),u.deleteShader(p),u.deleteShader(E),a},bg=function(c,B,z){var W=c.createShader(B);return c.shaderSource(W,z),c.compileShader(W),c.getShaderParameter(W,c.COMPILE_STATUS)?W:(Ci("COMPILE","LITE",B,c.getError(),c.getShaderInfoLog(W)),null)},Si=function(W,N){for(var y={},Z=W.getProgramParameter(N,W.ACTIVE_UNIFORMS),w=0;Z>w;w++){var D=W.getActiveUniform(N,w),t=D.name.replace(/\[.*?\]/,""),d=_p(W,D.type);y[t]={type:d,size:D.size,location:W.getUniformLocation(N,t),value:oe(d,D.size)}}return y},cc=function(G,a){for(var k={},l=G.getProgramParameter(a,G.ACTIVE_ATTRIBUTES),Q=0;l>Q;Q++){var j=G.getActiveAttrib(a,Q),r=_p(G,j.type);k[j.name]={type:r,size:Qd(r),gl:G,location:G.getAttribLocation(a,j.name),pointer:Qg}
}return k},Qg=function(n,R,u,C,o){var $=this.gl;$.enableVertexAttribArray(this.location),n instanceof Pq.Buffer||(n=Pq.Buffer.createVertexBuffer($,n)),$.bindBuffer(n.type,n.buffer),$.vertexAttribPointer(this.location,this.size,R||$.FLOAT,u||!1,C||0,o||0)},Qd=function(K){return Tm[K]},Tm={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},_p=function(B,Q){if(!Ij){var j=i.keys(cp);Ij={};for(var O=0;O<j.length;++O){var v=j[O];Ij[B[v]]=cp[v]}}return Ij[Q]},Ij=null,cp={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},oe=function(x,u){switch(x){case"float":return 0;case"vec2":return new Float32Array(2*u);case"vec3":return new Float32Array(3*u);case"vec4":return new Float32Array(4*u);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*u);case"ivec3":return new Int32Array(3*u);case"ivec4":return new Int32Array(4*u);case"bool":return!1;case"bvec2":return Pc(2*u);case"bvec3":return Pc(3*u);case"bvec4":return Pc(4*u);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Pc=function(f){for(var D=new Array(f),I=0;I<D.length;I++)D[I]=!1;return D},Hc=function(k,L){var l={data:{}};l.gl=k;for(var A=i.keys(L),z=0;z<A.length;z++){var r=A[z],p=r.split("."),N=p[p.length-1],P=ir(p,l),h=L[r];P.data[N]=h,P.gl=k,i.defineProperty(P,N,{get:cq(N),set:gs(N,h)})}return l},cq=function(n){var z=Tq.replace("%%",n);return new Function(z)},gs=function(Q,$){var d,H=of.replace(/%%/g,Q);return d=1===$.size?oj[$.type]:zs[$.type],d&&(H+="\nthis.gl."+d+";"),new Function("value",H)},ir=function(B,i){for(var N=i,A=0;A<B.length-1;A++){var K=N[B[A]]||{data:{}};N[B[A]]=K,N=K}return N},Tq=["return this.data.%%.value;"].join("\n"),of=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),oj={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},zs={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Al=function(n){function E(j){if("string"!=typeof j)return 0|j;switch(j){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var U=this;U.enable=!1;var K,I,M=L.graph3dViewShadowType,o=L.graph3dViewShadowIntensity,X=L.graph3dViewShadowBias,t=L.graph3dViewShadowQuality,s=L.graph3dViewShadowRadius,q=L.graph3dViewShadowDegreeX,V=L.graph3dViewShadowDegreeZ,r=1,C=E(t),l=!1,F=new T.Math.Matrix4,j=new T.Math.Matrix4,Y=U.pvMatrix=new T.Math.Matrix4;U.render=function(){if(!n._picking&&U.enable){var j=n.getGL();if(j){l&&U.setupShadowCamera(),n._glCapabilities&&(C=Math.min(C,n._glCapabilities.maxTextureSize)),U.map?K.setSize(C,C):K=U.map=new Rp(n,n.getGL(),0,0,{samples:1,minFilter:zm.NEAREST,magFilter:zm.NEAREST,width:C,height:C}),j._shadowShader||(j._shadowShader=new Pq.Shader(j,Al.shaderSrc.vs,Al.shaderSrc.fs));var v=n._frameState,V=v.renderState.glState;V.blend.enabled=!1,V.depth.enabled=!0,V.depth.mask=!0;var X=V.color.clear.slice(0);fb(j,[1,1,1,1]),v.renderState.useProgram(j._shadowShader.program),k(),fb(j,X)}}},U.getShadow=function(){var l={degreeX:q,degreeZ:V,intensity:o,quality:t,type:M,radius:s,bias:X};return 1!==r&&(l.boundExtend=r),l},U.setShadow=function(Q,u){Q=!!Q;var J=U.enable!==Q;U.enable=Q,"object"==typeof u&&(u.intensity!==c&&(o=u.intensity),u.bias!==c&&(X=u.bias),u.radius!==c&&(s=u.radius),u.degreeX!==c&&(q=u.degreeX),u.degreeZ!==c&&(V=u.degreeZ),u.quality!==c&&(t=u.quality),u.type!==c&&M!==u.type&&(M=u.type,J=!0),C=E(t),u.boundExtend!==c&&(r=u.boundExtend)),Q&&U.setupShadowCamera(),J&&Wr(n),n.iv()},U.refresh=function(){this.enable&&(this.setupShadowCamera(),n.iv())},U.tryUpdateBounding=function(M){var V=this.boundingSphere;if(V){var B=(new ab).fromArray($l(M,n.getMat(M))),f=M.getAnchor3d(),E=new Xc;V.containsPoint(E.set(0-f.x,0-f.y,0-f.z).applyMatrix4(B))&&V.containsPoint(E.set(0-f.x,0-f.y,1-f.z).applyMatrix4(B))&&V.containsPoint(E.set(0-f.x,1-f.y,0-f.z).applyMatrix4(B))&&V.containsPoint(E.set(0-f.x,1-f.y,1-f.z).applyMatrix4(B))&&V.containsPoint(E.set(1-f.x,0-f.y,0-f.z).applyMatrix4(B))&&V.containsPoint(E.set(1-f.x,0-f.y,1-f.z).applyMatrix4(B))&&V.containsPoint(E.set(1-f.x,1-f.y,0-f.z).applyMatrix4(B))&&V.containsPoint(E.set(1-f.x,1-f.y,1-f.z).applyMatrix4(B))||U.setupShadowCamera()}},U.createShadow=function(l){l||(l=n._frameState.renderState.directUniforms()),l.shadowMatrix=Y.toArray(),l.shadowMap=K.texture,l.shadowSize=[K.width,K.height],l.shadowIntensity=o,l.shadowBias=X,l.shadowRadius=s},U.genShaderDefine=function(){var O="#define USE_SHADOWMAP\n";return"hard"===M?O+="#define SHADOWMAP_TYPE_PCF\n":"soft"===M&&(O+=n.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),O};var p;U.setupShadowCamera=function(){I||(I=U.boundingSphere=new T.Math.Sphere),l=!1;var J,D,X=n.getBoundingBox(n.dm().toDatas(function(m){return m.s("shadow.cast")&&n.isVisible(m)}));X?(J=new Xc(X.min),D=new Xc(X.max)):(J=new Xc(-256,-256,-256),D=new Xc(256,256,256),l=!0),I.set(J.clone().add(D).multiplyScalar(.5),.5*J.distanceTo(D)*r);var w,a=I.radius,G=n.getBoundingBox(n.dm().toDatas(function(r){return(r.s("shadow.cast")||r.s("shadow.receive"))&&n.isVisible(r)}));if(G){J.copy(G.min),D.copy(G.max);var u=.5*J.distanceTo(D);w=u+Math.min(u,a+I.center.distanceTo(J.add(D).multiplyScalar(.5)))}else w=2*a;p=Xm(Bf(),-a,a,-a,a,w/1e3,w),Y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Y.multiply(F.fromArray(p));var o=Math.tan(-q*Math.PI/180),W=Math.tan(-V*Math.PI/180),S=a/Math.sqrt(o*o+W*W+1),B=new Xc(S*o,S,S*W);F.lookAt(B,new Xc(0,0,0),new Xc(0,1,0)).setPosition(B.add(I.center)),F.getInverse(F),Y.multiply(F)};var k=function(){var d=n.getGL(),X=C,l=C;K.setSize(d,X,l),K.bind(d),d.clear(zm.COLOR_BUFFER_BIT|zm.DEPTH_BUFFER_BIT);var $=n._frameState,s=$.renderState,L=s.directUniforms(),I=s.directAttribs(),h=s.directState();L.projectionMatrix=p;var B=n._viewport;n.setViewport(d,0,0,X,l);var q,e,E,j;for(q=0,e=on.length;e>q;q++)if(E=on[q],!Sr[E].ignore&&(j=n._40Q.get(E))){var o=j.batchIndexMap;U.renderItems(d,L,I,h,j.opaque,o),U.renderItems(d,L,I,h,j.transparent,o),U.renderBatch(d,L,I,h,j.batchModelMap,o)}K.unbind(d),n.setViewport(d,B[0],B[1],B[2],B[3])};U._renderDirect=function(S,V,N,c){N&&N.length&&(V.position=cg(S,n._buffer.vs,N,Z),c?(Yc(S,n._buffer.is,c),nh(S,0,c.length,null,c instanceof Uint32Array?S.UNSIGNED_INT:null)):Ae(S,0,N.length/3))},U.renderShapeModel=function(G,c,R,K){var Q,z,t;if(tj(R))for(z=0,t=R.length;t>z;z++)Q=R[z],Q&&U.renderShapeModel(G,c,Q,K);else em(R)?U.renderShapeModel(G,c,If(K,R),K):Ue(R)&&(R.shape3d?U.renderShapeModel(G,c,R.shape3d,K):U.renderShapeModelImpl(G,c,R))},U.renderShapeModelImpl=function(T,v,M){yc(M),U._renderDirect(T,v,M.vs,M.is),U._renderDirect(T,v,M.top_vs,M.top_is),U._renderDirect(T,v,M.bottom_vs,M.bottom_is),U._renderDirect(T,v,M.from_vs,M.from_is),U._renderDirect(T,v,M.to_vs,M.to_is)},U.renderBatch=function(Z,G,D,T,r){if(!_j(r)&&!n.drawFilter){G.modelViewMatrix=j.identity().premultiply(F).toArray();var m,g,o;for(m in r)o=n.getBatchInfo(m)||je,o.visible!==!1&&o.shadowCast!==!1&&(g=r[m],g.invalidate&&Oj(g),U._renderDirect(Z,D,g.vs32,g.is))}},U.renderItems=function(o,Y,r,N,t,L){var i,A,g,z,M,O=t.length;for(i=0;O>i;i++)if(A=t[i],z=A.ui,g=A.data,!(vk(g)||!g.s("shadow.cast")||g instanceof Bg)&&n.isVisible(g)&&!L[g._id]){var I=z.s("3d.clip.direction");if(I){var P=z.s("3d.clip.percentage");if(0===P)continue;var D=z._formatClipUniforms(I,P,g);Y.uClipPercent=D[1],Y.uClipDirection=D[0]}else Y.uClipDirection=0;M=z.shapeModel||If(z),M||(M=g instanceof T.Node&&!(g instanceof T.Shape)?{vs:ur,is:Zo}:[z.left,z.front,z.right,z.back,z.top,z.bottom]),Y.modelViewMatrix=(z.mat?j.fromArray(z.mat):j.identity()).premultiply(F).toArray(),N.cullFace.enabled=!!g.s("shape3d.reverse.cull"),U.renderShapeModel(o,r,M,z)}}};Al.shaderSrc={vs:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},Al.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"];var sm=function(H){this.gv=H,this.onMouseOver=this.onMouseOver.bind(this),this.mode=sm.Mode.Style,this.type=X["highlight.type"],this.color=X["highlight.color"],this.width=X["highlight.width"],this.glow=X["highlight.glow"],this.strength=X["highlight.strength"]};sm.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Jm.ms_highlight=function(Y){Y.setHighlightMode=function(S){var P;P="selection"===S||"selected"===S?sm.Mode.Selection:"mouseover"===S||"hover"===S?sm.Mode.MouseOver:"style"===S?sm.Mode.Style:sm.Mode.Disable;var O=this.getHighlightMode();this._highlightHelper.mode=P,this.firePropertyChange("highlightMode",O,S)},Y.getHighlightMode=function(){var p=this._highlightHelper.mode;return p===sm.Mode.Selection?"selected":p===sm.Mode.MouseOver?"hover":p===sm.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(i){var E=i.replace(/(^|\.)[a-z]/g,function(K){return K[K.length-1].toUpperCase()});Y["getHighlight"+E]=function(){return this._highlightHelper[i]},Y["setHighlight"+E]=function(L){var x=this._highlightHelper,w=x[i];L!==w&&(x[i]=L,this.firePropertyChange("highlight"+E,w,L))}})},hk(sm,i,{onMouseOver:function(e){L.preventDefault(e);var x=this.gv.getDataAt(e);x!==this.mouseOverData&&(this.mouseOverData=x,this.gv.iv())},setFetchTargetFunc:function(u){this.fetchTargetFunc=u},_42:function(O,y){var R,i,g=this,M=g._mode,P=g.gv;if(!O._renderInfo.reflectDepth&&M!==sm.Mode.Disable){if(M===sm.Mode.Selection?R=P.sm().getSelection().toArray(function(f){return f.s("highlight.visible")}):M===sm.Mode.MouseOver&&g.mouseOverData&&g.mouseOverData.s("highlight.visible")&&(R=[g.mouseOverData]),g.fetchTargetFunc&&(R=g.fetchTargetFunc(R)),M===sm.Mode.Style)R=R||[],i=function(t){if(R.indexOf(t)>=0)return!1;var y=P.getDataHighlightMode(t);return y===!1?!0:y===!0?!1:"selected"===y?P.isSelected(t)?!1:!0:"hover"===y?t===g.mouseOverData?!1:!0:!0};else{if(!R||!R.length)return;i=function(G){return R.indexOf(G)<0?!0:void 0}}var b=P.isVRPresenting(),C=P.getWidth();if(b){var X=P.getWidth;C/=2,P.getWidth=function(){return C};var w=P.getViewport()}var r,c=P.getDevicePixelRatio(),p=Math.floor(C*c),U=Math.floor(P.getHeight()*c);(r=g._renderTarget)?r.setSize(O,p,U):g._renderTarget=r=new Ar.RenderTarget(P,O,p,U);var E="soft"===g.type;if(r.bind(O),E){var n=O.getParameter(O.COLOR_CLEAR_VALUE);fb(O,[1,1,1,1]),O.clear(O.COLOR_BUFFER_BIT),fb(O,n)}else O.clear(O.COLOR_BUFFER_BIT);P.setViewport(O,0,0,p,U),P.drawFilter=i,sf=function(_,I,O,H,K,F){var B=[O?0:1,1,1,1];return F||(ep.for(_).directUniforms().uFixPickReverseColor=B),B},P.renderPickScene(),sf=Sj,P.drawFilter=null,r.unbind(O),wk&&sg(O,y.aPosition),sg(O,y.aNormal),b&&(P.getWidth=X,P.setViewport(O,w[0],w[1],w[2],w[3]));var z=P.getHighlightColor();if(g._lastHighlightColor!==z){var $=ue(g._lastHighlightColor=z);g._highlightColorData=[$[0]/255,$[1]/255,$[2]/255,$[3]/255]}return E?g.renderSoftOutline(O,p,U):g.renderHardOutline(O,p,U),O.useProgram(y=P._prg),wk&&_n(O,y.aPosition),!0}},_assureShader:function(x,B){var K=x._compiledShader[B];return K||(K=x._compiledShader[B]=new Pq.Shader(x,sm.CommonShaderVs,sm[B].fs)),K},renderHardOutline:function(e,b,l){var p=this,s=p.gv,Z=s._postProcessing,U=ep.for(e),m=U.directState();m.blend.enabled=!0,m.depth.enabled=!1,Z.blitScreen(null,p._renderTarget.texture,p._assureShader(e,"HighlightHard"),{textureSize:[b,l],edgeWidth:s.getHighlightWidth(),edgeColor:p._highlightColorData},{clear:!1}),m.blend.enabled=!1,m.depth.enabled=!0},renderSoftOutline:function(R,K,T){var G,s,I,D,V,A=this,q=A.gv,a=q._postProcessing,v=Math.floor(K/2),e=Math.floor(T/2),N=Math.floor(K/4),i=Math.floor(T/4),h=A._downSampleRenderTarget;h?(G=A._edgeDetectionRenderTarget,s=A._blurV2,I=A._blurH2,D=A._blurV4,V=A._blurH4,(h.width!==v||h.height!==e)&&(h.setSize(v,e),G.setSize(v,e),s.setSize(v,e),I.setSize(v,e),D.setSize(N,i),V.setSize(N,i))):(h=A._downSampleRenderTarget=new Ar.RenderTarget(q,R,v,e),G=A._edgeDetectionRenderTarget=new Ar.RenderTarget(q,R,v,e),s=A._blurV2=new Ar.RenderTarget(q,R,v,e),I=A._blurH2=new Ar.RenderTarget(q,R,v,e),D=A._blurV4=new Ar.RenderTarget(q,R,N,i),V=A._blurH4=new Ar.RenderTarget(q,R,N,i));var d=R.getParameter(R.COLOR_CLEAR_VALUE),b=q.getViewport(),F=A.width,L=A.strength,r=A.glow,t=ep.for(R).glState,Z=t.depth,P=t.blend,o=Z.enabled;fb(R,[1,1,1,1]),Z.enabled=!1,P.apply({func:[R.SRC_ALPHA,R.ONE]}),a.blitScreen(h,A._renderTarget.texture),a.blitScreen(G,h.texture,A._assureShader(R,"EdgeDetection"),{texSize:[v,e],color:A._highlightColorData}),a.blitScreen(I,G.texture,A._assureShader(R,"Blur"),{direction:[1,0],texSize:[v,e],radius:F}),a.blitScreen(s,I.texture,A._assureShader(R,"Blur"),{direction:[0,1],texSize:[v,e],radius:F}),a.blitScreen(V,s.texture,A._assureShader(R,"Blur"),{direction:[1,0],texSize:[N,i],radius:F}),a.blitScreen(D,V.texture,A._assureShader(R,"Blur"),{direction:[0,1],texSize:[N,i],radius:F}),P.apply({enabled:!0}),q.setViewport(R,b[0],b[1],b[2],b[3]),a.blitScreen(null,A._renderTarget.texture,A._assureShader(R,"BlendTogether"),{edgeTexture1:s.texture,edgeTexture2:D.texture,edgeStrength:L*F,edgeGlow:r},{clear:!1}),P.apply({func:[R.SRC_ALPHA,R.ONE_MINUS_SRC_ALPHA,R.ONE,R.ONE_MINUS_SRC_ALPHA]}),Z.enabled=o,fb(R,d)}}),i.defineProperties(sm.prototype,{mode:{get:function(){return this._mode},set:function(q){var V=this._mode;if(q!==V){this._mode=q;var W=V===sm.Mode.MouseOver||V===sm.Mode.Style,s=q===sm.Mode.MouseOver||q===sm.Mode.Style;s&&W||(W&&M(this.gv.getView(),"mousemove",this.onMouseOver),s&&n(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),sm.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),sm.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},sm.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},sm.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},sm.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};var df=T.Light=function(){to(df,this),this.s(Lr,X[Lr]),this.s(lg,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};is("Light",Eq,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(S,J,u){df.superClass.onStyleChanged.apply(this,arguments),S===Lr&&this.s("shape3d.color",u)}});var Ap=Ar.FrameState=function(T,q){this.renderState=ep.for(q),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=c,this.projectMatrix=c,this.viewMatrix=c,this.view=T,this.defaultProgram=c,this.pickColorMap=c,this._pvStack=[],this._renderStateStack=[]};Ap.prototype.savePV=function(){var A=this.view;this._pvStack.push([Di(this.projectMatrix),Di(this.viewMatrix),A._18Q,Di(A._7O)])},Ap.prototype.restorePV=function(){var A=this._pvStack.pop();if(A){var u=this.view;this.projectMatrix=u._projectMatrix=A[0],this.viewMatrix=u._viewMatrix=A[1],u._18Q=A[2],u._7O=A[3]}},Ap.prototype.setPV=function(r,A){var z=this.view,u=!1;if(r&&(this.projectMatrix=z._projectMatrix=r,u=!0),A&&(this.viewMatrix=z._viewMatrix=A,z._7O=Di(A),u=!0),u){var B=z.getWidth(),U=z.getHeight(),L=Di(this.projectMatrix);z._18Q=Pf(L,L,A),z._18Q._wh=B/U}},Ap.prototype.syncEnv=function(y){var U=this,_=U.view;U.envmapReflectivity=_._envmapReflectivity||.5,U.cameraPosition=_.getEye(),U.projectMatrix=_._projectMatrix,U.viewMatrix=_._viewMatrix,U.pickColorMap=y,U.picking=_.getGL()._picking},Ap.prototype.setGLState=function(){var R=[0,0,0,0],d=[!0,!0,!0,!0],w=[-1,1],S=[zm.FUNC_ADD,zm.FUNC_ADD],k=[zm.SRC_ALPHA,zm.ONE_MINUS_SRC_ALPHA,zm.ONE,zm.ONE_MINUS_SRC_ALPHA];return function(J,D){var F=this,s=F.renderState.gl,G=F.renderState.glState;G.dither=!1,D?G.color.mask=d:G.color.reset(),G.pixelStore.reset(),G.blend.color=R,G.blend.equation=S,G.blend.func=k,G.cullFace.enabled=!1,G.scissor.enabled=!1,G.depth.enabled=!0,G.depth.clear=1,G.depth.func=s.LEQUAL,G.depth.range=w,G.stencil.enabled=!1,G.polygonOffset.enabled=!1,J?(G.depth.mask=!1,G.blend.enabled=!0):(G.depth.mask=!0,G.blend.enabled=!1)}}(),Ap.prototype.setUniforms=function(U){var H=this,W=H.view,C=H.renderState,w=C.gl,l=C.uniforms;l.uBrightness=1,l.uOpacity=1,l.uPartOpacity=1,l.uPick=H.picking,l.uTexture=!1,l.uBlendTexture=!1,l.uAlphaTest=X.alphaTest,l.uTransparent=!!U,l.uFix=!1,l.uBatchColor=!1,l.uBatchBlend=!1,l.uBatchBrightness=!1,l.uReflectivity=H.envmapReflectivity||.5,l.uCameraPosition=H.cameraPosition,l.uPMatrix=H.projectMatrix,l.uViewMatrix=H.viewMatrix,W.bindEnvMap(w),H.picking||(Zl(W,w,c),W._fogDisabled||(l.uFogColor=W._fogColor,l.uFogDensity=W._fogDensity,l.uFogNear=W._fogNear,l.uFogFar=W._fogFar))},Ap.prototype.drawLayer=function(I){return this.view.renderLayers(I,!0)},Ap.prototype.drawData=function(p,N,$){var w=this.view;if(w.isVisible(p)){var Z=this.renderState,s=Z.uniforms,Q=w.getData3dUI(p);if(Q){var t=Z.gl,d=t._picking,y=w._picking,X=p._pickId;$&&(p._pickId=$),s.uPick=t._picking=w._picking=!!$,s.uTransparent=!!N,Q._42(Z.gl,Z.program,N?U:I),s.uPick=t._picking=d,w._picking=y,p._pickId=X}}};var Dk=Ar.Graph3dView=function(d,P){var r=this;r._webGLVersion=1,r._attributes=P||L.graph3dViewAttributes,r._25I={},r._view=zf(1,r);var A=r._canvas=qs(r._view);n(A,"webglcontextlost",function(N){N.preventDefault(),Wr(r),r._26I&&r._doBufferGC(r._26I,!0),r._26I=Z,r._1o.onContextLost(),r._35O=!0}),n(A,"webglcontextrestored",function(){r._35O=!1,r.iv()}),r._40Q=new sp,r._43Q={},r._44Q=-1,r._batchIndexMap={},r._batchModelMap={},r._wireframeIndexMap={},r._wireframeModelMap={},r._wireframeIndexMapSwap={},r._wireframeModelMapSwap={},r._polylineIndexMap={},r._polylineIndexMap={},r._polylineIndexMapSwap={},r._polylineIndexMapSwap={},r._8O=[],r._7O=Bf(),r._6O=Bf(),r._1o=new up(r),r._30O=new so(r),r._31O=new Oq(r),r._32O=new dh(r),r._raycaster=new Is(r),r._highlightHelper=new sm(r),r._postProcessing=new Ss(r),r._41Q=[],r._42Q=0,r._frameRenderOptionStack=[],Ar.VR?(r.vr=new Ar.VR(r),r.isVREnabled=function(){return this.vr.enable},r.isVRPresenting=function(){return this.vr.isPresenting()}):(r.vr={enable:!1,isPresenting:p},r.isVREnabled=p,r.isVRPresenting=p),r.shadowMap=new Al(r),r._33Q=!0,r._eye=zl(L.graph3dViewEye),r._center=zl(L.graph3dViewCenter),r._up=zl(L.graph3dViewUp),r._lightChanged=!1,r._59O=[],r._spots=[],r._dirs=[],r._frameId=0,r._batchInfoMap={},r.overlappingBox=new _e(r),r.dm(d?d:new Id),r._coreInteractor=new Lj(this),r.setInteractors([new ie(r)]),r._initView()},xn={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},bn=0;We("Graph3dView",i,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",dr,lk,"firstPersonMode",Jg,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",Kg,Wj,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:L.graph3dViewSortable,_editHelperDisabled:L.graph3dViewEditHelperDisabled,_blockSelectable:L.graph3dViewBlockSelectable,_devicePixelRatio:c,_boundaries:c,_moveStep:L.graph3dViewMoveStep,_rotateStep:L.graph3dViewRotateStep,_rotateMinPhi:L.graph3dViewMinPhi===c?L.graph3dViewRotateMinPhi:L.graph3dViewMinPhi,_rotateMaxPhi:L.graph3dViewMaxPhi===c?L.graph3dViewRotateMaxPhi:L.graph3dViewMaxPhi,_pannable:L.graph3dViewPannable,_rotatable:L.graph3dViewRotatable,_walkable:L.graph3dViewWalkable,_resettable:L.graph3dViewResettable,_zoomable:L.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:L.graph3dViewFirstPersonMode,_mouseRoamable:L.graph3dViewMouseRoamable,_gridVisible:L.graph3dViewGridVisible,_gridSize:L.graph3dViewGridSize,_gridGap:L.graph3dViewGridGap,_gridColor:L.graph3dViewGridColor,_originAxisVisible:L.graph3dViewOriginAxisVisible,_centerAxisVisible:L.graph3dViewCenterAxisVisible,_axisXColor:L.graph3dViewAxisXColor,_axisYColor:L.graph3dViewAxisYColor,_axisZColor:L.graph3dViewAxisZColor,_ortho:L.graph3dViewOrtho,_orthoWidth:L.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:L.graph3dViewSyncEyeWithOrthoWidth,_fovy:L.graph3dViewFovy,_near:L.graph3dViewNear,_far:L.graph3dViewFar,_headlightColor:L.graph3dViewHeadlightColor,_headlightIntensity:L.graph3dViewHeadlightIntensity,_headlightRange:L.graph3dViewHeadlightRange,_headlightAmbientIntensity:L.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:L.graph3dViewHeadlightDisabled,_rectSelectable:L.graph3dViewRectSelectable,_rectSelectBackground:L.graph3dViewRectSelectBackground,_editSizeColor:L.graph3dViewEditSizeColor,_autoMakeVisible:Un,_fogDisabled:L.graph3dViewFogDisabled,_fogMode:L.graph3dViewFogMode,_fogDensity:L.graph3dViewFogDensity,_fogColor:L.graph3dViewFogColor,_fogNear:L.graph3dViewFogNear,_fogFar:L.graph3dViewFogFar,_pickerResolution:L.graph3dViewPickerResolution,_dashDisabled:L.graph3dViewDashDisabled,_batchColorDisabled:L.graph3dViewBatchColorDisabled,_batchBlendDisabled:L.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:L.graph3dViewBatchBrightnessDisabled,addCamera:function(V){var f=this,a=i.freeze({id:f._42Q++,priority:V.priority||0,ignoreInPick:!!V.ignoreInPick,render:V.render});V.switch3DStatus&&(f._43Q[a.id]=!0),f._41Q.push(a),f._41Q.sort(function(l,L){return l.priority!==L.priority?l.priority-L.priority:l.id-L.id})},setEye:function(w,J,i){1===arguments.length&&(J=w[1],i=w[2],w=w[0]);var q=this._eye;q[0]=w,q[1]=J,q[2]=i,this.fp(Kg,Z,q)},setCenter:function(B,D,N){1===arguments.length&&(D=B[1],N=B[2],B=B[0]);var f=this._center;f[0]=B,f[1]=D,f[2]=N,this.fp(Wj,Z,f)},setUp:function(M,P,f){1===arguments.length&&(P=M[1],f=M[2],M=M[0]);var v=this._up;v[0]=M,v[1]=P,v[2]=f,this.fp("up",Z,v)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||Bj},isTransparentMask:function(w){return w.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var D=this,O=D._aspect;return O?O:(O=D.getWidth()/D.getHeight(),O||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(y){var C=this,I=C._dataModel,M=C._selectionModel;I!==y&&(I&&(I.ump(C.handleDataModelPropertyChange,C),I.umm(C.handleDataModelChange,C),I.umd(C.handleDataPropertyChange,C),M||I.sm().ums(C.handleSelectionChange,C)),C._dataModel=y,y.mp(C.handleDataModelPropertyChange,C),y.mm(C.handleDataModelChange,C),y.md(C.handleDataPropertyChange,C),M?M._21I(y):y.sm().ms(C.handleSelectionChange,C),C._postProcessing.handleDataModleChange(I,y),C.invalidateAll(!0),C.invalidateLight(),C.fp(vi,I,y),C._canvas.style.background=y.getBackground()||"")},handleDataModelPropertyChange:function(G){if("background"===G.property){var S=this._canvas.style.background,x=G.newValue||"";this._canvas.style.background=x,this.fp("canvasBackground",S,x)}else"envmap"===G.property?this.iv():"cubicEnvmap"===G.property&&(this._lastEnvMap=c,this.iv())},handleDataPropertyChange:function(T){var V=T.data;this.invalidateData(V),vk(V)&&"s:light.type"===T.property?this.invalidateLight():"s:shadow.cast"===T.property&&this.shadowMap.tryUpdateBounding(V)},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(I){var x=this,M=I.property;x.iv(),x._18Q=Z,"eye"===M?x._33Q=!0:"devicePixelRatio"===M?x._42(x.getDevicePixelRatio()):xn[M]&&Wr(x)},_5O:function(I){var f=I._22Q();return f?new f(this,I):Z},getData3dUI:function(O){var T=this._25I[O._id];return T===c&&(T=this._5O(O),this._25I[O._id]=T),T},invalidateAll:function(q){var n=this;if(q){for(var W in n._25I){var y=n._25I[W];y&&y.dispose()}n._25I={},n.iv(),ic(n)}else ic(n),n.dm().each(function(g){n.invalidateData(g)})},invalidateSelection:function(){var m=this;m.sm().each(function(x){m.invalidateData(x)})},invalidateData:function(B){var J=this,r=J.getData3dUI(B);r&&(r.iv(),J.iv()),ic(J,B)},getShape3dText:function(D){return D.getStyle("shape3d.text")||this.getLabel(D)},invalidateBatch:function(n){var A=this,j=A._40Q;j.each(function(R){A._invalidateBatch(R.batchModelMap,R.batchIndexMap,R.polylineModelMap,R.polylineIndexMap,R.wireframeModelMap,R.wireframeIndexMap,n),R.markBatchInvalid()})},_invalidateBatch:function(o,F,g,w,U,j,Y){var x=this,T=o[Y],e=[],$={};if(T){T.ds.forEach(function(f){var O=x.getData3dUI(f);O&&O.iv(),delete F[f._id],e.push(f._id)}),delete o[Y];for(var s,M,I,O,Q,S,y,i,D,r=[U,g],P=[j,w],H=0;H<r.length;H++){var W=r[H],E=P[H];for($={},i=0;i<e.length;i++){var G=E[e[i]];if(G){delete E[e[i]],D=G.batch,s=W[D];var v=G.begin,b=G.size,a=3*v,d=3*b,N=4*v,J=4*b;for(M=s.ds,I=s.vs,O=s.cs,Q=s.ps,S=s.ls,y=G.index,s.invalidate=!0,M[y]=c,y=a;a+d>y;y++)I[y]=c;for(y=N;N+J>y;y++)O[y]=c;for(y=N;N+J>y;y++)Q[y]=c;if(S)for(y=a;a+d>y;y++)S[y]=c;$[D]=!0}}for(D in $){s=W[D],M=s.ds,I=s.vs,O=s.cs,Q=s.ps,S=s.ls;var p=[];for(y=0;y<M.length;y++)M[y]!==c&&p.push(M[y]);if(0===p.length)delete W[D];else{for(s.ds=p,p=[],y=0;y<I.length;y++)I[y]!==c&&p.push(I[y]);for(s.vs=p,p=[],y=0;y<O.length;y++)O[y]!==c&&p.push(O[y]);for(s.cs=p,p=[],y=0;y<Q.length;y++)Q[y]!==c&&p.push(Q[y]);if(s.ps=p,S){for(p=[],y=0;y<S.length;y++)S[y]!==c&&p.push(S[y]);s.ls=p}}}}x.iv()}},handleDataModelChange:function(Y){var R=this,P=Y.kind,L=Y.data;if("add"===P)R.invalidateData(L),El(L)&&L.getEdgeGroup()&&L.getEdgeGroup().eachSiblingEdge(R.invalidateData,R),vk(L)&&R.invalidateLight();else if(P===Ri){var y=L._id,z=R._25I[y];z&&(z.dispose(),delete R._25I[y],R.iv()),L===R._currentSubGraph&&R.setCurrentSubGraph(Z),ic(R,L),vk(L)&&R.invalidateLight()}else P===cr&&(R.invalidateAll(!0),R.setCurrentSubGraph(Z),ic(R),R.invalidateLight())},toCanvas:function(g,F,B){var E=this,t=E.getGL();if(E.validate(),g){var s=t.getParameter(t.COLOR_CLEAR_VALUE);fb(t,g)}E._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var $=E.getWidth()||1,u=E.getHeight()||1,a=new Uint8Array(4*$*u),r=qs(),i=r.getContext("2d");t.readPixels(0,0,$,u,t.RGBA,t.UNSIGNED_BYTE,a),Ud(r,$,u,1);for(var N=i.getImageData(0,0,$,u),X=N.data,K=0;K<X.length;K+=4){var T=K/4,c=G(T/$),V=T-c*$;T=4*((u-1-c)*$+V),X[T]=a[K],X[T+1]=a[K+1],X[T+2]=a[K+2],X[T+3]=a[K+3]
}if(i.putImageData(N,0,0),g&&fb(t,s),E._42(E.getDevicePixelRatio()),F&&B){var U=qs(),I=U.getContext("2d");return Ud(U,F,B,1),L.drawImage(I,r,0,0,F,B),U}return r},toDataURL:function(H,e){var S=this,q=S.getGL();if(S.validate(),H){var Y=q.getParameter(q.COLOR_CLEAR_VALUE);fb(q,H)}S._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var o=S._canvas.toDataURL(e||"image/png",1);return H&&fb(q,Y),S._42(S.getDevicePixelRatio()),o},getGL:function(){var n=this._26I;if(n)return this.acquireProgram(),n;if(!this._35O){var d=this,M=d._canvas,S=d._attributes;if(!S||S.requestWebGL2!==!1)try{n=M.getContext("webgl2",S)||M.getContext("experimental-webgl2",S),n&&(d._webGLVersion=2,d._26I=n)}catch(T){}if(!n)try{n=M.getContext("webgl",S)||M.getContext("experimental-webgl",S)}catch(T){throw new Error("WebGL not supported")}if(!n)throw new Error("WebGL not supported");d._26I=n;var o=d._frameState=new Ap(this,n);d._glExtensions=new m(n),d._glCapabilities=new E(n,d._glExtensions),d._2O={},n._emptyCubeTexture=Sc(n),n._compiledShader={},n._emptyTexture=Jd(n),n._emptyBlendTexture=Jd(n),n._bufPool={},n._id=++bn,o.setGLState(),d._buffer={vs:ml(n),ns:ml(n),is:ml(n),uv:ml(n),batchColor:ml(n),batchBlend:ml(n),batchBrightness:ml(n),lineDistance:ml(n)},d._1O=db(n);var k=d._cube={vs:ml(n),ns:ml(n),is:ml(n),uv:ml(n)};return Xi(n,k.vs,ur),Xi(n,k.ns,ye),Xi(n,k.uv,me),Vg(n,k.is,Zo),d.acquireProgram(),n._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},n}},getGLCapabilities:function(){var V=this.getGL();return V?this._glCapabilities:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<L.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},acquireProgram:function(){var H=this,v=H._26I;if(v){var n=L.getImage(H.getEnvmap()),z=n&&n.tagName?!0:!1,j=H._prg&&H._prg.envMapFlag?!0:!1;if(!H._prg||z!==j){var _=H._prg=v.createProgram();if(!_)return Z;_.envMapFlag=z;var q=H._dirs.length,B=H._spots.length,C=H._59O.length,k=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];q&&k.push("uDirColor","uDirDirection"),B&&k.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),C&&k.push("uPointColor","uPointRange","uPointPosition"),Im||(Kj=Rk(Kj.substring(0,Kj.indexOf("^#"))),wl=Rk(wl),Im=!0);var M=["#define MAX_DIR "+q,"#define MAX_SPOT "+B,"#define MAX_POINT "+C,H._fogDisabled?"":"#define FOG","exp2"===H.getFogMode()?"#define FOG_EXP2":"",H._dashDisabled?"":"#define DASH",z?"#define USE_ENVMAP":"",H.isOrtho()?"#define ORTHOGRAPHIC":"",H._batchColorDisabled?"":"#define BATCHCOLOR",H._batchBlendDisabled?"":"#define BATCHBLEND",H._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",H.shadowMap.enable?H.shadowMap.genShaderDefine():"",""].join("\n"),t=mq(v,_,v.VERTEX_SHADER,Kj.replace("PREFIX",M));v.getShaderParameter(t,v.COMPILE_STATUS)||Ci("COMPILE",v.VERTEX_SHADER,v.getError(),v.getShaderInfoLog(t));var P=mq(v,_,v.FRAGMENT_SHADER,wl.replace("PREFIX",M));if(v.getShaderParameter(P,v.COMPILE_STATUS)||Ci("COMPILE",v.FRAGMENT_SHADER,v.getError(),v.getShaderInfoLog(P)),wk?k.push("aPosition"):(_.aPosition=0,v.bindAttribLocation(_,0,"aPosition")),v.linkProgram(_),!v.getProgramParameter(_,v.LINK_STATUS)){var J=v.getProgramInfoLog(_);return H._prg=Z,J.indexOf("maximum temp register")>=0&&!H._glTempRegisterLimited?(H._glTempRegisterLimited=!0,v.deleteProgram(_),H.acquireProgram()):(Ci("LINK",v.getProgramParameter(_,v.VALIDATE_STATUS),v.getError(),J),v.deleteProgram(_),Z)}k.forEach(function(R){_[R]=/^u/.test(R)?v.getUniformLocation(_,R):v.getAttribLocation(_,R)});var D=H._frameState;D.renderState.program=D.defaultProgram=_,v.deleteShader(t),v.deleteShader(P)}}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(E){var j=E.s("brightness"),i=this.isSelected(E)?E.s("select.brightness"):Z;return j==Z?i:i==Z?j:j*i},getDataHighlightMode:function(S){return S.s("highlight.mode")},bindEnvMap:function(S){var U=this,y=ep.for(S),X=y.directUniforms(),A=U.getEnvmap(),_=L.getImage(A);if(_&&_.tagName){if(A!==U._lastEnvMap){var d={};if(U.dm().isCubicEnvmap()){var b=Vk(_),N=xl(_);if(0===b||0===N)return;var f=b/4,p=N/3,V={top:{x:f,y:0},left:{x:0,y:p},front:{x:f,y:p},right:{x:2*f,y:p},back:{x:3*f,y:p},bottom:{x:f,y:2*p}};["top","left","front","right","back","bottom"].forEach(function(Y){var J=V[Y],s=d[Y]=qs();Ud(s,f,p,1);var T=ms(s);T.drawImage(_,J.x,J.y,f,p,0,0,f,p),T.restore(),d[Y]=L.resizeImagePOT(s,!0)})}else _=L.resizeImagePOT(_,!0);U._envMapTexture&&S.deleteTexture(U._envMapTexture);var J=U._envMapTexture=S.createTexture();S.activeTexture(S.TEXTURE0),S.bindTexture(S.TEXTURE_CUBE_MAP,J),S.texParameteri(S.TEXTURE_CUBE_MAP,S.TEXTURE_MAG_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_CUBE_MAP,S.TEXTURE_MIN_FILTER,S.LINEAR),S.texImage2D(S.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,d.right||_),S.texImage2D(S.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,d.left||_),S.texImage2D(S.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,d.top||_),S.texImage2D(S.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,d.bottom||_),S.texImage2D(S.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,d.front||_),S.texImage2D(S.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,d.back||_),S.bindTexture(S.TEXTURE_CUBE_MAP,S._emptyCubeTexture),U._lastEnvMap=A}X.uEnvMap=U._envMapTexture}},getWireframe:function(F){var f=F.s("wf.visible"),i=F.s("wf.width");return f===!0||i>0&&"selected"===f&&this.isSelected(F)?{color:F.s("wf.color"),width:i,"short":F.s("wf.short"),mat:F.s("wf.mat")}:void 0},_transformPointToViewSpace:function(Z){var F=[Z[0],Z[1],Z[2]];return oi(F,this._viewMatrix),F},_transformDirectionToViewSpace:function(C,e){var V=[C[0],C[1],C[2]];oi(V,this._viewMatrix);var W=e?[e[0],e[1],e[2]]:[0,0,0];oi(W,this._viewMatrix);var n=W[0]-V[0],K=W[1]-V[1],g=W[2]-V[2],h=Math.sqrt(n*n+K*K+g*g);return h?[n/h,K/h,g/h]:[n,K,g]},getWireframeGeometry:function(V){return V.s("wf.geometry")?{color:V.s("wf.color"),width:V.s("wf.width"),mat:V.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(r){return r.s("body.color")},getMat:function(R){return R.getMat?R.getMat():R.s("mat")},getFaceMat:function(Q,U){return Q.getFaceMat?Q.getFaceMat(U):Q.s(U+".mat")},getFaceBlend:function(Z,m){return Z.s(m+".blend")||Z.s("all.blend")},getFaceColor:function(q,p){return q.s(p+".color")||q.s("all.color")},getFaceImage:function(x,O){return x.s(O+".image")||x.s("all.image")},getFaceBlendImage:function(d,P){return d.s(P+".blend.image")||d.s("all.blend.image")},getFaceDiscardSelectable:function(i,f){var E=i.s(f+".discard.selectable");return E==Z?i.s("all.discard.selectable"):E},getFaceUv:function(y,G){return y.s(G+".uv")||y.s("all.uv")},getFaceUvOffset:function(t,L){return t.s(L+".uv.offset")||t.s("all.uv.offset")},getFaceUvScale:function(c,W){return c.s(W+".uv.scale")||c.s("all.uv.scale")},getFaceUvRotation:function(z,Y){return z.s(Y+".uv.rotation")||z.s("all.uv.rotation")},getFaceLight:function(n,u){var j=n.s(u+".light");return j==Z?n.s("all.light"):j},getFaceVisible:function(z,R){var U=z.s(R+".visible");return U==Z?z.s("all.visible"):U},getFaceOpacity:function(N,G){var F=N.s(G+".opacity");return F==Z?N.s("all.opacity"):F},getFaceTransparent:function(D,l){var e=D.s(l+".transparent");return e==Z?D.s("all.transparent"):e},getFaceReverseColor:function(N,L){return N.s(L+".reverse.color")||N.s("all.reverse.color")},getFaceReverseFlip:function(p,M){var G=p.s(M+".reverse.flip");return G==Z?p.s("all.reverse.flip"):G},getFaceReverseCull:function(p,l){var T=p.s(l+".reverse.cull");return T==Z?p.s("all.reverse.cull"):T},getTextureMap:function(){return this._2O},deleteTexture:function(l){var X=this;if(X._2O){var f=X._2O[l];f&&(delete X._2O[l],X.getGL().deleteTexture(f))}},renderPickScene:function(){var x=this.getGL();this.syncRenderState(),this._picking=x._picking=!0,this.renderScene(),this._picking=x._picking=!1},invalidateCachedTexture:function(X){var N=this.getData3dUI(X);N.invalidateCachedTexture(this.getGL()),this.invalidateData(X)},invalidateShape3dCachedImage:function(l){this.invalidateCachedTexture(l)},invalidateCachedGeometry:function(G){var X=this.getData3dUI(G);X.invalidateCachedGeometry(),this.invalidateData(G)},isInteractive:function(D){return D.s("interactive")},getTexture:function(k,t,e){if(!k)return Z;var G=this,U=G.getGL(),j=G._2O[k];if(!j){var s=qh(k),B={};if(!s)return U._emptyTexture;if(t){B.mipmapMaxLevel=t.s("texture.mipmap.max");var _=t.s("texture.wrap");B.clampToEdge="clampToEdge"===_?!0:"repeat"===_?!1:c}if(s.uuid||(s.uuid=T.Math.generateUUID()),s.tagName){if(s.dynamic)return db(U,s,G._1O,B);j=G._2O[k]=db(U,s,c,B)}else{var q,o=t&&(t.s("texture.cache")||t.s("shape3d.image.cache")||s.textureCache),Q=G.isVRPresenting();if(Q&&(t._textureUpdateFrame===U._renderInfo.frame?o=!0:t._textureUpdateFrame=U._renderInfo.frame),o&&(q=G.getData3dUI(t),j=q.getCachedTexture(e),j&&q.interactiveInfo&&j.interactiveInfo&&(q.interactiveInfo[j.interactiveInfo.key]=j.interactiveInfo.info)),!j){var i=U._renderInfo.textureCache;if(o){if(i.time>L.graph3dMaxVectorCacheTime)return G.redraw(),U._emptyTexture;if(!ko(s,t))return U._emptyTexture}var N;t&&(1!==t.s("texture.scale")?N=t.s("texture.scale"):1!==t.s("shape3d.texture.scale")&&(N=t.s("shape3d.texture.scale"))),N||(N=1);var I=t&&(t.s("fixSizeOnScreen")||t.s("shape3d.fixSizeOnScreen")),K=I?U.NEAREST:U.LINEAR;I?"number"==typeof I&&(N*=0>I?1:I):t&&(t.s("vector.dynamic")||t.s("shape3d.vector.dynamic"))&&(q||(q=G.getData3dUI(t)),I=q.getVectorDynamicSize());var X,x,M,P=t&&t.s("shape3d");"billboard"===P?M=t.getTall()/t.getWidth():"plane"===P&&(M=t.getHeight()/t.getWidth());var z=Vk(s,t);if(I){var n;n=o?G._devicePixelRatio||Bj:G.getDevicePixelRatio(),X=I[0]>0?I[0]*n:N*z*n,x=I[1]>0?I[1]*n:N*(M?xl(s,t,G,Math.min(4096,z*M)):xl(s,t))*n}else X=N*z,x=N*(M?xl(s,t,G,Math.min(4096,z*M)):xl(s,t));if(X>=1&&x>=1){var F=0;(o||Q)&&(F=Date.now());var Y=G._glCapabilities.maxTextureSize;X=Math.min(X,Y),x=Math.min(x,Y);var A=ul(X,x);if(!q&&t&&(q=G.getData3dUI(t)),q&&q.interactiveInfo){var b=k;"object"==typeof b&&(b=b.uuid||(b.uuid=T.Math.generateUUID()));var f=q.interactiveInfo[b]={};A.interactiveInfo=f.bodyInfo={compInfos:[],matrix:new Uh,rect:{x:0,y:0,width:X,height:x}}}Ce(A,s,0,0,X,x,t,G),A.interactiveInfo&&(A.interactiveInfo=null),A.restore(),i.count++,i.pixels+=X*x,t?(B.minFilter=Ml(t.s("texture.filter.min")||t.s("texture.filter"))||K,B.magFilter=Ml(t.s("texture.filter.mag")||t.s("texture.filter"))||K):B.minFilter=B.magFilter=K,o||Q?(j=db(U,tq,null,B),q.setCachedTexture(j,e),i.time+=Date.now()-F,f&&(j.interactiveInfo={key:b,info:f}),tq=null):j=db(U,tq,G._1O,B)}}}}return j},redraw:function(){this.iv()},validateImpl:function(){var m=this;if(m._lightChanged){m._lightChanged=!1;var C=[],T=[],O=[];m.dm().each(function(I){if(vk(I)){var L=I.s("light.type");L===Tj?C.push(I):L===Fo?T.push(I):L===as&&O.push(I)}}),(C.length!==m._59O.length||T.length!==m._spots.length||O.length!==m._dirs.length)&&Wr(m),m._59O=C,m._spots=T,m._dirs=O}var V=m.getAspect();V!==m.__cachedAspect__&&(m._updateSkybox({property:"asceptChanged"}),m.__cachedAspect__=V),m._42(),m._1o.iv()},getRenderInfo:function(){var d=this.getGL();return d?d._renderInfo:void 0},getDebugTip:function(){var G=this,w=G.getRenderInfo();if(w){var o=G.getGL()._validBufCount||0,D="Draw Calls: "+w.calls+"<br/>"+"Vertices: "+w.vertices+"<br/>"+"Faces: "+w.faces+"<br/>"+"Lines: "+w.lines+"<br/>"+(w.points?"Points: "+w.points+"<br/>":"")+"Buffers: "+o+"<br/>"+"Cache Models: "+i.keys(sk).length+"<br/>"+"Shape3d Models: "+i.keys(vf).length;if(G.isVRPresenting()&&(D+="<br/>VR fps: "+G.vr.getFps()),w.textureCache){var C=w.textureCache.count;if(D+="<br/>2D Dynamic Textures: "+w.textureCache.count,C>0){var F,j=w.textureCache.pixels;F=j>1e6?Math.round(j/1e6)+"M":j>1e3?Math.round(j/1e3)+"K":Math.round(j),D+="<br/>2D Dynamic pixels: "+F}}return D}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var c=new T.Math.Box3,f=new T.Math.Matrix4;return function(i){var F=i;if(F instanceof T.Data&&(F=this.getData3dUI(F)),!F.mat)return!0;var j=F.getBoundingBox();c.copy(j).applyMatrix4(f.fromArray(F.mat));var m=this.getFrustum();return m.intersectsBox(c)}}(),updateScene:function(){var E=this;E._81O=Z,E.overlappingBox.clear();var l=E._40Q;l.init();var M=E.getGL(),G=E.dm();if(G.isHierarchicalRendering())G.eachByHierarchical(function(T){var C=E.getData3dUI(T);C&&C.update(E,M,l)});else{var a,v,W,D=G.getDatas().getArray(),B=D.length;for(a=0;B>a;a++)v=D[a],W=E.getData3dUI(v),W&&W.update(E,M,l)}l.onUpdated()},_pushFrameRenderOptions:function(f){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=f},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(n){var K=this._currentFrameRenderOptions;return K&&K[n]},renderScene:function(A){function V(e,A){E.setGLState(e,A),E.setUniforms(e),E.renderState.attribs.disable(),R=u.directUniforms(),q=u.directAttribs(),q.disable()}function b(S){for(;k>t;t++){var c=J[t];if(!l||!c.ignoreInPick){if(c.priority>=S)break;(!K._43Q[K._44Q=c.id]||bi[mi.length])&&(c.render(z,K,E),V())}}}var K=this;K._pushFrameRenderOptions(A),K.shadowMap.render(),K._44Q=-1;var q,E=K._frameState,u=E.renderState,s=u.glState,R=u.directUniforms(),z=K.getGL(),T=K._prg;K._projectMatrix=Mb(K),ee(K,K._7O),K._viewMatrix=Di(K._7O),Pf(K._projScreenMatrix=Bf(),K._projectMatrix,K._viewMatrix),E.syncEnv(this._picking?this.pickColorMap:c),u.useProgram(T),V(!1,!0),z.clear(z.DEPTH_BUFFER_BIT);var l=K._picking,J=this._41Q,t=0,k=J.length;if(b(L.cameraPriority.skybox),l){var H=s.color.clear.slice(0);fb(z,[0,0,0,0])}else fb(z,[0,0,0,0]),s.blend.enabled=!1,s.depth.enabled=!1,s.depth.mask=!1,K.drawSky(z,T),K.drawReflectors(z)&&(K._projectMatrix=Mb(K),ee(K,K._7O),K._viewMatrix=Di(K._7O),E.syncEnv(),V()),s.blend.enabled=!1,s.depth.enabled=!0,s.depth.mask=!0,R.uTransparent=!1,K._getFrameRenderOptions("renderGrid")!==!1&&K._31O._42(z,T);if(!z.textureBatch||bi[(ONE_FRAME_TIME-6)/2]){!l&&K.shadowMap.enable&&K.shadowMap.createShadow(R);for(var r=0,o=on.length;o>r;r++){var M=on[r],B=Sr[M];if(!B.ignore){var f=B.priority;b(f),this.renderLayer(M)}}b(L.cameraPriority.infinity),s.depth.enabled=!1,R.uTransparent=!1,R.shadowReceive=!1,l?K.drawFilter||K._30O._42(z,T):(K._highlightHelper._42(z,T),this._renderAxisAndEditHelper(K._getFrameRenderOptions("renderAxis")!==!1,K._getFrameRenderOptions("renderEdit")!==!1),s.blend.enabled=!1,s.depth.mask=!0),s.depth.enabled=!0,l&&fb(z,H),Xi(z,Z),Vg(z,Z),K._44Q=-1,K._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(X,O){if(X||O){var m=this,b=m.getGL(),v=m._prg,R=m._frameState,M=R.renderState,V=M.glState,L=M.directUniforms();R.renderState.attribs.disable(),V.depth.enabled=!1,L.uTransparent=!1,L.shadowReceive=!1,V.blend.enabled=!1,V.depth.mask=!0,L.uPick=m._picking,X&&m._32O._42(b,v),O&&m._30O._42(b,v),Xi(b,Z),Vg(b,Z)}},renderLayers:function(r,f){f&&(r=Nj(r));for(var q=0,I=r.length;I>q;q++)this.renderLayer(r[q])},addRenderLayerListener:function(F,o,b){var $=this;$._renderLayerNotifier||($._renderLayerNotifier=new wq),$._renderLayerNotifier.add(F,o,b)},removeRenderLayerListener:function(i,m){this._renderLayerNotifier&&this._renderLayerNotifier.remove(i,m)},fireRenderLayerEvent:function(o,c){var s=this._renderLayerNotifier;s&&s.fire({layer:o,phase:c})},renderLayer:function(J){var h=this,Y=h._picking,r=h._40Q.get(J);if(r){h.fireRenderLayerEvent(J,"prepare");var P=h.getGL(),R=Sr[J],o=h._frameState,v=o.renderState,A=v.glState,b=v.directUniforms();!Y&&h.isSortable()&&r.sort(h._sortFunc,h._projScreenMatrix);var O,e,_,u=r.opaque,M=r.transparent,B=r.batchModelMap,l=r.polylineModelMap,H=r.wireframeModelMap,P=h.getGL(),a=h._prg;Y||(A.blend.enabled=!1,A.depth.enabled=!0,A.depth.mask=!0),b.uTransparent=!1,R.clearDepth!==!1&&P.clear(P.DEPTH_BUFFER_BIT);var n=this.drawFilter;if(n)for(_=u,O=0,e=_.length;e>O;O++)n(_[O].data)!==!0&&_[O].ui._42(P,a,I);else{for(_=u,O=0,e=_.length;e>O;O++)_[O].ui._42(P,a,I);if(Y)for(_=M,O=0,e=_.length;e>O;O++)_[O].ui._46Q(P);$m(h,B),Qb(h,l),Qb(h,H)}if(Y||(A.blend.enabled=!0,A.depth.mask=!1),h._45Q=b.uTransparent=!0,n)for(_=M,O=0,e=_.length;e>O;O++)n(_[O].data)!==!0&&_[O].ui._42(P,a,U);else{for(_=M,O=0,e=_.length;e>O;O++)_[O].ui._42(P,a,U);$m(h,B,null,!0),Qb(h,l,null,!0),Qb(h,H,null,!0)}h._45Q=null,h.fireRenderLayerEvent(J,"post")}},_42:function(_,C){var r=this;if(!r._35O&&(!rm||bi(rm))){var w=r.getWidth(),b=r.getHeight();if(w&&b){var H=r.getGL();if(H){var s,c=r._canvas;if(_?s=!0:_=r.getDevicePixelRatio(),!r._picking&&(s||w!==c.clientWidth||b!==c.clientHeight)){Ud(c,w,b,_);var $=_;w&&Math.abs(H.drawingBufferWidth-w*_)>1&&($=Math.min($,H.drawingBufferWidth/w)),b&&Math.abs(H.drawingBufferHeight-b*_)>1&&($=Math.min($,H.drawingBufferHeight/b)),$!==_&&(r.setDevicePixelRatio(_=$),Ud(c,w,b,_)),r._18Q=null}H.clear(H.COLOR_BUFFER_BIT);var e=H._renderInfo;e.calls=0,e.vertices=0,e.faces=0,e.lines=0,e.points=0,e.textureCache={time:0,count:0,pixels:0},e.frame=++r._frameId,e.cacheTimeCost=0,e.reflectDepth=0,w*=_,b*=_,this.syncRenderState();do{if(r.isVREnabled()&&r.vr.render(H,w,b,C))break;if(r.updateScene(),r._postProcessing.render(H,w,b,C))break;r.setViewport(H,0,0,w,b),r.renderScene(C)}while(!1);r._33Q=!1,r.countFrame(),r._doBufferGC(H)}}}},syncRenderState:function(){var I,w;(I=this._frameState)&&(w=I.renderState)&&w.syncLoss()},drawReflectors:function(N){N._renderInfo.reflectDepth++;var t,n,r,L=this,_=L._dataModel.getReflectors(),b=!1;for(t in _)n=_[t],L.isVisible(n)&&(r=L.getData3dUI(n),r&&r.drawReflector(N)&&(b=!0));return N._renderInfo.reflectDepth--,b},isReflecting:function(y){return y._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(F,A){return this._postProcessing.enableModule(F,A)},getPostProcessingModule:function(Q){return this._postProcessing.getModule(Q)},getPostProcessingValue:function(n,a){var D=this._postProcessing.getModule(n);return D?D[a]:c},setPostProcessingValue:function(W,b,A){var t=this.getPostProcessingValue(W,b),k=this._postProcessing.getModule(W);k&&t!==A&&("enable"===b?this.enablePostProcessing(W,A):k[b]=A,this.firePropertyChange("postProcessing."+W+"."+b,t,A))},setViewport:function(y,X,Y,N,v){this._viewport=[X,Y,N,v],ep.for(y).directState().viewport=this._viewport},getRenderState:function(){return ep.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(O){this._bufferGCInterval=O},_doBufferGC:function(H,u){var S,W,J=H._bufPool,M=0,O=0,f=H._renderInfo.frame,v=this._bufferGCInterval||10;for(S in J)M++,W=J[S],W&&(u||f-W._fid>v?(H.deleteBuffer(W._buf),W._buf=null,J[S]=null):O++);if(M/2>O&&M>128){var _={};for(S in J)J[S]&&(_[S]=J[S]);H._bufPool=_}H._validBufCount=O},_swapLineMap:function(){var D=this;Tk=D._polylineModelMap,D._polylineModelMap=D._polylineModelMapSwap,D._polylineModelMapSwap=Tk,Tk=D._wireframeModelMap,D._wireframeModelMap=D._wireframeModelMapSwap,D._wireframeModelMapSwap=Tk,Tk=D._polylineIndexMap,D._polylineIndexMap=D._polylineIndexMapSwap,D._polylineIndexMapSwap=Tk,Tk=D._wireframeIndexMap,D._wireframeIndexMap=D._wireframeIndexMapSwap,D._wireframeIndexMapSwap=Tk},_updateSkybox:function(Y){if(this._skybox&&Y){var t=Y.property,i=!1,A=this._skybox;if("eye"===t||"forceUpdate"===t){var M=this._eye;A.p3(M[0],M[1],M[2]),i=!0}if("near"===t||"far"===t||"forceUpdate"===t||"asceptChanged"===t){var E=A.__cachedS3__;E||(E=A.__cachedS3__=A.getFinalScale3d());var b=Math.sqrt(3),g=1/0,f=-1/0;E.forEach(function(N){N/=2,g=S(N,g),f=$(N,f)}),f*=b;var H=this._near,I=this._far,z=Math.tan(this.getFovy()/2)*H,y=this.getAspect()*z,F=1.1*Math.sqrt(y*y+z*z+H*H),l=1;if(F>g)l=F/g;else if(f>=I){var O=I*I/(H+I);l=O/f}if(1!==l){A.__updatingSkybox__=!0;var X=A.getScale3d().map(function(p,L){return p*l*E[L]});A.s3(X),A.setScale3d(1,1,1),i=!0,delete A.__updatingSkybox__}}i&&this.invalidateData(A)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(z){return this.setSkybox(z)},getSkybox:function(){return this._skybox},setSkybox:function(Z){var r=this._skybox;if(r===Z)return Z&&this._updateSkybox({property:"forceUpdate"}),void 0;if(r&&(this._skyboxStyleMap&&r.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&r.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&r.p3(this._skyboxP3),this._skyboxP3=null),this._skybox=Z,this.ump(this._updateSkybox,this),Z){Z.dm()&&Z.dm().remove(Z),this._skyboxStyleMap=T.Default.clone(Z.getStyleMap()),this._skyboxAnchor3d=Z.getAnchor3d(),Z.setAnchor3d(.5,.5,.5),this._skyboxP3=Z.p3().slice(0),Z.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var V=Z.onPropertyChanged;Z.onPropertyChanged=function(P){V.call(Z,P),!Z.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(P.property)>=0&&(Z.__cachedS3__=c)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",r,Z)},drawSky:function(i,I){var S=this,T=S._skybox;if(T){var w=ep.for(i).directUniforms(),z=S._headlightIntensity,j=sc(S._headlightColor),I=S._prg;1!==z&&(j=[j[0]*z,j[1]*z,j[2]*z]),w.uHeadlightColor=[j[0],j[1],j[2],1];var Z=S.getData3dUI(T);if(Z){var E=S.isOrtho(),L=E||this._computedProjectMatrix;if(L){var v=S._projectMatrix;E&&(S._ortho=!1),w.uPMatrix=S._projectMatrix=Mb(S,!0)}var c=T.p3(),h=this._eye;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2])&&(T._position.x=h[0],T._54O=h[1],T._position.y=h[2]),Z.validate(),Z._42(i,I,a),L&&(E&&(S._ortho=!0),w.uPMatrix=S._projectMatrix=v)}i.clear(i.DEPTH_BUFFER_BIT),w.uHeadlightColor=[j[0],j[1],j[2],S._headlightDisabled?1:0]}},getLogicalPoint:function(E){return we(E,this._canvas)},isRectOverlapping:function(h){var e=this.getData3dUI(h);return e._rectOverlapping},getHitFaceInfo:function(t){t.target&&(t=this.lp(t));var y=this.getDataInfoAt(t);if(y){var F=this.intersectObject(t,y.data);if(F)return{data:y.data,face:F.part}}return Z},unproject:function(E,z){var q=this,F=q.getWidth(),O=q.getHeight(),Y=E.target?q.lp(E):E,L=Y.x-F/2,A=Y.y-O/2,r=2*(L/F),$=2*(-1*A/O);z=z||0;var b=Bf(),J=Mb(q),Z=ee(q);Pf(b,J,Z),ce(b);var T=Fk([r,$,z,1],b);return[T[0]/T[3],T[1]/T[3],T[2]/T[3]]},getDataAt:function(n){var Q=this.getDataInfoAt(n);return Q?Q.data:Z},getDataInfoAt:function(S,v,y){return S.target&&(S=this.lp(S)),this._1o.get(fn(S.x,S.y,v),!0,y)},getDatasInRect:function(T,W){return this._1o.get(T,!1,W)},setEditable:function(J){var Q=this,f=Q._editable;Q._editable=J,this.fp(ss,f,J)},isEditable:function(P){var d=this;return P?d._editable?lm(P)?P.s("3d.editable")?d._editableFunc?d._editableFunc(P):!0:!1:!1:!1:d._editable},isSelectable:function(k){return k.s("3d.selectable")&&this.sm().isSelectable(k)},isMovable:function(k){var D=this;return El(k)&&k.getStyle(Qe)!==Eb?!1:k.s("3d.movable")?D._movableFunc?D._movableFunc(k):!0:!1},isSizeEditable:function(p){return lm(p)?this._sizeEditableFunc?this._sizeEditableFunc(p):!0:!1},isRotationEditable:function(P){return lm(P)&&P.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(P):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(t){this.setZoom(Yk,t)},zoomOut:function(b){this.setZoom(1/Yk,b)},setZoom:function(){var S=new Xc,X=new Xc,Q=new Xc,g=new Xc;return function(K,t){if(1!==K){var x=this;x._14o&&x._14o.stop(!0);var I,u=1/K;S.copy(x.getCenter()),X.copy(x.getEye());var $=x._ortho;if($){if(I=x._orthoWidth,I<x._moveStep&&K>1)return}else if(S.distanceTo(X)<x._moveStep&&1>u)return;var o=!1;return x._zoomToCenter===!1&&x._lastZoomLP&&(Q.copy(X).sub(S).normalize(),x._81O=null,g.copy(x.getHitPosition(x._lastZoomLP,S.toArray(),Q.toArray())),o=!0,x._lastZoomHit=g),(t=Ej(t))?(t.action=function(a){x.fi({kind:x._zooming?"betweenZoom":"beginZoom"}),x._zooming=1;var M=(u-1)*a+1;$&&x.setOrthoWidth(I*M),o?(x.setEye(Q.lerpVectors(g,X,M).toArray()),x.setCenter(Q.lerpVectors(g,S,M).toArray())):$||x.setEye(Q.lerpVectors(S,X,M).toArray())},t._37o=function(){delete x._14o,delete x._zooming,x.fi({kind:"endZoom"}),x.onZoomEnded()},x._14o=uo(t)):($&&x.setOrthoWidth(I*u),o?(x.setEye(Q.lerpVectors(g,X,u).toArray()),x.setCenter(Q.lerpVectors(g,S,u).toArray())):$||x.setEye(Q.lerpVectors(S,X,u).toArray()),void 0)}}}(),setOrthoZoom:function(s,P){return this.setZoom(s,P)},getPositionInfo:function(z){var d=this,S=d._eye,r=d._center,O=d.getAspect(),F=z?Wh($i(r,S,!0),$i(z,S)):Yf(S,r);if(d._ortho){var o=d._orthoWidth;return{length:F,height:o/O,width:o}}var B=2*Lp(d._fovy/2)*F;return{length:F,height:B,width:B*O}},getCenterInfo:function(){var N=this;return N._81O||(N._81O=N.getPositionInfo()),zl(N._81O)},rotate:function(m,G,E,W){var I=this;if(m||G){W==Z&&(W=I._firstPersonMode),I._88O&&I._88O.stop(!0);var q=I._center,F=I._eye,J=I.getCenterInfo().length,L=W?q:F,t=W?F:q,s=$i(L,t),Q=Nh(s[0],s[2]),X=Nh(V(s[0]*s[0]+s[2]*s[2]),s[1]),U=W?Wj:Kg;return W&&(G=-G),(E=Ej(E))?(E.action=function(j){I.fi({kind:I._rotating?"betweenRotate":"beginRotate"}),I._rotating=1;var D=Q+m*j,F=X+G*j;F=W?v-Nf(I,v-F):Nf(I,F),s[0]=J*z(F)*z(D),s[1]=J*K(F),s[2]=J*z(F)*K(D),L[0]=t[0]+s[0],L[1]=t[1]+s[1],L[2]=t[2]+s[2],I.fp(U,Z,L)},E._37o=function(){delete I._88O,delete I._rotating,I.fi({kind:"endRotate"}),I.onRotateEnded()},I._88O=uo(E)):(Q+=m,X+=G,X=W?v-Nf(I,v-X):Nf(I,X),s[0]=J*z(X)*z(Q),s[1]=J*K(X),s[2]=J*z(X)*K(Q),L[0]=t[0]+s[0],L[1]=t[1]+s[1],L[2]=t[2]+s[2],I.fp(U,Z,L),void 0)}},pan:function(J,n,M,s){if(J||n){var i=this;s==Z&&(s=i._firstPersonMode),i._89O&&i._89O.stop(!0);var h=ee(i),r=[h[0]*J,h[4]*J,h[8]*J],T=[h[1]*n,h[5]*n,h[9]*n],G=r[0]+T[0],B=r[1]+T[1],$=r[2]+T[2],U=i._center,e=i._eye;if(s){var c=br(i.getBoundaries(),e[0],e[2],e[0]+G,e[2]+$,V(G*G+$*$));G=c[0],$=c[1]}if(M=Ej(M)){var O=zl(e),K=zl(U);return M.action=function(l){i.fi({kind:i._panning?"betweenPan":"beginPan"}),i._panning=1,U[0]=K[0]+G*l,U[1]=K[1]+B*l,U[2]=K[2]+$*l,e[0]=O[0]+G*l,e[1]=O[1]+B*l,e[2]=O[2]+$*l,i.fp(Kg,Z,e),i.fp(Wj,Z,U)},M._37o=function(){delete i._89O,delete i._panning,i.fi({kind:"endPan"}),i.onPanEnded()},i._89O=uo(M)}U[0]+=G,U[1]+=B,U[2]+=$,e[0]+=G,e[1]+=B,e[2]+=$,i.fp(Kg,Z,e),i.fp(Wj,Z,U)}},walk:function(y,J,Y){if(y){var i=this;Y==Z&&(Y=i._firstPersonMode),i._90O&&i._90O.stop(!0);var Q=i._center,V=i._eye,a=$i(Q,V,!0);if(Y){var F=br(i.getBoundaries(),V[0],V[2],V[0]+a[0]*y,V[2]+a[2]*y,C(y));if(y=Yf(F),!y)return;a=[F[0]/y,0,F[1]/y]}if(J=Ej(J)){var n=zl(V),R=zl(Q);return J.action=function(M){i.fi({kind:i._walking?"betweenWalk":"beginWalk"}),i._walking=1;var I=y*M;V[0]=n[0]+a[0]*I,V[1]=n[1]+a[1]*I,V[2]=n[2]+a[2]*I,Q[0]=R[0]+a[0]*I,Q[1]=R[1]+a[1]*I,Q[2]=R[2]+a[2]*I,i.fp(Kg,Z,V),i.fp(Wj,Z,Q)},J._37o=function(){delete i._90O,delete i._walking,i.fi({kind:"endWalk"}),i.onWalkEnded()},i._90O=uo(J)}V[0]+=a[0]*y,V[1]+=a[1]*y,V[2]+=a[2]*y,Q[0]+=a[0]*y,Q[1]+=a[1]*y,Q[2]+=a[2]*y,i.fp(Kg,Z,V),i.fp(Wj,Z,Q)}},handleScroll:function(H,N){_m(H);var v=this,M=v._moveStep,W=v.getDataInfoAt(H);if(W){var D=W.data;if(D&&v.isInteractive(D)){var E=v.intersectObject(H,D);if(E){var r=E.part,z=qh(D.s(r+".image")||D.s("shape3d."+r+".image")||D.s("all.image")||D.s("shape3d.image"));if(z&&sn(z.scrollable,D,v))return}}}return v.isFirstPersonMode()?(v.isPannable()&&v.pan(0,N>0?M:-M),void 0):(v.isZoomable()&&(v._lastZoomLP=v.lp(H),v.setZoom(0>N?1/ys:ys),v._lastZoomLP=v._lastZoomHit=null),void 0)},handlePinch:function(U,j){if(this.isZoomable()){if(Math.abs(U-j)<L.pinchZoomThreshold)return;this.setZoom(j>U?1/yl:yl)}},reset:function(x){this.setUp(L.graph3dViewUp),this.moveCamera(L.graph3dViewEye,L.graph3dViewCenter,x)},moveSelection:function(t,A,N){var H=this;H.dm().beginTransaction(),Lb(this.sm().toSelection(this.isMovable,this),t,A,N),H.dm().endTransaction()},getMoveMode:function(w,I){var g=I.s("3d.move.mode");if(g)return g;var _="88",q="89",R="90";return Ji(w)||Pm[_]&&Pm[q]&&Pm[R]?"xyz":Pm[_]&&Pm[q]?"xy":Pm[_]&&Pm[R]?"xz":Pm[q]&&Pm[R]?"yz":Pm[_]?"x":Pm[q]?"y":Pm[R]?"z":"xz"},handleTick:function(){var L=this,M=!1,g=L._moveStep,S=g,j=!1,B=!0,Z=L._rotateStep*(B?-1:1);if(L.isWalkable()||(S=0),L.isPannable()||(g=0),L.isRotatable()||(Z=0),L._32Q){var v=(Ug()-L._32Q)/50;S*=v,g*=v,Z*=v}L._31Q&&(al(L._31Q),delete L._31Q,delete L._32Q),uc()&&(M=!0,L.pan(-g,0,j,B)),Hb()&&(M=!0,L.pan(g,0,j,B)),Nm()&&(M=!0,Ji()?L.pan(0,g,j,B):L.walk(S,j,B)),eh()&&(M=!0,Ji()?L.pan(0,-g,j,B):L.walk(-S,j,B)),uj()&&(M=!0,L.rotate(-Z,0,j,B)),Wn()&&(M=!0,L.rotate(Z,0,j,B)),np()&&(M=!0,L.rotate(0,-Z/2,j,B)),ob()&&(M=!0,L.rotate(0,Z/2,j,B)),M&&(L._32Q=Ug(),L._31Q=jf(L.handleTick,L))},handleKeyDown:function(j){var I=this;!ig(j)&&Bo[j.keyCode]?I.handleTick():Vi(j)?I.selectAll():Tr(j)?I.handleDelete(j):Zh(j)&&this.isResettable()&&I.reset()},checkDoubleClickOnNote:function(G,w,t){var k=this;if(t===Bl){if(w.s("note.toggleable"))return w.s(eq,!w.s(eq)),k.fi({kind:"toggleNote",event:G,data:w,part:t}),!0}else if(t===re&&w.s("note2.toggleable"))return w.s(Xq,!w.s(Xq)),k.fi({kind:"toggleNote2",event:G,data:w,part:t}),!0;return!1},checkDoubleClickOnRotation:function(u,X,S){return S===Cs?(X.setRotationX(0),!0):S===Nd?(X.setRotationY(0),!0):S===Ds?(X.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(m){var g=this;if(g.isOrtho())return g.getWidth()/g.getOrthoWidth();var O=g.getCenter(),n=g.getHeight(),d=g.getEye(),L=[O[0]-d[0],O[1]-d[1],O[2]-d[2]],c=[m[0]-d[0],m[1]-d[1],m[2]-d[2]],u=Math.sqrt(L[0]*L[0]+L[1]*L[1]+L[2]*L[2]),K=1/Math.tan(g.getFovy()/2);return n*u*K/(c[0]*L[0]+c[1]*L[1]+c[2]*L[2])},inViewSpace:function(u){var y,s=this,Z=s._transformPointToViewSpace(u),j=s.getAspect(),n=s.getNear(),O=s.getFar();return-Z[2]<n||-Z[2]>O?!1:s.isOrtho()?(y=s.getOrthoWidth()/2,Math.abs(Z[0])<=y&&Math.abs(Z[1]*j)<=y):(y=Math.sqrt(Z[0]*Z[0]+Z[1]*Z[1]+Z[2]*Z[2])*Math.tan(s.getFovy()/2),Math.abs(Z[1]<=y)&&Math.abs(Z[0])<=y*j)},getPVMatrix:function(){var O,v=this;return(O=v._18Q)||(O=Mb(v),v._18Q=Pf(O,O,ee(v)),v._18Q._wh=v.getWidth()/2/v.getHeight()),O},getFrustum:function(){var C=new ab,i=new Pj,U=new Array(16);return function(){for(var A=this.getPVMatrix(),c=!1,q=0;16>q;q++)A[q]!==U[q]&&(c=!0,U[q]=A[q]);return c&&i.setFromMatrix(C.fromArray(A)),i}}(),toViewPosition:function($){var V=this,i=V.getWidth()/2,o=V.getHeight()/2,v=V.getPVMatrix();return $=Fk([$[0],$[1],$[2],1],v),{x:i+i*$[0]/$[3],y:o-o*$[1]/$[3],z:$[2]/$[3]}},getHitPosition:function(B,x,E){var R=this,J=R.getWidth(),f=R.getHeight(),s=B.target?R.lp(B):B,V=s.x-J/2,Y=s.y-f/2,a=R.getCenterInfo(),c=ee(R);x=x?x:[0,0,0],E=E?E:[0,1,0],V=V/J*a.width,Y=-1*Y/f*a.height;var X=[c[0]*V,c[4]*V,c[8]*V],C=[c[1]*Y,c[5]*Y,c[9]*Y],z=[X[0]+C[0],X[1]+C[1],X[2]+C[2]],W=R.getCenter(),k=pn(R,x,E,[z[0]+W[0],z[1]+W[1],z[2]+W[2]]);return k?k:[0,0,0]},intersectObject:function(l,h){return this._raycaster.intersectObject(l,h)},intersectObjects:function(p,i,Z){return this._raycaster.intersectObjects(p,i,Z)},getLineLength:function(E){this.validate();var $=this.getData3dUI(E);if($&&$.getCache){var x=$.getCache();if(x)return x[x.length-1].length}return 0},getLineOffset:function(h,M){var s=this.getData3dUI(h);if(s&&s.getCache){var H=s.getCache();if(H){var c=Pk(H,M);
if(!h.r3)return c;var K=h.r3();if(0===K[0]&&0===K[1]&&0===K[2])return c;var i=new Xc(h.p3()),S=new Xc(c.point).sub(i),E=new Xc(c.tangent).add(S),n=(new oc).setFromEuler(new Lc(K,h.getRotationMode(),!0));return S.applyQuaternion(n),E.applyQuaternion(n),{point:S.add(i),tangent:E.sub(S).normalize()}}}return Z},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(h,R,N){var s=this,q=s.getEye();q=[q[0],q[1],q[2]];var F=s.getCenter();if(F=[F[0],F[1],F[2]],h||(h=q),R||(R=F),s._flyAnim&&s._flyAnim.stop(!0),N=Ej(N),!N)return s.setEye(h[0],h[1],h[2]),s.setCenter(R[0],R[1],R[2]),delete s._flyAnim,!0;var Z=[h[0]-q[0],h[1]-q[1],h[2]-q[2]],b=[R[0]-F[0],R[1]-F[1],R[2]-F[2]];return N.action=function(t){s.setCenter(F[0]+b[0]*t,F[1]+b[1]*t,F[2]+b[2]*t),s.setEye(q[0]+Z[0]*t,q[1]+Z[1]*t,q[2]+Z[2]*t)},N._37o=function(){delete s._flyAnim},s._flyAnim=uo(N)},flyTo:function(){function G(U,b,n){if(n instanceof T.Node){z.fromArray($l(n,b.getMat(n)));var o=n.getAnchor3d();U.push((new Xc).set(0-o.x,0-o.y,0-o.z).applyMatrix4(z)),U.push((new Xc).set(0-o.x,0-o.y,1-o.z).applyMatrix4(z)),U.push((new Xc).set(0-o.x,1-o.y,0-o.z).applyMatrix4(z)),U.push((new Xc).set(0-o.x,1-o.y,1-o.z).applyMatrix4(z)),U.push((new Xc).set(1-o.x,0-o.y,0-o.z).applyMatrix4(z)),U.push((new Xc).set(1-o.x,0-o.y,1-o.z).applyMatrix4(z)),U.push((new Xc).set(1-o.x,1-o.y,0-o.z).applyMatrix4(z)),U.push((new Xc).set(1-o.x,1-o.y,1-o.z).applyMatrix4(z))}}var W=new Xc,S=new Xc,V=new Xc,K=new Xc,z=new ab,i=new T.Math.Quaternion,R=new Lc,Y=new Ek;return function(C,q,$){var A=this;if($!==c)q={animation:q,ratio:$};else{var k=typeof q;("boolean"===k||"object"===k&&q.duration)&&(q={animation:q})}q=q||{},W.fromArray(A.getEye()),S.fromArray(A.getCenter());var U,n,w=[],h=q.center,j=q.distance===c;if(h&&V.fromArray(h),C||(C=A.dm().getDatas()),1===C.length&&(C=Nn(C)?C.get(0):C[0]),C instanceof T.Node)h||V.fromArray(C.p3()),j&&(G(w,A,C),U=w.length);else{if(!C.length)return;if((j||!h)&&(w=[],C.forEach(function(W){G(w,A,W)}),U=w.length,!U))return;h||(Y.setFromPoints(w),V.copy(Y.min).add(Y.max).multiplyScalar(.5))}if(A.setCenter(V.x,V.y,V.z),K.subVectors(W,S),q.direction||q.worldDirection){!q.worldDirection&&C instanceof T.Node?i.setFromEuler(R.set(C.r3(),C.getRotationMode(),!0)):i.set(0,0,0,1);var m=K.length();K.fromArray(q.worldDirection||q.direction).applyQuaternion(i).setLength(m)}var B=0;if(j){var y,x,v,$=q.ratio||.8,I=q.xRatio||$,r=q.yRatio||$;if(A.isOrtho()){var e=-1/0;for(A._eye[0]=K.x+V.x,A._eye[1]=K.y+V.y,A._eye[2]=K.z+V.z,y=Mb(A),Pf(y,y,ee(A)),n=0;U>n;n++)v=w[n],x=Fk([v.x,v.y,v.z,1],y),e=Math.max(e,Math.max(Math.abs(x[0])/I,Math.abs(x[1])/r));B=A.getOrthoWidth()*e,K.add(V)}else{for(var d,g,p=A.getNear(),F=10;F--;){for(A._eye[0]=K.x+V.x,A._eye[1]=K.y+V.y,A._eye[2]=K.z+V.z,y=Mb(A),Pf(y,y,ee(A)),d=!0,g=-1/0,n=0;U>n;n++){if(v=w[n],x=Fk([v.x,v.y,v.z,1],y),x[3]<p&&F){K.multiplyScalar(2),d=!1;break}g=Math.max(g,Math.max(Math.abs(x[0])/I,Math.abs(x[1])/r)-x[3])}if(d)break}K.setLength(g+K.length()).add(V)}}else K.setLength(q.distance).add(V);A._flyAnim&&A._flyAnim.stop(!0);var X=Ej(q.animation);if(X){A.setEye(W.x,W.y,W.z),A.setCenter(S.x,S.y,S.z);var P=(new Xc).subVectors(K,W),u=(new Xc).subVectors(V,S);if(B)var M=A.getOrthoWidth();var t=new Xc,Z=new Xc,f=X.action,O=X._37o,N=W.clone(),o=S.clone();return X.action=function(Y,T){t.copy(N).addScaledVector(P,Y),Z.copy(o).addScaledVector(u,Y),A.setCenter(Z.x,Z.y,Z.z),A.setEye(t.x,t.y,t.z),B&&A.setOrthoWidth((B-M)*Y+M),f&&f(Y,T)},X._37o=function(){delete A._flyAnim,O&&O()},{lastEye:W,lastCenter:S,eye:K,center:V,orthoWidth:B,animation:A._flyAnim=uo(X)}}return A.setEye(K.x,K.y,K.z),B&&A.setOrthoWidth(B),delete A._flyAnim,{lastEye:W,lastCenter:S,eye:K,center:V,orthoWidth:B}}}(),getBoundingBox:function(){function F(P,G,e){r.fromArray($l(e,G.getMat(e)));var s=e.getAnchor3d();P.push((new Xc).set(0-s.x,0-s.y,0-s.z).applyMatrix4(r)),P.push((new Xc).set(0-s.x,0-s.y,1-s.z).applyMatrix4(r)),P.push((new Xc).set(0-s.x,1-s.y,0-s.z).applyMatrix4(r)),P.push((new Xc).set(0-s.x,1-s.y,1-s.z).applyMatrix4(r)),P.push((new Xc).set(1-s.x,0-s.y,0-s.z).applyMatrix4(r)),P.push((new Xc).set(1-s.x,0-s.y,1-s.z).applyMatrix4(r)),P.push((new Xc).set(1-s.x,1-s.y,0-s.z).applyMatrix4(r)),P.push((new Xc).set(1-s.x,1-s.y,1-s.z).applyMatrix4(r))}var r=new ab;return function(G){if(G=G||this.sm().getSelection(),G instanceof T.Node&&(G=[G]),0===G.length)return Z;var y=[];G.forEach(function(G){lm(G)&&F(y,this,G)},this);var N=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];return y.forEach(function(R){N[0]=Math.min(R.x,N[0]),N[1]=Math.min(R.y,N[1]),N[2]=Math.min(R.z,N[2]),d[0]=Math.max(R.x,d[0]),d[1]=Math.max(R.y,d[1]),d[2]=Math.max(R.z,d[2])}),{min:N,max:d}}}(),setBatchInfo:function(v,j){var T=this._batchInfoMap[v];this._batchInfoMap[v]=j,this.fp("batchInfo",T,j)},getBatchInfo:function(F){return this._batchInfoMap[F]||Xn[F]},setOrthoWidth:function(z){var c=this._orthoWidth;if(this._orthoWidth=z,this._syncEyeWithOrthoWidth){var h=z/this.getAspect(),t=h/2/Lp(this.getFovy()/2),E=(new Xc).fromArray(this.getEye()),T=(new Xc).fromArray(this.getCenter());E.sub(T).setLength(t).add(T),this.setEye(E.toArray())}this.fp("orthoWidth",c,z)}}),Ar.RenderEnv=function(D){this.gv=D,this.enable=!1},i.defineProperties(Ar.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(W){this._debugOn=W,this.capture&&this.capture()}}}),i.assign(Ar.RenderEnv.prototype,{renderEnvToCube:function(A,e,I,K){var l=this,u=l.gv;if(!A||!e||!I)return l.enable=!1,l._42=null,void 0;l.enable=!0;var U=Math.floor(K/A*e),m=u.getGL(),F=l._renderTargets;F?F.length<I&&(F=l._renderTargets=F.concat(new Array(I-F.length))):F=l._renderTargets=new Array(I);for(var y=0;I>y;y++)F[y]?F[y].setSize(m,K,U):F[y]=new Ar.RenderTarget(u,m,K,U);var Y=!1;l.capture=function(){Y=!0,u._42(),Y=!1};var J=new Xc,M=new Xc,z=new Xc,Q=new Xc,V=(new Xc).setY(0),$=2*Math.PI/I,k=A/2/Math.tan(Math.PI/I),w=2*Math.atan2(e/2,k),O=A/e;l._42=function(U,h,T,x){var e=l._debugOn;if(!Y&&!e)return!1;J.copy(u.getEye()),Q.copy(u.getCenter()).sub(J);var g=Math.atan2(Q.z,Q.x),K=u.getNear(),c=u.getFovy(),v=u.getAspect();M.copy(u.getCenter());for(var f,R=0;I>R;R++)if(f=F[R],V.setZ(Math.cos(g)).setX(Math.sin(g)).multiplyScalar(k),g-=$,z.addVectors(J,V),u.setNear(k),u.setCenter([z.x,z.y,z.z]),u.setFovy(w),u.setAspect(O),e){var H=Math.round(h/I);ep.for(U).glState.viewport=[H*R,0,H,T],x()}else io(U,f.frame),ep.for(U).glState.viewport=[0,0,f.width,f.height],U.clear(U.COLOR_BUFFER_BIT),x(),lo(U),f.assureTexture();return u.setNear(K),u.setCenter([M.x,M.y,M.z]),u.setFovy(c),u.setAspect(v),!0},l.capture()},getTextureInfo:function(s){var l=this._renderTargets;if(!l)return null;var W=this._renderTargets[s];return W?{index:s,texture:W.texture,textureName:W.uuid}:null}}),i.assign(Ar.Graph3dView.prototype,{renderEnvToCube:function(S,R,g,C){var v=this;v.envRenderer||(v.envRenderer=new Ar.RenderEnv(v)),v.envRenderer.renderEnvToCube(S,R,g,C)}});var cm=["left","front","right","back","top","bottom"],lh=Ar._RenderList=function(){function U(){j.length=0,l.length=0,K={}}function D(w){var h,V,b,K,O=w.gv,m=w.data,H=w.shapeModel;if(H){var q,u,E,_=m.s("shape3d.transparent")||m.s("points.transparent");for(tj(H)||(q=sn(H.transparent,m,O),H=[H]),b=0,K=H.length;K>b;b++)E=H[b],u=sn(E.transparent,m,O),u===c&&(u=q),u===c&&(u=_),u?V=!0:h=!0}for(b=0,K=cm.length;K>b;b++){var o=w[cm[b]];o&&(o.transparent?V=!0:h=!0)}O.isLabelVisible(m)&&(w.labelInfo&&(m.s(Tp+".transparent")?V=!0:h=!0),w.label2Info&&(m.s(Mj+".transparent")?V=!0:h=!0)),O.isNoteVisible(m)&&(w.noteInfo&&(m.s(Bl+".transparent")?V=!0:h=!0),w.note2Info&&(m.s(re+".transparent")?V=!0:h=!0)),w._38o&&(V=h=!0),V||(h=!0),w._renderParams={opaque:h,transparent:V}}function e(Q,n){n&&D(Q);var b=Q.data,G=b._id;if(!K[G]){K[G]=!0;var u=Q._renderParams;u&&u.visible!==!1&&(Q={ui:Q,data:b,z:0,id:G},u.opaque&&j.push(Q),u.transparent&&l.push(Q))}}function F(k,Q){if(l.length>1){for(var $,o=0,u=l.length;u>o;o++)$=l[o].data.p3(),l[o].z=oi($,Q)[2];l.sort(k||O)}}function N(j){j?(Sk(r,o,j),Sk(v,M,j),Sk(g,$,j)):(r=this.batchModelMap={},o=this.batchIndexMap={},v=this.polylineModelMap={},M=this.polylineIndexMap={},g=this.wireframeModelMap={},$=this.wireframeIndexMap={}),this.markBatchInvalid()}function w(l){l?Sk(r,o,l):(r=this.batchModelMap={},o=this.batchIndexMap={}),this.markBatchInvalid()}function m(Q){Q?Sk(v,M,Q):(v=this.polylineModelMap={},M=this.polylineIndexMap={}),this.markBatchInvalid()}function W(C){C?Sk(g,$,C):(g=this.wireframeModelMap={},$=this.wireframeIndexMap={}),this.markBatchInvalid()}function b(){return this._batchInvalid}function S(){this._batchInvalid=!0}function E(){this._batchInvalid=null}var j=[],l=[],r={},o={},v={},M={},g={},$={},K={};return{opaque:j,transparent:l,init:U,push:e,batchModelMap:r,batchIndexMap:o,polylineModelMap:v,polylineIndexMap:M,wireframeModelMap:g,wireframeIndexMap:$,ivBatch:N,ivModelBatch:w,ivPolylineBatch:m,ivWireframeBatch:W,markBatchInvalid:S,isBatchInvalid:b,onUpdated:E,sort:F}},sp=Ar._RenderLists=function(){function g(){for(var T in X)X[T].init()}function V(){for(var y in X)X[y].onUpdated()}function t(x,_){x=x||"main";var G=X[x];return!G&&_&&(G=X[x]=new lh),G}function r(H,J){var c=H.data.getRenderLayer(),i=t(c,!0);i.push(H,J)}function h(U){for(var P in X)U(X[P])}var X={};return{init:g,onUpdated:V,get:t,push:r,each:h,lists:X}},Rp=Ar.RenderTarget=function(_,z,H,w,p){var y=this;p=p||{},p.samples=Math.min(_._glCapabilities.maxSamples,p.samples&&p.samples>1&&2===_._webGLVersion?p.samples:0),y.options=p,y.uuid=T.Math.generateUUID(),y.gv=_,y.init(_,z,p),p.samples&&!_._glCapabilities._maxSamplesChecked?y.setSize(z,H||1,w||1):y.setSize(z,H,w)};i.assign(Ar.RenderTarget.prototype,{bind:function(d){io(d,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(f){lo(f),this.options.samples&&(f.bindFramebuffer(f.READ_FRAMEBUFFER,this._MSAAFbo),f.bindFramebuffer(f.DRAW_FRAMEBUFFER,this.frame),f.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,f.COLOR_BUFFER_BIT,f.NEAREST),f.bindFramebuffer(f.READ_FRAMEBUFFER,null),f.bindFramebuffer(f.DRAW_FRAMEBUFFER,null))},init:function(u,C,G){var Z=this,_=Z.texture=C.createTexture();C.activeTexture(C.TEXTURE0),zk(C,_);var J=G.samples,g=J?C.NEAREST:C.LINEAR;C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,G.minFilter||g),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,G.magFilter||g),zk(C,null),Z.render=C.createRenderbuffer(),Z.frame=C.createFramebuffer(),u._2O[Z.uuid]=_},assureTexture:function(){var i=this,X=i.uuid,b=i.gv._2O;b[X]||(b[X]=i.texture)},setSize:function(c,g,P){var r=this;if(g&&P&&(r.width!==g||r.height!==P)){var s=c.RGBA,m=c.TEXTURE_2D,t=c.RENDERBUFFER,K=c.FRAMEBUFFER,M=r.options.samples;if(c.activeTexture(c.TEXTURE0),zk(c,r.texture),c.texImage2D(m,0,s,g,P,0,s,c.UNSIGNED_BYTE,Z),gi.isPOT(g)&&gi.isPOT(P)&&!r.options.clampToEdge?(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT)):(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE)),c.bindRenderbuffer(t,r.render),M){var N=r.gv._glCapabilities;if(N._maxSamplesChecked)c.renderbufferStorageMultisample(t,M,c.DEPTH_COMPONENT16,g,P);else{for(c.getError();M>1&&(c.renderbufferStorageMultisample(t,M,c.DEPTH_COMPONENT16,g,P),c.getError());)M=Math.floor(M>>1);1>=M&&(M=0,c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,r.options.minFilter||c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,r.options.magFilter||c.LINEAR),c.renderbufferStorage(t,c.DEPTH_COMPONENT16,g,P)),N._maxSamplesChecked=!0,N.maxSamples=r.options.samples=M}}else c.renderbufferStorage(t,c.DEPTH_COMPONENT16,g,P);M&&!r._MSAAFbo&&(r._MSAAFbo=c.createFramebuffer(),r._MSAARbO=c.createRenderbuffer()),io(c,r.frame),c.framebufferTexture2D(K,c.COLOR_ATTACHMENT0,m,r.texture,0),M||c.framebufferRenderbuffer(K,c.DEPTH_ATTACHMENT,t,r.render),lo(c),M&&(c.bindRenderbuffer(c.RENDERBUFFER,r._MSAARbO),c.renderbufferStorageMultisample(c.RENDERBUFFER,M,c.RGBA8,g,P),io(c,r._MSAAFbo),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.RENDERBUFFER,r._MSAARbO),c.framebufferRenderbuffer(K,c.DEPTH_ATTACHMENT,t,r.render),lo(c)),zk(c,Z),c.bindRenderbuffer(t,Z),r.width=g,r.height=P}},toCanvas:function(){var q=this,Q=q.gv.getGL();io(Q,q.frame);var R=q.width,E=q.height,f=new Uint8Array(4*R*E);Q.readPixels(0,0,R,E,Q.RGBA,Q.UNSIGNED_BYTE,f),lo(Q);var o=t.createElement("canvas");o.width=R,o.height=E;var T=o.getContext("2d"),y=T.createImageData(R,E);return y.data.set(f),T.putImageData(y,0,0),o}});var Oh=Ar.Interactor=function(L){this.gv=this.g3d=L};We("Interactor",i,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(o){this.gv.fi(o)},startDragging:function(P){co(this,P)}});var ie=Ar.DefaultInteractor=function(g){to(ie,this,[g])};We("DefaultInteractor",Oh,{getState:function(){return this._62O},setState:function(J){this._62O=J},getDataInfoAt:function(b,A){var W=this.gv,S=W.getDataInfoAt(b);if(!W.isBlockSelectable()||!S||!S.data)return S;if(!A&&W.isSelected(S.data))return S;for(var m=S.data;(m=m.getParent())&&m instanceof T.Block&&W.isSelectable(m);){var C=W.isSelected(m);if(C&&A)break;if(S={data:m,part:S.part},C&&!A)break}return S},handle_contextmenu:function(M){_m(M)},handle_mousewheel:function(l){this.gv.handleScroll(l,l.wheelDelta/40)},handle_DOMMouseScroll:function(l){2===l.axis&&this.gv.handleScroll(l,-l.detail)},handle_keydown:function(g){this.gv.handleKeyDown(g)},handle_mousedown:function(A){this.handle_touchstart(A)},handle_touchstart:function(f){_m(f);var u=this,$=u.gv,P=tp(f),R=u.getDataInfoAt(f),L=R?R.data:Z,M=R?R.part:Z,b=$.sm(),q=hg(f),z=hr(f);$.setFocus(f)&&(u._62O=Z,u._57I=Z,u.pendingClickThrough=Z,u.__lastClientPoint__=Nq(f),L?ig(f)?b.co(L)?b.rs(L):b.as(L):b.co(L)?L instanceof Tb&&L.isClickThroughEnabled()&&tp(f)&&(u.pendingClickThrough=Nq(f)):b.ss(L):P&&(ig(f)?$.isRectSelectable()&&(u._62O=Gq):u._57I=Nq(f)),u._31Q&&(al(u._31Q),delete u._31Q,delete u._32Q),u._62O||($.isFirstPersonMode()&&(Ji(f)||_h(f)||z>2?u._62O="pan":$.isMouseRoamable()||wf(f)?(u._62O="roaming",u.foward=q&&tp(f),u._32Q=Ug(),u._31Q=jf(u.tick,u)):P||(u._62O="roaming")),u._62O||(P&&q&&Hs[M]?(u._62O=M,u.p3=L.p3()):P&&q&&lm(L)&&$.isSelected(L)?$.isMovable(L)?(u._62O="move",u.p3=L.p3(),u.movedata=L):$._39Q(L)&&(u._62O="none"):wf(f)&&(z>2?u._62O="pan":2===z&&(u.dist=Ub(f),u._62O="pinch")))),u.point=$.lp(f),co(u,f),_c(f)?$.handleDoubleClick(f,L,M):$.handleClick(f,L,M))},tick:function(){var H=this,Y=H.gv,h=Y._moveStep;H.point&&Y.isWalkable()&&(H._32Q&&(h*=(Ug()-H._32Q)/50),Y.walk(H.foward?h:-h),H._32Q=Ug(),H._31Q=jf(H.tick,H))},handle_mouseup:function(Q){this.handle_touchend(Q)},handle_touchend:function(b){var h=this._57I;if(h&&(Yf(h,Nq(b))<=1&&this.gv.sm().cs(),this._57I=Z),h=this.pendingClickThrough){if(Yf(h,Nq(b))<=1){var y=this.getDataInfoAt(b);y&&y.data instanceof Tb&&y.data.isClickThroughEnabled()&&(y=this.getDataInfoAt(b,!0),y&&(b.clickThrough=!0,this.gv.sm().ss(y.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(w){this.handleWindowTouchMove(w)},handleWindowTouchMove:function(J){var w,l,R=this,K=R.gv,U=R._62O,t=R.point,H=K.dm(),h=K.lp(J),T=h.x-t.x,k=h.y-t.y,S=K.getWidth(),x=K.getHeight();if(S&&x){var u=Nq(J),r=Zm(K,u,R.__lastClientPoint__),n=Yf({x:0,y:0},r),D=-s*T/S,I=-s*k/x;if("roaming"===U)R.rotate(J,D/2,I/2);else if(U===Cs||U===Nd||U===Ds)K._86O||H.beginTransaction(),K.fi({kind:K._86O?"betweenEditRotation":"beginEditRotation",event:J}),K._86O=1,K.sm().each(function(r){if(lm(r)&&K.isRotationEditable(r)){var W=C(D)>C(I)?D:I;U===Cs?r.setRotationX(r.getRotationX()+W):U===Nd?r.setRotationY(r.getRotationY()+W):U===Ds&&r.setRotationZ(r.getRotationZ()+W)}});else if("move"===U||Hs[U]){if(U===Es||U===Fs||U===Gs)K._87O||H.beginTransaction(),K.fi({kind:K._87O?"betweenEditScale":"beginEditScale",event:J}),K._87O=1;else{if(!K._moving){if(n<L.touchMoveThreshold)return;H.beginTransaction()}K.fi({kind:K._moving?"betweenMove":"beginMove",event:J}),K._moving=1}var Q,j=R.p3,P=K.getPositionInfo(j),d=ee(K);Q=U===an?"x":U===Kd?"y":U===jb?"z":U===Es?"sx":U===Fs?"sy":U===Gs?"sz":K.getMoveMode(J,R.movedata),T=T/S*P.width,k=-1*k/x*P.height;var Y,$,Z=[d[0]*T,d[4]*T,d[8]*T],v=[d[1]*k,d[5]*k,d[9]*k],m=Z[0]+v[0],b=Z[1]+v[1],z=Z[2]+v[2],e=[j[0]+m,j[1]+b,j[2]+z],i=$i(K.getEye(),e,!0);if("xyz"===Q?(Y=e,K.moveSelection(m,b,z)):"xz"===Q?(Y=pn(K,j,[0,1,0],e),Y&&K.moveSelection(Y[0]-j[0],0,Y[2]-j[2])):"xy"===Q?(Y=pn(K,j,[0,0,1],e),Y&&K.moveSelection(Y[0]-j[0],Y[1]-j[1],0)):"yz"===Q?(Y=pn(K,j,[1,0,0],e),Y&&K.moveSelection(0,Y[1]-j[1],Y[2]-j[2])):"x"===Q||"sx"===Q?(i[0]=0,Y=pn(K,j,i,e),Y&&($=Y[0]-j[0],"x"===Q?K.moveSelection($,0,0):K.sm().each(function(C){lm(C)&&K.isSizeEditable(C)&&(w=C.getScaleX()+$/100,l=w/C.getScaleX(),C.setScaleX(w),Ji(J)&&(C.setScaleY(C.getScaleY()*l),C.setScaleTall(C.getScaleTall()*l)))}))):"y"===Q||"sy"===Q?(i[1]=0,Y=pn(K,j,i,e),Y&&($=Y[1]-j[1],"y"===Q?K.moveSelection(0,$,0):K.sm().each(function(k){lm(k)&&K.isSizeEditable(k)&&(w=k.getScaleTall()+$/100,l=w/k.getScaleTall(),k.setScaleTall(w),Ji(J)&&(k.setScaleY(k.getScaleY()*l),k.setScaleX(k.getScaleX()*l)))}))):("z"===Q||"sz"===Q)&&(i[2]=0,Y=pn(K,j,i,e),Y&&($=Y[2]-j[2],"z"===Q?K.moveSelection(0,0,$):K.sm().each(function(M){lm(M)&&K.isSizeEditable(M)&&(w=M.getScaleY()+$/100,l=w/M.getScaleY(),M.setScaleY(w),Ji(J)&&(M.setScaleX(M.getScaleX()*l),M.setScaleTall(M.getScaleTall()*l)))}))),!Y)return;R.p3=Y}else if(U===Gq){var X=R.div;X||(X=R.div=Ke(),Fd(R.getView(),X),X.op=t,X.style.background=K.getRectSelectBackground()),K.fi({kind:K._rectSelecting?"betweenRectSelect":"beginRectSelect",event:J}),K._rectSelecting=1,X.rect=An(X.op,h),Rf(X,X.rect)}else if("pinch"===U&&2===hr(J)){K.fi({kind:K._pinching?"betweenPinch":"beginPinch",event:J}),K._pinching=1;var $=Ub(J);K._lastZoomLP||(K._lastZoomLP=Hk(J)),K.handlePinch($,R.dist),R.dist=$}else"pan"===U||Ji(J)||_h(J)?R.pan(J,T,k):"none"===U||K.isFirstPersonMode()||R.rotate(J,D,I);R.point=h}},pan:function(O,e,s){var E=this.gv;if(E.isPannable()){var N=E.getWidth(),b=E.getHeight();if(!N||!b)return;var l=E.getCenterInfo(),W=e/N*l.width,S=-1*s/b*l.height;E.fi({kind:E._panning?"betweenPan":"beginPan",event:O}),E._panning=1,E.pan(-W,-S)}},rotate:function(J,s,_){var A=this.gv;A.isRotatable()&&(A.fi({kind:A._rotating?"betweenRotate":"beginRotate",event:J}),A._rotating=1,A.rotate(s,_))},handleWindowMouseUp:function(Y){this.handleWindowTouchEnd(Y)},handleWindowTouchEnd:function(z){var l=this,$=l.gv,W=$.dm(),F=l.div;if(F){var N=$.getDatasInRect(F.rect);if(!N.isEmpty()){var P=$.sm(),O=P.toSelection();N.each(function(y){P.co(y)?O.remove(y):O.add(y)}),P.ss(O)}ws(F)}$._moving&&(delete $._moving,$.fi({kind:"endMove",event:z}),$.onMoveEnded(),W.endTransaction()),$._panning&&(delete $._panning,$.fi({kind:"endPan",event:z}),$.onPanEnded()),$._rotating&&(delete $._rotating,$.fi({kind:"endRotate",event:z}),$.onRotateEnded()),$._86O&&(delete $._86O,$.fi({kind:"endEditRotation",event:z}),W.endTransaction()),$._87O&&(delete $._87O,$.fi({kind:"endEditScale",event:z}),W.endTransaction()),$._pinching&&(delete $._pinching,$.fi({kind:"endPinch",event:z}),$.onPinchEnded()),$._rectSelecting&&(delete $._rectSelecting,$.fi({kind:"endRectSelect",event:z}),$.onRectSelectEnded()),$._walking&&(delete $._walking,$.fi({kind:"endWalk",event:z}),$.onWalkEnded()),$._lastZoomLP=$._lastZoomHit=null,l.dist=l.point=l._62O=l.p3=l.movedata=l.div=l._57I=l.pendingClickThrough=l._32Q=l._31Q=l.foward=Z,l.__lastClientPoint__=Z}});var hi=Ar.MapInteractor=function(D){to(hi,this,[D]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};We("MapInteractor",Oh,{setUp:function(){hi.superClass.setUp.call(this);var H=this.gv;this.__oldMinPhi__=H.getRotateMinPhi(),this.__oldMaxPhi__=H.getRotateMaxPhi(),H.setRotateMinPhi(this._minPhi),H.setRotateMaxPhi(this._maxPhi)},tearDown:function(){hi.superClass.tearDown.call(this);var M=this.gv;M.setRotateMinPhi(this.__oldMinPhi__),M.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(Z){_m(Z)},handle_mousewheel:function(w){this.gv.handleScroll(w,w.wheelDelta/40)},handle_DOMMouseScroll:function(O){2===O.axis&&this.gv.handleScroll(O,-O.detail)},handle_keydown:function(S){this.gv.handleKeyDown(S)},handle_mousedown:function(u){this.handle_touchstart(u)},handle_touchstart:function(m){_m(m);var $=this,Q=$.gv;if(Q.setFocus(m)){var M=Q.getDataInfoAt(m),l=M?M.data:Z,S=M?M.part:Z,o=$.editing={point:Q.lp(m)};wf(m)?o.touch=!0:(o.touch=!1,o.clickLeft=tp(m),o.pan=_h(m)?!0:"left"===this.panButton===o.clickLeft),l&&Q._39Q(l)&&(o.preventDefault=!0),co($,m),_c(m)?Q.handleDoubleClick(m,l,S):Q.handleClick(m,l,S)}},handle_mouseup:function(D){this.handle_touchend(D)},handle_touchend:function(){},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(j){var z=this,D=z.gv,M=z.editing;if(M){var Q=D.lp(j),d=M.point,Y=Q.x-d.x,X=Q.y-d.y;if(!M.moved){if(Math.abs(Y)<z.threshold&&Math.abs(X)<z.threshold&&!(j.touches&&j.touches.length>1))return;M.moved=!0}if(!M.preventDefault)if(M.point=Q,M.touch){var e=j.touches.length;if(2!==e)z.pan(j,Y,X);else{if(1>=e)return;var V=j.touches,L={x:V[0].clientX,y:V[0].clientY},C={x:V[1].clientX,y:V[1].clientY},H={x:C.x-L.x,y:C.y-L.y},P=M.lastCenter,W=Math.atan2(H.y,H.x),b=M.theta,U=0;b==Z?b=M.theta=W:(U=W-b,M.thetaStarted||Math.abs(U)>z.touchRotateThreshold?(M.thetaStarted=!0,M.theta=W):U=0);var k=v*(L.y+C.y)/2/D.getHeight(),r=M.phi,$=0;r==Z?r=M.phi=k:($=k-r,M.phiStarted||Math.abs($)>z.touchRotateThreshold?(M.phiStarted=!0,M.phi=k):$=0);var w,q=Math.sqrt(H.x*H.x+H.y*H.y),t=M.vlen;if(t){var R=L.x-P.x,x=L.y-P.y,n=C.x-P.x,S=C.y-P.y,y=Math.sqrt(R*R+x*x),E=Math.sqrt(n*n+S*S),N=t/2,p=z._sign2(y-N),F=z._sign2(E-N);0>p*F||0===p&&0===F?(w=1,M.vlen=q):(w||(w=q/t),M.scaleStarted||Math.abs(w-1)>z.touchScaleThreshold?(M.vlen=q,M.scaleStarted=!0):w=1)}else t=M.vlen=q,w=1;1!==w&&D.setZoom(w),($||U)&&z.rotate(j,U,-$),M.lastCenter={x:(C.x+L.x)/2,y:(C.y+L.y)/2}}}else if(M.pan)z.pan(j,Y,X);else{var T=D.getWidth(),G=D.getHeight();if(!T||!G)return;var B=-s*Y/T,m=-s*X/G;z.rotate(j,B,m)}}},_sign2:function(W){return Math.abs(W)<this._touchScaleCheckAccuracy?0:W>0?1:-1},handleWindowMouseUp:function(g){this.handleWindowTouchEnd(g)},getDataInfoAt:function(Y,k){var s=this.gv,W=s.getDataInfoAt(Y);if(!s.isBlockSelectable()||!W||!W.data)return W;if(!k&&s.isSelected(W.data))return W;for(var E=W.data,F=W.part;(E=E.getParent())&&E instanceof T.Block&&s.isSelectable(E);){var D=s.isSelected(E);if(D&&k)break;if(W={data:E,part:F},D&&!k)break}return W},handleWindowTouchEnd:function(H){var L=this,y=L.editing;if(L.editing=null,y){var K=L.gv;if(y.moved||!y.clickLeft&&!y.touch)K._panning=null,K._rotating=null,K.fi({kind:y.pan?"endPan":"endRotate",event:H});else{var A=L.getDataInfoAt(H),x=A&&A.data;x instanceof Tb&&x.isClickThroughEnabled()&&(A=L.getDataInfoAt(H,!0),A&&(x=A.data)),x?K.sm().setSelection([x]):K.sm().clearSelection()}}},pan:function(r,x,M){var d=this,e=d.gv;if(e.isPannable()){var G=e.getWidth(),i=e.getHeight();if(G&&i){var V=e.getCenterInfo(),j=-x/G*V.width,o=1*M/i*V.height;e.fi({kind:e._panning?"betweenPan":"beginPan",event:r}),e._panning=1;var W=d.keepHorizon,k=d.editing.touch;if((k&&r.touches&&r.touches.length>1||!k&&Ji(r))&&(W=!W),!W)return e.pan(j,o);if(j||o){var f=ee(e),w=[f[0]*j,f[4]*j,f[8]*j],E=[f[1],0,f[9]],I=Math.sqrt(E[0]*E[0]+E[2]*E[2]);I&&(E=[E[0]/I*o,0,E[2]/I*o]);var y=w[0]+E[0],s=w[1]+E[1],l=w[2]+E[2],g=e._center,_=e._eye;g[0]+=y,g[1]+=s,g[2]+=l,_[0]+=y,_[1]+=s,_[2]+=l,e.fp(Kg,Z,_),e.fp(Wj,Z,g)}}}},rotate:function(c,p,I){var h=this,s=h.gv;if(s.isRotatable()){var w=s._center,q=s._eye,W=$i(q,w),_=Nh(V(W[0]*W[0]+W[2]*W[2]),W[1]),S=Nf(s,_+I);I=S-_,s.fi({kind:s._rotating?"betweenRotate":"beginRotate",event:c}),s._rotating=1,s.rotate(p,I)}}}),i.defineProperties(hi.prototype,{panButton:{get:function(){return this._panButton},set:function(w){this._panButton=w}},minPhi:{get:function(){return this._minPhi},set:function(b){this.gv.setRotateMinPhi(this._minPhi=b)}},maxPhi:{get:function(){return this._maxPhi},set:function(G){this.gv.setRotateMaxPhi(this._maxPhi=G)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(L){this._keepHorizon=L}},threshold:{get:function(){return this._threshold},set:function(w){this._threshold=w}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(P){this._touchScaleThreshold=P}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(G){this._touchRotateThreshold=G}}});var Vr,ol="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",yd=32,Nc=Ar.GlobeInteractor=function(x,A){to(Nc,this,[x]);var K,$=A.radius||6378137,J=this,T=null;Vr||(Vr=Ke(),Vr.style.border="",Vr.style.backgroundImage="url("+ol+")");var d=new oc,h=new Xc,i=new Xc,S=new Xc,t=new Ne,w="number"==typeof $?{x:$,y:$,z:$}:$,O={center:new Xc(0,0,0),radius:w},B=function(o){x._81O=null;var F=x.getHitPosition(o,x.getCenter(),h.copy(x.getEye()).sub(i.copy(x.getCenter())).toArray());return t.origin.copy(x.getEye()),t.direction.copy(F).sub(t.origin).normalize(),t.intersectEllipsoid(O)},m=function(D,d){x._81O=null,t.origin.copy(x.getEye());for(var p,b,v=x.getCenter(),R=h.copy(x.getEye()).sub(i.copy(x.getCenter())).toArray(),z=1,w=16,e=0,r=1,M={x:0,y:0};w--;){if(M.x=d.x+(D.x-d.x)*z,M.y=d.y+(D.y-d.y)*z,p=x.getHitPosition(M,v,R),t.direction.copy(p).sub(t.origin).normalize(),b=t.intersectEllipsoid(O),b&&1===z)return{hit:b};b?e=z:r=z,z=(e+r)/2}return{hit:b,out:1>z}},L=function(Q,l){if(T){var K=Date.now();T.deltaTime=T.lastTime?K-T.lastTime:1e3,T.lastTime=K,T.lastAxis=Q,T.lastAngle=l}l&&(d.setFromAxisAngle(Q,l),x.setEye(h.copy(x.getEye()).applyQuaternion(d).toArray()),x.setCenter(h.copy(x.getCenter()).applyQuaternion(d).toArray()),x.setUp(h.copy(x.getUp()).applyQuaternion(d).toArray()))};J._showCrossIcon=function(E){Fd(J.getView(),Vr),Rf(Vr,{x:E.clientX-yd/2,y:E.clientY-yd/2,width:yd,height:yd})},J._hideCrossIcon=function(){ws(Vr)},J._scrollImpl=function(k,G){T={point:x.lp(k),screen:Nq(k),hit:B(k),type:"right"},T.hitNormalize=T.hit?T.hit.clone().normalize():new Xc;var e={clientX:T.screen.x,clientY:T.screen.y+10*G};J._handleMoveImpl(e),J._endMoveImpl(e)},J._startMoveImpl=function(I){K&&(K.stop(!0),K=null),T={point:x.lp(I),screen:Nq(I),hit:B(I)},T.hitNormalize=T.hit?T.hit.clone().normalize():new Xc,wf(I)?1===I.touches.length?T.hit&&(T.type="left"):2===I.touches.length&&(T.type="touch2"):(tp(I)?T.hit&&(T.type="left"):Gm(I)?T.type="right":_h(I)&&T.hit&&(T.type="middle"),!T.hit||"right"!==T.type&&"middle"!==T.type||J._showCrossIcon(I)),T.type&&co(J,I)},J._handleMoveImpl=function(h){if(T)switch(T.type){case"left":return J._handleLeft(h);case"right":return J._handleRight(h);case"middle":return J._handleMiddle(h);case"touch2":return J._handleTouch2(h)}},J._endMoveImpl=function(){if(T){if(this._hideCrossIcon(),"left"===T.type||"middle"===T.type){var O=1e3*(T.lastAngle/(T.deltaTime||30)),a=T.lastAxis,d=T.lastTime,j=function(){var Y=Date.now(),M=(Y-d)/1e3;return d=Y,O*=Math.pow(Math.abs(J.decelerationRate),3*M),Math.abs(O)<.01?(O=0,K&&K.stop(),void 0):(L(a,O*M),void 0)};K=uo({action:function(){j(arguments)},duration:5e3})}T=null}},J._handleLeft=function(e){if(!T.finished){var E=Nq(e),S=m(E,T.lastScreen||T.screen);if(T.lastScreen=E,!S.hit)return T.finished=!0,J._endMoveImpl(e),void 0;var P=S.hit;P.normalize();var q=T.hitNormalize,c=Math.acos(P.dot(q)),N=P.cross(q).normalize();L(N,c),S.out&&(T.finished=!0,J._endMoveImpl(e))}},J._handleRight=function(R){var N=T.lastScreen||T.screen,X=N.y;N=T.lastScreen=Nq(R);var M=N.y,o=M-X;if(o){var s=Math.min(.5,o*J.scaleSpeed);h.copy(x.getEye());var F=T.hit;F||(F=h.clone().divide(w).normalize().multiply(w)),i.copy(h).lerp(F,s),x.setEye(i.toArray()),h.copy(x.getUp()),i.normalize();var n=h.clone().cross(i).normalize();if(S.copy(x.getCenter()),S.sub(n.multiplyScalar(S.dot(n))),x.setCenter(S.toArray()),T.hit){var _=B(T.screen),G=T.hitNormalize;if(_){_.normalize();var K=Math.acos(_.dot(G)),t=_.cross(G).normalize();K&&L(t,K)}}}};var u=function(L){return Math.abs(L)<.01?0:L>0?1:-1};J._handleTouch2=function(Q){var P=Q.touches.length;if(2===P){var w=Q.touches,F={x:w[0].clientX,y:w[0].clientY},R={x:w[1].clientX,y:w[1].clientY},y={x:R.x-F.x,y:R.y-F.y},A=T.lastCenter,d=Math.atan2(y.y,y.x),b=T.theta,s=0;b==Z?b=T.theta=d:(s=d-b,T.thetaStarted||Math.abs(s)>.03?(T.thetaStarted=!0,T.theta=d):s=0);var j,n=Math.sqrt(y.x*y.x+y.y*y.y),o=T.vlen;if(o){var f=F.x-A.x,B=F.y-A.y,z=R.x-A.x,q=R.y-A.y,m=Math.sqrt(f*f+B*B),Y=Math.sqrt(z*z+q*q),p=o/2,E=u(m-p),t=u(Y-p);0>E*t||0===E&&0===t?(j=1,T.vlen=n):(j||(j=n/o),T.scaleStarted||Math.abs(j-1)>.05?(T.vlen=n,T.scaleStarted=!0):j=1)}else o=T.vlen=n,j=1;var y=i.copy(x.getEye()).clone();1!==j&&x.setEye(y.setLength((y.length()-$)/j+$).toArray()),s&&L(y.normalize(),s),T.lastCenter={x:(R.x+F.x)/2,y:(R.y+F.y)/2}}},J._handleMiddle=function(m){var Z=Nq(m),p=T.screen;T.screen=Z;var W=(Z.y-p.y)/180*Math.PI*J.rollSpeed;i.copy(x.getCenter()).sub(h.copy(x.getEye())).normalize(),h.copy(x.getUp()).cross(i).normalize(),i.copy(x.getEye()).sub(T.hit).applyAxisAngle(h,W).add(T.hit);var _=i.clone();i.copy(x.getCenter()).sub(T.hit).applyAxisAngle(h,W).add(T.hit);var b=i.clone(),e=i.copy(x.getUp()).applyAxisAngle(h,W).clone(),F=!1;W>0&&(S.copy(e),i.copy(b).sub(_).normalize(),h.copy(_).multiplyScalar(-1).normalize(),h.dot(S)-i.dot(S)>0&&(F=!0)),F||S.copy(T.hit).sub(_).dot(T.hitNormalize)>=0&&(F=!0),F||(x.setEye(_.toArray()),x.setCenter(b.toArray()),x.setUp(e.toArray()));var z=-(Z.x-p.x)/180*Math.PI*J.rotateSpeed;L(T.hitNormalize,z)}};We("GlobeInteractor",Oh,{handle_contextmenu:function(Q){_m(Q)},handle_mousewheel:function(Z){this._scrollImpl(Z,Z.wheelDelta/40)},handle_DOMMouseScroll:function(Y){2===Y.axis&&this._scrollImpl(Y,-Y.detail)},handle_keydown:function(C){this.gv.handleKeyDown(C)},handle_mousedown:function(R){this.handle_touchstart(R)},handle_touchstart:function(x){_m(x);var Y=this.gv;if(Y.setFocus(x)){var y=Y.getDataInfoAt(x),q=y?y.data:Z;q&&Y.isInteractive(q)||this._startMoveImpl(x);var v=y?y.part:Z;_c(x)?Y.handleDoubleClick(x,q,v):Y.handleClick(x,q,v)}},handle_mouseup:function(w){this.handle_touchend(w)
},handle_touchend:function(){},handleWindowMouseMove:function(Y){this.handleWindowTouchMove(Y)},handleWindowTouchMove:function(d){this._handleMoveImpl(d)},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(l){this._endMoveImpl(l)}}),i.defineProperties(Nc.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(g){this._rotateSpeed=g}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(y){this._rollSpeed=y}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(h){this._scaleSpeed=h}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(m){this._decelerationRate=m}}});var mc=function(S){var M=2147483648|S;return[(255&M>>16)/255,(255&M>>8)/255,(255&M)/255,(255&M>>24)/255]},up=function(d){this.gv=d,this.gv.pickColorMap={_pickIdUsed:2e3}};hk(up,i,{_iv:!0,iv:function(){this._iv=!0},get:function(w,Y,t){this.validate();var x=this,K=x.gv.getGL();if(!K)return Z;var l,f,j=x._resolution,L=Math.round(w.x*j),u=Math.ceil(w.width*j),c=Math.ceil(w.height*j),g=x.height-Math.round(w.y*j)-c,e=G(u/2),R=new Uint8Array(4*u*c),I=0,X=R.length,E=Y?Z:new Dd,N=Y?Z:{};if(io(K,x.frame),K.readPixels(L,g,u,c,K.RGBA,K.UNSIGNED_BYTE,R),lo(K),Y){for(;e>=I;I++)for(var q=e-I,V=e+I,m=q;V>=m;m++)for(var B=q;V>=B;B++)if((m===q||m===V||B===q||B===V)&&(l=x.info(R,4*(m*u+B)))){if(t&&t(l)===!1)continue;return l}}else for(;X>I;I+=4)if(l=x.info(R,I)){if(t&&t(l)===!1)continue;f=l.data,N[f._id]||(E.add(f),N[f._id]=f)}return E},info:function(i,t){return this.gv.pickColorMap[(i[t]<<16)+(i[t+1]<<8)+i[t+2]+((127&i[t+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var t=this,Q=t.gv,N=Q.getGL();if(N){var T=t._resolution=Q._pickerResolution*Q.getDevicePixelRatio(),l=Math.round(T*Q.getWidth()),x=Math.round(T*Q.getHeight()),u=N.RGBA,h=N.TEXTURE_2D,q=N.RENDERBUFFER,n=N.FRAMEBUFFER;if(t.texture||(t.texture=db(N),t.render=N.createRenderbuffer(),t.frame=N.createFramebuffer()),(t.width!==l||t.height!==x)&&(N.activeTexture(N.TEXTURE0),zk(N,t.texture),N.texImage2D(h,0,u,l,x,0,u,N.UNSIGNED_BYTE,Z),Ad(N,N.TEXTURE_MIN_FILTER,N.LINEAR),N.bindRenderbuffer(q,t.render),N.renderbufferStorage(q,N.DEPTH_COMPONENT16,l,x),io(N,t.frame),N.framebufferTexture2D(n,N.COLOR_ATTACHMENT0,h,t.texture,0),N.framebufferRenderbuffer(n,N.DEPTH_ATTACHMENT,q,t.render),zk(N,Z),N.bindRenderbuffer(q,Z),lo(N),t.width=l,t.height=x),t._iv){t._iv=!1;var y=!1;Q._40Q.each(function(r){!y&&r.isBatchInvalid()&&(y=!0)}),y&&Q.updateScene(),io(N,t.frame),N.clear(N.COLOR_BUFFER_BIT),Q.overlappingBox.clear(),Q.setViewport(N,0,0,l,x),Q.renderPickScene(),lo(N)}}}});var Oq=function(D){this.gv=D};hk(Oq,i,{gap:0,size:0,_42:function(M,K){var r=this,h=r.gv,l=h._gridGap,G=h._gridSize;if(h._gridVisible){if(r.gap!==l||r.size!==G){for(var e=[],m=h._gridSize/2,q=l*m,S=0;2*m+1>S;S++){var Y=6*S,v=6*(2*m+1)+Y;e[Y]=-q,e[Y+1]=0,e[Y+2]=-q+S*l,e[Y+3]=q,e[Y+4]=0,e[Y+5]=-q+S*l,e[v]=-q+S*l,e[v+1]=0,e[v+2]=-q,e[v+3]=-q+S*l,e[v+4]=0,e[v+5]=q}r.vs=new Sf(e),r.gap=l,r.size=G}Gr(h),Sh(M,K),zc(M),qp(M,K,1,h._gridColor,h._buffer.vs,r.vs),Ae(M,0,r.vs.length/3,M.LINES),ui(M),Dq(M,K)}else r.vs=r.gap=r.size=Z}});var dh=function(h){this.gv=h};hk(dh,i,{_42:function(I,P){var i=this.gv,y=i._buffer.vs,Y=i._axisXColor,h=i._axisYColor,Q=i._axisZColor,H=i._originAxisVisible,o=i._centerAxisVisible;if(H||o){var K=wk?I.TRIANGLES:I.TRIANGLE_FAN,q=I.LINES;if(Gr(i),Sh(I,P),zc(I),H){var s=i.getCenterInfo(),B=S(s.width,s.height)/5,E=.8*B,T=.05*B;qp(I,P,1.5,Y,y,new Sf([0,0,0,B,0,0,E,T,0,E,0,T,E,-T,0,E,0,-T,E,T,0,0,0,0,0,B,0,T,E,0,0,E,T,-T,E,0,0,E,-T,T,E,0,0,0,0,0,0,B,T,0,E,0,T,E,-T,0,E,0,-T,E,T,0,E])),Ae(I,0,2,q),Ae(I,1,6,K),qp(I,P,Z,h),Ae(I,7,2,q),Ae(I,8,6,K),qp(I,P,Z,Q),Ae(I,14,2,q),Ae(I,15,6,K)}if(o){var W=i._center,N=W[0],k=W[1],e=W[2],s=i.getPositionInfo(W);B=S(s.width,s.height)/20,qp(I,P,1.5,Y,y,new Sf([N,k,e,N+B,k,e,N,k,e,N,k+B,e,N,k,e,N,k,e+B])),Ae(I,0,2,q),qp(I,P,Z,h),Ae(I,2,2,q),qp(I,P,Z,Q),Ae(I,4,2,q)}ui(I),Dq(I,P)}}});var so=function(w){this.gv=w},an="edit_tx",Kd="edit_ty",jb="edit_tz",Cs="edit_rx",Nd="edit_ry",Ds="edit_rz",Es="edit_sx",Fs="edit_sy",Gs="edit_sz",Hs={};Hs[an]=101,Hs[Kd]=102,Hs[jb]=103,Hs[Cs]=104,Hs[Nd]=105,Hs[Ds]=106,Hs[Es]=107,Hs[Fs]=108,Hs[Gs]=109,hk(so,i,{_42:function(V,c,f){var e=this,K=e.gv,b=K.sm().ld();if(b&&K.isEditable(b)&&!K.isEditHelperDisabled()&&lm(b)&&(!K.isFirstPersonMode()||!K.isMouseRoamable()&&!Km)){Gr(K);var v,_=K.isMovable(b),U=K.isRotationEditable(b),Y=K.isSizeEditable(b),M=K._axisXColor,t=K._axisYColor,q=K._axisZColor,l=K._editSizeColor,N=b.p3();if(K.isOrtho()){var X=K.getCenterInfo();v=S(X.width,X.height)/8}else v=Yf(K.getEye(),N)/10;var h,Z,y=v/(f?5:10),j=.7*v,m=.4*j,F=N[0],D=N[1],z=N[2];h=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],_&&e._17O(V,c,b,f,an,M,h,[F,D-y,z,F+j,D-y,z,F+j,D,z,F+j,D,z,F,D,z,F,D-y,z,F,D-y,z+y,F+j,D-y,z+y,F+j,D-y,z,F+j,D-y,z,F,D-y,z,F,D-y,z+y]),Z=F+j,Y&&e._17O(V,c,b,f,Es,l,h,[Z,D-y,z,Z+m,D-y,z,Z+m,D,z,Z+m,D,z,Z,D,z,Z,D-y,z,Z,D-y,z+y,Z+m,D-y,z+y,Z+m,D-y,z,Z+m,D-y,z,Z,D-y,z,Z,D-y,z+y]),Z+=m,U&&e._17O(V,c,b,f,Cs,M,h,[Z,D-y,z,Z+m,D-y,z,Z+m,D,z,Z+m,D,z,Z,D,z,Z,D-y,z,Z,D-y,z+y,Z+m,D-y,z+y,Z+m,D-y,z,Z+m,D-y,z,Z,D-y,z,Z,D-y,z+y]),h=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],_&&e._17O(V,c,b,f,Kd,t,h,[F,D,z,F,D+j,z,F-y,D+j,z,F-y,D+j,z,F-y,D,z,F,D,z,F,D,z,F,D,z-y,F,D+j,z-y,F,D+j,z-y,F,D+j,z,F,D,z]),Z=D+j,Y&&e._17O(V,c,b,f,Fs,l,h,[F,Z,z,F,Z+m,z,F-y,Z+m,z,F-y,Z+m,z,F-y,Z,z,F,Z,z,F,Z,z,F,Z,z-y,F,Z+m,z-y,F,Z+m,z-y,F,Z+m,z,F,Z,z]),Z+=m,U&&e._17O(V,c,b,f,Nd,t,h,[F,Z,z,F,Z+m,z,F-y,Z+m,z,F-y,Z+m,z,F-y,Z,z,F,Z,z,F,Z,z,F,Z,z-y,F,Z+m,z-y,F,Z+m,z-y,F,Z+m,z,F,Z,z]),h=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],_&&e._17O(V,c,b,f,jb,q,h,[F,D,z,F,D,z+j,F,D-y,z+j,F,D-y,z+j,F,D-y,z,F,D,z,F,D-y,z,F-y,D-y,z,F-y,D-y,z+j,F-y,D-y,z+j,F,D-y,z+j,F,D-y,z]),Z=z+j,Y&&e._17O(V,c,b,f,Gs,l,h,[F,D,Z,F,D,Z+m,F,D-y,Z+m,F,D-y,Z+m,F,D-y,Z,F,D,Z,F,D-y,Z,F-y,D-y,Z,F-y,D-y,Z+m,F-y,D-y,Z+m,F,D-y,Z+m,F,D-y,Z]),Z+=m,U&&e._17O(V,c,b,f,Ds,q,h,[F,D,Z,F,D,Z+m,F,D-y,Z+m,F,D-y,Z+m,F,D-y,Z,F,D,Z,F,D-y,Z,F-y,D-y,Z,F-y,D-y,Z+m,F-y,D-y,Z+m,F,D-y,Z+m,F,D-y,Z])}},_17O:function(e,f,R,z,q,O,k,i){var s=this.gv,d=s._buffer,l=ep.for(e),r=l.directUniforms(),Q=l.directAttribs();if(s._picking){z=s.pickColorMap;var $=Hs[q];z[$]={data:R,part:q},r.uFixPickReverseColor=mc($)}Me(e,f,Z,!0,Z,!0,Z,!1),r.uDiffuse=O,Q.aPosition=Xi(e,d.vs,new Sf(i),Z),Q.aNormal=Xi(e,d.ns,new Sf(k),Z),zc(e),Ae(e,0,12),ui(e),Qc(e,f)}});var Is=T.Raycaster=function(z){this.gv=z,this.maxTriangleTest=1/0,this.backfaceCulling=!0};is("Raycaster",i,{intersect:function(d){var p=this,b=p.gv,Q=b.getDataAt(d);return Q?p.intersectObject(d,Q):null},intersectObjects:function(X,j,n){var a,t,H,w,b=this,_=1/0,D=X.origin||(new Xc).fromArray(b.gv.getEye()),z=b.maxTriangleTest,g=[];j.forEach(function(w){n&&n(w)===!1||w.s("intersect")!==!1&&g.push(w)});var U=D.distanceToSquared2([0,0,0]);return g.sort(function(q,S){return(q.p3?D.distanceToSquared2(q.p3()):U)-(S.p3?D.distanceToSquared2(S.p3()):U)}),b.countTriangles=0,g.forEach(function(i){b.countTriangles>z||(a=b.intersectObject(X,i),a&&(t=D.distanceToSquared(a.world),_>t&&(H=i,w=a,_=t)))}),b.countTriangles=0,{data:H,intersect:w}},intersectObject:function(r,M){if(r instanceof Ne)return this._intersectObjectImpl(r,M);var p=this,i=p.gv,J=i.unproject(r),o=new Xc,l=i.getEye(),G=new Xc;if(i.isOrtho()){var L=new Xc(l);G.copy(i.getCenter()).sub(L).normalize();var N=o.copy(J).sub(L).dot(G);o.copy(G).setLength(-N).add(L.copy(J))}else o.copy(l),G.copy(J).sub(o).normalize();var x=new T.Math.Ray(o,G);return p._intersectObjectImpl(x,M)},_intersectObjectImpl:function(){function k(){var H=new Xc;return H.subVectors(z,x),Y.subVectors(y,x),H.cross(Y).normalize(),H}function $(m,u,T,f,G,l,Z){return Gl.barycoordFromPoint(m,u,T,f,S),G.multiplyScalar(S.x),l.multiplyScalar(S.y),Z.multiplyScalar(S.z),G.add(l).add(Z),G.clone()}var Z=new ab,w=new ab,G=new Ne,g=new Xc,b=new Xc,C=new Xc,K=new Xc,O=new Xc,y=new Xc,x=new Xc,z=new Xc,h=new xg,c=new xg,v=new xg,Y=new Xc,U={vs:ur,is:Zo,uv:me},S=new Xc,X=Sl.slice(0);return X.push("csg"),function(r,L){var n=this.gv.getData3dUI(L),u=L.mat||n.mat;u?Z.fromArray(u):Z.identity(),w.getInverse(Z),G.copy(r).applyMatrix4(w);var e,m,W,l="body",S=n.shapeModel;if(!S&&(L instanceof T.Polyline||L instanceof T.Edge)&&n.lineShapeModel&&(S=n.lineShapeModel),S||(S=If(n)),S||(T.CSGNode&&L instanceof T.CSGNode||T.CSGShape&&L instanceof T.CSGShape?(W=!0,S=[n.left,n.front,n.right,n.back,n.top,n.bottom,n.csg]):L instanceof T.Node&&!(L instanceof T.Shape)?(e=!0,S=U):(m=!0,S=[n.left,n.front,n.right,n.back,n.top,n.bottom])),!S)return console.log("Can not find shape model."),null;tj(S)||(S=[S]);var i,D,Q,Y,P,A,t,N,d,E,f,q,J,j,o,M,H=1/0,s=["","top_","bottom_"],F=!1,R=this.backfaceCulling,B=[];for(li(S,n,B),i=0,D=B.length;D>i;i++)if(J=B[i])for(Q=0,Y=s.length;Y>Q;Q++)if(j=s[Q],t=J[j+"vs"],N=J[j+"is"],d=J[j+"uv"]||J[j+"tuv"],t){if(o=J[j+"boundingBox"]){var f=G.intersectBox(o);if(!f)continue;if(G.origin.distanceTo(f)>H)continue;M=!1}else J[j+"boundingBox"]=o=new T.Math.Box3,M=!0;for(P=0,A=N?N.length:t.length/3;A>P;P+=3)this.countTriangles++,N?(b.fromArray(t,3*N[P]),C.fromArray(t,3*N[P+1]),K.fromArray(t,3*N[P+2])):(b.fromArray(t,3*P),C.fromArray(t,3*(P+1)),K.fromArray(t,3*(P+2))),M&&(o.expandByPoint(b),o.expandByPoint(C),o.expandByPoint(K)),E=G.intersectTriangle(b,C,K,R,g),E&&(q=G.origin.distanceTo(E),H>q&&(H=q,O.copy(E),y.copy(b),x.copy(C),z.copy(K),""!==j?l=j.slice(0,-1):e?l=Sl[Math.floor(P/6)]:m?l=Sl[i]:W&&(l=X[i]),d&&(F=!0,N?(h.fromArray(d,2*N[P]),c.fromArray(d,2*N[P+1]),v.fromArray(d,2*N[P+2])):(h.fromArray(d,2*P),c.fromArray(d,2*(P+1)),v.fromArray(d,2*(P+2))))))}if(!isFinite(H))return null;var a,I=O.clone().applyMatrix4(Z);F&&(a=$(O,y,x,z,h,c,v));var _=k(y,x,z),V=k(y.applyMatrix4(Z),x.applyMatrix4(Z),z.applyMatrix4(Z)),p=G.direction.dot(_);return p>0&&(_.multiplyScalar(-1),V.multiplyScalar(-1)),{world:I,local:O.clone(),worldNormal:V,normal:_,uv:a,part:l}}}()});var Js=function(d,G){this.gv=d,this.s=function(v,$,T){return $==Z&&($=T),$==Z?G.getStyle(v):sn($,G,d)},this.data=G};hk(Js,i,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:c,iv:function(){this._iv=!0},update:function(J,w,T){var U=this,o=U.data;if(J||(J=U.gv,w=J.getGL(),T=w._40Q),!U.needValidate(w)||!J.isVisible(o))return T.push(this,!1),void 0;var V,B,$,v,s,F=o._id,H=U.s("autorotate")||U.s("shape3d.autorotate")||U.s("fixSizeOnScreen")||U.s("shape3d.fixSizeOnScreen")?null:U.s("batch"),n=o.getRenderLayer(),S=T.get(n,!0),u=S.batchIndexMap,L=S.batchModelMap,i=J.getBrightness(o),t=i!=Z&&1!==i;V=Jp(u,L,o,H,J);var C=U.validate(V,H?J.getBatchInfo(H)||je:Z);if(V&&(B=u[F],$=B.size=V.vs.length/3-B.begin,s=V.rs))for(i=t?i:1,v=0;$>v;v++)s.push(i);var P=J.getWireframeGeometry(o);if(P)Ii(J,o,P);else if(lm(o)){var N=J.getWireframe(o);N&&Ii(J,o,N)}U.labelInfo=U.label2Info=U.noteInfo=U.note2Info=U._38o=Z,U._24O(Tp,"getLabel"),U._24O(Mj,"getLabel2"),U._26O(Bl,"getNote"),U._26O(re,"getNote2"),U._15O(),U.interactiveInfo=J.isInteractive(o)?{}:Z,S.push(this,!0),C!==!1&&(U._iv=!1)},clearWireframeGeometryCache:function(){var Y=this;Gj(Y),Y.data.iv()},_46Q:function(s){var t=this,T=t.data,h=t.gv;if(h.isVisible(T)){var c=T._id,w=h._40Q.get(T._renderLayer,!0),$=w.batchIndexMap[c],r=w.polylineIndexMap[c],z=w.wireframeIndexMap[c];if($||r||z){var S=sf(s,h.pickColorMap,h.isSelectable(T),T,Jh,!0);S&&(eg(S,$,w.batchModelMap),eg(S,r,w.polylineModelMap),eg(S,z,w.wireframeModelMap))}}},_42:function(R,f,P){function A(f,b,I){var s=b.getBrightness(I),$=I.s("alphaTest"),V=I.s("envmap"),E=ep.for(f),A=E.directUniforms();s!=Z&&1!==s&&(A.uBrightness=s),A.uAlphaTest=$,A.uUseEnvMap=V?!0:!1,A.uReflectivity=V||.01,A.shadowReceive=!_&&I.s("shadow.receive"),A.shadowCull=!_&&!!I.s("shadow.cull");var W=n.s("3d.clip.direction");if(W){var P=n.s("3d.clip.percentage");0===P&&(q=!1);var c=n._formatClipUniforms(W,P,I);A.uClipPercent=c[1],A.uClipDirection=c[0]}else A.uClipDirection=0;f._blooming&&!I.s("bloom")&&(A.blackout=!0)}var n=this,l=n.data,G=n.gv;if(G.isVisible(l)){var h,_=G._picking;if(_)h=G.pickColorMap;else{if(G.isTransparentMask(l)||G.isReflecting(R)&&l.s("3d.reflectable")===!1)return;h=c}if(Js.getTitle===c){Js.getTitle=0;for(var X in L)if(X.length===Mj.length+1&&X[Mj.length]===Bs[4].toUpperCase()&&X[Mj.length-1]===Bs[Mj.length+1].toUpperCase()){Js.getTitle=Nl;break}}if(!Js.getTitle||bi[Mj.length+2]){if(Js.getHead===c){Js.getHead=0;for(var X in d){var M="box-sizing";6===X.length&&X[0]===Bs[4]&&X[3]===M[0]&&X[4]===M[1]&&X[5]===M[2]&&(Js.getHead=Nl)}}if(!Js.getHead||bi[Mj.length]){var s,v,w=l._id,o=G._40Q.get(l._renderLayer,!0),Q=o.batchIndexMap,u=o.batchModelMap,J=G.isSelectable(l),S=!1,q=!0,C=Q[w];if(_&&(v=sf(R,h,J,l,Jh,C),v&&!G._45Q&&(eg(v,C,u),eg(v,o.polylineIndexMap[w],o.polylineModelMap),eg(v,o.wireframeIndexMap[w],o.wireframeModelMap))),C||(S||(S=!0,A(R,G,l)),q&&n._80o(R,f,P)),G.isLabelVisible(l)&&((s=n.labelInfo)&&(_&&sf(R,h,J,l,Tp),S||(S=!0,A(R,G,l)),n._28O(s,Tp,P)),(s=n.label2Info)&&(_&&sf(R,h,J,l,Mj),S||(S=!0,A(R,G,l)),n._28O(s,Mj,P))),G.isNoteVisible(l)&&((s=n.noteInfo)&&(_&&sf(R,h,J,l,Bl),S||(S=!0,A(R,G,l)),n._29O(s,Bl,P)),(s=n.note2Info)&&(_&&sf(R,h,J,l,re),S||(S=!0,A(R,G,l)),n._29O(s,re,P))),(s=n._38o)&&(S||(S=!0,A(R,G,l)),n._99O(R,f,s,h,J,P)),S){var z=ep.for(R).directUniforms();z.uBrightness=1,z.uClipDirection=0,R._blooming&&(z.blackout=!1)}}}}},_formatClipUniforms:function(P,z,Q){switch(P){case"left":P=2;break;case"top":P=3;break;case"bottom":P=4;break;case"front":P=5;break;case"back":P=6;break;case"right":default:P=1}if(0===P%2&&(z=1-z),Q instanceof T.Shape){var I=Q.s3(),H=Q.p3(),m=Q.getAnchor3d();z=3>P?(z-m.x)*I[0]+H[0]:5>P?(z-m.y)*I[1]+H[1]:(z-m.z)*I[2]+H[2]}else z-=.5;return[P,z]},prepare:function(){var h=this,p=h.data;if(!(p instanceof Tb)){var d,t,S,U,N,V=h.gv,y=V.getGL(),n=p._id,j=h.s("batch"),c=V._batchIndexMap,b=V._batchModelMap,F=V.getBrightness(p),o=F!=Z&&1!==F;if(h.needValidate(y)){if(d=Jp(c,b,p,j,V),h.validate(d,j?V.getBatchInfo(j)||je:Z),d&&(t=c[n],S=t.size=d.vs.length/3-t.begin,N=d.rs))for(F=o?F:1,U=0;S>U;U++)N.push(F);if(lm(p)){var P=V.getWireframeGeometry(p);if(P)Ii(V,p,P);else{var g=V.getWireframe(p);g&&Ii(V,p,g)}}h.labelInfo=h.label2Info=h.noteInfo=h.note2Info=h._38o=Z,h._24O(Tp,"getLabel"),h._24O(Mj,"getLabel2"),h._26O(Bl,"getNote"),h._26O(re,"getNote2"),h._15O(),h.interactiveInfo=V.isInteractive(p)?{}:Z,h._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=c},getBoundingBox:function(){var x,V,I,d,z,F;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;x||(x={vs:ur,is:Zo,uv:me},V=new Xc,I=new Xc,d=new Xc,z=new Xc,F=new Xc);var M=this,k=M.data,G=M.shapeModel;if(G||k instanceof T.Shape||(G=If(M)),!G&&k instanceof T.Shape&&(M.prepare(),G=M.shapeModel),G||(k instanceof T.Node&&!(k instanceof T.Shape)?G=x:(M.left||M.front||M.right||M.back||M.top||M.bottom)&&(G=[M.left,M.front,M.right,M.back,M.top,M.bottom])),!G)return c;tj(G)||(G=[G]);var o,B,b,s,R,h,r,C,v,Z,l,W,X=["","top_","bottom_"],w=new T.Math.Box3,S=!1;if(M._needRecoverPosition){z.set.apply(z,k.p3());var e=k.s3();F.set(1/(e[0]||1),1/(e[1]||1),1/(e[2]||1))}else z.set(0,0,0),F.set(1,1,1);for(o=0,B=G.length;B>o;o++)if(v=G[o])for(b=0,s=X.length;s>b;b++)if(Z=X[b],r=v[Z+"vs"],C=v[Z+"is"],r){if(W=Z+"boundingBox",l=v[W],!l)for(v[W]=l=new T.Math.Box3,R=0,h=C?C.length:r.length/3;h>R;R+=3)C?(V.fromArray(r,3*C[R]).sub(z).multiply(F),I.fromArray(r,3*C[R+1]).sub(z).multiply(F),d.fromArray(r,3*C[R+2]).sub(z).multiply(F)):(V.fromArray(r,3*R).sub(z).multiply(F),I.fromArray(r,3*(R+1)).sub(z).multiply(F),d.fromArray(r,3*(R+2)).sub(z).multiply(F)),!V.isNaN()&&l.expandByPoint(V),!I.isNaN()&&l.expandByPoint(I),!d.isNaN()&&l.expandByPoint(d);w.expandByBox(l),S=!0}return S?(this._cacheBoundingBox=w,i.freeze(w),i.freeze(w.min),i.freeze(w.max),ic(M.gv,k),w):c}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return De},_80o:function(){},dispose:function(){var G=this,h=G.data,D=h._pickId;if(D){var B=G.gv.pickColorMap;B[D]&&delete B[D]}},getBodyColor:function(D){var X=this.data,c=this.gv.getBodyColor(X);return c?c:D?X.getStyle(D):Z},getCachedTexture:function(_){var v=this._cachedTextures;return v?v[_||"main"]:null},setCachedTexture:function(s,e){var S=this._cachedTextures;return S||(S=this._cachedTextures={}),S[e||"main"]=s,s},invalidateCachedTexture:function(d){var K=this._cachedTextures;if(K){for(var f in K)d.deleteTexture(K[f]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(W,q){var p=this,n=p.data,A=p.gv,P=p.s,L=A[q](n);if(L!=Z){var u=P(W+".scale"),_=P(W+".max"),Q=p[W+"Info"]={label:L,textureScale:P(W+".texture.scale"),color:A[q+"Color"](n),font:P(W+".font"),align:P(W+".align"),background:A[q+"Background"](n)},s=Q.rect=Yr(Q,L);_>0&&_<s.width&&(Q.labelWidth=s.width,s.width=_),s.x=s.y=0,s.width*=u,s.height*=u,Q.mat=p._16O(P(W+".autorotate"),P(W+".position"),s,P(W+".face"),P(W+".t3"),P(W+".r3"),P(W+".rotationMode"));var K=s.width/2,B=s.height/2;Q.vs=new Sf([-K,B,0,-K,-B,0,K,-B,0,K,B,0]),s.width/=u,s.height/=u}},_26O:function(K,b){var g=this,Y=g.data,x=g.gv,r=g.s,_=x[b](Y);if(_!=Z){var J=r(K+".scale"),E=this[K+"Info"]={note:_,textureScale:r(K+".texture.scale"),expanded:r(K+".expanded"),font:r(K+".font"),color:r(K+".color"),align:r(K+".align"),borderWidth:r(K+".border.width"),borderColor:r(K+".border.color"),background:x[b+"Background"](Y)};if(E.expanded){var i=r(K+".max"),v=Yr(E,_);v.width+=6,v.height+=2,i>0&&i<v.width&&(E.labelWidth=v.width,v.width=i);var s={x:-v.width/2,y:-8-v.height,width:v.width,height:v.height+8}}else s={x:-6,y:-18,width:12,height:18};E.mat=g._16O(r(K+".autorotate"),r(K+".position"),Z,r(K+".face"),r(K+".t3"),r(K+".r3"),r(K+".rotationMode")),E.rect=s,1!==J&&(s=zl(s),s.x*=J,s.height*=J,s.y=-s.height,s.width*=J);var F=s.x,G=s.y,n=s.width,t=s.height;E.vs=new Sf([F,-G,0,F,-G-t,0,F+n,-G-t,0,F+n,-G,0])}},eachShapeModel:function($,k){function s(K){yc(K),K.vs&&$(K.vs,K.is,K.ns,K.uv),K.top_vs&&$(K.top_vs,K.top_is,K.top_ns,K.top_uv),K.bottom_vs&&$(K.bottom_vs,K.bottom_is,K.bottom_ns,K.bottom_uv),K.from_vs&&$(K.from_vs,K.from_is,K.from_ns,K.from_uv),K.to_vs&&$(K.to_vs,K.to_is,K.to_ns,K.to_uv)}function z(k){var C,R,p;if(tj(k))for(R=0,p=k.length;p>R;R++)C=k[R],C&&z(C);else em(k)?z(If(J,k),J):Ue(k)&&(k.shape3d?z(k.shape3d):s(k))}var J=this,j=J.data,k=k||J.shapeModel||If(J);k||(k=j instanceof T.Node&&!(j instanceof T.Shape)?{vs:ur,is:Zo}:[J.left,J.front,J.right,J.back,J.top,J.bottom]),z(k)},_28O:function(Y,K,$){if($(this.s(K+".transparent"))){var _=Y.rect,M=Y.textureScale,j=_.width*M,p=_.height*M;if(j>=1&&p>=1){var c=ul(j,p);1!==M&&(c.translate(_.x,_.y),c.scale(M,M),c.translate(-_.x,-_.y)),$n(c,Y),c.restore(),_o(this,K,Y.mat,Y.vs,!0)}}},_29O:function(R,h,a){if(a(this.s(h+".transparent"))){var K=R.rect,e=R.textureScale,d=K.x,Q=K.y,w=K.width*e,v=K.height*e;if(w>=1&&v>=1){K.x=K.y=0;var l=ul(w,v);1!==e&&l.scale(e,e),Qk(l,R),l.restore(),K.x=d,K.y=Q,_o(this,h,R.mat,R.vs,!1)}}},_99O:function(X,k,z,B,e,F){if(z){var r=this,P=r.gv,D=r.data,j=P._buffer,I=P._1O,c=z.icons,A=ep.for(X),y=A.directAttribs();for(var C in c){var x=c[C],R=z.rects[C];if(R&&F(sn(x.transparent,D,P))){P._picking&&sf(X,B,e,D,C);var m=sn(x.shape3d,D,P),M=m?[m]:sn(x.names,D,P),f=M?M.length:0,d=sn(x.textureScale,D,P)||1,U=sn(x.light,D,P);U==Z&&(U=m?!0:!1),Me(X,k,sn(x.blend,D,P),U,sn(x.opacity,D,P),sn(x.reverseFlip,D,P),sn(x.reverseColor,D,P),sn(x.reverseCull,D,P));for(var V=0;f>V;V++){var J=M[V],g=R[V];if(Jr(r,g.mat),m)$q(P,D,If(r,m),r);else{var H=qh(J);if(H){var W=g.width*d,b=g.height*d;if(W>=1&&b>=1){var _=ul(W,b);_r(_,H,sn(x.stretch,D,P),0,0,W,b,D,P),_.restore(),db(X,tq,I),zc(X,k,I,sn(x.discardSelectable,D,P),j.uv,Ai),y.aPosition=Xi(X,j.vs,g.vs,Z),y.aNormal=cg(X,j.ns,Kq,Z),Yc(X,j.is,yh),nh(X,0,yh.length),ui(X,k,I)}}}Wl(P)}Qc(X,k)}}}}});var Ks=function(u,H){to(Ks,this,[u,H])};hk(Ks,Js,{_16O:function(q,l,O,h,g,C,p,m,s){var t=this.data,$=t.getFinalScale3d(),n=tf(l,$,O,h,m,s);if(t.hasOwnProperty("_anchor")||t.hasOwnProperty("_anchorElevation")){var Q=t.getAnchor3d();n[0]-=(Q.x-.5)*$[0],n[1]-=(Q.y-.5)*$[1],n[2]-=(Q.z-.5)*$[2]}return yj(Bf(),n,t.p3(),h,g,C,p,q,t.getFinalRotation3d(),t.getRotationMode())},clear:function(){var f=this;f.faceMat=f.mat=f.shapeModel=f.left=f.right=f.front=f.back=f.top=f.bottom=f.csg=Z},needValidate:function(K){if(this._iv)return this._validateFrameId=K._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var R=K._renderInfo.frame;if(this._validateFrameId!==R)return this._validateFrameId=R,!0}return!1},validate:function(F,U){var O=this,h=O.gv,v=O.data,_=O.shapeName=O.s(lg),T=If(O,_);if(O._updateAutoRotation(),O._updateFixSize2d(),O._updateOverlapping(),O.dispatchBoundingBoxChanged(),this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")){var z=v.getRenderLayer(),t=h._40Q.get(z);t&&t.ivWireframeBatch(v)}var B=$l(v,h.getMat(v),T?O.s("shape3d.scaleable"):!0);if(v.appendAnchorMatrix3d(B),O.clear(),O.mat=v.mat=B,T||!_)if(O.shapeModel=T,F)if(T)fe(h,v,T,O,O.getBodyColor(),[B],F);else{var H=jp(B);sq(h,v,F,U,B,H,Cl,Vd),sq(h,v,F,U,B,H,ij,$c),sq(h,v,F,U,B,H,Vl,Uq),sq(h,v,F,U,B,H,mf,gk),sq(h,v,F,U,B,H,qn,Wp),sq(h,v,F,U,B,H,Kf,Fp)}else T||(O._cubeUvs=null,O.vf(Cl,0),O.vf(ij,16),O.vf(qn,8),O.vf(Kf,24),O.vf(Vl,32),O.vf(mf,40))},_updateAutoRotation:function(){var H=new Lc,k=new ab,C=new Xc,c=new Xc,z=new Xc;return function(){var e=this,K=e.data,T=e.s("autorotate")||e.s("shape3d.autorotate");if(!T)return K._dynamicRotation&&delete K._dynamicRotation,void 0;var N=e.gv;z.copy(e.s("shape3d.autorotate.up")||N._up);var x;x="string"==typeof T?[T.indexOf("x")<0?N._eye[0]:N._center[0],T.indexOf("y")<0?N._eye[1]:N._center[1],T.indexOf("z")<0?N._eye[2]:N._center[2]]:N._eye;var t=N._center,i=K.p3();C.copy(i),c.set(x[0]-t[0],x[1]-t[1],x[2]-t[2]).add(C),k.lookAt(c,C,z),H.set(0,0,0,K.getRotationMode(),!0).setFromRotationMatrix(k);var X=K._dynamicRotation;X&&Math.abs(X[0]-H.x)<1e-5&&Math.abs(X[1]-H.y)<1e-5&&Math.abs(X[2]-H.z)<1e-5||(K._dynamicRotation=[H.x,H.y,H.z])}}(),_updateFixSize2d:function(){var R=this,t=R.data,B=R.s("fixSizeOnScreen")||R.s("shape3d.fixSizeOnScreen");if(!B)return t._dynamicScale3d&&delete t._dynamicScale3d,void 0;var z=R.gv,S=$l(t,z.getMat(t)),M=oi([0,0,0],S),Z=z.toViewPosition(M);if(!isNaN(Z.x)&&!isNaN(Z.y)){var i=oi([1,0,0],S),e=z.toViewPosition(i),b=oi([0,1,0],S),c=z.toViewPosition(b),N=e.x-Z.x,q=c.y-Z.y;if(N&&q){var Y,G,v=t._dynamicScale3d||[1,1,1],_=qh(t.s("shape3d.image"));if(B[0]>0&&(Y=B[0]),B[1]>0&&(G=B[1]),!Y||!G){var r=B>0?B:1;Y||(Y=(Vk(_,t)||t.getWidth())*r),G||(G=(xl(_,t)||t.getTall())*r)}var W=Math.abs(N/Y),l=Math.abs(q/G);Math.abs(W-1)<.001&&Math.abs(l-1)<.001||(t._dynamicScale3d=[v[0]/W,v[1]/l,v[2]])}}},_updateOverlapping:function(){var j=this,Q=j.s("hide.overlapping.group");if(!Q)return j._rectOverlapping&&(j._rectOverlapping=c),void 0;var X,Z,f,u=j.gv,p=j.data,e=$l(p,u.getMat(p)),h=1/0,N=1/0,o=-1/0,U=-1/0,w=p.getAnchor3d(),A=w.x,n=w.y,k=w.z;for(X=0;8>X;X++){if(Z=oi([(X>>2)-A,(1&X>>1)-n,(1&X)-k],e),f=u.toViewPosition(Z),isNaN(f.x)||isNaN(f.y))return;h=Math.min(h,f.x),o=Math.max(o,f.x),N=Math.min(N,f.y),U=Math.max(U,f.y)}var B={x:h,y:N,w:o-h,h:U-N};j._rectOverlapping=u.overlappingBox.isOverlapping(Q,B)},getVectorDynamicSize:function(){var S,g=this,u=g.s("shape3d"),C=g.data;if("billboard"===u||"plane"===u||(S=C._currentCubeElementId)!=Z){var e,h,J=g.gv,M=$l(C,J.getMat(C)),v=C.getAnchor3d(),Y=.5-v.x,F=.5-v.y,N=.5-v.z,i=Math.min(g.s("vector.dynamic.maxsize"),J._glCapabilities.maxTextureSize)/J.getDevicePixelRatio(),L=function(o,I){o[0]+=Y,o[1]+=F,o[2]+=N,I[0]+=Y,I[1]+=F,I[2]+=N;var q=J.toViewPosition(oi(o,M)),U=J.toViewPosition(oi(I,M)),$=q.x-U.x,f=q.y-U.y;return Math.min(i,Math.sqrt($*$+f*f))};if("billboard"===u)e=L([-.5,0,0],[.5,0,0]),h=L([0,-.5,0],[0,.5,0]);else if("plane"===u)e=L([-.5,0,0],[.5,0,0]),h=L([0,0,-.5],[0,0,.5]);else if(C._currentCubeElementId!=Z){var d=3*Zo[S+1],z=3*Zo[S],x=3*Zo[S+2];e=L([ur[d],ur[d+1],ur[d+2]],[ur[x],ur[x+1],ur[x+2]]),h=L([ur[d],ur[d+1],ur[d+2]],[ur[z],ur[z+1],ur[z+2]])}return[e,h]}},vf:function(P,e){var M=this;if(M.gv.getFaceVisible(M.data,P)){var h=Qj(M,P);h.mat&&(M.faceMat=!0);var N=h.uv;if(N){var J=M._cubeUvs;J||(J=M._cubeUvs=new Sf([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var u=0;8>u;u++)J[e+u]=N[u]}return h}},_billboardInView:function(){var $=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],T=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],g=new Ek,w=new Xc,C=new ab;return function(I){var A=this;if(!A.mat)return!0;var L=A.gv.getFrustum(),Q="billboard"===I?$:T;g.makeEmpty(),C.fromArray(A.mat);for(var q=0,f=Q.length;f>q;q+=3)g.expandByPoint(w.fromArray(Q,q).applyMatrix4(C));return L.intersectsBox(g)}}(),_80o:function(q,z,t){var r=this;if(r._rectOverlapping)return!0;var S=r.shapeModel;if(S||!r.shapeName){var h=r.s("shape3d");if(("billboard"===h||"plane"===h)&&!r._billboardInView(h))return!0;var $=r.gv,J=r.data,y=$._cube,l=ep.for(q),I=l.directAttribs();if(og&&!jj){var X=r.mat;if(X)for(var d=0;d<X.length;d++)r.mat[d]=X[X.length-d-1]}Gr($,r.mat),r.s("shape3d.reflector")&&!q._picking||(S?$q($,J,S,r,r.getBodyColor(),t):(I.aPosition=Xi(q,y.vs,Z,Z),I.aNormal=Xi(q,y.ns,Z,Z),Vg(q,y.is),r._18O(q,z,"left",0,t),r._18O(q,z,"front",6,t),r._18O(q,z,"right",12,t),r._18O(q,z,"back",18,t),r._18O(q,z,"top",24,t),r._18O(q,z,"bottom",30,t))),Wl($),r.faceMat&&(r._18O(q,z,"left",0,t,!0),r._18O(q,z,"front",6,t,!0),r._18O(q,z,"right",12,t,!0),r._18O(q,z,"back",18,t,!0),r._18O(q,z,"top",24,t,!0),r._18O(q,z,"bottom",30,t,!0))}},_18O:function(O,W,l,y,e,r){var d=this[l];if(d){if(!e(d.transparent))return;if(r&&!d.mat||!r&&d.mat)return;var n=this.data.s("polygonOffset");n&&ef(O,n),r&&Gr(this.gv,d.mat);var x=this,s=x.data,A=ep.for(O),P=A.directUniforms();s._currentCubeElementId=y;var S=x.gv,t=S.getTexture(d.texture,s,l),F=d.uv,M=d.uvScale,G=d.uvOffset,I=d.uvRotation,T=d.discardSelectable;t?F?zc(O,W,t,T,S._buffer.uv,x._cubeUvs,G,M,I):zc(O,W,t,T,S._cube.uv,Z,G,M,I):zc(O),Me(O,W,d.blend,d.light,d.opacity,d.reverseFlip,d.reverseColor,d.reverseCull),P.uDiffuse=d.color||X["color.empty"],nh(O,y,6),Qc(O,W),ui(O,W,t),r&&Wl(S),n&&Aj(O),s._currentCubeElementId=null}},drawReflector:function(){var F=new Xc,$=new Xc,b=new Lc,M=new ab,a=new Xc,A=new Xc,e=new Xc,Q=new Xc,G=new ab,z=new ab,I=new bj,S=new xo,m=new xo,x=function(r,S,E){r[E]=S[0],r[E+1]=S[1],r[E+2]=S[2]},J=function(X,t){x(X,t.getEye(),0),x(X,t.getCenter(),3),x(X,t.getUp(),6)},o=function(p,t){t._eye=[p[0],p[1],p[2]],t._center=[p[3],p[4],p[5]],t._up=[p[6],p[7],p[8]],t._18Q=Z;var a=t._skybox;a&&(a.p3([p[0],p[1],p[2]]),t.getData3dUI(a).iv())};return function(_){var N=this;N._reflectorInfo=null;var H=N.data;if(H._reflecting)return!1;var V=N.gv;if(V._picking)return!1;var k=N._reflectorRenderTarget,W=V._canvas.width,v=V._canvas.height;k?k.setSize(_,W,v):k=N._reflectorRenderTarget=new Ar.RenderTarget(V,_,W,v),F.copy(H.p3()),$.copy(V.getEye()),M.makeRotationFromEuler(b.set(H.r3(),H.getRotationMode(),!0));var T;if(!N._reflectNormal){var T=If(N,N.s("shape3d"));if(!T)return!1;if(!T.ns&&T.length&&(T=T[0]),!T.ns||!T.vs)return!1;N._reflectNormal=[T.ns[0],T.ns[1],T.ns[2]],N._reflectorVbuffer=Pq.Buffer.createVertexBuffer(_,new Float32Array(T.vs))}if(a.copy(N._reflectNormal),a.applyMatrix4(M),A.subVectors(F,$),A.dot(a)>0)return!1;A.reflect(a).negate(),A.add(F),e.copy(V.getCenter()).negate().add(F),e.reflect(a).negate(),e.add(F),Q.copy(V.getUp()),Q.reflect(a);var d=[0,0,0,0,0,0,0,0,0];J(d,V),V._eye=A.toArray(),V._center=e.toArray(),V._up=Q.toArray(),V._18Q=Z;var q=V._skybox;q&&(q.p3(V._eye),V.getData3dUI(q).iv()),io(_,k.frame),V.setViewport(_,0,0,k.width,k.height);var O=H.s("shape3d.reflector.background");if(O){var r=_.getParameter(_.COLOR_CLEAR_VALUE);fb(_,O)}else fb(_,[0,0,0,1]);ep.for(_).glState.depth.mask=!0,_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT);var X=H.s("shape3d.reflector.clip"),x=X===c?.003:X,t=Mb(V),K=ee(V);I.setFromNormalAndCoplanarPoint(a,F.add(a.clone().multiplyScalar(x))),I.applyMatrix4(z.fromArray(K)),S.set(I.normal.x,I.normal.y,I.normal.z,I.constant),z.fromArray(t).getInverse(z),m.set(Math.sign(S.x),Math.sign(S.y),1,1).applyMatrix4(z),S.multiplyScalar(2/S.dot(m)),t[2]=S.x-t[3],t[6]=S.y-t[7],t[10]=S.z-t[11],t[14]=S.w-t[15];var R=V._computedProjectMatrix;V._computedProjectMatrix=t,H._reflecting=!0,V.renderScene({renderAxis:!1,renderEdit:!1,renderGrid:!1}),V._computedProjectMatrix=R,G.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),G.multiply(z.fromArray(V._projectMatrix)),G.multiply(z.fromArray(V._viewMatrix)),O&&fb(_,r),lo(_),o(d,V);var i=H.s("shape3d.reflector.blur");if(i){var P=V.getPostProcessingModule("Blur");P&&P.drawImpl(_,k,i,i>=3,H.s("shape3d.reflector.blur.iterations"))}var f=_._compiledShader.reflector;f||(f=_._compiledShader.reflector=new Pq.Shader(_,Hm.Reflector.vs,Hm.Reflector.fs)),f.bind(),_.activeTexture(_.TEXTURE0),zk(_,k.texture),f.uniforms.tDiffuse=0,f.uniforms.color=sc(H.s("shape3d.reflector.color")||"rgb(128,128,128)"),f.uniforms.textureMatrix=G.toArray(),f.uniforms.modelMatrix=$l(H),f.uniforms.viewMatrix=ee(V),f.uniforms.projectionMatrix=Mb(V),N._reflectorVbuffer.upload(),f.attributes.pos.pointer(N._reflectorVbuffer);var g=this.s("shape3d.transparent");if(g){var B=ep.for(_).glState,C=B.depth.mask;B.depth.mask=!1}return _.drawArrays(_.TRIANGLES,0,6),g&&(B.depth.mask=C),H._reflecting=!1,_.useProgram(V._prg),zk(_,Z),!0}}()}),Hm.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Ls=function(W,Q){to(Ls,this,[W,Q])};hk(Ls,Ks,{_80o:function(){}});var Ms=function(Z,P){to(Ms,this,[Z,P])};hk(Ms,Js,{_25Q:1,validate:function(C){var U=this;if(!U.s("geometry.cache")||!U.info){var T=U.gv,d=U.data,n=U.s,o=n("edge.width"),Q=d._40I,X=d._41I;if(U.shapeModel=U.info=U.lineShapeModel=Z,Q&&X){var N,y,w,h,v,F,R,u,O,Y,b=d.isLooped(),A=n(Qe),H=L.getEdgeType(A);if(H){var P=H(d,qj(U,T,d,b,A),T,U._19Q);if(!P.points||P.points.isEmpty())return;F=U.info={},R=P.segments,v=P.points,u=v.size();for(var G=Q.getElevation(),W=X.getElevation(),m=0;u>m;m++){var r=v.get(m);r.e==Z&&(r.e=G+(W-G)*m/(u-1))}O=rq(v.get(0)),Y=rq(v.get(u-1));var j=u%2;0===j?(F.c1=rq(v.get(u/2-1)),F.c2=rq(v.get(u/2))):F.p3=rq(v.get((u-j)/2)),F.s1=O,F.s2=rq(v.get(1)),F.t1=rq(v.get(u-2)),F.t2=Y}else{v=new Dd,F=U.info={};var q=n("edge.offset"),z=n("edge.center"),M=n("edge.source.t3"),D=n("edge.target.t3"),g=Or(T,d,"source"),J=Or(T,d,"target");if(!g||!J)return T.invalidateData(d),delete U.info,!1;if(M&&(g[0]+=M[0],g[1]+=M[1],g[2]+=M[2]),D&&(J[0]+=D[0],J[1]+=D[1],J[2]+=D[2]),A===Eb){R=n("edge.segments");var $=F.points=n(xi)||jr;if(u=$.size()){O=rq($.get(0)),Y=rq($.get(u-1)),!z&&q&&(w=$i(O,g,!0),q=S(q,Yf(g,O)),g=[g[0]+w[0]*q,g[1]+w[1]*q,g[2]+w[2]*q],w=$i(J,Y,!0),q=S(q,Yf(Y,J)),J=[J[0]-w[0]*q,J[1]-w[1]*q,J[2]-w[2]*q]);var j=u%2;0===j?(N=rq($.get(u/2-1)),y=rq($.get(u/2))):F.p3=rq($.get((u-j)/2)),F.s1=g,F.s2=O,F.t1=Y,F.t2=J
}else!z&&q&&(w=$i(J,g,!0),h=Yf(g,J),q=xc(q,h),g=[g[0]+w[0]*q,g[1]+w[1]*q,g[2]+w[2]*q],J=[J[0]-w[0]*q,J[1]-w[1]*q,J[2]-w[2]*q]),N=g,y=J;v.add({x:g[0],y:g[2],e:g[1]}),v.addAll($),v.add({x:J[0],y:J[2],e:J[1]})}else{var V=qj(U,T,d,b,A);if(U._19Q||(V=-V),b){var x=g[0],k=g[1],E=g[2],e=Q.getTall()/2+V;N=[x-V,k+e,E],y=[x+V,k+e,E],v.add({x:x-V,y:E,e:k}),v.add({x:x-V,y:E,e:k+e}),v.add({x:x+V,y:E,e:k+e}),v.add({x:x+V,y:E,e:k})}else{w=$i(J,g,!0),h=Yf(g,J);var s={x:g[0],y:g[2]},i={x:J[0],y:J[2]},t=Ab(Z,s,i,V),c=t.x-s.x,B=t.y-s.y;q=xc(q,h),w[0]*=q,w[1]*=q,w[2]*=q,N=[g[0]+w[0]+c,g[1]+w[1],g[2]+w[2]+B],y=[J[0]-w[0]+c,J[1]-w[1],J[2]-w[2]+B],z?(v.add({x:g[0],y:g[2],e:g[1]}),v.add({x:N[0],y:N[2],e:N[1]}),v.add({x:y[0],y:y[2],e:y[1]}),v.add({x:J[0],y:J[2],e:J[1]})):(v.add({x:N[0],y:N[2],e:N[1]}),v.add({x:y[0],y:y[2],e:y[1]}))}}F.c1=N,F.c2=y}F._lastPointsSegments={points:v,segments:R},F.list=n(lg)===hm?U.createTubeModel(v,R,o/2,C):U.createLineModel(v,R,o,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=Z}});var Ns=function(a,h){to(Ns,this,[a,h]),this._needRecoverPosition=!0};hk(Ns,Ks,{_80o:function(V,z,g){var N=this,c=N.mat;if(c){var q=N.gv,t=N.shapeModel;Gr(q,c),t?$q(q,N.data,t,N,N.getBodyColor(),g):(qb(N,V,z,"left",g),qb(N,V,z,"front",g),qb(N,V,z,"right",g),qb(N,V,z,"back",g),qb(N,V,z,"top",g),qb(N,V,z,"bottom",g)),Wl(q)}},validate:function(H,I){var l,w,B=this,z=B.s,E=B.data,O=E._thickness/2,t=E.isClosePath(),_=E.getPoints(),h=E.getSegments(),v=z(wo),d=H&&H.uv;if(B.clear(),B.dispatchBoundingBoxChanged(),0>O){try{var n=z("shape3d.image.projection");if(n&&n[4]){var W=E.p3(),L=W[0],$=W[2];n=[L+n[0],n[1]-$,L+n[2],n[3]-$]}w=B.shapeModel=xh(_,h,z(sh),z(lj),v,z(Dp),E.getTall(),E.getShapeElevation(),t,n)}catch(D){w=B.shapeModel={}}z(Tl)?z("shape3d.image")||delete w.uv:(delete w.vs,delete w.ns,delete w.uv),z("shape3d.top.image")||delete w.top_uv,z("shape3d.bottom.image")||delete w.bottom_uv}else if(z(lg)===hm)l=ac(_,h,v,t),w=B.shapeModel={vs:[]},z("shape3d.image")&&(w.uv=[],w.sum=z(Dp)||xf(l)||1,w.len=0),z(sh)&&!t&&(w.top_vs=[],z("shape3d.top.image")&&(w.top_uv=[])),z(lj)&&!t&&(w.bottom_vs=[],z("shape3d.bottom.image")&&(w.bottom_uv=[])),B._12O(l,O);else{var j,M,c,s,r,X,F,u,b,N;if(l=ac(_,h,v,t),r=B.vf(qn,d,!1,I),O&&(X=B.vf(Kf,d,!1,I),F=t?Z:B.vf(Cl,d,!1,I),u=t?Z:B.vf(ij,d,!1,I),b=B.vf(Vl,d,!1,I),N=B.vf(mf,d,!1,I)),O){for(var Y=0,V=l.length;V>Y;Y++)l[Y]=B._tryRemoveBezierPoints(l[Y],O);B._12O(l,O)}else r&&l.forEach(function(T){if(s=T.length,s>0)for(j=T[0],c=1;s>c;c++)M=T[c],B.addV(r.vs,j,M),j=M});B._20Q(l),H||(r&&(r.ns=$j(r.vs),jq(r,"vs"),jq(r,Ur)),O&&(X&&(X.ns=$j(X.vs),jq(X,"vs"),jq(X,Ur)),F&&(F.ns=$j(F.vs),jq(F,"vs"),jq(F,Ur)),u&&(u.ns=$j(u.vs),jq(u,"vs"),jq(u,Ur)),b&&(b.ns=$j(b.vs),jq(b,"vs"),jq(b,Ur)),N&&(N.ns=$j(N.vs),jq(N,"vs"),jq(N,Ur))))}var e=B.mat=E.getPointsMatrix3d().getElements();H&&(xs(B,e,H,w),B.clear())},_20Q:function(I){var b,M,v,K,k,x,o,T=this,V=T.front,Y=T.back,W=T.top,i=T.bottom,h=V?V.tuv:Z,U=Y?Y.tuv:Z,z=W?W.tuv:Z,_=i?i.tuv:Z,d=0;(h||U||z||_)&&(b=T.s(Dp)||xf(I)||1,I.forEach(function(Q){if(M=Q.length,M>0)for(x=Q[0],v=1;M>v;v++)o=Q[v],K=d/b,d+=Yf(x,o),k=d/b,T._14O(V,K,k),T._14O(Y,1-k,1-K),T._14O(W,K,k),T._14O(i,K,k),x=o}))},_14O:function(S,z,b){if(S){var c=S.uv,W=S.tuv;if(W){if(c)var f=c[0]+(c[6]-c[0])*z,y=c[1]+(c[7]-c[1])*z,C=c[2]+(c[4]-c[2])*z,i=c[3]+(c[5]-c[3])*z,q=c[2]+(c[4]-c[2])*b,I=c[3]+(c[5]-c[3])*b,Q=c[0]+(c[6]-c[0])*b,T=c[1]+(c[7]-c[1])*b;else f=z,y=0,C=z,i=1,q=b,I=1,Q=b,T=0;W.push(C,i,q,I,Q,T,Q,T,f,y,C,i)}}},_13O:function(W){var l=W.uv,F=W.tuv;F&&(l?F.push(l[2],l[3],l[4],l[5],l[6],l[7],l[6],l[7],l[0],l[1],l[2],l[3]):F.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(b,D){var F=b.length;if(4>F)return b;var L,T,Q,R,Y,f,p=!1,M=function(I){return b[I]},s=function(w){return b[F-1-w]};for(Y=0;1>=Y;Y++)for(f=Y?s:M,T=f(0),Q=f(1),L=2;F-1>L;L++)if(R=f(L),!R.remove)if(R.b){var q=Ab(T,Q,R,D);q.adjust?(R.remove=!0,p=!0):(T=Q,Q=R)}else T=Q,Q=R;if(!p)return b;var H=[];for(L=0;F>L;L++)b[L].remove||H.push(b[L]);return H},_12O:function(A,k){var r,V,m,Q,K,u=this.s("shape3d.point.epsilon"),q=this;A.forEach(function(e){if(K=e.length,K>0)for(r={p:e[0],n:!0},Q=1;K>Q;Q++)V=e[Q],m=K-1>Q?e[Q+1]:Z,m&&Math.abs(V.x-m.x)<u&&Math.abs(V.y-m.y)<u||q.addPoint(r,V,m,k,e)})},addPoint:function(f,d,i,T,S){var s,B,k,b,J,O,H,Y,h,V=this,C=f.p,z=f.f,l=f.b,j=V.s("shape3d.side")||Kk,v=V.s("shape3d.start.angle"),q=V.s("shape3d.sweep.angle"),n=V.shapeModel,$=V.data.isClosePath();if(f.n&&(f.n=!1,z=$&&S.length>2?Ab(S[S.length-2],C,d,T):Ab(Z,C,d,T),l=zo(C,z),n?n.top_vs&&V._10O(l,z,j,v,q,n.top_vs,n.top_uv):(s=V.left)&&(V.addV(s.vs,l,z),V._13O(s))),B=i?Ab(C,d,i,T):$&&S.length>2?Ab(C,d,S[1],T):Ab(C,d,Z,T),k=zo(d,B),n){var P,w,e=n.vs,G=n.uv,p=n.sum;for(G&&(P=n.len/p,n.len+=Yf(C,d),w=n.len/p),O=V._9O(l,z,j,v,q),H=V._9O(k,B,j,v,q),Y=0;j>Y;Y++)h=Y+1,Ff(e,O[h]),Ff(e,H[Y]),Ff(e,O[Y]),Ff(e,H[Y]),Ff(e,O[h]),Ff(e,H[h]),G&&(b=Y/j,J=h/j,G.push(P,J,w,b,P,b,w,b,P,J,w,J));!i&&n.bottom_vs&&V._10O(k,B,j,v,q,n.bottom_vs,n.bottom_uv,!0)}else!i&&(s=V.right)&&(V.addV(s.vs,B,k),V._13O(s)),(s=V.front)&&V.addV(s.vs,z,B),(s=V.back)&&V.addV(s.vs,k,l),(s=V.top)&&V.addH(s.vs,z,B,k,l,!0),(s=V.bottom)&&V.addH(s.vs,l,k,B,z);f.p=d,f.f=B,f.b=k},_10O:function(X,T,V,H,w,d,W,n){var e,Z,I=this,P=I.data,A=I._9O(X,T,V,H,w),L=(X.x+T.x)/2,x=(X.y+T.y)/2,M=P.getShapeElevation(),k=0;for(k=0;V>k;k++)n?(Ff(d,A[k]),Ff(d,A[k+1])):(Ff(d,A[k+1]),Ff(d,A[k])),Ff(d,[L,M,x]),W&&(n?(e=s*(k+1)/V+H,Z=s*k/V+H):(e=s*k/V+H,Z=s*(k+1)/V+H),W.push(.5-.5*K(Z),.5-.5*z(Z),.5-.5*K(e),.5-.5*z(e),.5,.5))},_9O:function(i,H,N,g,_){var w,L,Q=this,e=Q.data,u=[],M=(i.x+H.x)/2,J=(i.y+H.y)/2,I=e.getTall()/2,T=e.getShapeElevation(),W=0;for(_==Z&&(_=s);N>=W;W++)w=_*W/N+g,L=K(w),u.push([M+(i.x-M)*L,T+I*z(w),J+(i.y-J)*L]);return u},addV:function(V,r,G){var h=r.x,I=r.y,E=G.x,o=G.y,A=this.data,C=A.getShapeElevation(),a=A.getTall()/2;V.push(h,C-a,I,E,C-a,o,E,C+a,o,E,C+a,o,h,C+a,I,h,C-a,I)},addH:function(D,Q,o,h,X,L){var e=this.data,Z=e.getTall()/2,k=e.getShapeElevation()+(L?Z:-Z);D.push(Q.x,k,Q.y,o.x,k,o.y,h.x,k,h.y,h.x,k,h.y,X.x,k,X.y,Q.x,k,Q.y)},vf:function(a,j,W,l){var k,F=this,z=F.gv.getFaceVisible(F.data,a);return(W||z)&&(k=Qj(F,a,l),k.vs=[],k.tuv=z&&(k.texture||j)?[]:Z,k.visible=z),k}});var Os=function(H,U){to(Os,this,[H,U])},Ps={},Qs=function(c){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(c)};hk(Os,Ks,{validate:function(){var s=this,h=s.gv,l=s.data,k=s.s,m=sc(k("points.color")),_=k("points.size"),L=k("points.uv.offset"),U=k("points.image");!U||Qs(U)||xe.test(U)||(Ps[U]||(Ps[U]=s._createCachedImage(U)),U=Ps[U]);var H,o,t=l._modelDirty,b=k("points.model");if(b){if(s._lastShapeModel!==b||!s.shapeModel){var z=If(s,b);if(!z)return;var y=[],W={};s.eachShapeModel(function(z){for(var x=0,j=z.length;j>x;x+=3){var U=z[x],s=z[x+1],J=z[x+2],T=""+U+"_"+s+"_"+J;W[T]||(W[T]=!0,y.push(U,s,J))}},z),s._setShapeModelPoints(new Sf(y)),s._lastShapeModel=b,t=!0}H=s.shapeModel.vs.length,o=H/3}else{var V=l.getPoints();if(o=H=V.length,t||l._pointsDirty||!s.shapeModel){for(var F=[],D=0;o>D;D++){var Y=V[D];Y&&F.push(Y.x,Y.e,Y.y)}s._setShapeModelPoints(new Sf(F)),l._pointsDirty=!1,s._lastShapeModel=null,t=!0}}if(s.info={mat:$l(l),size:_,diffuse:m,opacity:k("points.opacity"),texture:U,alphaTest:k("points.transparent")?0:k("alphaTest"),uvScale:k("points.uv.scale"),uvOffset:L,discardSelectable:k("points.discard.selectable")},t||l._colorsDirty){var A=!1,K=l.getColors();if(K&&K.length>0)for(var N=[],D=0;o>D;D++)for(var C=K[D],q=C?(A=!0,sc(C)):m,J=4*D,u=0;4>u;u++)N[J+u]=q[u];s.shapeModel.cs=A?new Sf(N):null,l._colorsDirty=!1}if(t||l._sizesDirty){var P=!1,G=l.getSizes();if(G&&G.length>0)for(var Q,O=[],D=0;o>D;D++)Q=G[D],Q>=0?(O.push(Q),P=!0):O.push(_);s.shapeModel.ss=P?new Sf(O):null,l._sizesDirty=!1}if(t||l._offsetsDirty){var R=!1,E=l.getUvoffsets();if(E&&E.length>0)for(var i,Z,T,j=[],D=0;o>D;D++)i=2*D,Z=E[i],T=E[i+1],Z!=c&&T!=c?(j.push(Z,T),R=!0):j.push(L[0],L[1]);s.shapeModel.os=R?new Sf(j):null,l._offsetsDirty=!1}if(t||s._lastPointNumber!==o){this.dispose();var g=h.pickColorMap,$=s._startPickId=g._pickIdUsed;g._pickIdUsed=$+o;for(var F=[],D=0;o>D;D++){var n=$+D,d=mc(n);F.push(d[0],d[1],d[2],d[3]),g[n]||(g[n]={data:l,part:D})}s.shapeModel.ps=new Sf(F),s._lastPointNumber=o}l._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(z){var q=this,n=q.shapeModel,l=q.shapeModel={vs:z};if(!n)return l;var y=z.length,s=Math.round(y/3);return n.cs&&n.cs.length==4*s&&(l.cs=n.cs),n.ss&&n.ss.length==s&&(l.ss=n.ss),n.os&&n.os.length==2*s&&(l.os=n.os),n.ps&&n.ps.length==4*s&&(l.ps=n.ps),l},_createCachedImage:function(m){var i=128,z=qs(),X=z.getContext("2d");Ud(z,i,i,1),Ce(X,{width:i,height:i,comps:[{type:m,background:"white",borderWidth:0,rect:[0,0,i,i]}]},0,0,i,i);var W=T.Math.generateUUID();return pe[W]=z,W},_80o:function(b,y){var z=this,i=z.gv,m=i._picking;if(!m||i.isSelectable(z.data)){var E=z.shapeModel,U=z.info;if(E&&E.vs&&E.vs.length){var N=ep.for(b);N.useProgram(z._asureProgram(b));var s=N.directUniforms(),a=N.directAttribs();s.modelMatrix=U.mat,s.modelViewMatrix=Pf([],i._viewMatrix,U.mat),s.projectionMatrix=i._projectMatrix,s.viewMatrix=i._viewMatrix,s.scale=i.getHeight()/2,s.size=U.size,s.diffuse=U.diffuse,s.opacity=U.opacity,s.map=i.getTexture(U.texture,z.data),s.alphaTest=U.alphaTest,s.resolution=i.getDevicePixelRatio(),s.discardSelectable=U.discardSelectable,s.uvScale=U.uvScale,a.uvOffset=!m&&E.os?cg(b,i._buffer.os,E.os,Z):U.uvOffset,s.blackout=b._blooming&&!z.data.s("bloom"),a.position=cg(b,i._buffer.vs,E.vs,Z),m?(s.picking=!0,a.pickColor=cg(b,i._buffer.ps,E.ps,Z),s.useColor=!1,a.color=null):(s.picking=!1,a.pickColor=null,E.cs?(s.useColor=!0,a.color=cg(b,i._buffer.cs,E.cs,Z)):(s.useColor=!1,a.color=null)),E.ss?(s.useSizeArray=!0,a.sizeArray=cg(b,i._buffer.ss,E.ss,Z)):(s.useSizeArray=!1,a.sizeArray=null),Ae(b,0,E.vs.length/3,b.POINTS),N.useProgram(y),a.disable(),i.shadowMap.enable&&i.shadowMap.createShadow()}}},_asureProgram:function(W){return W._pointsShader||(W._pointsShader=this.gv._postProcessing.createShader(W,Os.shaderSrc)),W._pointsShader.program},dispose:function(){Os.superClass.dispose.call(this);var x=this._startPickId,O=this._lastPointNumber;if(x&&O){for(var s=this.gv.pickColorMap,M=0;O>M;M++){var p=x+M;s[p]&&delete s[p]}delete this._startPickId,delete this._lastPointNumber}}}),Os.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var Rs=function(I,y){to(Rs,this,[I,y]),this._needRecoverPosition=!0};hk(Rs,Js,{_25Q:1,validate:function(T){var A=this,y=A.data,b=A.s,K=y.getPoints(),w=K.size();A.dispatchBoundingBoxChanged();var G=y.p3(),q=A.mat=Bf();Kl(q,G),nm(q,y.getFinalRotation3d(),y.getRotationMode());var B=y.getScale3d(),E=y._dynamicScale3d;if(E&&(B[0]*=E[0],B[1]*=E[1],B[2]*=E[2]),rk(q,B),Kl(q,Hi(G)),(!A.s("geometry.cache")||!A.shapeModel)&&(A.shapeModel=A.info=A.lineShapeModel=Z,w>1)){var n=A.info={},$=y.getSegments(),I=y.getThickness(),M=rq(K.get(0)),l=rq(K.get(w-1)),W=w%2;0===W?(n.c1=rq(K.get(w/2-1)),n.c2=rq(K.get(w/2))):n.p3=rq(K.get((w-W)/2)),n.s1=M,n.s2=rq(K.get(1)),n.t1=rq(K.get(w-2)),n.t2=l,n.list=b(lg)===hm?A.createTubeModel(K,$,I/2,T):A.createLineModel(K,$,I,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=Z},_80o:function(c,T,G){var $=this,n=$.shapeModel;if(n){var s=$.gv;Gr(s,$.mat),$q(s,$.data,n,$,$.getBodyColor(),G),Wl(s)}}});var Ss=T.graph3d.PostProcessing=function(a){function q(){if(!Y){var J=a.getGL();Y=new Ar.RenderTarget(a,J,null,null,{samples:X.renderTextureSamples||1,minFilter:J.LINEAR,magFilter:J.LINEAR}),H=new Pq.Shader(J,M.vs,M.fs),w=Pq.Buffer.createIndexBuffer(J,new Uint16Array([0,2,1,1,2,3])),G=Pq.Buffer.createVertexBuffer(J,new Float32Array([0,0,1,0,0,1,1,1]))}}var Y,H,w,G,x=this,_={},O=!1;!function(){i.keys(Ss).forEach(function(u){_[u]=new Ss[u](a)})}(),x.getModule=function(J){return J?_[J]:x},x.getModuleList=function(){return i.keys(_)},x._serializable=!0,x.handleDataModleChange=function(i,P){i&&(x._serializable&&i.setPostProcessingData(x.serialize()),i.removeSerializeListener(x.onDataModelSerialize,x)),P&&(P.addSerializeListener(x.onDataModelSerialize,x),x.deserialize(P))},x.onDataModelSerialize=function(W){"serialize"===W.type?x._serializable&&(a.dm()._postProcessingData=x.serialize()):"deserialize"===W.type&&x.deserialize(a.dm())},x.isDeserializeDisabled=function(T){return!x._serializable||T.a("sceneBloom")!==c},x.isSerializable=function(){return x._serializable},x.setSerializable=function(b){x._serializable=b,b||a.dm().setPostProcessingData(c)},x.serialize=function(){var K,H,b,Q,s={};for(H in _)if(b=_[H],Q=b.serializeProperties){K={},b.enable&&(K.enable=!0);for(var I in Q){var R=b[I];R!=Q[I]&&(K[I]=R)}i.keys(K).length&&(s[H.toLowerCase()]=K)}return s},x.deserialize=function(z){var Y,p,j,A,R,r={},F={};for(Y in _){j=_[Y],A=j.serializeProperties;var a={},s="scene"+Y,g=z.a(s);g!==c&&(a.enable=g);for(var R in A)g=z.a(s+R[0].toUpperCase()+R.slice(1)),g!==c&&g!==A[R]&&(a[R]=g);_j(a)||(F[Y[0].toLowerCase()+Y.slice(1)]=a)}if(_j(F)&&(F=z.getPostProcessingData()),F)for(p in F)if(p&&(Y=p[0].toUpperCase()+p.slice(1),j=_[Y])){r[Y]=!0,A=F[p];var m=!!A.enable;x.enableModule(Y,m),Y="scene"+Y,z.a(Y,m),j.resetProperties&&j.resetProperties();for(R in A)if("enable"!==R){var g=A[R];j[R]=g,z.a(Y+R[0].toUpperCase()+R.slice(1),g)}}for(Y in _)r[Y]||(j=_[Y],j.enable=!1,j.resetProperties&&j.resetProperties())},x.getRenderTarget=function(){return Y},x.blitScreen=function(M,z,I,y,k){var T=a.getGL();if(T){M&&(M.bind(T),a.setViewport(T,0,0,M.width,M.height)),k&&k.clear===!1||T.clear(T.COLOR_BUFFER_BIT|T.DEPTH_BUFFER_BIT),q(),I||(I=H),I.bind(),T.activeTexture(T.TEXTURE0+0),zk(T,z);var L=I.uniforms;L.image=0;var J=1;if(y)for(var n in y){var o=y[n];o instanceof WebGLTexture&&(T.activeTexture(T.TEXTURE0+J),zk(T,o),o=J,J++),L[n]=o}if(w.upload(),G.upload(),I.attributes.pos.pointer(G),T.drawElements(T.TRIANGLES,6,T.UNSIGNED_SHORT,0),J>1)for(;--J>=0;)T.activeTexture(T.TEXTURE0+J),zk(T,null);else zk(T,null);M&&M.unbind(T)}},x.decodeShader=function(e){var $,z,q,Q="",I="";for(q=0;q<e.length;q++)$=e[q],"%"===$?$="'":"a"===$?$='"':"]"===$&&($="\\"),z=String.fromCharCode($.charCodeAt(0)-1),q%2?I+=z:Q=z+Q;return I+Q},x.createShader=function(c,j,h){var A,w;if("string"==typeof j){var z=j.indexOf("^#");A=x.decodeShader(j.substr(0,z)),w=x.decodeShader(j.substr(z+2))}else A=j.vs,w=j.fs;if(h){var Z=h(A,w);Z&&Z.vs&&(A=Z.vs),Z&&Z.fs&&(w=Z.fs)}return new Pq.Shader(c,A,w)},x.enableModule=function(U,w){var y,l,H,L=U.split(",");for(y=0,l=L.length;l>y;y++)H=L[y].trim(),_[H]&&(_[H].enable=w);O=!1;for(H in _)if(_[H].enable){O=!0;break}O&&q()};var M=x.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};x.render=function(I,t,Q,P){if(O){Y.setSize(I,t,Q),Y.bind(I);var y=I.getParameter(I.COLOR_CLEAR_VALUE);y&&0===y[0]&&0===y[1]&&0===y[2]&&0===y[3]?y=null:fb(I,[0,0,0,0]),I.clear(I.COLOR_BUFFER_BIT|I.DEPTH_BUFFER_BIT),a.setViewport(I,0,0,t,Q),P=P||{};var R=P.renderAxis!==!1,$=P.renderEdit!==!1;P.renderAxis=P.renderEdit=!1,a.renderScene(P),Y.unbind(I);for(var U=0,p=a._glCapabilities.maxAttributes;p>U;U++)I.disableVertexAttribArray(U);var s,f=Y;for(s in _)f=_[s]._42(I,f)||f;a.setViewport(I,0,0,t,Q),y&&fb(I,y);var q=x.getModule("Fxaa");return q&&q.enable?x.blitScreen(null,f.texture,q.getShader(I),{resolution:[1/t,1/Q]}):x.blitScreen(null,f.texture),I.useProgram(a._prg),a._renderAxisAndEditHelper(R,$),!0}}},Ts=T.graph3d.PostProcessing.HueSaturation=function(y){function r(){X=!0;var l=y.getGL();c=new Ar.RenderTarget(y,l),o=y._postProcessing.createShader(l,Ts.hueSaturationShader),m=Pq.Buffer.createIndexBuffer(l,new Uint16Array([0,2,1,1,2,3])),F=Pq.Buffer.createVertexBuffer(l,new Float32Array([0,0,1,0,0,1,1,1]))}var m,F,o,c,v=this,e=!1,X=!1,s=[],N=[],C=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var g=this.serializeProperties;for(var d in g)this[d]=g[d]},this.resetProperties(),i.defineProperties(v,{enable:{get:function(){return e},set:function(G){!!e!=!!G&&(e=G,G&&!X&&r(),y.iv())}},hue:{get:function(){return s.map(function(m){return G(180*m)})},set:function(O){if(s!==O&&7===O.length){for(var X=0;7>X;X++)s[X]=O[X]/180;y.iv()}}},saturation:{get:function(){return N.map(function(Y){return G(100*Y)})},set:function(o){if(N!==o&&7===o.length){for(var U=0;7>U;U++)N[U]=o[U]/100;y.iv()}}},lightness:{get:function(){return C.map(function(q){return G(100*q)})},set:function(k){if(C!==k&&7===k.length){for(var i=0;7>i;i++)C[i]=k[i]/100;y.iv()}}}}),v._42=function(M,w){if(e){X||r();var E=w.width,k=w.height;if(E&&k){c.setSize(M,E,k),io(M,c.frame),y.setViewport(M,0,0,c.width,c.height),M.clear(M.COLOR_BUFFER_BIT|M.DEPTH_BUFFER_BIT),o.bind(),M.activeTexture(M.TEXTURE0+0),zk(M,w.texture);var v=o.uniforms;return v.image=0,v.hue=s,v.saturation=N,v.lightness=C,m.upload(),F.upload(),o.attributes.pos.pointer(F),M.drawElements(M.TRIANGLES,6,M.UNSIGNED_SHORT,0),zk(M,null),lo(M),c}}}};Ts.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var Us=T.graph3d.PostProcessing.Bloom=function(_){function o(){var v=_.getGL();if(v)for(var E=_._postProcessing,R=0;Q>R;R++)Z[R]=E.createShader(v,Us._35Q,function(U,w){return{fs:w.replace(/DEFINE_VALUE/g,u[R]).replace("%OVERRIDE_ALPHA_DEFINE%",O?"#define OVERRIDE_ALPHA":"")}})}function y(){var Z=_.getWidth(),T=_.getHeight();if(Z&&T){N=[Z,T],m=!0;var v,V=_.getGL(),D=Math.round(N[0]/2),L=Math.round(N[1]/2);for(A=new Ar.RenderTarget(_,V,D,L),v=0;Q>v;v++)X.push(new Ar.RenderTarget(_,V,D,L)),K.push(new Ar.RenderTarget(_,V,D,L)),D=Math.round(D/2),L=Math.round(L/2);var U=_._postProcessing;R=U.createShader(V,Us._34Q),o(),H=U.createShader(V,Us._36Q,function(t,X){return{fs:X.replace(/NUM_MIPS/g,Q)}}),b=U.createShader(V,Us.finalShader),Y=Pq.Buffer.createIndexBuffer(V,new Uint16Array([0,2,1,1,2,3])),E=Pq.Buffer.createVertexBuffer(V,new Float32Array([0,0,1,0,0,1,1,1]))}}var I,M,F,O,f,Y,E,V,n=this,l=!1,m=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var N=this.serializeProperties;for(var A in N)this[A]=N[A]},i.defineProperties(n,{enable:{get:function(){return l},set:function(j){!!l!=!!j&&(l=j,j&&!m&&y(),_.iv())}},strength:{get:function(){return I},set:function(Q){I!==Q&&(I=Q,_.iv())}},threshold:{get:function(){return M},set:function(P){M!==P&&(M=P,_.iv())}},radius:{get:function(){return F},set:function(H){F!==H&&(F=H,_.iv())}},overrideAlpha:{get:function(){return O},set:function(R){!!O!=!!R&&(O=R,m&&o(),_.iv())}},selective:{get:function(){return f},set:function(D){!!f!=!!D&&(f=!!D,_.iv())}}}),this.resetProperties();var A,R,H,b,N=[256,256],X=[],K=[],Q=5,u=[3,5,7,9,11],Z=[];n._42=function(a,U){function h(P,L,z,l){io(a,L.frame),_.setViewport(a,0,0,L.width,L.height),l?l(a):a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),S!==P&&P.bind();var M=0;for(var Z in z){var T=z[Z];T instanceof WebGLTexture&&(a.activeTexture(a.TEXTURE0+M),zk(a,T),T=M,M++),P.uniforms[Z]=T}for(S!==P&&(Y.upload(),E.upload(),P.attributes.pos.pointer(E),S=P),a.drawElements(a.TRIANGLES,6,a.UNSIGNED_SHORT,0);M--;)a.activeTexture(a.TEXTURE0+M),zk(a,null);lo(a)}if(l&&(m||(y(),m))){var S;if(f){V||(V=new Ar.RenderTarget(_,a)),V.setSize(a,U.width,U.height),V.bind(a);var W=a.getParameter(a.COLOR_CLEAR_VALUE);W&&0===W[0]&&0===W[1]&&0===W[2]&&1===W[3]?W=null:fb(a,[0,0,0,1]),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),_.setViewport(a,0,0,U.width,U.height),a._blooming=!0,_.syncRenderState(),_.renderScene(),a._blooming=!1,W&&fb(a,W),V.unbind(a)}h(R,A,{smoothWidth:.01,luminosityThreshold:M,tDiffuse:f?V.texture:U.texture});var d,u=A,i=Math.round(N[0]/2),w=Math.round(N[1]/2);for(d=0;Q>d;d++)h(Z[d],X[d],{colorTexture:u.texture,direction:[1,0],texSize:[i,w]}),h(Z[d],K[d],{colorTexture:X[d].texture,direction:[0,1],texSize:[i,w]}),i=Math.round(i/2),w=Math.round(w/2),u=K[d];return h(H,X[0],{blurTexture1:K[0].texture,blurTexture2:K[1].texture,blurTexture3:K[2].texture,blurTexture4:K[3].texture,blurTexture5:K[4].texture,bloomStrength:I,bloomRadius:F,bloomTintColor:[1,1,1]}),h(b,U,{image:X[0].texture},function($){ep.for($).glState.blend.apply({enabled:!0,equation:$.FUNC_ADD,func:[$.SRC_ALPHA,$.ONE]})}),ep.for(a).glState.blend.apply({equation:a.FUNC_ADD,func:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA]}),U}}};Us._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",Us._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",Us._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",Us.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Vs=T.graph3d.PostProcessing.Dof=function(N){function d(){a=!0;var I=N.getGL();B=new Ar.RenderTarget(N,I),Q=N._postProcessing.createShader(I,Vs._38Q),$=Pq.Buffer.createIndexBuffer(I,new Uint16Array([0,2,1,1,2,3])),W=Pq.Buffer.createVertexBuffer(I,new Float32Array([0,0,1,0,0,1,1,1]))}var B,Q,$,W,O,F,V,t,v=this,f=!1,a=!1,z=gi.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var t=this.serializeProperties;for(var q in t)this[q]=t[q]},i.defineProperties(v,{enable:{get:function(){return f},set:function(E){!!f!=!!E&&(f=E,E&&!a&&d(),N.iv())}},image:{get:function(){return F},set:function(G){F!==G&&(F=G,O&&(N.deleteTexture(z),O=null),N.iv())}},maxblur:{get:function(){return V},set:function(i){V!==i&&(V=i,N.iv())}},aperture:{get:function(){return t},set:function(Y){t!==Y&&(t=Y,N.iv())}}}),this.resetProperties(),v._42=function(h,l){function A(X,j,T,H){io(h,j.frame),N.setViewport(h,0,0,j.width,j.height),H?H(h):h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),J!==X&&X.bind();var u=0;for(var _ in T){var k=T[_];k instanceof WebGLTexture&&(h.activeTexture(h.TEXTURE0+u),zk(h,k),k=u,u++),X.uniforms[_]=k}for(J!==X&&($.upload(),W.upload(),X.attributes.pos.pointer(W),J=X),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0);u--;)h.activeTexture(h.TEXTURE0+u),zk(h,null);lo(h)}if(f){a||d();var J;if(!O){var v=qh(this.image);if(!v||!v.comps&&!v.tagName)return l;T.Default.setImage(z,v),O=N.getTexture(z)}var o=l.width,I=l.height;if(o&&I)return B.setSize(h,o,I),A(Q,B,{tColor:l.texture,tDepth:O,aspect:o/I,aperture:this.aperture,maxblur:this.maxblur}),B}}};Vs._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";
var Ws=T.graph3d.PostProcessing.Blur=function(X){function O(){z=!0;var J=X.getGL();r=new Ar.RenderTarget(X,J),b=X._postProcessing.createShader(J,Ws.hBlurShader),_=X._postProcessing.createShader(J,Ws.vBlurShader)}var b,_,r,R,Y,J,P,s,E,B=this,l=!1,z=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var k=this.serializeProperties;for(var S in k)this[S]=k[S]},i.defineProperties(B,{enable:{get:function(){return l},set:function(P){!!l!=!!P&&(l=P,P?X.addRenderLayerListener(K,this):X.removeRenderLayerListener(K,this),P&&!z&&O(),X.iv())}},downSample:{get:function(){return P},set:function(J){P!==J&&(P=J,X.iv)}},value:{get:function(){return J},set:function(j){J!==j&&(J=j,X.iv())}},iterations:{get:function(){return s},set:function(r){s!==r&&(s=r,X.iv())}},layer:{get:function(){return E},set:function(a){E!==a&&(E=a,X.iv())}}}),this.resetProperties();var K=function($){if(l&&$.layer===E&&"post"===$.phase){var m=X.getGL();if(!X._picking&&!X.isReflecting(m)){var D=X._postProcessing.getRenderTarget();D.unbind(m);for(var o=0,T=X._glCapabilities.maxAttributes;T>o;o++)m.disableVertexAttribArray(o);B.drawImpl(m,D),D.bind(m),m.useProgram(X._prg)}}};B._42=function(){},B.drawImpl=function(p,h,i,u,j){z||O();var m,I;if(h?(m=h.width,I=h.height):(m=X._viewport[2],I=X._viewport[3]),m&&I){var q=X._postProcessing;"boolean"!=typeof u&&(u=P),i==Z&&(i=J),j==Z&&(j=s),j=Math.max(1,Math.round(j));var K=ep.for(p).glState.depth,n=K.enabled;if(K.enabled=!1,u){i/=2;var x=[m,I];m/=2,I/=2,R||(R=new Ar.RenderTarget(X,p),Y=q.createShader(p,Ws.downSampleShader)),R.setSize(p,m,I),q.blitScreen(R,h.texture,Y,{texelSize:[1/x[0],1/x[1]]}),h.setSize(p,m,I)}else R&&R.setSize(0,0);r.setSize(p,m,I);for(var L=[],v=0;j>v;v++)L.push(i),i=Math.max(1,Math.floor(i/2));for(var v=0;j>v;v++){var B=L[j-v-1],H=u&&0===v?R.texture:h.texture;q.blitScreen(r,H,b,{value:B/m}),u&&v===j-1&&h.setSize(p,x[0],x[1]),q.blitScreen(h,r.texture,_,{value:B/I})}return K.enabled=n,h}}};Ws.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",Ws.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",Ws.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var Xs=T.graph3d.PostProcessing.Fxaa=function(S){var I,H=this,L=!1;i.defineProperties(H,{enable:{get:function(){return L},set:function(Q){!!L!=!!Q&&(L=Q,S.iv())}}}),H.getShader=function(U){if(I)return I;var O=S.getPostProcessingModule();return I=O.createShader(U,{vs:O.blitScreenShaderSrc.vs,fs:O.decodeShader(Xs.ShaderSourceFs)})},H._42=function(){}};Xs.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",kp(L,{accordionViewExpandIcon:hb(Po),accordionViewCollapseIcon:hb(Po,!0),accordionViewLabelColor:eo,accordionViewLabelFont:iq,accordionViewTitleBackground:Mo,accordionViewSelectBackground:zd,accordionViewSelectWidth:3,accordionViewSeparatorColor:c,splitViewDividerSize:1,splitViewDividerBackground:Mo,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:hl,rect:[2,2,12,12],background:Po}]},propertyViewLabelColor:ec,propertyViewLabelSelectColor:eo,propertyViewLabelFont:iq,propertyViewExpandIcon:hb(pf),propertyViewCollapseIcon:hb(pf,!0),propertyViewBackground:Cm,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Jl,propertyViewColumnLineColor:Jl,propertyViewSelectBackground:zd,listViewLabelColor:ec,listViewLabelSelectColor:eo,listViewLabelFont:iq,listViewRowLineVisible:!1,listViewRowLineColor:Jl,listViewSelectBackground:zd,treeViewLabelColor:ec,treeViewLabelSelectColor:eo,treeViewLabelFont:iq,treeViewExpandIcon:hb(Bd),treeViewCollapseIcon:hb(Bd,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Jl,treeViewSelectBackground:zd,treeViewDoubleClickToToggle:!0,tableViewLabelColor:ec,tableViewLabelSelectColor:eo,tableViewLabelFont:iq,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Jl,tableViewColumnLineColor:Jl,tableViewSelectBackground:zd,treeTableViewLabelColor:ec,treeTableViewLabelSelectColor:eo,treeTableViewLabelFont:iq,treeTableViewExpandIcon:hb(Bd),treeTableViewCollapseIcon:hb(Bd,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Jl,treeTableViewColumnLineColor:Jl,treeTableViewSelectBackground:zd,tableHeaderLabelColor:ec,tableHeaderLabelFont:iq,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:tk,tableHeaderBackground:Cm,tableHeaderMoveBackground:Ep,tableHeaderInsertColor:zd,tableHeaderSortDescIcon:Nr(pf,!0),tableHeaderSortAscIcon:Nr(pf),tabViewTabGap:1,tabViewLabelColor:eo,tabViewLabelFont:iq,tabViewTabBackground:Mo,tabViewSelectWidth:3,tabViewSelectBackground:zd,tabViewMoveBackground:Ep,tabViewInsertColor:zd,toolbarLabelColor:ec,toolbarLabelSelectColor:eo,toolbarLabelFont:iq,toolbarBackground:Cm,toolbarSelectBackground:zd,toolbarItemGap:8,toolbarSeparatorColor:Pg},!0);var Ys={translateX:1,sortColumn:1},Zs={sortable:1,sortOrder:1,sortFunc:1},$s={focusData:1},_s={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},at={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},bt=function(I,E){E.add(I),I.hasChildren()&&I.eachChild(function(F){bt(F,E)})},ct=function(J,$,d,e,l,f,k,N,U,m,T){var H,g=d.getValueType(m),a=d.getAlign(m);if(d.getEnumValues(m)){var B=d.toEnumLabel($,m),Y=Ul||0,w=0,W=f,h=L.getTextSize(e,B).width;return H=qh(d.toEnumIcon($,m)),H&&(w=f+Ul/2,"center"===a?w+=(N-(Y+h))/2:"right"===a&&(w=w+N-(Y+h)),yo(J,H,w,k+U/2,m,T),W=w+Ul/2),B!=Z&&(H?fm(J,B,e,l,W,k,N-(W-f),U):fm(J,B,e,l,f,k,N,U,a)),void 0}return $=d.formatValue($),$!=Z?g===Ei?(Ki(J,f,k,N,U,$),void 0):g===Hp||!g&&Xe($)?(H=qh($?Sm:md),yo(J,H,f+N/2,k+U/2,m,T),void 0):(fm(J,$,e,l,f,k,N,U,a),void 0):void 0},dt=function(M,S){var J=S.view,s=Dm(M),$=S.column||S.property;J.getDataModel().beginTransaction(),S.editor=M,M.info=S,J.setCurrentEditor(M),J.getView().insertBefore(s,J._79O),Rf(M,S.editorRect),M.setFocus?M.setFocus():mk(M),M.commitValue=function(f,Q){M._17Q&&(M=M._17Q),Q||J.setValue(S.data,$,M.getValue?M.getValue():M.value),M.close&&M.close(),ws(s)},$.onEditorCreated&&$.onEditorCreated(S)},et=function(J,m,D,l,z){var v=uh(J,D),C=m.value,N=m.view,I=z.getValueType(m.data);return v.onblur=v.onchange=function(){N.endEditing()},"input"===J?(C=z.formatValue(C),C!=Z&&(v.value=C),v.onkeydown=function(G){Pp(G)?N.endEditing():bf(G)&&N.endEditing(!0)},(I===Bn||I===Mh)&&n(v,Ok,L.numberListener)):J===Gq&&l.forEach(function(B){var q=t.createElement("option");q.innerHTML=z.toEnumLabel(B),q.value=B,z.isEnumEqual(C,B)&&(q.selected=!0),Fd(v,q)}),dt(v,m),v},ft=T.widget={},gt=function(m,V,A){hk(R+".widget."+m,V,A)};kp(Jm,{ms_value:function(G){G.getValue=function(z){var M=this.getItemById(z),b=M.element;return em(b)?b:b?b.getValue?b.getValue():b.value:M.selected},G.setValue=function(P,K){var a=this.getItemById(P);if(a){var s=a.element;s&&!em(s)?s.setValue?s.setValue(K):s.value=K:Xe(K)?(a.selected=K,this.iv()):(a.element=K,this.iv())}},G.v=function(k,x){var l=this;if(2===arguments.length)l.setValue(k,x);else{if(!Ue(k))return l.getValue(k);for(var z in k)l.setValue(z,k[z])}return l}},_46o:function(z){z._icon=Z,z._accessType=Z,z._valueType=Z,z._editable=!1,z._batchEditable=!0,z._align=Cl,z._nullable=!0,z._emptiable=!1,z.setParent=qk,z.formatValue=function(W){var V=this,z=V._valueType;return V.getEnumValues()?V.toEnumLabel(W):z===Hp?!!W:W!=Z&&z===Bn?y(W):W},z.setEnum=function(C,X,n,H,$,r,b){var o=this;C&&!tj(C)&&C.values&&(H=C.editable,n=C.icons,X=C.labels,$=C.strict,r=C.maxHeight,b=C.dropDownWidth,C=C.values),Nn(C)&&(C=C._as),Nn(X)&&(X=X._as),Nn(n)&&(n=n._as),o._enumValues=C,o._enumLabels=X,o._enumIcons=n,o._enumEditable=H,o._enumStrict=$==Z?!0:$,o._enumMaxHeight=r,o._enumDropDownWidth=b,C&&C.length&&km(C[0])&&(o._valueType=Mh),o.fp("enum",!1,!0)},z.getEnumDropDownWidth=function(){return this._enumDropDownWidth},z.getEnumMaxHeight=function(){return this._enumMaxHeight},z.isEnumEditable=function(){return this._enumEditable},z.getEnumValues=function(){return this._enumValues},z.getEnumLabels=function(){return this._enumLabels},z.getEnumIcons=function(){return this._enumIcons},z.isEnumStrict=function(){return this._enumStrict},z.isEnumEqual=function(a,P){return this._enumStrict?a===P:a==P},z.toEnumLabel=function(F,m){var d=this,M=d.getEnumValues(m),B=d.getEnumLabels(m);if(M&&B)for(var V=0;V<M.length;V++)if(d.isEnumEqual(F,M[V]))return B[V];return F},z.toEnumIcon=function(E,S){var n=this,t=n.getEnumValues(S),N=n.getEnumIcons(S);if(t&&N)for(var V=0;V<t.length;V++)if(n.isEnumEqual(E,t[V]))return N[V];return c}},_45o:function(z){z._87o=function(w,R,O,I,X,t){if(w){var m=this,p=m._90I,B=Ke(1);m._columnLineVisible&&(X-=1),m._rowLineVisible&&(t-=1),0>=X||0>=t||(m._90I||(p=m._90I={}),p[R]||(p[R]=new Dd),Rf(B,m.tx()+O,m.ty()+I,X,t),Fd(B,w),m._view.insertBefore(B,m._79O),w.onParentAdded&&w.onParentAdded(B),p[R].add(B))}},z._76o=function(){var u=this,e=u._90I;if(e){for(var J in e)e[J].each(function(a){ws(a)});delete u._90I}},z._77o=function(D){var S=this;if(S._90I){var i=S._90I[D];i&&(i.each(function(i){ws(i)}),delete S._90I[D])}}},_47o:function(d){d.getValue=function(t,J){return J.getValue?J.getValue(t,J,this):Nl(t,J.getAccessType(),J.getName())},d.setValue=function(N,$,X){if($.isEmptiable(N)||""!==X||(X=c),$.isNullable(N)||X!=Z){var V=this,Y=$.getName(N),J=$.getAccessType(N),h=$.getValueType(N);h===Bn&&em(X)?X=te(X):h===Mh&&em(X)?X=parseFloat(X):h===Hp&&em(X)&&(X="true"===X),V._batchEditable&&$._batchEditable&&V.isSelected(N)?V.sm().each(function(O){$.setValue?$.setValue(O,$,X,V):In(O,J,Y,X)}):$.setValue?$.setValue(N,$,X,V):In(N,J,Y,X)}},d.setCurrentEditor=function(p){this.endEditing(),this._currentEditor=p,this.redraw()},d.isEditing=function(o,h){var Z=this,m=Z._currentEditor;if(!m)return!1;if(h){var X=m.info;return X?(X.column||X.property)===h&&X.data===o:!1}return!0},d.endEditing=function(B){var P=this,K=P._currentEditor;K&&(delete P._currentEditor,K.commitValue&&K.commitValue(K.info,B),P.redraw(),P.getDataModel().endTransaction())},d.beginEditing=function(P){this.endEditing();var O=this,N=P.column||P.property;if(N.beginEditing)N.beginEditing(P);else{var W=P.data,V=P.value,p=O.getSelectBackground(W),x=N.getEnumValues(W),h=N.getSlider(W),L=N.getColorPicker(W);if(h){var I=Mi(ft.Slider,h);return I.setValue(V),I.getView().onblur=function(){O.endEditing()},I.isInstant()&&(I.onValueChanged=function(){O.setValue(W,N,I.getValue())}),dt(I,P),void 0}if(L||N.getValueType(W)===Ei){var H=Mi(ft.ColorPicker,L);return H.setValue(V),H.onClosed=function(){O.endEditing()},H.isInstant()&&(H.onValueChanged=function(D,z){O.setValue(W,N,z)}),dt(H,P),H.open(),void 0}if(x){if(ft.ComboBox){var e=new ft.ComboBox;e.setValue(V),e.setValues(x),e.setLabels(N.getEnumLabels(W)),e.setIcons(N.getEnumIcons(W)),e.setEditable(N.isEnumEditable(W)),e.setStrict(N.isEnumStrict(W)),e.setMaxHeight(N.getEnumMaxHeight(W)),e.setDropDownWidth(N.getEnumDropDownWidth(W)),e.onClosed=function(){O.endEditing()},dt(e,P),e.open()}else et(Gq,P,p,x,N);return}var C=N.getValueType(W);if(C===Hp||Xe(V))return O.setValue(W,N,!V),void 0;if(N.getItemEditor(W)){var f=yf(N.getItemEditor(W)),K=new f(W,N,O,P),u=K.getView();return u._17Q=K,K.setValue(V),gf(u),dt(u,P),K.editBeginning&&K.editBeginning(),void 0}et("input",P,p,Z,N)}}},_44o:function(d){d.init=function(b){var e=this,E=e.th=new vt(b),k=e._view=zf(1,e);e.tv=e._tableView=b,Fd(k,E.getView()),Fd(k,b.getView()),E.mp(function(c){c.property===Sn&&e.iv()}),e.iv()},d.getTableView=function(){return this.tv},d.getTableHeader=function(){return this.th},d.getDataModel=function(){return this.tv.dm()},d.getColumnModel=function(){return this.tv.getColumnModel()},d.setColumns=function(c){this.tv.setColumns(c)},d.addColumns=function(A){this.tv.addColumns(A)},d.endEditing=function(){this.tv.endEditing()},d.validateImpl=function(){var s=this,L=s.th,B=ph(L),t={x:0,y:0,width:s.getWidth(),height:B};Rf(L,t),t.y=B,t.height=$(0,s.getHeight()-B),Rf(s.tv,t)}},ms_vs:function(A){A._41o=function(){return this._29I.height<this._59I},A._43o=function(){var K=this;K._41o()&&(K._58I||(vc(function(){K._94O()},us),K.iv()),K._58I=new Date)},A._94O=function(){var B=this;if(B._58I){var w=new Date;w.getTime()-B._58I.getTime()>=us?(delete B._58I,B.iv()):vc(function(){B._94O()},us)}},A._93I=function(){var B=this,O=B._27I;if(B._58I||!B._autoHideScrollBar){O||Fd(B._79O,O=B._27I=Ke());var J=B._29I,w=J.height,H=B._59I,h=B.getScrollBarSize(),C=J.width-h-2,L=w*(-B.ty()/H),g=w*(w/H),D=O.style;H>w?(le>g&&(L=L+g/2-le/2,0>L&&(L=0),L+le>w&&(L=w-le),g=le),D.visibility=mb,D.background=B.getScrollBarColor(),D.borderRadius=h/2+sj,Rf(O,C,L,h,g)):D.visibility=de}else O&&(O.style.visibility=de)}},ms_hs:function(Z){Z._40o=function(){return this._29I.width<this._91I},Z._42o=function(){var G=this;G._40o()&&(G._95O||(vc(function(){G._94I()},us),G.iv()),G._95O=new Date)},Z._94I=function(){var z=this;if(z._95O){var R=new Date;R.getTime()-z._95O.getTime()>=us?(delete z._95O,z.iv()):vc(function(){z._94I()},us)}},Z._92I=function(){var d=this,A=d._28I;if(d._95O||!d._autoHideScrollBar){A||Fd(d._79O,A=d._28I=Ke());var D=d._29I,c=D.width,r=d._91I,B=d.getScrollBarSize(),X=D.height-B-2,m=c*(-d.tx()/r),I=c*(c/r),a=A.style;r>c?(le>I&&(m=m+I/2-le/2,0>m&&(m=0),m+le>c&&(m=c-le),I=le),a.visibility=mb,a.background=d.getScrollBarColor(),a.borderRadius=B/2+sj,Rf(A,m,X,I,B)):a.visibility=de}else A&&(A.style.visibility=de)}}}),Qr(Sm,ks(16,16,[{type:ug,rect:[1,1,14,14],background:zd},{type:Ro,rect:[1,1,14,14],width:1,color:Fb},{type:Gd,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Qr(md,ks(16,16,{type:Ro,rect:[1,1,14,14],width:1,color:Fb})),Qr(Df,ks(16,16,[{type:cn,rect:[2,2,12,12],borderWidth:1,borderColor:Fb,background:"#FFF"},{type:cn,rect:[4,4,8,8],background:zd}])),Qr(hq,ks(16,16,{type:cn,rect:[2,2,12,12],borderWidth:1,borderColor:Fb})),Jm._15Q=function(O){O._29I=Cp,O._59I=0,O._91I=0,O._5o=function(M){var C=this;C._30I=new Dd,C._rows=new Dd,C._rowMap={},C._31I=0,C._14I=0,C._view=zf(1,C),C._canvas=qs(C._view),Fd(C._view,C._79O=Ke()),C.dm(M?M:new Id)},O.getCheckIcon=function(E){var d=this.sm(),a=d.co(E);return d.sg()?qh(a?Df:hq):qh(a?Sm:md)},O.checkData=function(y){var k=this.sm(),o=k.co(y);k.sg()&&o||(this._32o=1,o?k.rs(y):k.as(y),delete this._32o)},O.getDataAt=function(z){z.target&&(z=this.lp(z));var M=G(z.y/this._rowHeight),h=this._rows;return 0>M||M>=h.size()?Z:h.get(M)},O.onDataDoubleClicked=function(){},O.onDataClicked=function(){},O.adjustTranslateX=function(){return 0},O.adjustTranslateY=function(Z){var h=this.getHeight()-this._59I;return h>Z&&(Z=h),Z>0?0:y(Z)},O.onPropertyChanged=function(C){var O=this,K=C.property;_s[K]?O.ivm():$s[K]||O.redraw(),K===jm?O._42o():K===uf&&O._43o()},O.getLabel=function(V){return V.toLabel()},O.getLabelFont=function(){return this._labelFont},O.getLabelColor=function(E){var c=this;if(c.isCheckMode()){if(c._focusData===E)return c._labelSelectColor}else if(c.isSelected(E))return c._labelSelectColor;return c._labelColor},O.getStartRowIndex=function(){return this._31I},O.getEndRowIndex=function(){return this._14I},O.getRowDatas=function(){return this._rows},O.getRowIndex=function(W){return this._rowMap[W._id]},O.getRowSize=function(){return this._rows.size()},O.getViewRect=function(){return zl(this._29I)},O.isVisible=function(C){return this._visibleFunc?this._visibleFunc(C):!0},O.getCurrentSortFunc=function(){return this._sortFunc},O.setDataModel=function(j){var d=this,V=d._dataModel,k=d._selectionModel;V!==j&&(V&&(V.umm(d.handleDataModelChange,d),V.umd(d.handleDataPropertyChange,d),V.umh(d.handleHierarchyChange,d),k||V.sm().ums(d.handleSelectionChange,d)),d._dataModel=j,j.mm(d.handleDataModelChange,d),j.md(d.handleDataPropertyChange,d),j.mh(d.handleHierarchyChange,d),k?k._21I(j):j.sm().ms(d.handleSelectionChange,d),d.fp("dataModel",V,j))},O.validateModel=function(){var p=this;p._rows.clear(),p._rowMap={},p.buildChildren(p._dataModel._roots);var D=p._rows=p._rows.toList(p.isVisible,p),U=0,Q=p.getCurrentSortFunc(),t=D.size();for(Q&&D.sort(Q);t>U;U++)p._rowMap[D.get(U)._id]=U},O.buildChildren=function(H){var Y=this;H.each(function(h){Y._rows.add(h),Y.buildChildren(h._children)})},O.handleDataModelChange=function(){this.ivm()},O.handleDataPropertyChange=function(E){"parent"===E.property?this.ivm():this.invalidateData(E.data)},O.handleHierarchyChange=function(){this.ivm()},O.handleSelectionChange=function(Y){Y.datas.each(this.invalidateData,this),this.onSelectionChanged(Y)},O.onSelectionChanged=function(b){var o=this,p=o.sm();!o.isAutoMakeVisible()||1!==p.size()||"set"!==b.kind&&"append"!==b.kind||o._32o||o.makeVisible(p.ld())},O.handleBackgroundClick=function(U){tp(U)&&!this.isCheckMode()&&this.sm().cs()},O.makeVisible=function(D){D&&(this._23I=D,this.iv())},O.scrollToIndex=function(M){var $=this,w=$._29I,V=w.height,e=$._rowHeight,q=e*M;M>=0&&M<$._rows.size()&&V>0&&(q+e>w.y+V?$.ty(-q+V-e):q<w.y&&$.ty(-q))},O.autoScroll=function(S,F){var Y=this,L=Y._rowHeight,a=L,I=L/4,v=Y._29I,d=Y.lp(S),p={x:Y.tx(),y:Y.ty()};return L>0&&v&&(d.x-v.x<a?Y.translate(I,0):v.x+v.width-d.x<a&&Y.translate(-I,0),d.y-v.y<a?Y.translate(0,I):v.y+v.height-d.y<a&&Y.translate(0,-I)),p.x=Y.tx()-p.x,p.y=Y.ty()-p.y,F&&(F.x+=p.x,F.y+=p.y),p},O.getTopRowOrderSelection=function(){var I=this.sm().getTopSelection(),G={},H=new Dd;return I.each(function(C){G[C._id]=C}),this._rows.each(function(V){G[V._id]&&H.add(V)}),H},O.getRowOrderSelection=function(){var z=new Dd;return this._rows.each(function(i){this.isSelected(i)&&z.add(i)},this),z},O.ivm=function(){this.invalidateModel()},O.invalidateModel=function(){var P=this;P._96I||(P._96I=1,P._32I=1,delete P._24I),P.iv()},O.redraw=function(){var S=this;S._32I||(S._32I=1,delete S._24I,S.iv())},O.invalidateData=function(e){var W=this;Xb?W.redraw():W._32I||(W._24I||(W._24I={}),W._24I[e._id]=e,W.iv())},O.getFocusData=function(){return this._focusData},O.setFocusDataById=function(c){this.setFocusData(this.dm().getDataById(c))},O.setFocusData=function(Q){var X=this,H=X._focusData;H!==Q&&(X._focusData=Q,X.fp("focusData",H,Q),H&&X.invalidateData(H),Q&&(X.invalidateData(Q),X.isAutoMakeVisible()&&X.makeVisible(Q)))},O.drawRowBackground=function(b,M,F,Q,K,O,g){var h=this,P=h.isCheckMode();(M===h._focusData&&P||F&&!P)&&Ki(b,Q,K,O,g,h.getSelectBackground(M))},O.drawData=function(r,U,x){var o=this,d=o._rowHeight,Q=d*x,O=o._29I,s=O.x,t=O.width;r.save(),r.beginPath(),r.rect(s,Q,t,d),r.clip(),o._87o(o.drawRow(r,U,o.isSelected(U),s,Q,t,d),x,s,Q,t,d),r.restore(),o._rowLineVisible&&Ki(r,s,Q+d-1,t,1,o._rowLineColor)},O._12I=function(C){var p=this,A=p._31I,T=p._29I,N=T.x,$=T.y,y=T.width,V=T.height;for(C.beginPath(),C.rect(N,$,y,V),C.clip(),C.clearRect(N,$,y,V),p._76o(),p._93db(C);A<p._14I;A++)p.drawData(C,p._rows.get(A),A);p._92db(C)},O._13I=function(c){for(var m,S=this,I=S._rowHeight,r=S._29I,p=r.x,V=r.width,K=S._31I,C=S._30I;K<S._14I;K++)m=S._rows.get(K),S._24I[m._id]&&C.add({data:m,index:K});C.isEmpty()||(c.beginPath(),C.each(function(s){c.rect(p,s.index*I,V,I)}),c.clip(),C.each(function(l){c.clearRect(p,l.index*I,V,I)}),C.each(function(N){S._77o(N.index)}),S._93db(c),C.each(function(M){S.drawData(c,M.data,M.index)}),S._92db(c),C.clear())},O.preValidateModel=function(){this.endEditing&&this.endEditing()},O.validateImpl=function(){var h=this,j=h._canvas,A=h.getWidth(),$=h.getHeight(),L=h._rowHeight,D=h._32I;(A!==j.clientWidth||$!==j.clientHeight)&&(Ud(j,A,$),D=1),h._96I&&(h.preValidateModel(),h.validateModel());var U=h._29I,n={x:-h.tx(),y:-h.ty(),width:A,height:$},S=h._rows.size(),B=ms(j),m=h._23I;D||um(n,U)||(D=1),h._29I=n,h._59I=S*L,h._31I=G(n.y/L),h._14I=N((n.y+n.height)/L),h._31I<0&&(h._31I=0),h._14I>S&&(h._14I=S),h._99I&&D&&h._99I();var F=h.tx(),H=h.ty();(h._40o()||h._41o())&&(h._59I+=h.getScrollBarSize(),h._99I&&D&&(h._91I+=h.getScrollBarSize())),og&&!jj&&(B.save(),cd(B,A/hm.length,$/hm.length,1)),cd(B,F,H,1),D?h._12I(B):h._24I&&h._13I(B),h._93I(),h._92I(),B.restore(),h._32I=h._24I=h._96I=Z,m&&(h.scrollToIndex(h.getRowIndex(m)),delete h._23I),h.tx(h.tx()),h.ty(h.ty())},O.canHandleSelectMode=function(){return!0}},Jm._48o=function(P){P._rootVisible=!0,P._rootData=Z,P._35o=function(){this._expandMap={},this._levelMap={}},P.validateModel=function(){var $=this,D=$._rootData;$._rows.clear(),$._levelMap={},$._rowMap={},$._currentLevel=0,D?$._rootVisible?$.isVisible(D)&&$.buildData(D):$.buildChildren(D):$.buildChildren(),delete $._currentLevel},P.buildData=function(f){var R=this,Y=f._id,s=R._rows;R._rowMap[Y]=s.size(),s.add(f),R._levelMap[Y]=R._currentLevel,R.isExpanded(f)&&(R._currentLevel++,R.buildChildren(f),R._currentLevel--)},P.buildChildren=function(c){var _=this,y=c?c._children:_._dataModel._roots,H=_.getCurrentSortFunc();H&&_.isChildrenSortable(c)?y.toList(_.isVisible,_).sort(H).each(_.buildData,_):y.each(function(t){_.isVisible(t)&&_.buildData(t)})},P.getLevel=function(p){return this._levelMap[p._id]},P.getToggleIcon=function(n){var z=this,w=z._loader,A=z._collapseIcon;return w&&!w.isLoaded(n)?A:n.hasChildren()?z.isExpanded(n)?z._expandIcon:A:Z},P.isCheckMode=function(){return this._checkMode!=Z},P.isChildrenSortable=function(){return!0},P.handleDataModelChange=function(o){var c=this;o.kind===Ri?delete c._expandMap[o.data._id]:o.kind===cr&&(c._expandMap={}),c.ivm()},P.toggle=function(Y){var A=this;A.isExpanded(Y)?A.collapse(Y):A.expand(Y)},P.isExpanded=function(t){return 1===this._expandMap[t._id]},P.expand=function(j){var F=this,q=F._loader;F.isExpanded(j)||(q&&!q.isLoaded(j)&&q.load(j),F._expandMap[j._id]=1,F.ivm(),F.onExpanded(j))},P.onExpanded=function(){},P.collapse=function(U){var i=this;i.isExpanded(U)&&(delete i._expandMap[U._id],i.ivm(),i.onCollapsed(U))},P.onCollapsed=function(){},P.expandAll=function(M){if(M)this.expand(M),M.eachChild(function(g){this.expandAll(g)},this);else{var v=this;v._dataModel.each(function(e){e.hasChildren()&&(v._expandMap[e._id]=1)}),v.ivm()}},P.collapseAll=function(){this._expandMap={},this.ivm()
},P.makeVisible=function(T){if(T){var t=this;if(!t._rootData||T.isDescendantOf(t._rootData)){for(var U=T._parent;U;)t.expand(U),U=U._parent;t._23I=T,t.iv()}}},P.checkData=function(Z){var e,G=this,O=G._checkMode,R=G.sm(),X=R.co(Z);if(!R.sg()||!X){if(G._32o=1,O===Yb)X?R.rs(Z):R.as(Z);else if(O===Xf)e=new Dd(Z),e.addAll(Z._children);else if("descendant"===O)e=new Dd,bt(Z,e);else if("all"===O&&(e=new Dd,bt(Z,e),!X))for(var q=Z._parent;q;)e.add(q),q=q._parent;e&&(X?R.rs(e):R.as(e)),delete G._32o}},P.drawTree=function(J,U,k,K,H,$,w){var v=this,c=v._indent,i=v._levelMap[U._id],e=v.getIconWidth(U),C=qh(v.getToggleIcon(U));C?(K+=c*i,yo(J,C,K+c/2,H+w/2,U,v),K+=c):K+=c*(i+1),v._checkMode&&(yo(J,v.getCheckIcon(U),K+c/2,H+w/2,U,v),K+=c),v.drawIcon(J,U,K,H,e,w),v.drawLabel(J,U,K+e,H,w)}},Jm._14Q=function(v){v.getIcon=function(J){return J.getIcon()},v.getIconWidth=function(Q){return this.getIcon(Q)?this._indent:0},v.drawIcon=function(o,t,O,V,g,x){if(g){var h=this,w=h.getBodyColor(t),b=qh(h.getIcon(t),w);b&&(x-=h.isRowLineVisible()?1:0,_r(o,b,En,O,V,g,x,t,h,w),hj(o,h.getBorderColor(t),O,V,g,x))}},v.drawLabel=function(n,t,Y,d,N){var P=this;fm(n,P.getLabel(t),P.getLabelFont(t),P.getLabelColor(t),Y,d,0,N)}},Jm._50o=function(O){O._98I=function(){var m=this,a=m._39o=new Id;m._60I=new Dd,a.mm(m._17o,m),a.md(m._18o,m),a.mh(m._19o,m)},O.setColumns=function(p){this._39o.clear(),this.addColumns(p)},O.addColumns=function($){var T=this._39o;$.forEach(function(o){if(!(o instanceof it)){var V=yf(o.className);o=Mi(V?V:it,o)}T.add(o)})},O.onColumnClicked=function(){},O.onCheckColumnClicked=function(){},O._3Q=function(h){for(var X,W=0,J=this._60I,Q=J.size();Q>W;W++)if(X=J.get(W),X.column===h)return X;return Z},O.getColumnAt=function(l){var z=this._4Q(l);return z?z.column:Z},O._4Q=function(X){for(var H=this,_=X.target?H.lp(X).x:X.x,c=H._60I,a=0;a<c.size();a++){var y=c.get(a),x=y.startX;if(_>=x&&_<x+y.column.getWidth())return y}return Z},O.getToolTip=function(D){var w=this,f=w.getDataAt(D),K=w.getColumnAt(D);return f&&K?K.getToolTip(f,w):Z},O.adjustTranslateX=function(k){var p=this.getWidth()-this._91I;return p>k&&(k=p),k>0?0:y(k)},O._99I=function(){var x=this,$=x._29I,W=x._60I;W.clear(),x._91I=0,x._39o._roots.each(function(q){if(q.isVisible()){var S=x._91I+q.getWidth();x._91I<=$.x+$.width&&S>=$.x&&W.add({column:q,startX:x._91I}),x._91I=S}})},O.drawData=function(K,g,d){var D=this,m=D._rowHeight,H=m*d,Y=D.isSelected(g),c=D._29I,u=c.x,A=c.width;D.drawRowBackground(K,g,Y,u,H,A,m),D._60I.each(function(_){var o=_.column,Z=_.startX,i=o.getWidth();i>0&&!D.isEditing(g,o)&&(K.save(),K.beginPath(),K.rect(Z,H,i,m),K.clip(),D._87o(D.drawCell(K,g,Y,o,Z,H,i,m),d,Z,H,i,m),D._columnLineVisible&&Ki(K,Z+i-1,H,1,m,D._columnLineColor),K.restore())}),D._rowLineVisible&&Ki(K,u,H+m-1,A,1,D._rowLineColor)},O.drawCell=function(t,u,o,h,H,n,K,q){var G=this;if(h.drawCell)return h.drawCell(t,u,o,h,H,n,K,q,G);var b=G.getValue(u,h);ct(t,b,h,G.getLabelFont(u,h,b),G.getLabelColor(u,h,b),H,n,K,q,u,G)},O.getColumnModel=function(){return this._39o},O._17o=function(){this.redraw()},O._18o=function(u){var I=this;u.data===I._sortColumn&&Zs[u.property]?I.ivm():(I._42o(),I.redraw())},O._19o=function(){this.redraw()},O.getCurrentSortFunc=function(){var B=this,f=B._sortColumn;if(f&&f.isSortable()){var t=f.getSortFunc(),z=fd===f.getSortOrder()?1:-1;return t||(t=xj),function(C,s){return t.call(B,B.getValue(C,f),B.getValue(s,f),C,s)*z}}return B._sortFunc},O.isCellEditable=function(p,m,l){return m.isEditable()&&this.isEditable()?m.isCellEditable?m.isCellEditable(p,m,l,this):!0:!1},O._37O=function(v,k){if(tp(k))for(var H=this,q=H.lp(k),G=H._60I,A=H._rowHeight,J=H._29I,O=J.x,T=J.y,D=J.width,j=J.height,Z=0;Z<G.size();Z++){var b=G.get(Z),a=b.startX,$=b.column,u=$.getWidth();if($!==H._31o&&$!==H._4o&&q.x>=a&&q.x<a+u&&H.isCellEditable(v,$,k)){var n={x:a,y:H.getRowIndex(v)*A,width:u,height:A},P={x:n.x+H.tx(),y:n.y+H.ty(),width:n.width,height:n.height},p=0,i=0;return n.x<O?p=n.x-O:n.x+n.width>O+D&&(p=n.x+n.width-O-D),p&&(H.tx(H.tx()-p),P.x-=p),n.y<T?i=n.y-T:n.y+A>T+j&&(i=n.y+A-T-j),i&&(H.ty(H.ty()-i),P.y-=i),H.beginEditing({data:v,column:$,value:H.getValue(v,$),event:k,rect:n,editorRect:P,view:H}),void 0}}}},ft.BaseItemEditor=function(k,F,a,q){this._data=k,this._column=F,this._master=a,this._editInfo=q},gt("BaseItemEditor",i,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var ht=T.Tab=function(){to(ht,this)};is("Tab",Od,{ms_ac:["view","closable","disabled","visible"],_icon:Z,_closable:!1,_disabled:!1,_visible:!0,setParent:qk});var it=T.Column=function(){to(it,this)};is("Column",Od,{_46o:1,ms_ac:["accessType","valueType",mb,ss,gj,zp,"align",Ei,"sortOrder",Yq,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:fd,_sortFunc:Z,_sortable:!0,_clickable:!0,setWidth:function(H){16>H&&(H=16);var K=this._width;this._width=H,this.fp(zp,K,H)},getToolTip:function(Q,L){return this.formatValue(L.getValue(Q,this))}});var jt=T.Property=function(){to(jt,this)};is("Property",Od,{_46o:1,ms_ac:["accessType","valueType",ss,gj,"categoryName",Ei,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:Z,getToolTip:function(e,h,w){var S=this;return h?S.formatValue(w.getValue(e,S)):w.getPropertyName(S)}}),ft.AccordionView=function(){var P=this;P._20o={},P._21o=new Dd,P._10o=Z,P._9o=Z,P._11o=Z,P._view=zf(0,P),P.iv()},gt("AccordionView",i,{ms_v:1,ms_fire:1,ms_ac:[Uf,ud,"titleHeight",Sg,Mr,"titleBackground","selectWidth",qq,"orientation","separatorColor"],_expandIcon:L.accordionViewExpandIcon,_collapseIcon:L.accordionViewCollapseIcon,_titleHeight:Jc,_labelColor:L.accordionViewLabelColor,_labelFont:L.accordionViewLabelFont,_titleBackground:L.accordionViewTitleBackground,_selectBackground:L.accordionViewSelectBackground,_selectWidth:L.accordionViewSelectWidth,_orientation:"v",_separatorColor:L.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(h,b,V,R){var o=this,k=Ke(),S={content:b,div:k,canvas:qs(k),icon:R};if(o._20o[h])throw h+" already exists";var i=S.downEventFunc=function(R){_m(R)},z=S.upEventFunc=function(I){_m(I),tp(I)&&(o._10o===h?o.collapse():o.expand(h))};[_d,Wq].forEach(function(c){n(k,c,i)}),[Ah,fr].forEach(function(N){n(k,N,z)}),k.style.cursor=fl,Fd(o._view,k),o._20o[h]=S,o._21o.add(h),V&&o.expand(h),o.iv()},remove:function(n){var $=this,W=$._20o[n];if(W){var k=W.div;ws(k),[_d,Wq].forEach(function(l){M(k,l,W.downEventFunc)}),[Ah,fr].forEach(function(t){M(k,t,W.upEventFunc)}),delete $._20o[n],$._21o.remove(n),$.iv()}},clear:function(){var h=this;h._21o.toArray().forEach(h.remove,h),h._20o={},h._21o.clear(),h.iv()},isExpanded:function(L){return this._10o===L},expand:function(n){var E=this;E._20o[n]&&E._10o!==n&&(E._10o=n,E.onExpanded(n),E.iv())},onExpanded:function(){},collapse:function(){var n=this;n._10o&&(n.onCollapsed(n._10o),delete n._10o,n.iv())},onCollapsed:function(){},initCanvas:function(P,X,$){Ud(P,X,$);var G=ms(P);return cd(G,0,0,1),G.clearRect(0,0,X,$),G},drawTitle:function(N,T,U,b,e){var E=this,S=qh(e.icon),A=E.isExpanded(T),H=E._titleHeight,Q=E._titleBackground,s=E._selectWidth,V=E._separatorColor,M=qh(A?E._expandIcon:E._collapseIcon),i=s+4;Ki(N,0,0,U,b,Q),A&&s&&Ki(N,0,0,s,b,E._selectBackground),(A||E._21o.get(E._21o.size()-1)!==T)&&Ki(N,0,b-1,U,1,V?V:fg(Q)),S&&(yo(N,S,i+Vk(S)/2,H/2),i+=Vk(S)+2),fm(N,T,E.getLabelFont(T),E.getLabelColor(T),i,0,0,H),M&&yo(N,M,U-Vk(M)/2-4,H/2)},validateImpl:function(){var F=this,y=F._view,b=0,D=0,h=F.getWidth(),E=F.getHeight(),w=F._titleHeight,G=F._21o.size()*w,V=F._11o,O=F._9o;delete F._11o,delete F._9o,F._21o.each(function(z){var V,f,u=F._20o[z],O=u.content,Q=F._10o===z;Vn(F)?(Rf(u.div,b,0,w,E),V=F.initCanvas(u.canvas,w,E),Kn(V,0,E),Uo(V,-So),F.drawTitle(V,z,E,w,u),V.restore(),Q?(f=$(0,h-G),O&&(F._11o=O,F._9o=Dm(O),Rf(O,b+w,0,f,E)),b+=w+f):b+=w):(Rf(u.div,0,D,h,w),V=F.initCanvas(u.canvas,h,w),F.drawTitle(V,z,h,w,u),V.restore(),Q?(f=$(0,E-G),O&&(F._11o=O,F._9o=Dm(O),Rf(O,0,D+w,h,f)),D+=w+f):D+=w)});var Y=F._9o;V&&V!==F._11o&&V.endEditing&&V.endEditing(),Y&&Y!==O&&Fd(y,Y),O&&O!==Y&&ws(O)}}),ft.SplitView=function(L,m,T,B){var f=this,W=f._dividerDiv=Ke(),x=f._60O=qs(),o=f._61O=qs(),P=x.style,u=o.style;f._view=zf(1,f),Fd(f._view,W),P.msTouchAction=un,P.pointerEvents=un,P.cursor=fl,u.msTouchAction=un,u.pointerEvents=un,u.cursor=fl,L&&f.setLeftView(L),m&&f.setRightView(m),T&&f.setOrientation(T),B!=Z&&f.setPosition(B),f.setStatus(bd),new kt(f)},gt("SplitView",i,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:L.splitViewDividerSize,_dividerBackground:L.splitViewDividerBackground,_dragOpacity:L.splitViewDragOpacity,_toggleIcon:L.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(A,K){var R=this,W=R._position;isNaN(A)||(K||(R._82O=0>A?-1:A>1?1:0),R._position=A,R.fp(yg,W,A))},getLeftView:function(){return this._leftView},setLeftView:function(v){var s=this,u=s._leftView,e=s._view;if(s._leftView!==v){if(u&&u!==s._rightView){var M=Dm(u);M.parentNode===e&&ws(M)}if(s._leftView=v,v){var Q=Dm(v);Q.parentNode!==e&&e.insertBefore(Q,s._dividerDiv)}s.fp("leftView",u,v)}},getRightView:function(){return this._rightView},setRightView:function(b){var c=this,d=c._rightView,E=c._view;if(c._rightView!==b){if(d&&d!==c._leftView){var o=Dm(d);o.parentNode===E&&ws(o)}if(c._rightView=b,b){var I=Dm(b);I.parentNode!==E&&E.insertBefore(I,c._dividerDiv)}c.fp("rightView",d,b)}},validateImpl:function(){var A=this,T=A._draggable,x=A._position,C=A.getWidth(),t=A.getHeight(),V=A._dividerSize,i=A._dividerBackground,d=Km?18:8,O=A._dividerDiv,l=A._82O,I=A._60O,B=A._61O,f=A._toggleIcon,q=A._status,b=O.style,c=null,F=Km?20:4,L=f.comps[0];V>=d||0===V?A._coverDiv&&(ws(A._coverDiv),delete A._coverDiv):A._coverDiv||(A._coverDiv=Ke(),wk&&(A._coverDiv.style.background=Gg),Fd(O,A._coverDiv)),A._togglable?I.parentNode||(Fd(O,I),Fd(O,B)):(ws(I),ws(B));var h=A._coverDiv,_=A._leftView,D=A._rightView;if(Vn(A)){if(V>C&&(V=C),q===bd)if(1===l)var p=S(x,C),u=$(0,C-V-p);else-1===l?(u=S(-x,C),p=$(0,C-V-u)):(p=y((C-V)*x),u=$(0,C-V-p));else"cl"===q?(p=0,u=$(0,C-V)):"cr"===q&&(u=0,p=$(0,C-V));_&&Rf(_,0,0,p,t),D&&Rf(D,p+V,0,u,t),Rf(O,p,0,V,t),A._22o=p,h&&(Rf(h,V/2-d/2,0,d,t),h.style.cursor=T?Vm:""),O.style.cursor=T?Vm:"";var g=O.clientHeight/2,R=O.clientWidth;Ud(I,R,R),Rf(I,0,g-R-F,R,R),c=ms(I),cd(c,0,0,1),L.rotation=-So,Ce(c,f,0,0,R,R),c.restore(),Ud(B,R,R),Rf(B,0,g+F,R,R),c=ms(B),cd(c,0,0,1),L.rotation=So,Ce(c,f,0,0,R,R),c.restore()}else{if(V>t&&(V=t),q===bd)if(1===l)var J=S(x,t),r=$(0,t-V-J);else-1===l?(r=S(-x,t),J=$(0,t-V-r)):(J=y((t-V)*x),r=$(0,t-V-J));else"cl"===q?(J=0,r=$(0,t-V)):"cr"===q&&(r=0,J=$(0,t-V));_&&Rf(_,0,0,C,J),D&&Rf(D,0,J+V,C,r),Rf(O,0,J,C,V),A._22o=J,h&&(Rf(h,0,V/2-d/2,C,d),h.style.cursor=T?Ik:""),b.cursor=T?Ik:"";var P=O.clientWidth/2,R=O.clientHeight;Ud(I,R,R),Rf(I,P-R-F,0,R,R),c=ms(I),cd(c,0,0,1),L.rotation=0,Ce(c,f,0,0,R,R),c.restore(),Ud(B,R,R),Rf(B,P+F,0,R,R),c=ms(B),cd(c,0,0,1),L.rotation=v,Ce(c,f,0,0,R,R),c.restore()}b.background=i}});var kt=function(x){this.sv=x,this.addListeners()};hk(kt,i,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(A){var t=this,V=t.sv,r=V._dividerDiv,$=V._60O,q=V._61O,K=V._status,b=A.target;if(b===$)K===bd?V.setStatus("cl"):"cr"===K&&V.setStatus(bd);else if(b===q)K===bd?V.setStatus("cr"):"cl"===K&&V.setStatus(bd);else if(hg(A)&&(b===r||b===V._coverDiv)&&(_m(A),V.isDraggable())){V.getLeftView(),V.getRightView();var T=t.maskDiv=Ke();if(T.style.left=0,T.style.top=0,T.style.width=V.getWidth()+"px",T.style.height=V.getHeight()+"px",V.getView().appendChild(T),!V.isContinuousLayout()){var J=t.resizeDiv=Ke();J.style.left=r.style.left,J.style.top=r.style.top,J.style.width=r.style.width,J.style.height=r.style.height,J.style.opacity=V.getDragOpacity(),J.style.background=V.getDividerBackground(),Fd(t.getView(),J)}t._lastAbsPosition=V._22o,t._86o=Vn(V)?Nq(A).x:Nq(A).y,co(t,A)}},handleWindowTouchMove:function(x){hg(x)&&this.update(x,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(h){var G=this;G.update(h,!0),G.sv.setStatus(bd),G.maskDiv&&ws(G.maskDiv),G.resizeDiv&&ws(G.resizeDiv),G.maskDiv=G.resizeDiv=Z},handle_mousedown:function(i){tp(i)&&this.handle_touchstart(i)},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},update:function(B,b){var q=this,r=q.sv,w=Vn(r)?r.getWidth():r.getHeight(),C=r._dividerSize,E=q._lastAbsPosition-q._86o;Vn(r)?(E+=Nq(B).x,E>w-C&&(E=w-C),0>E&&(E=0),q.resizeDiv&&(q.resizeDiv.style.left=E+sj)):(E+=Nq(B).y,E>w-C&&(E=w-C),0>E&&(E=0),q.resizeDiv&&(q.resizeDiv.style.top=E+sj)),b&&w!==C&&(1===r._82O?r.setPosition(E,1):-1===r._82O?r.setPosition(E-w+C,1):r.setPosition(E/(w-C),1))}}),ft.TabView=function(){var C=this,L=C._view=zf(1,C),Z=C._91O=Ke(1),y=C._tabModel=new Id,S=y.sm(),d=C.invalidate;C._7o=new Dd,C._canvas=qs(Z),Fd(L,Z),Fd(L,C._92O=Ke(1)),S.setSelectionMode(Ih),S.ms(C.handleSelectionChange,C),y.mm(d,C),y.mh(d,C),y.md(d,C),C._interactor=new lt(C),C.iv()},gt("TabView",i,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Sg,Mr,"tabHPadding","tabBackground","selectWidth",qq,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Vl,_tabHeight:Jc,_tabGap:L.tabViewTabGap,_labelColor:L.tabViewLabelColor,_labelFont:L.tabViewLabelFont,_tabBackground:L.tabViewTabBackground,_selectWidth:L.tabViewSelectWidth,_selectBackground:L.tabViewSelectBackground,_moveBackground:L.tabViewMoveBackground,_insertColor:L.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(p,w,M){var O,f=this._tabModel;return p instanceof ht?(O=p,w&&O.setView(w)):(O=new ht,O.setName(p),O.setView(w)),f.add(O),M&&f.sm().ss(O),O},getLabel:function(j){return j.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(Q){this._23o=Q,this.iv()},get:function(R){var c=this,e=c._tabModel;if(km(R))return e._roots.get(R);if(em(R)){var B;return e.each(function(y){R===c.getLabel(y)&&(B=y)}),B}return R instanceof ht?R:Z},select:function(o){this._tabModel.sm().ss(this.get(o))},remove:function($){var k=this;if($=k.get($)){var q=k._tabModel,y=q._roots.indexOf($);k._tabModel.remove($),k.selectByIndex(--y)}},getCurrentTab:function(){return this._8o},hideTabView:function(v,c){c.parentNode===this._92O&&(Ld(c)?(c.style.display=tm,c._tab_=v):ws(c),Te())},showTabView:function(f,w){Ld(w)&&(w.style.display="block",w._tab_=f),w.parentNode!==this._92O&&(Fd(this._92O,w),Te())},_24o:function(){var e,j=this,J=j._8o,q=j._9o,h=j._tabModel.sm().ld();h&&(e=Dm(h.getView())),e!==q&&(q&&(J.getView()&&J.getView().endEditing&&J.getView().endEditing(),j.hideTabView(J,q)),e&&j.showTabView(h,e)),j._8o=h,j._9o=e,J!==h&&j.onTabChanged(J,h)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(O,e){this.selectByIndex(--e)},selectByIndex:function(o){var P=this,S=P._tabModel,m=S.size();if(m&&!S.sm().ld()){o==Z&&(o=0),o>=m&&(o=m-1),0>o&&(o=0);for(var u=o;u>=0;u--){var g=P.get(u);if(!g.isDisabled())return P.select(g),g}for(u=o+1;m>u;u++)if(g=P.get(u),!g.isDisabled())return P.select(g),g}},getTabWidth:function(M){var F=this.getTabHPadding(),u=4+2*F,P=qh(M.getIcon());P&&(u+=Vk(P,M)+4);var A=this.getLabel(M);return A&&(u+=dd(this.getLabelFont(M),A).width+4),M.isClosable()&&(u+=10),u},drawTab:function(G,d,o,i,b,H,R){var t,p=this,c=p._tabPosition,z=this.getTabHPadding(),k=o+4+z,m=p._selectWidth,$=qh(d.getIcon()),W=d.isDisabled(),U=p.getLabelColor(d),A=p.getLabelFont(d),s=p.getLabel(d),e=p._selectBackground,Z=c===Cl+"-vertical",w=c===ij+"-vertical";(Z||w)&&(k=i+4+z),W&&(G.globalAlpha=bb),Ki(G,o,i,b,H,R),d===p._8o&&m&&(c===Vl?Ki(G,o,i+H-m,b,m,e):c===Cl?Ki(G,o+b-m,i,m,H,e):c===ij?Ki(G,o,i,m,H,e):Z?Ki(G,o+b-m,i,m,H,e):w?Ki(G,o,i,m,H,e):Ki(G,o,i,b,m,e));var Y=b/2;if(Z&&(Kn(G,Y,i+H/2),Uo(G,v),Kn(G,-Y,-i-H/2)),$){var j=xl($,d),J=Vk($,d);if(Z||w){var M=o+b/2,P=k+j/2;Kn(G,M,P),Uo(G,So),Kn(G,-M,-P),yo(G,$,o+b/2,k+j/2,d,p),Kn(G,M,P),Uo(G,-So),Kn(G,-M,-P),k+=j+4}else yo(G,$,k+J/2,i+H/2,d,p),k+=J+4}return Z||w?(Kn(G,b/2,k+b/2),Uo(G,So),Kn(G,-b/2,-k-b/2),fm(G,s,A,U,o,k,H,b),Kn(G,b/2,k+b/2),Uo(G,-So),Kn(G,-b/2,-k-b/2)):fm(G,s,A,U,k,i,b,H),Z&&(Kn(G,Y,i+H/2),Uo(G,-v),Kn(G,-Y,-i-H/2)),d.isClosable()&&(t=w?{x:o+b-12,y:i+H-12,width:12,height:12}:{x:o+b-12,y:i+2,width:12,height:12},this.drawCloseIcon(d,G,U,t)),W&&(G.globalAlpha=1),t},drawCloseIcon:function(J,M,m,a){var $=a.x,y=a.y;M.strokeStyle=m,M.lineWidth=1,M.beginPath(),M.moveTo($+2,y+8),M.lineTo($+8,y+2),M.moveTo($+8,y+8),M.lineTo($+2,y+2),M.stroke()},getTabAt:function(p){var F=this._interactor._8Q(p);return F?F.tab:null},validateImpl:function(){var b=this;b._24o();var s,B=b._canvas,G=b._tabPosition,x=b._91O,o=b._92O,v=b._tabModel,K=b.getWidth(),I=b.getHeight(),i=b._tabHeight,H=b._7o,a=b._tabGap,Y=G===Vl,P=G===Cl,k=G===ij,S=G===Cl+"-vertical",p=G===ij+"-vertical",c=b._23o,j=0;if((P||k)&&v._roots.each(function(q){j=$(b.getTabWidth(q),j)}),Y?(Rf(x,0,0,K,i),s={x:0,y:i,width:K,height:$(0,I-i)}):P?(Rf(x,0,0,j,I),s={x:j,y:0,width:$(0,K-j),height:I}):k?(Rf(x,K-j,0,j,I),s={x:0,y:0,width:$(0,K-j),height:I}):S?(Rf(x,0,0,i,I),s={x:i,y:0,width:$(0,K-i),height:I}):p?(Rf(x,K-i,0,i,I),s={x:0,y:0,width:$(0,K-i),height:I}):(Rf(x,0,I-i,K,i),s={x:0,y:0,width:K,height:$(0,I-i)}),Rf(o,s),S||p){b._9o&&(s.x=0,Rf(b._8o.getView(),s)),Ud(B,i,I);var l=ms(B),e=0;if(cd(l,0,b.ty(),1),l.clearRect(0,0,i,I),H.clear(),v._roots.each(function(L){if(L.isVisible()){var S,W=b.getTabWidth(L);if(!c||c.tab!==L){var x=b.getTabBackground(L);S=b.drawTab(l,L,0,e,i,W,x)}H.add({_75o:S,tab:L,startY:e,endY:e+W,height:W}),e+=W+a}}),b._23Q=$(0,e-a),c){var V=c.position;b.drawTab(l,c.tab,0,c.startY,i,c.height,b._moveBackground),Ki(l,0,V,i,1,b._insertColor)}if(l.restore(),b._selectionChanged){b._selectionChanged=!1;for(var E=b.ty(),X=0;X<H.size();X++){var T=H.get(X);if(T.tab===b._8o){if(T.endY+E<0){b.ty(-T.startY);break}if(T.startY+E>I){b.ty(I-T.endY);break}}}}b.ty(b.ty())}else if(P||k){b._9o&&(s.x=0,Rf(b._8o.getView(),s)),Ud(B,j,I);var l=ms(B),e=0;if(cd(l,0,b.ty(),1),l.clearRect(0,0,j,I),H.clear(),v._roots.each(function(g){if(g.isVisible()){var _;if(!c||c.tab!==g){var C=b.getTabBackground(g);_=b.drawTab(l,g,0,e,j,i,C)}H.add({_75o:_,tab:g,startY:e,endY:e+i,height:i}),e+=i+a}}),b._23Q=$(0,e-a),c){var V=c.position;b.drawTab(l,c.tab,0,c.startY,j,c.height,b._moveBackground),Ki(l,0,V,j,1,b._insertColor)}if(l.restore(),b._selectionChanged){b._selectionChanged=!1;for(var E=b.ty(),X=0;X<H.size();X++){var T=H.get(X);if(T.tab===b._8o){if(T.endY+E<0){b.ty(-T.startY);break}if(T.startY+E>I){b.ty(I-T.endY);break}}}}b.ty(b.ty())}else{b._9o&&(s.y=0,Rf(b._8o.getView(),s)),Ud(B,K,i);var l=ms(B),t=0;if(cd(l,b.tx(),0,1),l.clearRect(0,0,K,i),H.clear(),v._roots.each(function(N){if(N.isVisible()){var k,n=b.getTabWidth(N);if(!c||c.tab!==N){var j=b.getTabBackground(N);k=b.drawTab(l,N,t,0,n,i,j)}H.add({_75o:k,tab:N,startX:t,endX:t+n,width:n}),t+=n+a}}),b._64I=$(0,t-a),c){var V=c.position;b.drawTab(l,c.tab,c.startX,0,c.width,i,b._moveBackground),Hr(l,b._insertColor,V,0,i)}if(l.restore(),b._selectionChanged){b._selectionChanged=!1;for(var r=b.tx(),X=0;X<H.size();X++){var T=H.get(X);if(T.tab===b._8o){if(T.endX+r<0){b.tx(-T.startX);break}if(T.startX+r>K){b.tx(K-T.endX);break}}}}b.tx(b.tx())}for(var u=[],F=o.children,X=0;X<F.length;X++){var y=F[X],m=y._tab_;m&&!v.contains(m)&&u.push(y)}u.forEach(function(W){o.removeChild(W)})}});var lt=function(l){this.tv=l,this.addListeners()};hk(lt,i,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(e){this.handleScroll(e,10*(e.wheelDelta/40))},handle_DOMMouseScroll:function(N){this.handleScroll(N,10*-N.detail)},handleScroll:function(s,o){_m(s);var Z=this.tv,w=Z._tabPosition;!Z._40o()||w!==Vl&&w!==mf||Z.tx(this.tv.tx()+o),!Z._41o()||w!==Cl&&w!==ij&&w!==Cl+"-vertical"&&w!==ij+"-vertical"||Z.ty(this.tv.ty()+o)},_8Q:function(b){var U,s,V=this.tv,X=V._tabPosition,t=V._7o;if(X===Vl||X===mf){var K=V.lp(b).x;for(U=0;U<t.size();U++)if(s=t.get(U),s.startX<=K&&K<=s.endX)return s}else if(X===Cl||X===ij||X===Cl+"-vertical"||X===ij+"-vertical"){var a=V.lp(b).y;for(U=0;U<t.size();U++)if(s=t.get(U),s.startY<=a&&a<=s.endY)return s}return Z},isClickable:function(u){var q=this.tv,b=q._tabPosition,y=this._73o=this._8Q(u);return!q._40o()||b!==Vl&&b!==mf?!q._41o()||b!==Cl&&b!==ij&&b!==Cl+"-vertical"&&b!==ij+"-vertical"?y&&(!y.tab.isDisabled()||q.isMovable()):!0:!0},handle_mousemove:function(B){var m=this;ei?m._74o=m._8Q(B):m.getView().style.cursor=m.isClickable(B)?fl:""},handle_mousedown:function(V){this.handle_mousemove(V),this.handle_touchstart(V)},handle_touchstart:function(P){var l=this,Q=l.tv,U=Q._tabPosition;_m(P),tp(P)&&l.isClickable(P)&&(U===Vl||U===mf?(l.x=Nq(P).x,l.lp=Q.lp(P),l.tx=Q.tx()):(l.y=Nq(P).y,l.lp=Q.lp(P),l.ty=Q.ty()),co(l,P))},handle_mouseup:function(S){this.handle_touchend(S)},handle_touchend:function(h){if(_h(h)){var W=this._73o;if(!W)return;var R=this.tv,B=R.getTabModel(),G=W.tab;if(!G.isDisabled()&&G.isClosable()){var w=function(){var s=B._roots.indexOf(G);B.remove(G),R.onTabClosed(G,s)};R.onTabClosing(G,w)&&w()}}},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(p){var B,z=this,n=z.tv,G=n._tabPosition,w=z._73o;if(G===Vl||G===mf){if(B=Nq(p).x-z.x,!z._25o&&!z.moving&&C(B)>2&&(n._40o()&&!ig(p)?z._25o=1:w&&n.isMovable()&&(z.moving=1)),z._25o)n.tx(z.tx+B);else if(z.moving){var y=z.lp.x+B,Y=n._tabGap/2;n._7o.each(function(Q){var W=Q.endX,V=y-Q.startX<W-y;y>=Q.startX&&W>=y&&n._7Q({tab:w.tab,startX:w.startX+B,width:w.width,front:V,insertTab:Q.tab,position:V?$(0,Q.startX-Y):S(n._64I,W+Y)})})}}else if(B=Nq(p).y-z.y,!z._25o&&!z.moving&&C(B)>2&&(n._41o()&&!ig(p)?z._25o=1:w&&n.isMovable()&&(z.moving=1)),z._25o)n.ty(z.ty+B);else if(z.moving){var m=z.lp.y+B,Y=n._tabGap/2;n._7o.each(function(q){var F=q.endY,l=m-q.startY<F-m;m>=q.startY&&F>=m&&n._7Q({tab:w.tab,startY:w.startY+B,height:w.height,front:l,insertTab:q.tab,position:l?$(0,q.startY-Y):S(n._23Q,F+Y)})})}},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(){var v=this,W=v.tv,G=W._tabPosition,p=W.getTabModel(),S=p._roots,H=v._73o;if(v.moving){var b=W._23o;if(b&&b.insertTab!==b.tab){var J=b.tab,w=S.remove(J),E=S.indexOf(b.insertTab);E>=0&&(b.front||E++,E<=S.size()&&(S.add(J,E),p._38I(J,w,E)))}W._7Q(Z),delete v.moving}else if(!v._25o&&H){J=H.tab;var L=v._74o;if(!L||L.tab===J)if(!J.isDisabled()&&Gb(H._75o,v.lp)){var m=function(){var N=S.indexOf(J);p.remove(J),W.onTabClosed(J,N)};W.onTabClosing(J,m)&&m()}else J.isDisabled()||W._8o===J||p.sm().ss(J)}v._25o=v._73o=v._74o=G===Vl||G===mf?v.x=v.lp=v.tx=Z:v.y=v.lp=v.ty=Z}}),ft.PropertyView=function(E){var n=this;n._view=zf(1,n),n._canvas=qs(n._view),Fd(n._view,n._79O=Ke()),n._rows=new Dd,n._28o=new Dd,n._26o={},n._26Q={};var M=n._propertyModel=new Id,K=n.ivm;M.mm(K,n),M.md(K,n),M.mh(K,n),n.dm(E?E:new Id),new mt(n)},gt("PropertyView",i,{ms_ac:[Sg,Rg,Mr,ss,gj,"categorizable",Ao,Yq,Jg,Uf,ud,Gp,id,$o,"selectRowIndex",qq,"background",Jk,fq,cb,Tn,Bs],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Cp,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Ul,_background:L.propertyViewBackground,_expandIcon:L.propertyViewExpandIcon,_collapseIcon:L.propertyViewCollapseIcon,_scrollBarColor:Rh,_scrollBarSize:Ql,_autoHideScrollBar:qc,_selectBackground:L.propertyViewSelectBackground,_rowHeight:yk,_rowLineVisible:L.propertyViewRowLineVisible,_rowLineColor:L.propertyViewRowLineColor,_10I:.5,_columnLineVisible:L.propertyViewColumnLineVisible,_columnLineColor:L.propertyViewColumnLineColor,_labelColor:L.propertyViewLabelColor,_labelSelectColor:L.propertyViewLabelSelectColor,_labelFont:L.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(P){0>P&&(P=0),P>1&&(P=1);var D=this,L=D._10I;D._10I=P,D.fp("columnPosition",L,P)},getPropertyName:function(i){return i.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(Y,$,c){return c===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(G,R){return R===this._selectRowIndex?this._labelSelectColor:G.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(J){var I=this.getHeight()-this._59I;return I>J&&(J=I),J>0?0:y(J)},isExpanded:function(h){if(!h)return!0;var X=this._26o[h];return X?X.isExpanded:!(this._26Q[h]===!1)},toggle:function(D){var i=this;i.isExpanded(D)?i.collapse(D):i.expand(D)},expandAll:function(){this.validate();for(var f in this._26o)this.expand(f)},expand:function(y){if(y&&y!==tm){var r=this,U=r._26o[y];U&&!U.isExpanded&&(U.isExpanded=!0,r.onExpanded(y),r.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var Q in this._26o)this.collapse(Q)},collapse:function(a){if(a&&a!==tm){var $=this,j=$._26o[a];j&&j.isExpanded&&(j.isExpanded=!1,$.onCollapsed(a),$.ivm())}},onCollapsed:function(){},getCategoryName:function(t){if(!this.isCategorizable())return tm;var d=t.getCategoryName();return d?d:tm},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(M){var Y=this,y=Y._dataModel;y!==M&&(y&&(y.umd(Y.handlePropertyChange,Y),Y._selectionModel||y.sm().ums(Y.handleSelectionChange,Y)),Y._dataModel=M,M.md(Y.handlePropertyChange,Y),Y._selectionModel?Y._selectionModel._21I(M):M.sm().ms(Y.handleSelectionChange,Y),Y.fp(vi,y,M))},isVisible:function(b){return this._visibleFunc?this._visibleFunc(b):!0},onPropertyChanged:function(g){var J=this,o=g.property;at[o]?J.ivm():J.iv(),o===uf&&J._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:jr},handlePropertyChange:function(h){this._27o===h.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var U=this;U._96I||(U.setSelectRowIndex(-1),U._96I=1,U.iv())},redraw:function(){this.iv()},validateModel:function(){var g=this,t=g._rows,M=g._28o,K={},n=new Dd,f=g._27o;g.updateCurrentData(),f!==g._27o&&g.endEditing(),t.clear(),M.clear(),g.getRawProperties().each(function(z){if(g.isVisible(z)){n.add(z);var y=g.getCategoryName(z);K[y]||(M.add(y,y===tm?0:c),K[y]={isExpanded:g.isExpanded(y),properties:new Dd})}}),g._sortFunc&&n.sort(g._sortFunc);for(var T in g._26o)g._26Q[T]=g.isExpanded(T);g._26o=K,M.each(function(_){_!==tm&&t.add(_);var b=K[_];b.isExpanded&&n.each(function(J){g.getCategoryName(J)===_&&(b.properties.add(J),t.add({property:J,data:g._27o}))},g)})},validateImpl:function(){var I=this;I._76o(),I._96I&&(I.validateModel(),delete I._96I);var S=I._canvas,b=I.getWidth(),O=I.getHeight(),_=-I.ty(),D=I._rowHeight,x=I._indent,r=b-x,s=I._rows,e=s.size(),y=I._9I=x+r*I._10I,Y=I._59I=e*D;Ud(S,b,O),I._29I={x:0,y:_,width:b,height:O},I._31I=G(_/D),I._14I=N((_+O)/D),I._31I<0&&(I._31I=0),I._14I>e&&(I._14I=e);var A,g=ms(S),Q=I._background;cd(g,0,-_,1),g.beginPath(),g.rect(0,_,b,O),g.clip(),g.clearRect(0,_,b,O),I._93db(g),Q&&Ki(g,0,0,x,Y,Q);for(var q=I._31I;q<I._14I;q++){var E=s.get(q),_=D*q;if(em(E))Q&&Ki(g,x,_,r,D,Q),A=qh(I.isExpanded(E)?I._expandIcon:I._collapseIcon),A&&_r(g,A,En,0,_,x,D),g.save(),g.beginPath(),g.rect(x,_,r,D),g.clip(),I.drawCategoryName(g,E,q,x,_,r,D),g.restore();else{var d=E.property,H=E.data,A=qh(d.getIcon()),c=I._selectRowIndex===q?I.getSelectBackground():Z;if(A&&_r(g,A,En,0,_,x,D),c&&Ki(g,x,_,r,D,c),g.save(),g.beginPath(),g.rect(x,_,y-x,D),g.clip(),I.drawPropertyName(g,d,q,x,_,y-x,D),g.restore(),!I.isEditing(H,d)){var P=y+1,k=b-y-1;g.save(),g.beginPath(),g.rect(P,_,k,D),g.clip(),I._87o(I.drawPropertyValue(g,d,I.getValue(H,d),q,P,_,k,D,H),q,P,_,k,D),g.restore()}}I._rowLineVisible&&Ki(g,x,_+D-1,r,1,I._rowLineColor)}I._columnLineVisible&&(Ki(g,y,0,1,Y,I._columnLineColor),Ki(g,b-1,0,1,Y)),I._92db(g),I._93I(),g.restore(),I.ty(I.ty())},drawCategoryName:function(z,m,C,h,Y,e,v){fm(z,m,this.getCategoryFont(m),this.getCategoryColor(m),h,Y,e,v)},drawPropertyName:function(j,N,x,w,c,J,v){return N.drawPropertyName?(N.drawPropertyName(j,N,x,w,c,J,v,this),void 0):(fm(j,this.getPropertyName(N),this.getPropertyFont(N,x),this.getPropertyColor(N,x),w,c,J,v),void 0)},drawPropertyValue:function(p,e,a,R,j,F,m,n,h){return e.drawPropertyValue?e.drawPropertyValue(p,e,a,R,j,F,m,n,h,this):(ct(p,a,e,this.getLabelFont(e,a,R),this.getLabelColor(e,a,R),j,F,m,n,h,this),void 0)},isPropertyEditable:function(y){return y.isEditable()&&this.isEditable()},setProperties:function(B){this._propertyModel.clear(),this.addProperties(B)},addProperties:function(b){if(b){var q=this._propertyModel;b.forEach(function(k){if(!(k instanceof jt)){var P=yf(k.className);k=Mi(P?P:jt,k)}q.add(k)})}},getRowIndexAt:function(B){var s=this,x=G(s.lp(B).y/s._rowHeight);return x>=0&&x<s._rows.size()?x:-1},getPropertyAt:function(h){var U=this,K=U.getRowIndexAt(h);return K>=0?U._rows.get(K).property:Z},getToolTip:function(h){var V=this,M=V.getPropertyAt(h),m=V._27o;return M&&m?M.getToolTip(m,V._9I<V.lp(h).x,V):Z}});var mt=function(S){this.pv=S,this.addListeners()};hk(mt,i,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(P){this.getView().style.cursor=P},clear:function(){var t=this;t._62O=t.cp=t.ty=t.p=Z,t.setCursor(Yb)},handle_mousedown:function(C){this.handle_touchstart(C)},handle_touchstart:function(u){var s=this,Y=s.pv;_m(u),Y.setFocus(u)&&(tp(u)?(s.cp=Nq(u),s.ty=Y.ty(),s.p=Y.getColumnPosition(),s.handle_touchmove(u)):Y.setSelectRowIndex(Y.getRowIndexAt(u)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(X){this.handle_touchend(X)},handle_touchend:function(y){var L=this;if(L.cp&&!L._62O){var p=L.pv,O=p.lp(y),k=O.x,o=O.y,J=p._indent,K=p.getRowIndexAt(y),V=p._9I;if(K>=0){var G=p._rowHeight,X=G*K,w=p._rows.get(K),l=w.property;if(em(w))qh(p.isExpanded(w)?p._expandIcon:p._collapseIcon)&&k>=0&&J>=k&&o>=X&&X+G>=o?p.toggle(w):_c(y)&&p.toggle(w);else if(k>V&&p.isPropertyEditable(l,y)){var b={x:V+1,y:X,width:p.getWidth()-V-1,height:G},j={x:b.x+p.tx(),y:b.y+p.ty(),width:b.width,height:b.height},C=0,P=p._29I;b.y<P.y?C=b.y-P.y:b.y+G>P.y+P.height&&(C=b.y+G-P.y-P.height),C&&(p.ty(p.ty()-C),j.y-=C),p.beginEditing({data:w.data,property:l,value:p.getValue(w.data,l),event:y,rect:b,editorRect:j,view:p})}}p.setSelectRowIndex(K)}L.clear()},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(U){var b=this,K=b.pv,S=b.ty,s=b.cp,W=Nq(U),o=b._62O;if("p"===o)K.setTranslateY(S+W.y-s.y);else if("c"===o){var p=K.getWidth()-K._indent;if(p>16){var d=b.p-(s.x-W.x)/p,y=16/p;y>d&&(d=y),d>1-y&&(d=1-y),K.setColumnPosition(d)}}else"s"===o&&K.setTranslateY(S+(s.y-W.y)*K._59I/K._29I.height)},handle_mousemove:function(O){this.handle_touchmove(O)},handle_touchmove:function(d){if(!ei&&tp(d)){var y=this,H=y.pv,v=C(H.lp(d).x-H._9I)<=(Km?8:3);y.cp?y._62O||(v?(y._62O="c",co(y,d)):C(Nq(d).y-y.cp.y)>=2&&(y._62O=y.isV(d)?"s":"p",co(y,d))):(v?y.setCursor(Vm):y.setCursor(Yb),y.isV(d)&&H._43o())}},isV:function(w){var X=this.pv,v=X._29I;return X._41o()&&v.x+v.width-X.lp(w).x<ts
},handle_mousewheel:function(v){this.handleScroll(v,v.wheelDelta/40)},handle_DOMMouseScroll:function(y){2===y.axis&&this.handleScroll(y,-y.detail)},handleScroll:function(U,Y){var H=this.pv;_m(U),H.endEditing(),H.translate(0,Y*H.getRowHeight())},handle_keydown:function(M){var Z=this.pv,N=Z._rows.size(),R=Z._selectRowIndex+(np(M)?-1:1);(np(M)||ob(M))&&(0>R&&(R=0),R>=N&&(R=N-1),Z.setSelectRowIndex(R))}}),ft.ListView=function(m){this._5o(m),new nt(this)},gt("ListView",i,{ms_ac:[Sg,Rg,Mr,Jk,Ao,fq,cb,Yq,Jg,Gp,id,$o,lk,qq],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Ul,_rowHeight:yk,_rowLineVisible:L.listViewRowLineVisible,_rowLineColor:L.listViewRowLineColor,_scrollBarColor:Rh,_scrollBarSize:Ql,_autoMakeVisible:Un,_autoHideScrollBar:qc,_selectBackground:L.listViewSelectBackground,_labelColor:L.listViewLabelColor,_labelSelectColor:L.listViewLabelSelectColor,_labelFont:L.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(C){var V=this,Y=V._checkMode;V._checkMode=C,V.fp(wc,Y,C)},drawRow:function(B,N,Y,w,Q,h,g){var P=this,v=0,X=P._indent,n=P.getIconWidth(N);P.drawRowBackground(B,N,Y,w,Q,h,g),P._checkMode&&(yo(B,qh(P.getCheckIcon(N)),v+X/2,Q+g/2,N,P),v+=X),P.drawIcon(B,N,v,Q,n,g),P.drawLabel(B,N,v+n,Q,g)}});var nt=function(n){this.list=n,this.addListeners()};hk(nt,i,{ms_listener:1,getView:function(){return this.list._view},clear:function(W){var R=this,T=R.list;W&&"d"===R._62O&&!R.dragCancel&&T.handleDragAndDrop(W,"end"),T.draggingData&&(T.draggingData=null,T.redraw()),R.dragCancel=R._62O=R._isV=R._isH=R.cp=R.tx=R.ty=Z},handle_mousedown:function(G){this.handle_touchstart(G)},handle_touchstart:function(R){var F=this,H=F.list;if(_m(R),H.setFocus(R)){var l=H.getDataAt(R);F.cp=Nq(R),F.tx=H.tx(),F.ty=H.ty(),tp(R)?l&&H.handleDragAndDrop&&!F.isV(R)&&!F.isH(R)&&(H.draggingData=l,H.redraw(),H.handleDragAndDrop(R,"prepare")):(l?F._33o(R,l):this._cancelDataDoubleSelect(),F.clear(R))}},handleWindowMouseUp:function(k){this.clear(k)},handleWindowTouchEnd:function(t){this.clear(t)},handle_mouseup:function(k){this.handle_touchend(k)},handle_touchend:function(r){var h=this,F=h.list;if(!h._isV&&!h._isH&&h.cp&&!h._62O){var Z=F.getDataAt(r);Z?(F.isCheckMode()?h._34o(r,Z):h._33o(r,Z),_c(r)?F.onDataDoubleClicked(Z,r):F.onDataClicked(Z,r)):(h._cancelDataDoubleSelect(),F.handleBackgroundClick(r))}h.clear(r)},handleWindowMouseMove:function(k){this.handleWindowTouchMove(k)},handleWindowTouchMove:function(q){var W=this,G=W.list,M=W._62O,j=W.tx,l=W.ty,d=W.cp,$=Nq(q),f=G._29I;"p"===M?G.setTranslate(j+$.x-d.x,l+$.y-d.y):"v"===M?G.ty(l+(d.y-$.y)*G._59I/f.height):"h"===M?G.tx(j+(d.x-$.x)*G._91I/f.width):"d"===M&&(W.dragCancel||G.handleDragAndDrop(q,"between"))},handle_mousemove:function(i){this.handle_touchmove(i)},handle_touchmove:function(x){if(!ei&&tp(x)){var d=this,m=d.list;if(d._isV=d.isV(x),d._isH=d.isH(x),d.cp){if(!d._62O){if(Yf(Nq(x),d.cp)<2)return;d._isV?d._62O="v":d._isH?d._62O="h":m.draggingData&&!this.dragCancel?(d._62O="d",m.handleDragAndDrop(x,"begin")):d._62O="p",d._62O&&"d"!==d._62O&&m.draggingData&&(m.draggingData=null,m.redraw()),co(d,x)}}else d._isV&&m._43o(),d._isH&&m._42o()}},isV:function(H){var R=this.list,Y=R._29I;return R._41o()&&Y.x+Y.width-R.lp(H).x<ts},isH:function(A){var b=this.list,l=b._29I;return b._40o()&&l.y+l.height-b.lp(A).y<ts},handle_mousewheel:function(z){this.handleScroll(z,z.wheelDelta/40,z.wheelDelta!==z.wheelDeltaX)},handle_DOMMouseScroll:function(W){this.handleScroll(W,-W.detail,1)},handleScroll:function(r,j,m){var t=this.list;_m(r),t.endEditing&&t.endEditing(),m&&t._41o()?t.translate(0,j*t.getRowHeight()):t._40o()&&t.translate(10*j,0)},handle_keydown:function(V){if(!L.isInput(V.target)){var i,b=this.list,G=b.sm(),r=b._rows,w=r.size();if(Vi(V))b.selectAll();else if(Tr(V))b.handleDelete&&b.handleDelete(V);else if(bf(V))"d"!==this._62O||this.dragCancel||(b.handleDragAndDrop(V,"cancel"),this.dragCancel=!0);else if(Zh(V))b.isCheckMode()&&(i=b.getFocusData(),i&&b.checkData(i));else if(np(V)||ob(V)){var o=b.isCheckMode();if(i=o?b.getFocusData():G.ld()){var g=b.getRowIndex(i);g>=0&&(np(V)?0!==g&&(i=r.get(g-1),o?b.setFocusData(i):G.ss(i)):g!==w-1&&(i=r.get(g+1),o?b.setFocusData(i):G.ss(i)))}else w>0&&(i=r.get(0),o?b.setFocusData(i):G.ss(i))}}},_34o:function(G,n){var T=this.list,m=T.lp(G).x;return m>=0&&m<=T._indent?(T.checkData(n),void 0):(T.setFocusData(n),void 0)},_33o:function(a,r){var h=this.list,L=h.sm(),D=L.ld();if(!h.canHandleSelectMode(a,r))return this._cancelDataDoubleSelect(),void 0;if(ig(a))h.isSelected(r)?L.rs(r):L.as(r);else if(Ji(a))if(D)for(var U=h.getRowIndex(D),Z=h.getRowIndex(r);U!==Z;)U+=Z>U?1:-1,L.as(h._rows.get(U));else L.ss(r);else tp(a)?(L.contains(r)?h.handleDataDoubleSelect&&(this._handleDataDoubleSelect(a,r),_c(a)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),L.ss(r)):L.contains(r)||L.ss(r)},_handleDataDoubleSelect:function(u,J){this._cancelDataDoubleSelect(),this._doubleSelectTimer=vc(function(){this.list.handleDataDoubleSelect(u,J),this._doubleSelectTimer=c}.bind(this),L.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(ki(this._doubleSelectTimer),this._doubleSelectTimer=c)}}),ft.TreeView=function(T){var R=this;R._35o(),R._5o(T),new ot(R)},gt("TreeView",i,{ms_ac:[Sg,Rg,Mr,"rootVisible",wc,"rootData",Yq,Jg,Gp,id,$o,Ao,Jk,fq,cb,Uf,ud,lk,qq,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:Z,_indent:Ul,_rowHeight:yk,_rowLineVisible:L.treeViewRowLineVisible,_rowLineColor:L.treeViewRowLineColor,_scrollBarColor:Rh,_scrollBarSize:Ql,_autoHideScrollBar:qc,_expandIcon:L.treeViewExpandIcon,_collapseIcon:L.treeViewCollapseIcon,_autoMakeVisible:Un,_selectBackground:L.treeViewSelectBackground,_labelColor:L.treeViewLabelColor,_labelSelectColor:L.treeViewLabelSelectColor,_labelFont:L.treeViewLabelFont,_doubleClickToToggle:L.treeViewDoubleClickToToggle,drawRow:function(v,z,o,q,T,R,L){var t=this;t.drawRowBackground(v,z,o,q,T,R,L),t.drawTree(v,z,o,0,T,R,L)},isOnToggleIcon:function(j){var J=this.getDataAt(j);if(J){var x=this.getIndent(),h=this.lp(j).x;if(qh(this.getToggleIcon(J))){var _=x*this.getLevel(J);if(h>=_&&_+x>=h)return!0}}return!1}});var ot=function(R){to(ot,this,[R])};hk(ot,nt,{toggle:function(L,W,t,c){var K=this.list,s=K.lp(L).x;if(qh(K.getToggleIcon(W))){var p=t*c;if(s>=p&&p+t>=s)return K.toggle(W),!0}return K.isDoubleClickToToggle()&&_c(L)?(K.toggle(W),!0):!1},_34o:function(P,c){var j=this.list,W=j.lp(P).x,N=j._levelMap[c._id],D=j._indent,i=D*(N+1);return W>=i&&i+D>=W?(j.checkData(c),void 0):(this.toggle(P,c,D,N)||j.setFocusData(c),void 0)},_33o:function(S,E){var H=this,M=H.list;if(!H.toggle(S,E,M._indent,M.getLevel(E)))if(Ji(S)){var t=M.sm();if(t.size()>0){for(var $=M._rows,p=null,L=0,y=$.size();y>L;L++)if(M.isSelected($.get(L))){p=L;break}for(var R=null,L=$.size()-1;L>=0;L--)if(M.isSelected($.get(L))){R=L;break}var z,n,F=M.getRowIndex(E);for(p>F?(z=F-1,n=p):F>R?(z=R,n=F):(z=p,n=R);z!==n;)z++,t.as(M._rows.get(z))}else t.ss(E)}else ot.superClass._33o.call(H,S,E)},handle_keydown:function(V){if(uj(V)||Wn(V)){var Q=this.list,p=Q._rows,B=Q.isCheckMode(),E=Q.sm(),U=B?Q.getFocusData():E.ld();U?U.hasChildren()&&(uj(V)?Q.collapse(U):Q.expand(U)):p.size()>0&&(U=p.get(0),B?Q.setFocusData(U):E.ss(U))}else ot.superClass.handle_keydown.call(this,V)}});var pt=ft.TableView=function(x){this._98I(),this._5o(x),new qt(this)};gt("TableView",i,{ms_ac:[Sg,Rg,Mr,"sortMode",ss,gj,Jk,fq,cb,Tn,Bs,"sortColumn",Yq,Jg,Gp,id,$o,lk,qq],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Nk,_editable:!0,_batchEditable:!1,_rowHeight:yk,_rowLineVisible:L.tableViewRowLineVisible,_rowLineColor:L.tableViewRowLineColor,_columnLineVisible:L.tableViewColumnLineVisible,_columnLineColor:L.tableViewColumnLineColor,_scrollBarColor:Rh,_scrollBarSize:Ql,_autoHideScrollBar:qc,_autoMakeVisible:Un,_selectBackground:L.tableViewSelectBackground,_labelColor:L.tableViewLabelColor,_labelSelectColor:L.tableViewLabelSelectColor,_labelFont:L.tableViewLabelFont,getCheckColumn:function(){var x=this;if(!x._31o){var A=x._31o=new it;A.setEditable(!0),A.setWidth(40),A.getValue=x.getCheckColumValue,A.drawCell=x.drawCheckColumnCell}return x._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(w){var P=this,o=P._39o,d=P.getCheckColumn();w!==P.isCheckMode()&&(w?o.add(d,0):o.remove(d),P.fp(wc,!w,w))},getCheckColumValue:function(P,p,R){return R.isSelected(P)},drawCheckColumnCell:function(H,V,g,y,l,P,a,W,_){yo(H,_.getCheckIcon(V),l+a/2,P+W/2,V,_)}});var qt=function(L){to(qt,this,[L])};hk(qt,nt,{_34o:function(f,z){var V=this.list,W=V._31o;if(V.isCellEditable(z,W,f)){var D=V._3Q(W),a=V.lp(f).x;if(D&&a>=D.startX&&a<D.startX+W.getWidth())return V.checkData(z),void 0}V._37O(z,f),V.setFocusData(z)},_33o:function(C,A){this.list._37O(A,C),qt.superClass._33o.apply(this,arguments)}});var rt=ft.TreeTableView=function(J){var c=this,v=c._4o=new it;c._35o(),c._98I(),c._5o(J),v.setDisplayName("Name"),v.setEditable(!0),v.setWidth(180),v.drawCell=st,v.getValue=tt,c._39o.add(v),new ut(c)},st=function(e,y,i,J,U,l,j,C,w){w.drawTree(e,y,i,U,l,j,C)},tt=function(r,q,u){return u.getLabel(r)};gt("TreeTableView",i,{ms_ac:[Sg,Rg,Mr,"sortMode",ss,gj,Ao,wc,"rootData","rootVisible",Yq,Jg,"sortColumn",Uf,ud,Gp,id,$o,lk,cb,Jk,fq,Tn,Bs,qq,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Nk,_checkMode:Z,_editable:!0,_batchEditable:!1,_indent:Ul,_rowHeight:yk,_rowLineVisible:L.treeTableViewRowLineVisible,_rowLineColor:L.treeTableViewRowLineColor,_columnLineVisible:L.treeTableViewColumnLineVisible,_columnLineColor:L.treeTableViewColumnLineColor,_expandIcon:L.treeTableViewExpandIcon,_collapseIcon:L.treeTableViewCollapseIcon,_scrollBarColor:Rh,_scrollBarSize:Ql,_autoHideScrollBar:qc,_autoMakeVisible:Un,_selectBackground:L.treeTableViewSelectBackground,_labelColor:L.treeTableViewLabelColor,_labelSelectColor:L.treeTableViewLabelSelectColor,_labelFont:L.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var ut=function(S){to(ut,this,[S])};hk(ut,nt,{_34o:function(F,w){var r=this.list,K=r._4o,B=r._3Q(K),t=r.lp(F).x;if(B){var n=r._indent,Y=B.startX+n*r.getLevel(w);if(qh(r.getToggleIcon(w))&&t>=Y&&Y+n>=t)return r.toggle(w),void 0;if(r.isCellEditable(w,K)&&(Y+=n,t>=Y&&Y+n>=t))return r.checkData(w),void 0}r._37O(w,F),r.setFocusData(w)},_33o:function(e,M){var x=this.list,i=x.lp(e).x;if(qh(x.getToggleIcon(M))){var q=x._3Q(x._4o);if(q){var X=x._indent,F=q.startX+X*x.getLevel(M);if(i>=F&&F+X>=i)return x.toggle(M),void 0}}x._37O(M,e),ut.superClass._33o.apply(this,arguments)}});var vt=ft.TableHeader=function(T){var s=this,C=s._view=zf(1,s),m=s._39o=T.getColumnModel(),x=s.iv;s.tv=s._tableView=T,s._60I=new Dd,s._canvas=qs(C),C.style.background=L.tableHeaderBackground||"",C.style.height=Mg+sj,m.mm(x,s),m.md(x,s),m.mh(x,s),T.mp(function(v){Ys[v.property]&&s.iv()},s),new wt(s),s.iv()};gt("TableHeader",i,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Sg,Mr,Ao,"moveBackground","insertColor",Tn,Bs,"resizable","movable"],_checkIcon:md,_movable:!0,_resizable:!0,_labelColor:L.tableHeaderLabelColor,_labelFont:L.tableHeaderLabelFont,_columnLineColor:L.tableHeaderColumnLineColor,_columnLineVisible:L.tableHeaderColumnLineVisible,_sortDescIcon:L.tableHeaderSortDescIcon,_sortAscIcon:L.tableHeaderSortAscIcon,_moveBackground:L.tableHeaderMoveBackground,_insertColor:L.tableHeaderInsertColor,_indent:Ul,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(H){return H.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(K){return K.getColor()||this._labelColor},getLabelAlign:function(T){return T._align},onPropertyChanged:function(){this.iv()},_5Q:function(n){this._61I=n,this.iv()},getLogicalPoint:function(d){return we(d,this._canvas,this.tv.tx())},validateImpl:function(){var w=this,h=w._canvas,Y=w.getWidth(),M=w.getHeight(),v=w.tv,d=w._60I,b=w._61I,S=-v.tx(),q=0;(Y!==h.clientWidth||M!==h.clientHeight)&&Ud(h,Y,M),d.clear(),w._39o._roots.each(function(J){if(J.isVisible()){var s=q+J.getWidth();S+Y>=q&&s>=S&&d.add({column:J,startX:q}),q=s}});var u=ms(h);if(cd(u,-S,0,1),u.beginPath(),u.rect(S,0,Y,M),u.clip(),u.clearRect(S,0,Y,M),d.each(function(U){var K=U.column,O=U.startX,Q=K.getWidth();Q>0&&(u.save(),u.beginPath(),u.rect(O,0,Q,M),u.clip(),b&&b.column===K||w.drawColumn(u,K,O,0,Q,M),w._columnLineVisible&&Ki(u,O+Q-1,0,1,M,w._columnLineColor),u.restore())}),b){var P=b.column,q=b.startX,W=b.position,Q=P.getWidth();u.save(),u.beginPath(),u.rect(q,0,Q,M),u.clip(),u.fillStyle=w._moveBackground,u.fill(),w.drawColumn(u,P,q,0,Q,M),u.restore(),Hr(u,w._insertColor,W,0,M)}u.restore()},_6Q:function(V){var U=this.tv;return U._31o===V&&U.sm().getSelectionMode()===Kc},drawColumn:function(J,N,K,D,X,c){var w=this,Y=w.tv,b=qh(N.getIcon()),n=w.getLabelAlign(N);if(w._6Q(N)){var A=qh(w._checkIcon);yo(J,A,K+X/2,D+c/2,N,w)}else{var o=w.getLabel(N),p=w.getLabelFont(N),S=w.getLabelColor(N),I=dd(p,o).width,x=b?w._indent:0;n===Cl?(b&&_r(J,b,En,K,D,x,c),fm(J,o,p,S,K+x,D,X,c,Cl)):n===ij?(b&&_r(J,b,En,K+X-I-x,D,x,c),fm(J,o,p,S,K,D,X,c,ij)):(b&&_r(J,b,En,K+(X-I-x)/2,D,x,c),fm(J,o,p,S,K+(X-I+x)/2,D,0,c,Cl))}if(N.isSortable()&&Y.getSortColumn()===N&&(b=qh(N.getSortOrder()===fd?w._sortAscIcon:w._sortDescIcon))){var j=Vk(b,N)/2+2;yo(J,b,n===ij?K+j:K+X-j,D+c/2,N,Y)}}});var wt=function(U){var k=this;k.th=U,k.tv=U._tableView,k.addListeners()};hk(wt,i,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(Y){this.getView().style.cursor=Y},handle_mousemove:function(S){if(!ei){var t=this;delete t._29o,t.setCursor(Yb);for(var j=t.th,d=j._60I,G=j.lp(S).x,H=d.size()-1;H>=0;H--){var l=d.get(H),F=l.column,E=l.startX+F.getWidth();if(j.isResizable()&&C(E-G)<=(Km?10:3))return t._29o=l,t.setCursor(Vm),void 0;G>l.startX&&E>G&&(t._29o=l),(F.isClickable()||F.isSortable()||j.isMovable()||t.tv.getCheckColumn&&F===t.tv.getCheckColumn())&&G>l.startX&&E>G&&t.setCursor(fl)}}},handle_mousedown:function(d){this.handle_touchstart(d)},handle_touchstart:function(f){var y=this;_m(f),y.tv.endEditing(),y.handle_mousemove(f),y._29o&&(y.x=Nq(f).x,y.lx=y.th.lp(f).x,y.w=y._29o.column.getWidth(),co(y,f))},handleWindowMouseMove:function(u){this.handleWindowTouchMove(u)},handleWindowTouchMove:function(K){var c=this,Y=c.th,M=c.getView().style.cursor,U=c._29o,u=Nq(K).x-c.x;if(c.resizing||c.moving||(M===Vm?c.resizing=1:Y.isMovable()&&M===fl&&C(u)>2&&(c.moving=1)),c.resizing)U.column.setWidth(c.w+u);else if(c.moving){var F=c.lx+u;Y._60I.each(function(h){var Z=h.startX,L=Z+h.column.getWidth();if(F>=Z&&L>=F){var v={column:U.column,startX:U.startX+u,front:L-F>F-Z,insertColumn:h.column};v.position=v.front?Z:L,Y._5Q(v)}})}},_16Q:function(b,S){var M=this,e=M.tv,k=M.th,I=k._checkIcon;if(k._6Q(b)){var B=qh(I),_=M.lx,l=b.getWidth(),V=Vk(B,b);if(_>=S+l/2-V&&S+l/2+V>=_){k.setCheckIcon(I===Sm?md:Sm);var z=e.sm(),L=e._rows;return I===Sm?z.rs(L):z.ss(L),e.onCheckColumnClicked(b),!0}}return!1},handleWindowMouseUp:function(h){this.handleWindowTouchEnd(h)},handleWindowTouchEnd:function(C){var p=this,t=p.tv,w=p.th,D=p._29o;if(p.moving){var x=w._61I;if(x&&x.insertColumn!==x.column){var o=x.column,d=t.getColumnModel()._roots,L=d.remove(o),l=d.indexOf(x.insertColumn);l>=0&&(x.front||l++,l<=d.size()&&(d.add(o,l),t.getColumnModel()._38I(o,L,l)))}w._5Q(Z),delete p.moving}else if(!p.resizing&&D){o=D.column;var V=w.lp(C).x,c=D.startX,U=!0;if(w.onColumnClicked){var H=w.onColumnClicked(o,C,c);H===!1&&(U=!1)}if(U&&V>=c&&V<=c+o.getWidth()&&!p._16Q(o,c)){if(o.isSortable()){var j=t.getSortMode(),I=o.getSortOrder();j===Nk?t.getSortColumn()===o?(I===ve&&t.setSortColumn(Z),o.setSortOrder(I===fd?ve:fd)):t.setSortColumn(o):"bistate"===j&&(t.getSortColumn()===o?o.setSortOrder(I===fd?ve:fd):t.setSortColumn(o))}t.onColumnClicked(o,C,c)}}p._29o=p.resizing=p.x=p.lx=p.w=Z}}),ft.TablePane=function(n){this.init(new pt(n))},gt("TablePane",i,{ms_v:1,_44o:1}),ft.TreeTablePane=function(u){this.init(new rt(u))},gt("TreeTablePane",i,{ms_v:1,_44o:1}),ft.Toolbar=function(D){var G=this,c=G._view=zf(1,G),e=c.style;e.background=L.toolbarBackground||"",e.height=Jc+sj,G._canvas=qs(c),G._30o=new Dd,G._90I=new Dd,G.setItems(D||[]),c.handleGroupSelectedChanged=function(W){if(W.isSelected()){var C=W.getGroupId();null!=C&&G._items.forEach(function(G){var w=G.element;w&&w!==W&&w.setSelected&&w.getGroupId&&w.getGroupId()===C&&w.setSelected(!1)})}},new xt(G)},gt("Toolbar",i,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Ch,Sg,Mr,Rg,qq,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:L.toolbarLabelColor,_labelSelectColor:L.toolbarLabelSelectColor,_labelFont:L.toolbarLabelFont,_selectBackground:L.toolbarSelectBackground,_itemGap:L.toolbarItemGap,_separatorColor:L.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(V){var n=this.getItemInfoAt(V);return n?n.item.toolTip:Z},getLabelColor:function(P){return P&&P.selected&&P.type!==Sm&&P.type!==Fm?this._labelSelectColor:this._labelColor},onPropertyChanged:function(f){this.iv(),f.property===Ch&&this._items.forEach(function(z){fc(z)})},redraw:function(){this.iv()},addItem:function(d,O){var J=this._items;O==Z?J.push(d):J.splice(O,0,d),this.fp(Ch,Z,J)},removeItem:function(G){if(G)for(var H=this._items,X=0;X<H.length;X++)G===H[X]&&(H.splice(X,1),this.fp(Ch,Z,H))},removeItemById:function(p){if(p!=Z)for(var z=this._items,R=0;R<z.length;R++)if(p===z[R].id){var Q=z.splice(R,1)[0];return this.fp(Ch,Z,z),Q}},getItemById:function(f){if(f!=Z)for(var e=this._items,w=0;w<e.length;w++){var U=e[w];if(f===U.id)return U}},setItemVisible:function(l,z){var o=this.getItemById(l);o&&(o.visible=z)},getItemInfos:function(){return this._30o},getItemInfoAt:function(d){var _=this,P=0,C=_._30o,Y=_.lp(d),l=Y.x,G=Y.y;if(G>=0&&G<=_.getHeight())for(;P<C.size();P++){var t=C.get(P);if(t.startX<=l&&l<=t.endX)return t}return Z},drawItem:function(c,s,l,E,X){if(s.visible===!1)return 0;if(ik(s.visible)&&!s.visible())return 0;var k=this,A=s.disabled;A&&(c.globalAlpha=bb);var z=k.drawItemImpl(c,s,l,E,X),U=k._itemGap;return A&&(c.globalAlpha=1),this._currentItem!==s||"separator"===s||s.separator===!0||s.unfocusable||hj(c,k._separatorColor,l-U/2,0,z+U,E),z},drawItemImpl:function(N,s,J,y,V){var S=this,p=S._view,j=S._itemGap,n=y/2,O=s.type,T=s.element,h=s.label;em(T)&&(h=T,T=Z);var l,M=S.getLabelFont(s),w=S.getLabelColor(s),c=s.selected,m=qh(s.icon),B=Vk(m,s),q=0,t=B+(h?dd(M,h).width:0);if("separator"===s||s.separator===!0)return Hr(N,S._separatorColor,J,y/4,n),1;if(T){m&&yo(N,m,J+B/2,n,s,S),fm(N,h,M,w,J+B,0,0,y);var G=Dm(T);V||S._90I.add(G),G.parentNode!==p&&Fd(p,G),T.iv&&T.iv(),T.validate&&T.validate();var D=G.getBoundingClientRect(),A=D.width,C=G.style;return gf(G),C.left=S.tx()+J+t+sj,C.top=(y-D.height)/2+sj,t+A}return O===Fm?l=qh(c?Df:hq):O===Sm&&(l=qh(c?Sm:md)),l?(q=Vk(l,s),yo(N,l,J+q/2,n,s,S),J+=q,t+=q):c&&Ki(N,J-j/2,0,t+j,y,S.getSelectBackground(s)),m&&yo(N,m,J+B/2,n,s,S),fm(N,h,M,w,J+B,0,0,y),t},validateImpl:function(){var R=this,d=R._canvas,O=R.getWidth(),l=R.getHeight(),_=R._30o,z=R._items;Ud(d,O,l);var U=ms(d),b=R._itemGap,E=b/2;cd(U,R.tx(),0,1),U.clearRect(0,0,O,l);var L=R._90I;R._90I=new Dd,_.clear(),z.forEach(function(M){var j=R.drawItem(U,M,E,l);_.add({item:M,startX:E,endX:E+j,width:j}),j&&(E+=j+b)}),L.each(function(U){R._90I.contains(U)||ws(U)});var h=R._64I;R._64I=$(0,E),U.restore(),R._stickToRight?(R._65O=0,U=ms(d),E=O-R._64I+b,cd(U,0,0,1),U.clearRect(0,0,O,l),_.clear(),z.forEach(function(w){var V=R.drawItem(U,w,E,l,!0);_.add({item:w,startX:E,endX:E+V,width:V}),V&&(E+=V+b)}),U.restore()):R.tx(R.tx()),h!==R._64I&&R.onSumWidthChanged(h,R._64I)},onSumWidthChanged:function(){},handleClick:function(T,t){var x=this,j=T.type,Q=T.action,_=T.groupId,C=T.selected;T.disabled||(_!=Z?C||(T.selected=!0,this._items.forEach(function(G){G.groupId===_&&T!==G&&(G.selected=!1)}),Q&&T.action(T,x,t)):j===Sm||"toggle"===j?(T.selected=!C,Q&&T.action(T,x,t)):Q&&T.action(T,x,t)),Te(),x.iv()}});var xt=function(I){this.tb=I,this.addListeners()};hk(xt,i,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(l){this.handleScroll(l,10*(l.wheelDelta/40))},handle_DOMMouseScroll:function(G){this.handleScroll(G,10*-G.detail)},handleScroll:function(a,H){_m(a);var p=this.tb;p.isScrollable()&&!p._stickToRight&&(p.tx(p.tx()+H),zg())},handle_mousemove:function(T){var D=this;ei||D.setItem(T)},handle_mouseout:function(F){var v=this;F.target===v.getView()?v.tb.setCurrentItem(Z):v.handle_mousemove(F)},handle_mousedown:function(K){this.handle_mousemove(K),this.handle_touchstart(K)},handle_touchstart:function(x){var l=this,O=l.tb,C=x.target;tp(x)&&(C===l.getView()||C===O._canvas)&&(_m(x),O.setFocus(x)&&(this.setItem(x,!0),(O.isScrollable()||l.info&&!l.info.item.disabled)&&(l.x=Nq(x).x,l.tx=O.tx(),co(l,x))))},handleWindowMouseMove:function(B){this.handleWindowTouchMove(B)},handleWindowTouchMove:function(b){var j=this,v=j.tb;if(!v._stickToRight){var T=Nq(b).x-j.x;!j._25o&&C(T)>2&&v.isScrollable()&&(j._25o=1),j._25o&&v.tx(j.tx+T)}},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(J){var w=this,e=w.tb,H=w.info,z=w.tb.getItemInfoAt(J);if(!w._25o&&H){var R=H.item;z&&z.item===R&&e.handleClick(R,J)}w._25o=w.x=w.tx=Z,w.setItem()},setItem:function(Q,V){var x=this,j=x.tb,h=x.info=Q?j.getItemInfoAt(Q):Z,u=h?h.item:Z;j.setCurrentItem(u),V&&u&&ik(u.onDown)&&u.onDown(Q)}}),ft.BorderPane=function(){this._view=zf(1,this),this.iv()},gt("BorderPane",i,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(B,E){this._12o("leftView",B),E!=Z&&this.setLeftWidth(E)},getRightView:function(){return this._rightView},setRightView:function(g,P){this._12o("rightView",g),P!=Z&&this.setRightWidth(P)},getTopView:function(){return this._topView},setTopView:function(m,z){this._12o("topView",m),z!=Z&&this.setTopHeight(z)},getBottomView:function(){return this._bottomView},setBottomView:function(J,E){this._12o("bottomView",J),E!=Z&&this.setBottomHeight(E)},getCenterView:function(){return this._centerView},setCenterView:function(u){this._12o("centerView",u)},_12o:function(j,e){var X=this,f="_"+j,D=X._view,O=X[f];O!==e&&(O&&(O.getView?ws(O.getView()):ws(O)),X[f]=e,e&&(e.getView?Fd(D,e.getView(),1):Fd(D,e,1)),X.fp(j,O,e))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var l=this,L=l._topView,G=l._bottomView,x=l._leftView,H=l._rightView,C=l._centerView,U=l.getWidth(),A=l.getHeight(),f=0,Q=0,t=U,J=A,p=0,_=0,r=0,y=0;L&&(p=l._topHeight==Z?ph(L):l._topHeight,Q=p),G&&(_=l._bottomHeight==Z?ph(G):l._bottomHeight,J=A-_),x&&(r=l._leftWidth==Z?wr(x):l._leftWidth,f=r),H&&(y=l._rightWidth==Z?wr(H):l._rightWidth,t=U-y);var V=$(0,t-f),K=$(0,J-Q);L&&Rf(L,0,0,U,p),G&&Rf(G,0,J,U,_),x&&Rf(x,0,Q,r,K),H&&Rf(H,t,Q,y,K),C&&Rf(C,f,Q,V,K)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
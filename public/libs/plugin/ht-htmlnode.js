!function(T){"use strict";var j="ht",g=T[j],X=function(){return document},Z=function(){return X().body},x=function(J,d,K){J.style.setProperty(d,K,null)},t=function(D){return X().createElement(D)},U=function(){return t("div")},h=function(){var Y=t("canvas");return Y},u=function(h,H){x(h,"-webkit-transform",H),x(h,"-ms-transform",H),x(h,"transform",H)},a=function(y,l){x(y,"-webkit-transform-origin",l),x(y,"-ms-transform-origin",l),x(y,"transform-origin",l)},H=function(a,z){a.appendChild(z)},s=function(X,K){X.removeChild(K)},S=T.parseInt,G=g.Default,I=G.getInternal(),n=I.addEventListener,p=(I.removeEventListener,Math.PI),V="white-space",l="visibility",f="left",J="top",m="width",Q="height",k="position",O="display",P="z-index",c="px",R="0 0",M="absolute",C="visible",q="hidden",B="none",o="block",v="nowrap",D="rgba(0, 0, 0, 0.005)";G.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var d=g.graph.GraphView.prototype,E=d._42;d.adjustHtmlNodeIndex=!0,d._42=function(M,G){if(E.call(this,M,G),this.adjustHtmlNodeIndex)for(var B=this.getDataModel()._datas._as,X=B.length,f=1,e=0;X>e;e++){var j=B[e];if(j instanceof y){var v=this.getDataUI(j);x(v.$2f,P,f+""),x(v.$3f,P,f+1+""),f+=2}}};var F=g.HtmlNodeUI=function(r,y){var j=this;F.superClass.constructor.call(j,r,y);var W=j.$2f=U(),E=j.$3f=h();x(W,k,M),x(W,l,q),x(W,V,v),E.draggable=!1,x(E,k,M),x(E,O,B),a(E,R),n(W,"change",function(T){var A=T.target,l=A.bind||A.getAttribute("bind"),k=A.type&&"checkbox"===A.type?A.checked:A.value,U=y.getContext();l&&U&&(U[l]=k,j.$4f=JSON.stringify(U))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(B){n(W,B,this.$9f.bind(this))},j)};G.def(F,I.ui().NodeUI,{_visible:!0,$11f:function(){var X=this,x=X.$3f,U=X._data,j=U.getDraggerImageWidth(),s=U.getDraggerImageHeight(),D=U.getDraggerImage(),h=I.initContext(x);h.beginPath(),I.setCanvas(x,j,s),I.translateAndScale(h,0,0,1),h.clearRect(0,0,j,s),G.drawImage(h,G.getImage(D),0,0,j,s),h.restore()},_80o:function(_){F.superClass._80o.call(this,_);var T=this,v=T._data,i=v._padding,b=2*i,z=T.$2f,s=T.$3f,r=T.gv,t=r.getZoom(),L=r.getTranslateX(),e=r.getTranslateY(),W=r.getView(),G=T._83o,N=v._width,$=v._height,Z=G.position,d=G.rotation,K=(N-b)/v.$5f*t,I=($-b)/v.$6f*t,g=T._html,V=v._html,n=v.getHtmlType();if("html"===n){var h=v.getContext()||{},R=T.$4f,A=v.$10f,X=JSON.stringify(h);g&&R&&g===V&&R===X||(T.$4f=X,T._html=V,z.innerHTML=A?A(h):V)}else if(null!=n){var w=v.getHtml();"ht"===n&&(w=w.getView()),g&&g===w&&z.contains(g)||(T._html=w,z.innerHTML="",H(z,w))}if(!z.parentNode){var E=r.$1f;if(!E){var a=U();x(a,k,M),x(a,P,"0"),E=r.$1f=a;var j=r._canvas.nextSibling;j?W.insertBefore(a,j):H(W,a)}H(E,z),H(E,s),v.onContentInitialized&&v.onContentInitialized(z)}if(v._scalable){var Y=v.$5f,y=v.$6f;u(z,"rotate("+180*(d/p)+"deg) scale("+K+","+I+")"),x(z,m,""),x(z,Q,""),x(z,f,(Z.x-Y/t/2)*t+L+c),x(z,J,(Z.y-y/t/2)*t+e+c)}else{var Kh=S(z.style.width),Ji=S(z.style.height),as=S((N-b)*t),Yh=S(($-b)*t),Ik="100%",zn=z.children[0];x(zn,m,Ik),x(zn,Q,Ik),(Kh!==as||Ji!==Yh)&&(x(z,m,as+c),x(z,Q,Yh+c),"ht"===n&&V.invalidate()),u(z,"rotate("+180*(d/p)+"deg)"),x(z,f,(Z.x-as/t/2)*t+L+c),x(z,J,(Z.y-Yh/t/2)*t+e+c)}var zb=T.dragRect;r.isMovable(v)&&r.isSelected(v)&&zb?(_.save(),_.fillStyle=D,_.fillRect(zb.x,zb.y,zb.width,zb.height),_.restore(),x(s,f,zb.x*t+L+c),x(s,J,zb.y*t+e+c),u(s,"scale("+t+","+t+")"),x(s,O,o),T.$11f()):x(s,O,B),x(z,l,this._visible?C:q)},dispose:function(){var K=this.gv.$1f;this.$2f.parentNode===K&&K.removeChild(this.$2f),this.$3f.parentNode===K&&K.removeChild(this.$3f)},_84o:function(Z){this._visible=Z,x(this.$2f,l,Z?C:q),x(this.$3f,O,Z?o:B)},_3O:function(){var C=this,f=C.gv,k=C._data;F.superClass._3O.call(C);var v=k.getRect();f.isEditable(k)&&(C.dragRect={x:v.x+v.width+k._padding,y:v.y+10,width:k.getDraggerImageWidth(),height:k.getDraggerImageHeight()},C._68o(C.dragRect))},rectIntersects:function(A){var J=this._79o();return g.Default.intersection(J,A)?!0:void 0},$9f:function(R){var f=this.gv,K=this._data;f.sm().contains(K)&&R.stopPropagation()}});var y=g.HtmlNode=function(){y.superClass.constructor.call(this)};g.Default.def(y,g.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:g.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function($){var G=this,s=G._html;G._html=$,"html"===G.getHtmlType()&&"Handlebars"in T&&(G.$10f=Handlebars.compile($)),G.$13f(),G.fp("html",s,$)},setContext:function(k){var o=this,t=o._context;o._context=k,o.fp("context",t,k),o.$13f()},setScalable:function(b){var d=this,R=d._scalable;d._scalable=b,d.fp("scalable",R,b),d.$13f()},getHtmlType:function(){var F=this._html;return F?"string"==typeof F?"html":F.getView?"ht":"dom":null},$13f:function(){var h=this,r=h._html,I=h.$10f;if(r){var g=U(),d=!1,O=h.getHtmlType();if(x(g,k,M),x(g,V,v),x(g,l,q),"html"===O?(g.innerHTML=I?I(h.getContext()||{}):r,d=!0):"ht"===O?(H(g,r.getView()),d=!0):"dom"===O&&(H(g,r),d=!0),d){var D=2*h._padding;H(Z(),g),h.$5f=g.scrollWidth,h.$6f=g.scrollHeight,h._width=h.$5f+D,h._height=h.$6f+D,h._originWidth=h._width,h._originHeight=h._height,s(Z(),g)}}},getUIClass:function(){return g.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
!function(k,$,T){"use strict";function R(S,G){this.position=S,this.$22n=G}var L="ht",V=k[L],I=null,Q=Math,n=Q.PI,b=Q.cos,r=Q.sin,t=Q.abs,x=Q.max,w=Q.sqrt,f=1e-5,O=V.Default,p=O.def,E=O.startAnim,z=O.createMatrix,j=O.transformVec,y=O.getInternal(),l=y.addMethod,i=y.superCall,a=y.toPointsArray,A=y.createNormals,J=y.toFloatArray,o=y.glMV,B=(y.glPop,V.graph3d.Graph3dView,V.Math),X=B.Vector3,H=B.Matrix4,Y=B.Euler,S=(B.Quaternion,y.batchShape),m=y.createNodeMatrix,u=y.getFaceInfo,q=y.transformAppend,g=y.drawFaceInfo,D=y.createAnim,U=y.cube(),Z=U.is,h=U.vs,P=U.uv,e=y.ui(),v=V.Node,W=V.Shape,s="h",N="v",c="front",M="back",K="left",F="right",G="top",_="bottom",C="dw.expanded",d=".expanded",Rl="dw.angle",El=".angle",sr=function(h,y,V){p(L+"."+h,y,V)},Bn=function(_,W,i){i?_.push(W.x,W.y):_.push(W.x,W.y,W.z)},co=function(){var F=new V.Math.Vector3,_=new V.Math.Vector3,C=new V.Math.Vector3;return function(q,m,d,Y,g){if(F.copy(m.$24n),_.copy(d.$24n),C.copy(Y.$24n),!(C.equals(F)||_.equals(F)||_.equals(C))){if(!m.$22n||!d.$22n||!Y.$22n){var t=_.sub(F).cross(C.sub(F)).normalize().multiplyScalar(1).toArray();m.$22n||(m.$22n=new Yf(t)),d.$22n||(d.$22n=new Yf(t)),Y.$22n||(Y.$22n=new Yf(t))}q.push(new Sf([m,d,Y],g))}}}(),hj=function(A,n,z,u){var e,_,l,k,G=0,w=[];if(u)for(e=u.length;e>G;G+=3)_=u[G],l=u[G+1],k=u[G+2],co(w,new aq([n[3*_],n[3*_+1],n[3*_+2]],null,z?[z[2*_],z[2*_+1],0]:I),new aq([n[3*l],n[3*l+1],n[3*l+2]],null,z?[z[2*l],z[2*l+1],0]:I),new aq([n[3*k],n[3*k+1],n[3*k+2]],null,z?[z[2*k],z[2*k+1],0]:I),A);else for(e=n.length/3;e>G;G+=3)_=G,l=G+1,k=G+2,co(w,new aq([n[3*_],n[3*_+1],n[3*_+2]],null,z?[z[2*_],z[2*_+1],0]:I),new aq([n[3*l],n[3*l+1],n[3*l+2]],null,z?[z[2*l],z[2*l+1],0]:I),new aq([n[3*k],n[3*k+1],n[3*k+2]],null,z?[z[2*k],z[2*k+1],0]:I),A);return w},mr=[K,c,F,M,G,_],Mb=["",G,_],Qo=mr.concat("csg"),js=[0,6,12,18,24,30],Je=function(Q,V,E){var F=m(Q),u=[];Q.appendAnchorMatrix3d(F);var W,b=V?V.getData3dUI(Q):null;if(b&&b.s("shape3d")&&!b.s("csg.cull.box")&&(W=b.shapeModel,b.shapeModel||(W=y.getShapeModel(b,b.s("shape3d"))),W))for(var A=y.createNormalMatrix(F),S=0,x=Mb.length;x>S;S++){var s=Mb[S],c=s.length?s+"_":s,t=W[c+"vs"],g=W[c+"uv"],N=W[c+"is"],O=W[c+"ns"];if(t&&t.length)for(var Y,w,v,T=0,L=N?N.length:t.length/3;L>T;T+=3)N?(Y=N[T],w=N[T+1],v=N[T+2]):(Y=T,w=T+1,v=T+2),co(u,new aq(j([t[3*Y],t[3*Y+1],t[3*Y+2]],F),O?j([O[3*Y],O[3*Y+1],O[3*Y+2]],A):null,[g[2*Y],g[2*Y+1],0]),new aq(j([t[3*w],t[3*w+1],t[3*w+2]],F),O?j([O[3*w],O[3*w+1],O[3*w+2]],A):null,[g[2*w],g[2*w+1],0]),new aq(j([t[3*v],t[3*v+1],t[3*v+2]],F),O?j([O[3*v],O[3*v+1],O[3*v+2]],A):null,[g[2*v],g[2*v+1],0]),Q)}if(!W)for(var S=0;6>S;S++)for(var s=mr[S],l=js[S],g=E?V.getFaceUv(Q,s):I,p=E?V.getFaceUvScale(Q,s):I,G=E?V.getFaceUvOffset(Q,s):I,C=0;2>C;C++){var M,e,B,K=Z[l+3*C],z=Z[l+3*C+1],$=Z[l+3*C+2];if(E){if(g){var H=8*S;M=[g[2*K-H],g[2*K+1-H],0],e=[g[2*z-H],g[2*z+1-H],0],B=[g[2*$-H],g[2*$+1-H],0]}else M=[P[2*K],P[2*K+1],0],e=[P[2*z],P[2*z+1],0],B=[P[2*$],P[2*$+1],0];p&&(M[0]*=p[0],M[1]*=p[1],e[0]*=p[0],e[1]*=p[1],B[0]*=p[0],B[1]*=p[1]),G&&(M[0]+=G[0],M[1]+=G[1],e[0]+=G[0],e[1]+=G[1],B[0]+=G[0],B[1]+=G[1])}co(u,new aq(j([h[3*K],h[3*K+1],h[3*K+2]],F),null,M),new aq(j([h[3*z],h[3*z+1],h[3*z+2]],F),null,e),new aq(j([h[3*$],h[3*$+1],h[3*$+2]],F),null,B),Q)}return am.$15n(u)},Fe=function(D,a){var R,G=D.data.getAttaches();if(G&&G.each(function(o){o instanceof pp&&o.s("attach.operation")&&(R||(R=[]),R.push(o))}),R){var f;mr.forEach(function(u){var H=hj(u,D[u].vs,D[u].tuv);f=f?f.concat(H):H}),f=am.$15n(f),R.forEach(function(R){var A=R.s("attach.operation");f[A]&&(f=f[A](Je(R,D.gv,D.csg.tuv)))}),mr.forEach(function(K){K=D[K],K.vs=[],K.ns=[],K.tuv&&(K.tuv=[])}),D.csg&&!D.csg.ns&&(D.csg.ns=[]);var i=[];if(f.$19n().forEach(function(d){var x,k=d.$10n;if(k instanceof pp){if(k.s("attach.cull"))return;x=k.s("csg.cull.color"),x&&(x=y.toColorArray(x)),k="csg"}for(var c=D[k],w=c.vs,W=c.ns,Z=c.tuv,m=d.$9n,_=2;_<m.length;_++)if(Bn(w,m[0].$24n),Bn(w,m[_-1].$24n),Bn(w,m[_].$24n),W&&(Bn(W,m[0].$22n),Bn(W,m[_-1].$22n),Bn(W,m[_].$22n)),Z&&(Bn(Z,m[0].uv,!0),Bn(Z,m[_-1].uv,!0),Bn(Z,m[_].uv,!0)),x)for(var L=4*(w.length/3),l=0;3>l;l++)i[--L]=x[3],i[--L]=x[2],i[--L]=x[1],i[--L]=x[0]}),i.length){for(var Q=y.toColorArray(D.csg.color),z=0,g=4*(D.csg.vs.length/3);g>z;z+=4)i[z]==T&&(i[z]=Q[0],i[z+1]=Q[1],i[z+2]=Q[2],i[z+3]=Q[3]);D.csg.cs=i}}Qo.forEach(function(Y){var l=D[Y];l.visible&&l.vs.length?(l.ns&&l.ns.length?J(l,"ns"):l.ns=A(l.vs),J(l,"vs"),J(l,"tuv"),l.cs&&J(l,"cs")):delete D[Y]}),a&&(S(D,I,a),D.clear())};l(O,{createFrameModel:function(Y,d,M,C){Y=Y==I?.07:Y,d=d==I?Y:d,M=M==I?Y:M,C=C?C:{};var c=C.top,V=C.bottom,L=C.left,X=C.right,p=C.front,J=C.back,R=[],B=[];return p===!0?(R.push(-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5),B.push(0,0,0,1,1,1,1,1,1,0,0,0)):p===!1||(R.push(-.5,.5,.5,-.5,-.5,.5,-.5+Y,-.5,.5,-.5+Y,-.5,.5,-.5+Y,.5,.5,-.5,.5,.5,.5-Y,.5,.5,.5-Y,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5-Y,.5,.5,-.5+Y,.5,.5,-.5+Y,.5-d,.5,.5-Y,.5-d,.5,.5-Y,.5-d,.5,.5-Y,.5,.5,-.5+Y,.5,.5,-.5+Y,-.5+d,.5,-.5+Y,-.5,.5,.5-Y,-.5,.5,.5-Y,-.5,.5,.5-Y,-.5+d,.5,-.5+Y,-.5+d,.5),B.push(0,0,0,1,Y,1,Y,1,Y,0,0,0,1-Y,0,1-Y,1,1,1,1,1,1,0,1-Y,0,Y,0,Y,d,1-Y,d,1-Y,d,1-Y,0,Y,0,Y,1-d,Y,1,1-Y,1,1-Y,1,1-Y,1-d,Y,1-d)),J===!0?(R.push(-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5),B.push(1,0,0,1,1,1,0,1,1,0,0,0)):J===!1||(R.push(-.5,.5,-.5,-.5+Y,-.5,-.5,-.5,-.5,-.5,-.5+Y,-.5,-.5,-.5,.5,-.5,-.5+Y,.5,-.5,.5-Y,.5,-.5,.5,-.5,-.5,.5-Y,-.5,-.5,.5,-.5,-.5,.5-Y,.5,-.5,.5,.5,-.5,-.5+Y,.5,-.5,.5-Y,.5-d,-.5,-.5+Y,.5-d,-.5,.5-Y,.5-d,-.5,-.5+Y,.5,-.5,.5-Y,.5,-.5,-.5+Y,-.5+d,-.5,.5-Y,-.5,-.5,-.5+Y,-.5,-.5,.5-Y,-.5,-.5,-.5+Y,-.5+d,-.5,.5-Y,-.5+d,-.5),B.push(1,0,1-Y,1,1,1,1-Y,1,1,0,1-Y,0,Y,0,0,1,Y,1,0,1,Y,0,0,0,1-Y,0,Y,d,1-Y,d,Y,d,1-Y,0,Y,0,1-Y,1-d,Y,1,1-Y,1,Y,1,1-Y,1-d,Y,1-d)),L===!0?(R.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5),B.push(0,0,0,1,1,1,1,1,1,0,0,0)):L===!1||(R.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5+M,-.5,-.5,-.5+M,-.5,.5,-.5+M,-.5,.5,-.5,-.5,.5,.5-M,-.5,-.5,.5-M,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5-M,-.5,.5,-.5+M,-.5,.5-d,-.5+M,-.5,.5-d,.5-M,-.5,.5-d,.5-M,-.5,.5,.5-M,-.5,.5,-.5+M,-.5,-.5+d,-.5+M,-.5,-.5,-.5+M,-.5,-.5,.5-M,-.5,-.5,.5-M,-.5,-.5+d,.5-M,-.5,-.5+d,-.5+M),B.push(0,0,0,1,M,1,M,1,M,0,0,0,1-M,0,1-M,1,1,1,1,1,1,0,1-M,0,M,0,M,d,1-M,d,1-M,d,1-M,0,M,0,M,1-d,M,1,1-M,1,1-M,1,1-M,1-d,M,1-d)),X===!0?(R.push(.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5),B.push(1,0,0,1,1,1,0,1,1,0,0,0)):X===!1||(R.push(.5,.5,-.5,.5,-.5,-.5+M,.5,-.5,-.5,.5,-.5,-.5+M,.5,.5,-.5,.5,.5,-.5+M,.5,.5,.5-M,.5,-.5,.5,.5,-.5,.5-M,.5,-.5,.5,.5,.5,.5-M,.5,.5,.5,.5,.5,-.5+M,.5,.5-d,.5-M,.5,.5-d,-.5+M,.5,.5-d,.5-M,.5,.5,-.5+M,.5,.5,.5-M,.5,-.5+d,-.5+M,.5,-.5,.5-M,.5,-.5,-.5+M,.5,-.5,.5-M,.5,-.5+d,-.5+M,.5,-.5+d,.5-M),B.push(1,0,1-M,1,1,1,1-M,1,1,0,1-M,0,M,0,0,1,M,1,0,1,M,0,0,0,1-M,0,M,d,1-M,d,M,d,1-M,0,M,0,1-M,1-d,M,1,1-M,1,M,1,1-M,1-d,M,1-d)),c===!0?(R.push(.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5),B.push(1,1,1,0,0,0,0,0,0,1,1,1)):c===!1||(R.push(.5,.5,.5,.5,.5,-.5,.5-Y,.5,-.5,.5-Y,.5,-.5,.5-Y,.5,.5,.5,.5,.5,-.5+Y,.5,.5,-.5+Y,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5+Y,.5,.5,.5-Y,.5,.5,.5-Y,.5,.5-M,-.5+Y,.5,.5-M,-.5+Y,.5,.5-M,-.5+Y,.5,.5,.5-Y,.5,.5,.5-Y,.5,-.5+M,.5-Y,.5,-.5,-.5+Y,.5,-.5,-.5+Y,.5,-.5,-.5+Y,.5,-.5+M,.5-Y,.5,-.5+M),B.push(1,1,1,0,1-Y,0,1-Y,0,1-Y,1,1,1,Y,1,Y,0,0,0,0,0,0,1,Y,1,1-Y,1,1-Y,1-M,Y,1-M,Y,1-M,Y,1,1-Y,1,1-Y,M,1-Y,0,Y,0,Y,0,Y,M,1-Y,M)),V===!0?(R.push(.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5),B.push(1,0,0,1,1,1,0,1,1,0,0,0)):V===!1||(R.push(.5,-.5,.5,.5-Y,-.5,-.5,.5,-.5,-.5,.5-Y,-.5,-.5,.5,-.5,.5,.5-Y,-.5,.5,-.5+Y,-.5,.5,-.5,-.5,-.5,-.5+Y,-.5,-.5,-.5,-.5,-.5,-.5+Y,-.5,.5,-.5,-.5,.5,.5-Y,-.5,.5,-.5+Y,-.5,.5-M,.5-Y,-.5,.5-M,-.5+Y,-.5,.5-M,.5-Y,-.5,.5,-.5+Y,-.5,.5,.5-Y,-.5,-.5+M,-.5+Y,-.5,-.5,.5-Y,-.5,-.5,-.5+Y,-.5,-.5,.5-Y,-.5,-.5+M,-.5+Y,-.5,-.5+M),B.push(1,0,1-Y,1,1,1,1-Y,1,1,0,1-Y,0,Y,0,0,1,Y,1,0,1,Y,0,0,0,1-Y,0,Y,M,1-Y,M,Y,M,1-Y,0,Y,0,1-Y,1-M,Y,1,1-Y,1,Y,1,1-Y,1-M,Y,1-M)),{vs:R,uv:B}}}),l(V.Style,{"csg.cull.color":T,"csg.cull.box":!0,"dw.flip":!1,"dw.s3":[.999,.999,.5],"dw.t3":T,"dw.expanded":!1,"dw.toggleable":!0,"dw.axis":"left","dw.start":0,"dw.end":n/2,"dw.angle":0,"attach.cull":!1,"attach.operation":"subtract"},!0),mr.forEach(function(U){var f={};f[U+d]=!1,f[U+".toggleable"]=!1,f[U+".axis"]=K,f[U+".start"]=0,f[U+".end"]=n/2,f[U+El]=0,l(V.Style,f,!0)});var am=function(){this.$4n=[]};am.$15n=function(K){var k=new am;return k.$4n=K,k},am.prototype={clone:function(){var S=new am;return S.$4n=this.$4n.map(function(p){return p.clone()}),S},$19n:function(){return this.$4n},union:function(Z){var D=new so(this.clone().$4n),k=new so(Z.clone().$4n);return D.$3n(k),k.$3n(D),k.$6n(),k.$3n(D),k.$6n(),D.$7n(k.$2n()),am.$15n(D.$2n())},subtract:function(D){var y=new so(this.clone().$4n),R=new so(D.clone().$4n);return y.$6n(),y.$3n(R),R.$3n(y),R.$6n(),R.$3n(y),R.$6n(),y.$7n(R.$2n()),y.$6n(),am.$15n(y.$2n())},intersect:function(w){var g=new so(this.clone().$4n),A=new so(w.clone().$4n);return g.$6n(),A.$3n(g),A.$6n(),g.$3n(A),A.$3n(g),g.$7n(A.$2n()),g.$6n(),am.$15n(g.$2n())},inverse:function(){var R=this.clone();return R.$4n.map(function(y){y.flip()}),R}},am.cube=function(e){e=e||{};var B=new Yf(e.center||[0,0,0]),U=e.radius?e.radius.length?e.radius:[e.radius,e.radius,e.radius]:[1,1,1];return am.$15n([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(n){return new Sf(n[0].map(function(S){var N=new Yf(B.x+U[0]*(2*!!(1&S)-1),B.y+U[1]*(2*!!(2&S)-1),B.z+U[2]*(2*!!(4&S)-1));return new aq(N,new Yf(n[1]))}))}))},am.sphere=function(w){function d(v,S){v*=2*n,S*=n;var W=new Yf(b(v)*r(S),b(S),r(v)*r(S));l.push(new aq(Z.$20n(W.$21n(L)),W))}w=w||{};for(var l,Z=new Yf(w.center||[0,0,0]),L=w.radius||1,W=w.slices||16,x=w.stacks||8,i=[],j=0;W>j;j++)for(var M=0;x>M;M++)l=[],d(j/W,M/x),M>0&&d((j+1)/W,M/x),x-1>M&&d((j+1)/W,(M+1)/x),d(j/W,(M+1)/x),i.push(new Sf(l));return am.$15n(i)},am.cylinder=function(h){function s(V,I,T){var K=2*I*n,B=X.$21n(b(K)).$20n(u.$21n(r(K))),J=Q.$20n(q.$21n(V)).$20n(B.$21n(P)),e=B.$21n(1-t(T)).$20n(H.$21n(T));return new aq(J,e)}h=h||{};for(var Q=new Yf(h.start||[0,-1,0]),f=new Yf(h.end||[0,1,0]),q=f.$13n(Q),P=h.radius||1,_=h.slices||16,H=q.$14n(),i=t(H.y)>.5,X=new Yf(i,!i,0).cross(H).$14n(),u=X.cross(H).$14n(),c=new aq(Q,H.$11n()),C=new aq(f,H.$14n()),m=[],Z=0;_>Z;Z++){var z=Z/_,A=(Z+1)/_;m.push(new Sf([c,s(0,z,-1),s(0,A,-1)])),m.push(new Sf([s(0,A,0),s(0,z,0),s(1,z,0),s(1,A,0)])),m.push(new Sf([C,s(1,A,1),s(1,z,1)]))}return am.$15n(m)};var Yf=function(V,$,B){var z=this;3==arguments.length?(z.x=V,z.y=$,z.z=B):"x"in V?(z.x=V.x,z.y=V.y,z.z=V.z):(z.x=V[0],z.y=V[1],z.z=V[2])};Yf.prototype={clone:function(){return new Yf(this.x,this.y,this.z)},$11n:function(){return new Yf(-this.x,-this.y,-this.z)},$20n:function(r){return new Yf(this.x+r.x,this.y+r.y,this.z+r.z)},$13n:function(G){return new Yf(this.x-G.x,this.y-G.y,this.z-G.z)},$21n:function(U){return new Yf(this.x*U,this.y*U,this.z*U)},$16n:function(c){return new Yf(this.x/c,this.y/c,this.z/c)},dot:function(k){return this.x*k.x+this.y*k.y+this.z*k.z},lerp:function(z,X){return this.$20n(z.$13n(this).$21n(X))},length:function(){return w(this.dot(this))},$14n:function(){return this.$16n(this.length())},cross:function(H){var A=this;return new Yf(A.y*H.z-A.z*H.y,A.z*H.x-A.x*H.z,A.x*H.y-A.y*H.x)}};var aq=function(Z,U,Q){var m=this;m.$24n=new Yf(Z),m.$22n=U?new Yf(U):null,m.uv=Q?new Yf(Q):null};aq.prototype={clone:function(){var r=this;return new aq(r.$24n.clone(),r.$22n.clone(),r.uv?r.uv.clone():null)},flip:function(){this.$22n=this.$22n.$11n()},$18n:function(u,B){var o=this;return new aq(o.$24n.lerp(u.$24n,B),o.$22n.lerp(u.$22n,B),o.uv?o.uv.lerp(u.uv,B):null)}};var pd=function(R,N){this.$22n=R,this.w=N};pd.$17n=function(S,o,P){var L=o.$13n(S).cross(P.$13n(S)).$14n();return new pd(L,L.dot(S))},pd.prototype={clone:function(){return new pd(this.$22n.clone(),this.w)},flip:function(){var Y=this;Y.$22n=Y.$22n.$11n(),Y.w=-Y.w},$5n:function(h,Q,e,R,K){for(var U=this,l=0,G=1,Z=2,b=3,M=0,B=[],T=0;T<h.$9n.length;T++){var Y=U.$22n.dot(h.$9n[T].$24n)-U.w,S=-f>Y?Z:Y>f?G:l;M|=S,B.push(S)}switch(M){case l:(U.$22n.dot(h.$8n.$22n)>0?Q:e).push(h);break;case G:R.push(h);break;case Z:K.push(h);break;case b:for(var H=[],c=[],T=0;T<h.$9n.length;T++){var a=(T+1)%h.$9n.length,o=B[T],x=B[a],y=h.$9n[T],n=h.$9n[a];if(o!=Z&&H.push(y),o!=G&&c.push(o!=Z?y.clone():y),(o|x)==b){var Y=(U.w-this.$22n.dot(y.$24n))/U.$22n.dot(n.$24n.$13n(y.$24n)),m=y.$18n(n,Y);H.push(m),c.push(m.clone())}}H.length>=3&&R.push(new Sf(H,h.$10n)),c.length>=3&&K.push(new Sf(c,h.$10n))}}};var Sf=function(C,y){var n=this;n.$9n=C,n.$10n=y,n.$8n=pd.$17n(C[0].$24n,C[1].$24n,C[2].$24n)};Sf.prototype={clone:function(){var M=this.$9n.map(function(j){return j.clone()});return new Sf(M,this.$10n)},flip:function(){this.$9n.reverse().map(function(p){p.flip()}),this.$8n.flip()}};var so=function(T){var $=this;$.$8n=null,$.front=null,$.back=null,$.$4n=[],T&&$.$7n(T)};so.prototype={clone:function(){var c=this,o=new so;return o.$8n=c.$8n&&c.$8n.clone(),o.front=c.front&&c.front.clone(),o.back=c.back&&c.back.clone(),o.$4n=c.$4n.map(function(P){return P.clone()}),o},$6n:function(){for(var I=this,Y=0;Y<I.$4n.length;Y++)I.$4n[Y].flip();I.$8n&&I.$8n.flip(),I.front&&I.front.$6n(),I.back&&I.back.$6n();var J=I.front;I.front=I.back,I.back=J},$1n:function(Y){var E=this;if(!E.$8n)return Y.slice();for(var c=[],q=[],P=0;P<Y.length;P++)E.$8n.$5n(Y[P],c,q,c,q);return E.front&&(c=E.front.$1n(c)),q=E.back?E.back.$1n(q):[],c.concat(q)},$3n:function(R){var F=this;F.$4n=R.$1n(F.$4n),F.front&&F.front.$3n(R),F.back&&F.back.$3n(R)},$2n:function(){var j=this,M=j.$4n.slice();return j.front&&(M=M.concat(j.front.$2n())),j.back&&(M=M.concat(j.back.$2n())),M},$7n:function(j){var o=this;if(j.length){o.$8n||(o.$8n=j[0].$8n.clone());for(var b=[],N=[],F=0;F<j.length;F++)this.$8n.$5n(j[F],o.$4n,o.$4n,b,N);b.length&&(o.front||(o.front=new so),this.front.$7n(b)),N.length&&(o.back||(o.back=new so),o.back.$7n(N))}}};var Ff="symbol",Bf=V.Symbol=function(_,J,A){var R=this;i(Bf,R),R.s3(20,20,20),R.s({"all.visible":!1,shape:"rect"}),R.setIcon(_,J,A)};sr("Symbol",v,{setIcon:function(J,E,M){var r,w=this;return Bf.superClass.setIcon.call(w,J),J?(r={for3d:!0,face:"center",position:44,names:[J]},M&&(r.transaprent=!0),E&&(r.autorotate=E),w.addStyleIcon(Ff,r)):w.removeStyleIcon(Ff),w.setWidth(y.getImageWidth(O.getImage(J),w)||20),r}});var pp=V.CSGNode=function(){i(pp,this),this.s({shape:"rect","attach.thickness":1.001,"2d.attachable":!0})},Bc={position:1,width:1,height:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,tall:1,elevation:1,anchor:1,anchorElevation:1,"s:attach.cull":1,"s:attach.operation":1};sr("CSGNode",v,{_22Q:function(){return Ao},onPropertyChanged:function(b){var i=this,S=i.getHost();pp.superClass.onPropertyChanged.call(i,b),Bc[b.property]&&(S instanceof Cs||S instanceof pp)&&S.fp("csgNodeChange",!0,!1)}});var Ao=function(M,a){i(Ao,this,[M,a])};p(Ao,e.Node3dUI,{_80o:function(q,z,Z){var i=this;i._shape3d?Ao.superClass._80o.call(i,q,z,Z):(o(i.gv),Qo.forEach(function(M){g(i,q,z,M,Z)}))},validate:function(F,j){var L=this,O=L.gv,l=L.data;if(l.s("shape3d"))return Ao.superClass.validate.call(L,F,j),L._shape3d=!0,void 0;L._shape3d=!1;var d=m(l,O.getMat(l));l.appendAnchorMatrix3d(d);var B=F&&F.uv;L.vf2("csg",B);for(var c=0;6>c;c++)for(var T=mr[c],K=js[c],s=L.vf2(T,B,j),Q=s.mat||d,Y=s.vs,b=s.uv,J=s.tuv,R=0;2>R;R++){var D=Z[K+3*R],N=Z[K+3*R+1],y=Z[K+3*R+2];if(q(Y,Q,[h[3*D],h[3*D+1],h[3*D+2]]),q(Y,Q,[h[3*N],h[3*N+1],h[3*N+2]]),q(Y,Q,[h[3*y],h[3*y+1],h[3*y+2]]),J)if(b){var r=8*c;J.push(b[2*D-r],b[2*D+1-r],b[2*N-r],b[2*N+1-r],b[2*y-r],b[2*y+1-r])}else J.push(P[2*D],P[2*D+1],P[2*N],P[2*N+1],P[2*y],P[2*y+1])}Fe(L,F,j)},vf2:function(B,a,Y){var K,C=this,t=C.gv.getFaceVisible(C.data,B);return K=u(C,B,Y),K.vs=[],K.tuv=t&&(K.texture||a)?[]:I,K.visible=t,K}});var Cs=V.CSGShape=function(){var b=this;i(Cs,b),b.s({"shape.background":I,"2d.hostable":!0,"shape.border.width":8}),b.setTall(240),b.setElevation(120),b.setThickness(14)};sr("CSGShape",W,{IRotatable:!1,_22Q:function(){return bb},setRotationX:function(){},setRotation:function(){},setRotationZ:function(){},setSegments:function(){}});var bb=function(d,y){i(bb,this,[d,y])};p(bb,e.Shape3dUI,{_80o:function(I,_,t){var n=this;n.undrawable||(o(n.gv),Qo.forEach(function(G){g(n,I,_,G,t)}))},validate:function(m,C){var D=this,O=D.data,E=O.getPoints();if(D.undrawable=E.size()<2)return D.clear(),void 0;var s=O.isClosePath(),b=x(O._thickness/2,f),r=a(E,I,I,s);Qo.forEach(function(T){D.vf(T,m&&m.uv,!0,C)}),s&&(D.left.visible=!1,D.right.visible=!1),D._12O(r,b),D._20Q(r);var i=O.getPointsMatrix3d(),w=V.Math.requestVector3();mr.forEach(function(p){if(D[p])for(var Q=D[p].vs,u=0,o=Q.length;o>u;u+=3)w.set(Q[u],Q[u+1],Q[u+2]).applyMatrix4(i),Q[u]=w.x,Q[u+1]=w.y,Q[u+2]=w.z}),V.Math.releaseVector3(w),Fe(D,m,C)}});var mj=V.DoorWindow=function(){var K=this;i(mj,K),K.setElevation(100),K.s3(100,200,14)};sr("DoorWindow",pp,{IDoorWindow:!0,toggle:function(o){this.setExpanded(!this.s(C),o)},isExpanded:function(){return this.s(C)},setExpanded:function(k,j){var c=this,S=c.$25n,i=c.getDataModel(),T=c.s(C);if(S&&(S.stop(!0),delete c.$25n),T!==k){i&&i.beginTransaction();var R=k?c.s("dw.end"):c.s("dw.start");c.s(C,k),j=D(j),j?(T=c.s(Rl),j.action=function(h){c.s(Rl,T+(R-T)*h)},j.finishFunc=function(){i&&i.endTransaction()},c.$25n=E(j)):(c.s(Rl,R),i&&i.endTransaction())}},getMat:function(){var m=this,C=m.s("dw.s3"),B=m.s("dw.t3"),L=m.s("dw.flip"),X=m.s(Rl);if(C||X||B||L){var W=[];if(L&&W.push({r3:[0,n,0]}),C&&W.push({s3:C}),X){C=m.getFinalScale3d();var O=m.s("dw.axis"),r=C[0]/2,p=C[1]/2;C[2]/2,O===K?W.push({t3:[r,0,0]},{r3:[0,-X,0]},{t3:[-r,0,0]}):O===F?W.push({t3:[-r,0,0]},{r3:[0,X,0]},{t3:[r,0,0]}):O===G?W.push({t3:[0,-p,0]},{r3:[-X,0,0]},{t3:[0,p,0]}):O===_?W.push({t3:[0,p,0]},{r3:[X,0,0]},{t3:[0,-p,0]}):O===N?W.push({r3:[0,X,0]}):O===s&&W.push({r3:[X,0,0]})}return B&&W.push({t3:B}),z(W)}return I}});var Mk=V.CSGBox=function(){var $=this;i(Mk,$),$.setElevation(100),$.s3(100,200,100)};sr("CSGBox",pp,{ICSGBox:!0,toggleFace:function($,r){this.setFaceExpanded($,!this.s($+d),r)},isFaceExpanded:function(J){return this.s(J+d)},setFaceExpanded:function(N,o,I){var S=this,g=S.$25n,Y=S.s(N+d);if(g&&(g.stop(!0),delete S.$25n),Y!==o){var P=o?S.s(N+".end"):S.s(N+".start");S.s(N+d,o),I=D(I),I?(Y=S.s(N+El),I.action=function(G){S.s(N+El,Y+(P-Y)*G)},S.$25n=E(I)):S.s(N+El,P)}},getFaceMat:function(B){var w=this,R=w.s(B+El);if(!R)return I;var T,c,o,W,N,u,e=w.s(B+".axis"),n=w.getFinalScale3d(),a=w.getAnchor3d(),b=n[0]*a.x,F=n[1]*a.y,x=n[2]*a.z,y=n[0]-b,P=n[1]-F,D=n[2]-x,E=B+"_"+e;switch(E){case"front_left":T=-b,c=0,o=D,W=0,N=-R,u=0;break;case"front_right":T=y,c=0,o=D,W=0,N=R,u=0;break;case"front_top":T=0,c=P,o=D,W=-R,N=0,u=0;break;case"front_bottom":T=0,c=-F,o=D,W=R,N=0,u=0;break;case"front_h":T=0,c=0,o=D,W=R,N=0,u=0;break;case"front_v":T=0,c=0,o=D,W=0,N=R,u=0;break;case"back_left":T=y,c=0,o=-x,W=0,N=-R,u=0;break;case"back_right":T=-b,c=0,o=-x,W=0,N=R,u=0;break;case"back_top":T=0,c=P,o=-x,W=R,N=0,u=0;break;case"back_bottom":T=0,c=-F,o=-x,W=-R,N=0,u=0;break;case"back_h":T=0,c=0,o=-x,W=R,N=0,u=0;break;case"back_v":T=0,c=0,o=-x,W=0,N=R,u=0;break;case"left_left":T=-b,c=0,o=-x,W=0,N=-R,u=0;break;case"left_right":T=-b,c=0,o=D,W=0,N=R,u=0;break;case"left_top":T=-b,c=P,o=0,W=0,N=0,u=-R;break;case"left_bottom":T=-b,c=-F,o=0,W=0,N=0,u=R;break;case"left_h":T=-b,c=0,o=0,W=0,N=0,u=R;break;case"left_v":T=-b,c=0,o=0,W=0,N=R,u=0;break;case"right_left":T=y,c=0,o=D,W=0,N=-R,u=0;break;case"right_right":T=y,c=0,o=-x,W=0,N=R,u=0;break;case"right_top":T=y,c=P,o=0,W=0,N=0,u=R;break;case"right_bottom":T=y,c=-F,o=0,W=0,N=0,u=-R;break;case"right_h":T=y,c=0,o=0,W=0,N=0,u=R;break;case"right_v":T=y,c=0,o=0,W=0,N=R,u=0;break;case"top_left":T=-b,c=P,o=0,W=0,N=0,u=R;break;case"top_right":T=y,c=P,o=0,W=0,N=0,u=-R;break;case"top_top":T=0,c=P,o=-x,W=-R,N=0,u=0;break;case"top_bottom":T=0,c=P,o=D,W=R,N=0,u=0;break;case"top_h":T=0,c=P,o=0,W=R,N=0,u=0;break;case"top_v":T=0,c=P,o=0,W=0,N=0,u=R;break;case"bottom_left":T=-b,c=-F,o=0,W=0,N=0,u=-R;break;case"bottom_right":T=y,c=-F,o=0,W=0,N=0,u=R;break;case"bottom_top":T=0,c=-F,o=D,W=-R,N=0,u=0;break;case"bottom_bottom":T=0,c=-F,o=-x,W=R,N=0,u=0;break;case"bottom_h":T=0,c=-F,o=0,W=R,N=0,u=0;break;case"bottom_v":T=0,c=-F,o=0,W=0,N=0,u=R}return z([{t3:[-T,-c,-o]},{r3:[W,N,u]},{t3:[T,c,o]}])}});var Eb=function(T,b,N,$,t){function D(){var w,H=[],K=new X,p=new X;for(d.eachShapeModel(function(b,h,A){for(var R=0,X=h?h.length:b.length/3;X>R;R++)h?(K.fromArray(b,3*h[R]),p.fromArray(A,3*h[R])):(K.fromArray(b,3*R),p.fromArray(A,3*R)),C(H,K,p)}),H=J(H,M.set(1,0,0)),H=J(H,M.set(-1,0,0)),H=J(H,M.set(0,1,0)),H=J(H,M.set(0,-1,0)),H=J(H,M.set(0,0,1)),H=J(H,M.set(0,0,-1)),w=0;w<H.length;w++){var z=H[w];e.push(.5+z.position.x/t.x,.5-z.position.y/t.y),z.position.applyMatrix4(i),x.push(z.position.x,z.position.y,z.position.z),u.push(z.$22n.x,z.$22n.y,z.$22n.z)}}function C(S,e,p){e.applyMatrix4(B),e.applyMatrix4(Y),p.transformDirection(B),p.transformDirection(Y),S.push(new R(e.clone(),p.clone()))}function J(F,b){for(var j=[],N=.5*Math.abs(t.dot(b)),R=0;R<F.length;R+=3){var f,X,P,z,K,v,m,V=0,s=F[R+0].position.dot(b)-N,H=F[R+1].position.dot(b)-N,o=F[R+2].position.dot(b)-N;switch(f=s>0,X=H>0,P=o>0,V=(f?1:0)+(X?1:0)+(P?1:0)){case 0:j.push(F[R]),j.push(F[R+1]),j.push(F[R+2]);break;case 1:if(f&&(z=F[R+1],K=F[R+2],v=U(F[R],z,b,N),m=U(F[R],K,b,N)),X){z=F[R],K=F[R+2],v=U(F[R+1],z,b,N),m=U(F[R+1],K,b,N),j.push(v),j.push(K.clone()),j.push(z.clone()),j.push(K.clone()),j.push(v.clone()),j.push(m);break}P&&(z=F[R],K=F[R+1],v=U(F[R+2],z,b,N),m=U(F[R+2],K,b,N)),j.push(z.clone()),j.push(K.clone()),j.push(v),j.push(m),j.push(v.clone()),j.push(K.clone());break;case 2:f||(z=F[R].clone(),K=U(z,F[R+1],b,N),v=U(z,F[R+2],b,N),j.push(z),j.push(K),j.push(v)),X||(z=F[R+1].clone(),K=U(z,F[R+2],b,N),v=U(z,F[R],b,N),j.push(z),j.push(K),j.push(v)),P||(z=F[R+2].clone(),K=U(z,F[R],b,N),v=U(z,F[R+1],b,N),j.push(z),j.push(K),j.push(v));break;case 3:}}return j}function U(k,l,j,e){var u=k.position.dot(j)-e,m=l.position.dot(j)-e,x=u/(u-m),f=new R(new X(k.position.x+x*(l.position.x-k.position.x),k.position.y+x*(l.position.y-k.position.y),k.position.z+x*(l.position.z-k.position.z)),new X(k.$22n.x+x*(l.$22n.x-k.$22n.x),k.$22n.y+x*(l.$22n.y-k.$22n.y),k.$22n.z+x*(l.$22n.z-k.$22n.z)));return f}var x=[],u=[],e=[],M=new X,d=T.getData3dUI(b);if(d.mat){var B=(new H).fromArray(d.mat),o=new H;o.makeRotationFromEuler($),o.setPosition(N);var Y=(new H).getInverse(o),i=(new H).scale({x:1/t.x,y:1/t.y,z:1/t.z});return D(),{vs:x,ns:u,uv:e}}};R.prototype.clone=function(){return new R(this.position.clone(),this.$22n.clone())};var Lq=function(w,I,c,$){var z=this,s=z.getDataAt(w);if(s){var l=z.intersectObject(w,s);if(l){"object"==typeof I?I=I.x?new X(I.x,I.y,I.z):new X(I[0],I[1],I[2]):(I=I||20,I=new X(I,I,I)),c=c===T?.1:c;var d=new X(z.getUp()),x=new X(z.getCenter()).sub(new X(z.getEye())).normalize(),L="cross",Z=x.clone()[L](d).normalize();d.copy(Z)[L](x).normalize(),$&&d.applyAxisAngle(l.worldNormal,-$);var i=new V.Node,y=l.worldNormal.clone().setLength(c).add(l.world),P=(new H).lookAt(l.worldNormal.clone(),new X(0,0,0),d),g=(new Y).setFromRotationMatrix(P),n=Eb(z,s,l.world.clone(),g,I);return i.p3(y.x,y.y,y.z),i.setEuler(g),i.s3(I.x,I.y,I.z),i.s({shape3d:n,"shape3d.reverse.flip":!0}),i}}};l(V.graph3d.Graph3dView,{createDecal:Lq})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
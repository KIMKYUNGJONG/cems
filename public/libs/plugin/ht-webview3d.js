!function(d){"use strict";function U(J){var w,q,v,$,K,G,i,_=[],s=0;w=Z.createDiv(!0);var d=J.getView();d.insertBefore(w,J.getCanvas()),q=O.Default.createDiv(),q.style.WebkitTransformStyle="preserve-3d",q.style.MozTransformStyle="preserve-3d",q.style.transformStyle="preserve-3d",w.appendChild(q),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(l){var Z=l.style;M.addEventListener(d,l.event,function(){J.isDragProtectForWebView()&&(w.style.pointerEvents=Z)})}),this.updateWebView=function(){if(J.getWidth()&&J.getHeight()){var Y=J.getCanvas(),Q=1*Y.style.width.slice(0,-2),m=1*Y.style.height.slice(0,-2);(_[0]!==Q||_[1]!==m)&&(_[0]=Q,_[1]=m,w.style.width=Q+"px",w.style.height=m+"px",q.style.width=Q+"px",q.style.height=m+"px");var y=J._projectMatrix[5]*_[1]/2;y!==v&&(v=y,w.style.WebkitPerspective=v+"px",w.style.MozPerspective=v+"px",w.style.perspective=v+"px"),G="translateZ("+v+"px)"+g(J._viewMatrix);var Z=G+"translate("+_[0]/2+"px,"+_[1]/2+"px)";$===Z||K||(q.style.WebkitTransform=Z,q.style.MozTransform=Z,q.style.transform=Z,$=Z),s++,i=!1,J.dm().each(function(e){e.isWebView&&W(e)});for(var k,o=q.children,c=[],X=0,B=o.length;B>X;X++)k=o[X],k._isHtWebView&&k._renderCookie!==s&&c.push(k);c.length&&c.forEach(function(E){q.removeChild(E)})}};var U=new Array(16),W=function(e){var c=e.getAttach();if(c){var W=J.isVisible(e);if(W&&c.parentNode!==q?q.appendChild(c):!W&&c.parentNode&&Z.removeHTML(c),W){c._renderCookie=s,i=!0;var Q=e.getFinalScale3d(),n=e._prefrenceSize;n&&n[0]?n[1]||(n[1]=n[0]/Q[0]*Q[1]):n=[Q[0],Q[1]],c.style.width=n[0]+"px",c.style.height=n[1]+"px";var x=1/n[0],t=1/n[1],z=1,N=e.mat;U[0]=N[0]*x,U[1]=N[1]*x,U[2]=N[2]*x,U[3]=N[3]*x,U[4]=N[4]*t,U[5]=N[5]*t,U[6]=N[6]*t,U[7]=N[7]*t,U[8]=N[8]*z,U[9]=N[9]*z,U[10]=N[10]*z,U[11]=N[11]*z,U[12]=N[12],U[13]=N[13],U[14]=N[14],U[15]=N[15];var g=A(U,K?"translate("+_[0]/2+"px,"+_[1]/2+"px)"+G:""),B=c.$a2;B!==g&&(c.$a2=g,c.style.WebkitTransform=g,c.style.MozTransform=g,c.style.transform=g)}}}}function L(d){return Math.abs(d)<1e-10?0:d}function g(C){var m=C;return"matrix3d("+L(m[0])+","+L(-m[1])+","+L(m[2])+","+L(m[3])+","+L(m[4])+","+L(-m[5])+","+L(m[6])+","+L(m[7])+","+L(m[8])+","+L(-m[9])+","+L(m[10])+","+L(m[11])+","+L(m[12])+","+L(-m[13])+","+L(m[14])+","+L(m[15])+")"}function A(e,I){var V=e,w="matrix3d("+L(V[0])+","+L(V[1])+","+L(V[2])+","+L(V[3])+","+L(-V[4])+","+L(-V[5])+","+L(-V[6])+","+L(-V[7])+","+L(V[8])+","+L(V[9])+","+L(V[10])+","+L(V[11])+","+L(V[12])+","+L(V[13])+","+L(V[14])+","+L(V[15])+")";return"translate(-50%,-50%)"+(I||"")+w}var t="ht",O=d[t],Z=O.Default,M=Z.getInternal(),I=M.superCall,F=O.graph3d.Graph3dView,f=F.prototype.validateImpl;F.prototype.validateImpl=function(){f.call(this);var I=this._webViewRenderer;I||(I=this._webViewRenderer=new U(this)),I.updateWebView()},F.prototype.isDragProtectForWebView=function(){return this._dragProtectForWebView},F.prototype.setDragProtectForWebView=function(h){this._dragProtectForWebView=h};var y=O.WebView3d=function(){var b=this;I(y,b),b.s({shape3d:"billboard","shape3d.reverse.flip":!0})},T=[1,1,1,1],n=[0,0,0,0];Z.def(t+"."+"WebView3d",O.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(D,a,v){if(!D)return this.detachDOM();if("string"==typeof D){var _=document.createElement("iframe");_.src=D,D=_}var f=D.style;f.position="absolute",f.border=0,f.outline=0,f.padding=0,f.margin=0,D._isHtWebView=!0,this.setAttach(D),this._prefrenceSize=[a,v],this.s("shape3d.blend",n)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(s){this.a("defaultBgColor",s),this.getAttach()||this.s("shape3d.blend",s)},getBgColor:function(){return this.a("defaultBgColor")||T}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
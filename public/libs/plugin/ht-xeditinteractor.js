!function(w,c,M){"use strict";var k="ht",Q=w[k],p=Q.Default,J=Q.graph,S=p.getInternal(),g=S.ui(),E=g.NodeUI.prototype,f=g.ShapeUI.prototype,m=J.GraphView,X=m.prototype,y=g.EdgeUI.prototype,C=Q.Node,r=Q.Shape,H=Q.Edge,v=Q.Group,o=p.isTouchable,q=p.isTouchEvent,L=p.preventDefault,a=w.setTimeout,Z=p.grow,A=p.isDragging,$=p.getDistance,u=null,e=Q.List,t="undefined"!=typeof Float32Array?Float32Array:Array,G=Math,s=G.PI,d="Crossing",F="No Crossing",h=s/2,Y=2*s,R=G.atan2,l=G.sqrt,I=G.pow,V=G.sin,N=G.cos,T=G.min,B=G.max,O=G.abs,W=G.ceil,P=G.round,i=p.unionPoint,U=p.unionRect,K=p.containsPoint,_=p.clone,b="rgb(52, 152, 219)",x="red",n={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},D={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var w=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],$=0;$<w.length;$++){var M=w[$];M=0===$%2?M/400*D.width:M/100*D.height,w[$]=M}return D.width>120&&(w[4]=D.width-26,w[6]=D.width-40,w[10]=D.width-40,w[12]=D.width-26,w[18]=33),w}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},z={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:b,rotation:.61},{type:"circle",rect:[200,120,70,70],background:b,rotation:.61},{type:"circle",rect:[200,220,70,70],background:b,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:b},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:b}]},j={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:x,rotation:.61}]},Wh={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:b},{type:"circle",rect:[0,210,90,90],background:b},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:b}]},oi={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:x},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:x}]},Zg={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:b}]},Vg={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:x}]},Ic={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},ae={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Pd=function(B){var N=B.touches[0];return N?N:B.changedTouches[0]},ki=function(m,x,d,N){return R(N-x,d-m)},ul=function(N,q){return{x:N.x*q,y:N.y*q}},Ii=function(k,i){k.each(function(J){return k.isSelected(J)?i(J):void 0})},xr=function(N,e){N.reverseEach(function(c){return N.isSelected(c)?e(c):void 0})},im=function(v,g,f){var U,u,R,K,b,k=this,z=g,F=k.gv;if(v instanceof r){R=v.getSegments();var j=F.getDataUI(v);b=j._55O.$15l,R&&R.size()||(R=Ui(b)),v.isClosePath()&&R.indexOf(5)<0&&(R=new e(R._as),R.add(5)),U=gl(v,j,z),u=b[U]}else{var A=F.getDataUI(v);b=on(A,v.s("edge.points")),R=v.s("edge.segments"),R&&R.size()||(R=Ui(b)),b=b._as,U=gl(v,A,z),u=b[U]}if(R&&(K=R.get(z)),2===K||1===K||5===K){var h=b[U+1];5===K&&(h=b[0]);var Q=yj(u,f,h);return Q}return f},Lb=function(f,N,w,T){var u=N/2,K=w/2,n=Wn(f,-u,-K,T),g=Wn(f,u,-K,T),R=Wn(f,-u,K,T),h=Wn(f,u,K,T),V=Wn(f,0,-K,T),y=Wn(f,u,0,T),X=Wn(f,0,K,T),l=Wn(f,-u,0,T);return[n,g,R,h,V,y,X,l]},yj=function(d,M,c){var h={x:M.x-d.x,y:M.y-d.y},K={x:c.x-d.x,y:c.y-d.y},$=l(I(c.x-d.x,2)+I(c.y-d.y,2)),H={x:K.x/$,y:K.y/$},T=h.x*H.x+h.y*H.y,e={x:H.x*T,y:H.y*T};return{x:d.x+e.x,y:d.y+e.y}},Wn=function(J,E,W,i){var S=N(i)*E-V(i)*W,q=V(i)*E+N(i)*W;return J?{x:J.x+S,y:J.y+q}:{x:S,y:q}},Xj=function(i,J){return J>2*i?i:J/2},ao=function(g,q,i,m){var Y=$(g,q);return i=m?T(i,Y):Xj(i,Y),Y?i/=Y:i=0,{x:g.x+(q.x-g.x)*i,y:g.y+(q.y-g.y)*i}},id=function(D,p){var o,C,B=D.gv,Q=D._data,M=Q._40I,$=Q._41I,h=Q.s("edge.offset"),c=Q.s("edge.source.position"),u=Q.s("edge.target.position"),Y=Q.s("edge.source.offset.x"),_=Q.s("edge.source.offset.y"),E=Q.s("edge.target.offset.x"),y=Q.s("edge.target.offset.y"),k=Q.s("edge.source.anchor.x"),K=Q.s("edge.source.anchor.y"),L=Q.s("edge.target.anchor.x"),F=Q.s("edge.target.anchor.y");if(p?(o=S.getEdgeAgentPosition(B,M,c,Y,_,k,K),C=S.getEdgeAgentPosition(B,$,u,E,y,L,F)):(o=S.getEdgeAgentPosition(B,M,c,0,0,k,K),C=S.getEdgeAgentPosition(B,$,u,0,0,L,F)),"points"===Q.s("edge.type")&&h&&!Q.s("edge.center")&&o){var i=Q.s("edge.points")||new e,s=i.size(),I=ao(o,s?i.get(0):C,h,s),a=ao(C,s?i.get(s-1):o,h,s);o=I,C=a}return[o,C]},on=function($,o,C){var y=$._78o,t=$._data,E=t.s("edge.type"),S=[y.sourcePoint,y.targetPoint];return"points"===E?C&&(S=id($)):S=y.center?E?C?id($):id($,!0):C?id($):[y.c1,y.c2]:C?id($):id($,!0),o=new e(o?o._as:u),o.add(S[0],0),o.add(S[1]),o},uf=function(p){return p=new e(p._as),p.removeAt(0),p.removeAt(p.size()-1),p},Ui=function(M){M._as||(M=new e(M));var g=new e;g.add(1);for(var I=1;I<M.size();I++)g.add(2);return g},dd=function(p,P){return{x:(p.x+P.x)/2,y:(p.y+P.y)/2}},Jc=function(g,V){return{x:g.x+1*(V.x-g.x)/4,y:g.y+1*(V.y-g.y)/4}},we=function(c,k){return{x:c.x+3*(k.x-c.x)/4,y:c.y+3*(k.y-c.y)/4}},Ag=function(G,L,W,C){var s=L.x+L.width/2,T=L.y+L.height/2,K=l(s*s+T*T),B=R(T,s)+W;return{x:C.x+K*N(B),y:C.y+K*V(B)}},Fn=X.validateImpl,Cp=X.isRectEditable,pd=X.isPointEditable,Dp=X._42,ip=f._79o,vs=y._79o,hc=f._48O,Hk=f._47O,tn=E._48O,yp=E._80o,kq=f._80o,qd=E.getSelectWidth,_p=E._47O,km=y._47O,$l=X.isEditable,Vb=["northwest","north","northeast","east","southeast","south","southwest","west"],yr=function(G,H,k,$,m,o,d,s,J,M){var n=G.x,Q=G.y,K=G.width,U=G.height,q={x:n+K/2,y:Q+U/2};$=$||0,H=Wn(q,H.x-q.x,H.y-q.y,-$),d&&!s&&(H.x+=J,H.y+=M);var h=.01;if("northwest"===k?(H.x+m>n+K-h&&(H.x=n+K-m-h),H.y+m>Q+U-h&&(H.y=Q+U-m-h),G=i(H,{x:n+K,y:Q+U})):"north"===k?(H.y+m>Q+U-h&&(H.y=Q+U-m-h),G=i({x:n,y:H.y},{x:n+K,y:Q+U})):"northeast"===k?(H.x<n+m+h&&(H.x=n+m+h),H.y+m>Q+U-h&&(H.y=Q+U-m-h),G=i({x:n,y:H.y},{x:H.x,y:Q+U})):"west"===k?(H.x+m>n+K-h&&(H.x=n+K-m-h),G=i({x:H.x,y:Q},{x:n+K,y:Q+U})):"east"===k?(H.x<n+m+h&&(H.x=n+m+h),G=i({x:n,y:Q},{x:H.x,y:Q+U})):"southwest"===k?(H.x+m>n+K-h&&(H.x=n+K-m-h),H.y<Q+m+h&&(H.y=Q+m+h),G=i({x:H.x,y:Q},{x:n+K,y:H.y})):"south"===k?(H.y<Q+m+h&&(H.y=Q+m+h),G=i({x:n,y:Q},{x:n+K,y:H.y})):"southeast"===k&&(H.x<n+m+h&&(H.x=n+m+h),H.y<Q+m+h&&(H.y=Q+m+h),G=i({x:n,y:Q},H)),"keepRatio"===o&&(!d&&s||d&&!s)&&("northeast"===k||"southeast"===k||"northwest"===k||"southwest"===k)){var W=G.width,p=G.height,b=W/K,y=p/U,F=T(b,y);G.width=K*F,G.height=U*F,"northeast"===k?G.y=Q+(U-G.height):"northwest"===k?(G.y=Q+(U-G.height),G.x=n+(K-G.width)):"southwest"===k&&(G.x=n+(K-G.width))}G.x-=q.x,G.y-=q.y;var A=Ag(u,G,$,q);return G.x=A.x-G.width/2,G.y=A.y-G.height/2,G},yg=function(w,v,q,E){var Z=w.getRotation(),p=v,M=p.x,b=p.y,m=p.width,u=p.height,N={x:M+p.width/2,y:b+p.height/2};E=Wn(N,E.x-N.x,E.y-N.y,-Z),"northwest"===q?p=i(E,{x:M+m,y:b+u}):"north"===q?p=i({x:M,y:E.y},{x:M+m,y:b+u}):"northeast"===q?p=i({x:M,y:E.y},{x:E.x,y:b+u}):"west"===q?p=i({x:E.x,y:b},{x:M+m,y:b+u}):"east"===q?p=i({x:M,y:b},{x:E.x,y:b+u}):"southwest"===q?p=i({x:E.x,y:b},{x:M+m,y:E.y}):"south"===q?p=i({x:M,y:b},{x:M+m,y:E.y}):"southeast"===q&&(p=i({x:M,y:b},E)),w.setRect(p),p.x-=N.x,p.y-=N.y;var A=Ag(w,p,Z,N);w.p(A.x,A.y)},rh=function(C,r,I,h,G,$,_,W){var X=u;$?(X=Wn(u,G.x-r.x,G.y-r.y,-I),X.x-=_.x,X.y-=_.y):X=Wn(u,G.x-r.x,G.y-r.y,0);var d={x:r.x+X.x,y:r.y+X.y};W&&(d=W(d.x,d.y)),d.e=C.getPoints().get(h).e,C.setPoint(h,d);var T=C.getWidth(),f=C.getHeight(),D=C.p().x-T/2,g=C.p().y-f/2;D-=r.x,g-=r.y;var M=Ag(C,{x:D,y:g,width:T,height:f},I,r);C.p(M.x,M.y)},gl=function(U,A,G){var k,v;if(U instanceof r?(k=U.getPoints(),v=U.getSegments()):U instanceof H&&"points"===U.s("edge.type")&&(k=U.s("edge.points"),v=U.s("edge.segments"),k=on(A,k)),v&&v.size()||(v=Ui(k)),U instanceof r&&U.isClosePath()&&v.indexOf(5)<0&&(v=new e(v._as),v.add(5)),v)for(var W=-1,C=0;C<v.size();C++){if(C===G)return W;var I=v.get(C);1===I?W+=1:2===I?W+=1:3===I?W+=2:4===I&&(W+=3)}},rb=function(l,W,j){var d,i;if(l instanceof r?(d=l.getPoints(),i=l.getSegments()):l instanceof H&&"points"===l.s("edge.type")&&(d=l.s("edge.points"),i=l.s("edge.segments"),d=on(W,d)),i&&i.size()||(i=Ui(d)),i)for(var v=-1,f=0;f<i.size();f++){var J=i.get(f);if(1===J?v+=1:2===J?v+=1:3===J?v+=2:4===J&&(v+=3),v===j)return f}},Dh=function(Y,O){var o=[Y[0]-O[0],Y[1]-O[1],Y[2]-O[2]];return o},yl=function(){var i=new t(16);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Cm=function(E,a){var V=E[0],h=E[1],j=E[2];return E[0]=a[0]*V+a[4]*h+a[8]*j+a[12],E[1]=a[1]*V+a[5]*h+a[9]*j+a[13],E[2]=a[2]*V+a[6]*h+a[10]*j+a[14],E},ih=function(T,B){if(B){var w=V(B),n=N(B),s=T[0],U=T[1],$=T[2],p=T[3],e=T[8],E=T[9],R=T[10],H=T[11];T[0]=s*n-e*w,T[1]=U*n-E*w,T[2]=$*n-R*w,T[3]=p*n-H*w,T[8]=s*w+e*n,T[9]=U*w+E*n,T[10]=$*w+R*n,T[11]=p*w+H*n}},Pr=function(r,J){for(var d=r.s("grid.row.count"),A=r.s("grid.column.count"),l=0;d>l;l++)for(var X=0;A>X;X++){var e=r.getCellRect(l,X);if(K(e,J))return{rowIndex:l,columnIndex:X,rect:e,grid:r}}return null},me=function(c,$,J,d,E,l){var W={},w=J-c,o=d-$,R=G.sqrt(w*w+o*o),Q=w/R,K=o/R,Y=(-c+E)*Q+(-$+l)*K;return 0>=Y?(W.x=c,W.y=$):Y>=R?(W.x=J,W.y=d):(W.x=c+Y*Q,W.y=$+Y*K),w=E-W.x,o=l-W.y,W.z=G.sqrt(w*w+o*o),W},yo=function(e,p){var H,n,F,I,D,P,T,f,l=e.getPoints(),z=e.getSegments(),y=e.p(),k=e.getRotation();if(!z||!(z.indexOf(3)>0||z.indexOf(4)>0)){for(f=0;f<=l.size()-1;f++)if(f===l.size()-1?(D=l.get(0),I=l.get(f)):(I=l.get(f),D=l.get(f+1)),I=Wn(y,I.x-y.x,I.y-y.y,k),D=Wn(y,D.x-y.x,D.y-y.y,k),P=me(I.x,I.y,D.x,D.y,p.x,p.y),T=P.z,T<(e.s("shape.border.width")||10)){n=I,F=D,H=f;break}if(H!=u){var a=me(n.x,n.y,F.x,F.y,p.x,p.y),q=$(n,a);return{attachIndex:H,attachOffset:q}}}},Bl=function(O){for(var R=O._data,c=R.p(),s=R.getRotation(),L=R.getPoints(),Z=u,t=[],M=0;M<L.size();M++)Z=L.get(M),t.push(Wn(c,Z.x-c.x,Z.y-c.y,s));O._55O.$15l=t};p.setImage("xeditinteractor_parentIcon",z),p.setImage("xeditinteractor_hostIcon",j),p.setImage("xeditinteractor_edgeIcon",Wh),p.setImage("xeditinteractor_removeIcon",oi),p.setImage("xeditinteractor_sourceIcon",Zg),p.setImage("xeditinteractor_targetIcon",Vg),p.setImage("xeditinteractor_elevationIcon",Ic),p.setImage("xeditinteractor_tallIcon",ae),X._editPointSize=o?24:9,X._edgeHelpers=["parent","remove","source","target"],X._leftTopHelpers=["parent"],X._rightTopHelpers=["host"],X._leftBottomHelpers=["edge"],X._rightBottomHelpers=["remove"],Vb=Vb.concat(Vb).concat(Vb),y._79o=function(){var B=this,L=B.gv,$=L.getZoom(),q=L._editInteractor,c=vs.call(B);if(!c)return null;var A=id(B,!0),W=A[0],g=A[1],O={x:c.x,y:c.y,width:c.width,height:c.height},D=i(W,g);if(q instanceof J.XEditInteractor){O=U(O,D);var P=B._55O,o=L.getEditPointSize()/$+2,K=0;P&&P._43O&&(K+=o/2,Z(O,K))}return O},y._47O=function(V){var S=this,X=S.gv,K=X._editInteractor;K instanceof J.XEditInteractor||km.call(S,V)},y.rectIntersects=function(V){var Q=this,M=Q._data,x=Q.gv,S=x.getZoom(),n=Q._55O,B=x._editInteractor;if(B instanceof J.XEditInteractor&&x.isEditable(M)&&n&&n._43O&&"points"===M.s("edge.type")){var Z=M.s("edge.points"),g=M.s("edge.segments");Z=on(Q,Z),g&&g.size()||(g=Ui(Z)),Z=Z._as;var P=!1,I=o?5:1,j=V.x+I,Y=V.y+I,N={x:j,y:Y};if(B._edge===M&&B._hoverSegmentIndex>=0){var e=x._editInteractor._hoverSegmentIndex,p=g.get(e),U=gl(M,Q,e),X=u;if(U!=u&&U>=0){var D=Z[U],c=x.getSegmentHoverWidth()/S;if(2===p||1===p){var _=Z[U+1];X=xg(new _i(D.x,D.y),new _i(_.x,_.y),new _i(N.x-c,N.y-c),new _i(N.x+2*c,N.y+2*c)),X.$62l===d&&(P=!0)}else if(3===p){var F=Z[U+1],_=Z[U+2];X=Ue(new _i(D.x,D.y),new _i(F.x,F.y),new _i(_.x,_.y),new _i(N.x-c,N.y-c),new _i(N.x+2*c,N.y+2*c)),X.$62l===d&&(P=!0)}else if(4===p){var G=Z[U+1],w=Z[U+2];_=Z[U+3],X=lb(new _i(D.x,D.y),new _i(G.x,G.y),new _i(w.x,w.y),new _i(_.x,_.y),new _i(N.x-c,N.y-c),new _i(N.x+2*c,N.y+2*c)),X.$62l===d&&(P=!0)}}}if(P)return!0}return u},f._47O=function(H){var V=this,E=V.gv,e=E._editInteractor;e instanceof J.XEditInteractor||Hk.call(V,H)},f.rectIntersects=function(g){var s=this,K=s._data,G=s.gv,r=G.getZoom(),t=s._55O,w=G._editInteractor;if(w instanceof J.XEditInteractor&&G.isEditable(K)&&t&&t._43O){var T=t.$15l,A=!1,p=o?5:1,z=g.x+p,i=g.y+p,Q={x:z,y:i};if(T&&T.length===K.getPoints().size()||(Bl(s),T=t.$15l),w._shape===K&&w._hoverSegmentIndex>=0){var q=K.getSegments();q&&q.size()||(q=Ui(T));var k=G._editInteractor._hoverSegmentIndex,Y=q.get(k),y=gl(K,s,k),B=u;if(y!=u&&y>=0){var n=T[y],X=G.getSegmentHoverWidth()/r;if(2===Y||1===Y){var F=T[y+1];B=xg(new _i(n.x,n.y),new _i(F.x,F.y),new _i(Q.x-X,Q.y-X),new _i(Q.x+2*X,Q.y+2*X)),B.$62l===d&&(A=!0)}else if(3===Y){var j=T[y+1],F=T[y+2];B=Ue(new _i(n.x,n.y),new _i(j.x,j.y),new _i(F.x,F.y),new _i(Q.x-X,Q.y-X),new _i(Q.x+2*X,Q.y+2*X)),B.$62l===d&&(A=!0)}else if(4===Y){var P=T[y+1],E=T[y+2];F=T[y+3],B=lb(new _i(n.x,n.y),new _i(P.x,P.y),new _i(E.x,E.y),new _i(F.x,F.y),new _i(Q.x-X,Q.y-X),new _i(Q.x+2*X,Q.y+2*X)),B.$62l===d&&(A=!0)}}}if(A)return!0}return u},f._48O=function(){var n=this,x=n.gv,G=x._editInteractor;G instanceof J.XEditInteractor?(E._48O.call(n),n._55O._43O&&Bl(n)):hc.call(n)},f._79o=function(){var F=this,Q=F.gv,R=Q.getZoom(),A=Q._editInteractor,y=ip.call(F);if(y){var o={x:y.x,y:y.y,width:y.width,height:y.height};if(A instanceof J.XEditInteractor){var G=F._55O,I=Q.getEditPointSize()/R+2,h=0;G&&G._43O&&(h+=I/2,Z(o,h))}return o}},E._47O=function(y){var K=this,U=K.gv,$=U._editInteractor;if($ instanceof J.XEditInteractor);else{var Y=K._55O;Y&&Y._98o&&_p.call(K,y)}},E.getSelectWidth=function(){var m=this,Q=m.gv,d=Q._editInteractor,g=m._data;return Q.isEditable(g)&&d instanceof J.XEditInteractor?0:qd.call(m)},E._80o=function(T){var q=this,X=q.gv._editInteractor;if(yp.call(q,T),X&&X._debug){T.save(),T.beginPath(),T.lineWidth=1,T.strokeStyle="green";var u=q._79o();u&&(T.rect(u.x,u.y,u.width,u.height),T.stroke()),T.restore()}},f._80o=function(Y){var s=this,P=s.gv._editInteractor;if(kq.call(s,Y),P&&P._debug){Y.save(),Y.beginPath(),Y.lineWidth=1,Y.strokeStyle="green";var Q=s._79o();Y.rect(Q.x,Q.y,Q.width,Q.height),Y.stroke(),Y.restore()}},E._48O=function(){var N=this,U=N.gv,P=N._data,j=U._editInteractor,v=N._55O,A=P.p(),f=P.getRotation();if(j instanceof J.XEditInteractor){if(v._42O){var l=Lb(A,P.getWidth(),P.getHeight(),f),p=l[0],o=l[1],Z=l[2],H=l[3],e=l[4],t=l[5],C=l[6],i=l[7];v.$45l=[p,e,o,t,H,C,Z,i]}}else tn.call(N)},X.getResizeMode=function(){return this.$25l||"normal"},X.setResizeMode=function(d){var w=this.$25l;this.$25l=d,this.fp("resizeMode",w,d)},X.getSnapAngle=function(){return this.$26l||Math.PI/36},X.setSnapAngle=function(R){var Y=this.$26l;this.$26l=R,this.fp("snapAngle",Y,R)},X.getSnapSpacing=function(){return this.$27l},X.setSnapSpacing=function(H){var o=this.$27l;this.$27l=H,this.fp("snapSpacing",o,H)},X.getPointSnapSpacing=function(){return this._pointSnapSpacing},X.setPointSnapSpacing=function(b){var B=this._pointSnapSpacing;this._pointSnapSpacing=b,this.fp("pointSnapSpacing",B,b)},X.setHelperEditableFunc=function(i){var Z=this._helperEditableFunc;this._helperEditableFunc=i,this.fp("helperEditableFunc",Z,i)},X.getHelperEditableFunc=function(){return this._helperEditableFunc},X.setLeftTopHelpers=function(k){var P=this._leftTopHelpers;this._leftTopHelpers=k,this.fp("leftTopHelpers",P,k)},X.getLeftTopHelpers=function(){return this._leftTopHelpers},X.setLeftTopHelpersAlign=function(c){var w=this._leftTopHelpersAlign;this._leftTopHelpersAlign=c,this.fp("leftTopHelpersAlign",w,c)},X.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},X.setRightTopHelpers=function(r){var s=this._rightTopHelpers;this._rightTopHelpers=r,this.fp("rightTopHelpers",s,r)},X.getRightTopHelpers=function(){return this._rightTopHelpers},X.setRightTopHelpersAlign=function(Y){var H=this._rightTopHelpersAlign;this._rightTopHelpersAlign=Y,this.fp("rightTopHelpersAlign",H,Y)},X.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},X.setLeftBottomHelpers=function(N){var v=this._leftBottomHelpers;this._leftBottomHelpers=N,this.fp("leftBottomHelpers",v,N)},X.getLeftBottomHelpers=function(){return this._leftBottomHelpers},X.setLeftBottomHelpersAlign=function(h){var m=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=h,this.fp("leftBottomHelpersAlign",m,h)},X.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},X.setRightBottomHelpers=function(Q){var b=this._rightBottomHelpers;this._rightBottomHelpers=Q,this.fp("rightBottomHelpers",b,Q)},X.getRightBottomHelpers=function(){return this._rightBottomHelpers},X.setRightBottomHelpersAlign=function(R){var z=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=R,this.fp("rightBottomHelpersAlign",z,R)},X.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},X.setEdgeHelpers=function(e){var H=this._edgeHelpers;this._edgeHelpers=e,this.fp("edgeHelpers",H,e)},X.getEdgeHelpers=function(){return this._edgeHelpers},X.isHelperEditable=function(W,G){return W instanceof H&&("host"===G||"edge"===G||"elevation"===G||"tall"===G)?!1:W instanceof C&&("source"===G||"target"===G)?!1:"pointElevation"===G?this._helperEditableFunc?this._helperEditableFunc(W,G):!1:this._helperEditableFunc?this._helperEditableFunc(W,G):!0},X.getEditHelperSize=function(){return this._editHelperSize||(o?28:16)},X.setEditHelperSize=function(t){var B=this._editHelperSize;this._editHelperSize=t,this.fp("editHelperSize",B,t)},X.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},X.setEditRectBorderColor=function(x){var t=this.$28l;this.$28l=x,this.fp("editRectBorderColor",t,x)},X.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},X.setNodeBorderColor=function(l){var L=this.$29l;this.$29l=l,this.fp("nodeBorderColor",L,l)},X.getEditRectBorderStyle=function(){return this.$30l||"dashed"},X.setEditRectBorderStyle=function(u){var h=this.$30l;this.$30l=u,this.fp("editRectBorderStyle",h,u)},X.getControlPointBackground=function(){return this.$31l||"#ff0"},X.setControlPointBackground=function(N){var Y=this.$31l;this.$31l=N,this.fp("controlPointBackground",Y,N)},X.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},X.setControlPointBorderColor=function(R){var r=this.$32l;this.$32l=R,this.fp("controlPointBorderColor",r,R)},X.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},X.setJoinPointBackground=function(V){var H=this.$33l;this.$33l=V,this.fp("joinPointBackground",H,V)},X.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},X.setJoinPointBorderColor=function(Y){var B=this.$34l;this.$34l=Y,this.fp("joinPointBorderColor",B,Y)},X.getDirectionLineColor=function(){return this.$35l||"#888"},X.setDirectionLineColor=function(M){var u=this.$35l;this.$35l=M,this.fp("directionLineColor",u,M)},X.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},X.setSegmentHoverColor=function(H){var q=this.$36l;this.$36l=H,this.fp("segmentHoverColor",q,H)},X.getSegmentHoverWidth=function(){return this.$22l||(o?16:8)},X.setSegmentHoverWidth=function(v){var R=this.$22l;this.$22l=v,this.fp("segmentHoverWidth",R,v)},X.getSnapPointBorderColor=function(){return this.$38l||"#f00"},X.setSnapPointBorderColor=function(W){var G=this.$38l;this.$38l=W,this.fp("snapPointBorderColor",G,W)},X.getEditRectPadding=function(){return this.$39l!=u?this.$39l:6},X.setEditRectPadding=function(e){var x=this.$39l;this.$39l=e,this.fp("editRectPading",x,e)},X.isRectEditable=function(q){var N=this,X=N._editInteractor;return X instanceof J.XEditInteractor?N._rectEditableFunc?N._rectEditableFunc(q):!0:Cp.call(N,q)},X.isPointEditable=function(V){var q=this,G=q._editInteractor;return G instanceof J.XEditInteractor?q._pointEditableFunc?q._pointEditableFunc(V):!0:pd.call(q,V)},X.validateImpl=function(){var s=this,k=s.$14l,j=s._editInteractor;if(k){var Z=s.getWidth(),U=s.getHeight();(Z!==k.clientWidth||U!==k.clientHeight)&&(j&&(j._68I=1),S.setCanvas(k,Z,U),s._32I=1)}Fn.call(this)},X.isEditable=function(D){var b=$l.call(this,D),V=this._editInteractor;if(V instanceof J.XEditInteractor&&D instanceof H){if(!D.s("2d.editable"))return!1;var P=this.getEditableFunc();b=P?P(D):!0}return b},X._42=function(t,o){var Q=this,F=Q._editInteractor;Dp.call(Q,t,o),F instanceof J.XEditInteractor&&F._68I&&F._42()},X.isSnapPoint=function(){return!0};var kk=function(D){arguments.length>0&&this.$58l(D)},lp=kk.prototype;lp.$58l=function(k){this.$62l=k,this.points=new Array},lp.$56l=function(w){this.points.push(w)},lp.$57l=function(h){this.points=this.points.concat(h)};var _i=function(u,X){arguments.length>0&&this.$58l(u,X)},fs=_i.prototype;fs.$58l=function(O,K){this.x=O,this.y=K},fs.add=function(t){return new _i(this.x+t.x,this.y+t.y)},fs.addEquals=function(x){return this.x+=x.x,this.y+=x.y,this},fs.$55l=function(N){return new _i(this.x*N,this.y*N)},fs.eq=function(O){return this.x==O.x&&this.y==O.y},fs.lt=function(l){return this.x<l.x&&this.y<l.y},fs.lte=function(S){return this.x<=S.x&&this.y<=S.y},fs.gt=function(o){return this.x>o.x&&this.y>o.y},fs.gte=function(B){return this.x>=B.x&&this.y>=B.y},fs.lerp=function(e,h){return new _i(this.x+(e.x-this.x)*h,this.y+(e.y-this.y)*h)},fs.distanceFrom=function(W){var _=this.x-W.x,L=this.y-W.y;return l(_*_+L*L)},fs.min=function(H){return new _i(T(this.x,H.x),T(this.y,H.y))},fs.max=function(o){return new _i(B(this.x,o.x),B(this.y,o.y))},fs.toString=function(){return this.x+","+this.y};var wi=function(){this.$58l(arguments)},lj=wi.prototype;wi.TO=1e-6,wi.AC=6,lj.$58l=function(Y){this.co=new Array;for(var B=Y.length-1;B>=0;B--)this.co.push(Y[B])},lj.$55l=function(l){for(var X=new wi,s=0;s<=this.$50l()+l.$50l();s++)X.co.push(0);for(var s=0;s<=this.$50l();s++)for(var U=0;U<=l.$50l();U++)X.co[s+U]+=this.co[s]*l.co[U];return X},lj.$59l=function(){for(var c=this.$50l();c>=0&&O(this.co[c])<=wi.TO;c--)this.co.pop()},lj.$50l=function(){return this.co.length-1},lj.$51l=function(){var l;switch(this.$59l(),this.$50l()){case 0:l=new Array;break;case 1:l=this.$52l();break;case 2:l=this.$53l();break;case 3:l=this.$54l();break;case 4:l=this.$63l();break;default:l=new Array}return l},lj.$52l=function(){var D=new Array,$=this.co[1];return 0!=$&&D.push(-this.co[0]/$),D},lj.$53l=function(){var e=new Array;if(2==this.$50l()){var V=this.co[2],f=this.co[1]/V,D=this.co[0]/V,m=f*f-4*D;if(m>0){var G=l(m);e.push(.5*(-f+G)),e.push(.5*(-f-G))}else 0==m&&e.push(.5*-f)}return e},lj.$63l=function(){var i=new Array;if(4==this.$50l()){var d=this.co[4],t=this.co[3]/d,E=this.co[2]/d,Y=this.co[1]/d,I=this.co[0]/d,N=new wi(1,-E,t*Y-4*I,-t*t*I+4*E*I-Y*Y).$54l(),q=N[0],U=t*t/4-E+q;if(O(U)<=wi.TO&&(U=0),U>0){var C=l(U),p=3*t*t/4-C*C-2*E,F=(4*t*E-8*Y-t*t*t)/(4*C),M=p+F,_=p-F;if(O(M)<=wi.TO&&(M=0),O(_)<=wi.TO&&(_=0),M>=0){var Q=l(M);i.push(-t/4+(C+Q)/2),i.push(-t/4+(C-Q)/2)}if(_>=0){var Q=l(_);i.push(-t/4+(Q-C)/2),i.push(-t/4-(Q+C)/2)}}else if(0>U);else{var F=q*q-4*I;if(F>=-wi.TO){if(0>F&&(F=0),F=2*l(F),p=3*t*t/4-2*E,p+F>=wi.TO){var y=l(p+F);i.push(-t/4+y/2),i.push(-t/4-y/2)}if(p-F>=wi.TO){var y=l(p-F);i.push(-t/4+y/2),i.push(-t/4-y/2)}}}}return i},lj.$54l=function(){var H=new Array;if(3==this.$50l()){var e=this.co[3],r=this.co[2]/e,h=this.co[1]/e,X=this.co[0]/e,u=(3*h-r*r)/3,q=(2*r*r*r-9*h*r+27*X)/27,s=r/3,a=q*q/4+u*u*u/27,E=q/2;if(O(a)<=wi.TO&&(a=0),a>0){var W,U,n=l(a);W=-E+n,U=W>=0?I(W,1/3):-I(-W,1/3),W=-E-n,W>=0?U+=I(W,1/3):U-=I(-W,1/3),H.push(U-s)}else if(0>a){var A=l(-u/3),G=R(l(-a),-E)/3,T=N(G),t=V(G),P=l(3);H.push(2*A*T-s),H.push(-A*(T+P*t)-s),H.push(-A*(T-P*t)-s)}else{var W;W=E>=0?-I(E,1/3):I(-E,1/3),H.push(2*W-s),H.push(-W-s)}}return H};var Oh=function(h,T){arguments.length>0&&this.$58l(h,T)},Kr=Oh.prototype;Kr.$58l=function(o,W){this.x=o,this.y=W},Kr.length=function(){return l(this.x*this.x+this.y*this.y)},Kr.$60l=function(k){return this.x*k.x+this.y*k.y};var Hr=function(Z,D,o,i){var A,K=(i.x-o.x)*(Z.y-o.y)-(i.y-o.y)*(Z.x-o.x),k=(D.x-Z.x)*(Z.y-o.y)-(D.y-Z.y)*(Z.x-o.x),W=(i.y-o.y)*(D.x-Z.x)-(i.x-o.x)*(D.y-Z.y);if(0!=W){var C=K/W,h=k/W;C>=0&&1>=C&&h>=0&&1>=h?(A=new kk(d),A.points.push(new _i(Z.x+C*(D.x-Z.x),Z.y+C*(D.y-Z.y)))):A=new kk(F)}else A=0==K||0==k?new kk("C"):new kk("P");return A},hp=function($,T,O,g,k){var l,G,H,Y,U,e,h,A=g.min(k),y=g.max(k),Z=new kk(F);l=T.$55l(-2),H=$.add(l.add(O)),l=$.$55l(-2),G=T.$55l(2),Y=l.add(G),U=new _i($.x,$.y),h=new Oh(g.y-k.y,k.x-g.x),e=g.x*k.y-k.x*g.y;for(var i=new wi(h.$60l(H),h.$60l(Y),h.$60l(U)+e).$51l(),m=0;m<i.length;m++){var C=i[m];if(C>=0&&1>=C){var n=$.lerp(T,C),S=T.lerp(O,C),K=n.lerp(S,C);g.x==k.x?A.y<=K.y&&K.y<=y.y&&(Z.$62l=d,Z.$56l(K)):g.y==k.y?A.x<=K.x&&K.x<=y.x&&(Z.$62l=d,Z.$56l(K)):K.gte(A)&&K.lte(y)&&(Z.$62l=d,Z.$56l(K))}}return Z},Ue=function(Z,b,W,N,h){var l=N.min(h),Q=N.max(h),t=new _i(Q.x,l.y),i=new _i(l.x,Q.y),k=hp(Z,b,W,l,t),T=hp(Z,b,W,t,Q),r=hp(Z,b,W,Q,i),x=hp(Z,b,W,i,l),C=new kk(F);return C.$57l(k.points),C.$57l(T.points),C.$57l(r.points),C.$57l(x.points),C.points.length>0&&(C.$62l=d),C},Qn=function(w,R,b,q,o,u){var y,s,Z,D,f,K,S,T,m,U,p=o.min(u),c=o.max(u),G=new kk(F);y=w.$55l(-1),s=R.$55l(3),Z=b.$55l(-3),D=y.add(s.add(Z.add(q))),f=new Oh(D.x,D.y),y=w.$55l(3),s=R.$55l(-6),Z=b.$55l(3),D=y.add(s.add(Z)),K=new Oh(D.x,D.y),y=w.$55l(-3),s=R.$55l(3),Z=y.add(s),S=new Oh(Z.x,Z.y),T=new Oh(w.x,w.y),U=new Oh(o.y-u.y,u.x-o.x),m=o.x*u.y-u.x*o.y;for(var V=new wi(U.$60l(f),U.$60l(K),U.$60l(S),U.$60l(T)+m).$51l(),z=0;z<V.length;z++){var i=V[z];if(i>=0&&1>=i){var l=w.lerp(R,i),O=R.lerp(b,i),v=b.lerp(q,i),Y=l.lerp(O,i),C=O.lerp(v,i),A=Y.lerp(C,i);o.x==u.x?p.y<=A.y&&A.y<=c.y&&(G.$62l=d,G.$56l(A)):o.y==u.y?p.x<=A.x&&A.x<=c.x&&(G.$62l=d,G.$56l(A)):A.gte(p)&&A.lte(c)&&(G.$62l=d,G.$56l(A))}}return G},lb=function(r,w,W,H,b,x){var P=b.min(x),N=b.max(x),v=new _i(N.x,P.y),G=new _i(P.x,N.y),c=Qn(r,w,W,H,P,v),T=Qn(r,w,W,H,v,N),X=Qn(r,w,W,H,N,G),I=Qn(r,w,W,H,G,P),j=new kk(F);return j.$57l(c.points),j.$57l(T.points),j.$57l(X.points),j.$57l(I.points),j.points.length>0&&(j.$62l=d),j},xg=function(i,c,N,z){var s=N.min(z),P=N.max(z),f=new _i(P.x,s.y),h=new _i(s.x,P.y),n=Hr(s,f,i,c),U=Hr(f,P,i,c),T=Hr(P,h,i,c),q=Hr(h,s,i,c),_=new kk(F);return _.$57l(n.points),_.$57l(U.points),_.$57l(T.points),_.$57l(q.points),_.points.length>0&&(_.$62l=d),_},xb=J.XEditInteractor=function(G){var L=this,F=L._view=document.createElement("canvas");F.className="editCanvas",F.style.position="absolute",xb.superClass.constructor.call(L,G)};p.def(xb,J.Interactor,{ms_edit:1,setUp:function(){var T=this,C=T.gv,c=C.getView(),s=T._view;xb.superClass.setUp.call(T),C.setEditInteractor(T),C.$14l=s,C._79O?c.insertBefore(s,C._79O):c.appendChild(s);var V=T.$49l=T.$11l.bind(T);C.dm().md(V),C.sm().ms(V),C.mp(V)},tearDown:function(){var t=this,s=t.gv,G=s.getView(),U=t.$49l;xb.superClass.tearDown.call(t),s.setEditInteractor(u),s.$14l=u,G.removeChild(t._view),s.dm().umd(U),s.sm().ums(U),s.ump(U)},clear:function(){var e=this,Q=e.gv;delete e._hoverSegmentIndex,delete e._edge,delete e._shape,delete Q._editing,delete e.$10l,delete e.$13l,delete e.$9l,delete e._removePointIndex,delete e._lp,e.$12l="",delete e.$40l,delete e.$67l,delete e.$72l,delete e.$73l,delete e.$75l,delete e.$1l,delete e.$3l,delete e.$2l,delete e.$92l,delete e.$93l,delete e.$94l,e.clearDragging()},handle_keydown:function(j){this.$48l!==j.shiftKey&&(this.$48l=j.shiftKey,this.handle_mousemove(j,M,!0))},handle_keyup:function($){this.$48l!==$.shiftKey&&(this.$48l=$.shiftKey,this.handle_mousemove($,M,!0))},handle_touchstart:function(M){this.handle_mousemove(M),this.handle_mousedown(M)},handle_mousedown:function(V){L(V);var G=this,k=G.$13l,R=G.gv,r=R.dm(),q=R.sm(),v=R.getZoom(),W=R.lp(V),s=p.isDoubleClick(V),I=p.isLeftButton(V),M=G.$7l,i=G._shape,O=G._hoverSegmentIndex,T=G._edge,l=G.$87l,Y=G.$88l,d=function(){G._68I||l===G.$87l&&Y===G.$88l||G.$43l()};if(7!==G.$67l&&(delete G.$87l,delete G.$88l),I&&(i||T)&&O>=0&&s&&(i&&q.contains(i)||T&&q.contains(T))){var B=im.call(G,i||T,O,W);return G.addShapePoint(i||T,O,B),a(function(){G.handle_mousemove(V)},40),void 0}if(I&&(i||T)&&G._removePointIndex>=0&&s)return G.removeShapePoint(),G.$5l=1,a(function(){G.handle_mousemove(V)},40),void 0;if(!I||!R._editing)return d(),void 0;if(i&&k>=0){var Q=i.getPoints().get(k),$=i.p(),h=Wn($,Q.x-$.x,Q.y-$.y,-M+i.getRotation());A=Wn($,W.x-$.x,W.y-$.y,-M),G.$24l={x:A.x-h.x,y:A.y-h.y},G.startDragging(V),r.beginTransaction(),G.fi({kind:"beginEditPoint",event:V,data:i,index:k}),G.$88l=k,G.$87l=i}else if(G.$10l){var x=R.sm().getSelection(),g=G.$6l,z=G.$1l={},b=G.$3l={},H=G.$16l[n[G.$10l]],J={x:g.x,y:g.y},o={x:g.x+g.width/2,y:g.y+g.height/2};G.$24l={x:W.x-H.x/v,y:W.y-H.y/v},G.$2l=_(G.$8l),G.$4l=_(g),x.each(function(c){if(c instanceof C){var s=c.p(),w=c.getWidth(),T=c.getHeight(),W=Wn(o,s.x-o.x,s.y-o.y,-M);z[c.getId()]={x:s.x-w/2,y:s.y-T/2,width:w,height:T},b[c.getId()]={x:(W.x-J.x)/g.width,y:(W.y-J.y)/g.height}}}),G.startDragging(V),r.beginTransaction(),G.fi({kind:"beginEditRect",event:V,direction:G.$10l})}else if(T&&k>=0){var u=on(R.getDataUI(T),T.s("edge.points")),Q=u.get(k);G.$24l={x:W.x-Q.x,y:W.y-Q.y},G.startDragging(V),r.beginTransaction(),G.fi({kind:"beginEditPoint",event:V,data:T,index:k}),G.$88l=k,G.$87l=T}else if(G.$40l){var g=G.$6l,o={x:g.x+g.width/2,y:g.y+g.height/2},S=_(G.$23l);S.x/=v,S.y/=v;var f=Wn(o,S.x-o.x,S.y-o.y,-M),A=Wn(o,W.x-o.x,W.y-o.y,-M);G.$24l={x:A.x-f.x,y:A.y-f.y},G.startDragging(V),r.beginTransaction(),G.fi({kind:"beginEditRotation",event:V,data:G._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(G.$67l)>=0){var j=G.$67l;(7===j||8===j||9===j)&&r.beginTransaction(),G.startDragging(V)}else if(G.$71l&&s&&G.$79l(G.$71l,W)){var t=q.toSelection();r.beginTransaction(),t.each(function(P){r.remove(P)}),r.endTransaction()}d()},$11l:function(){var e=this,c=e.gv;c._editing&&(e.$13l==u||e._shape==u&&e._edge==u)&&(e.$73l==u||1!==e.$67l&&5!==e.$67l&&6!==e.$67l)||(e.$5l=1),e._68I=1},$46l:function(Y){var c=this,t=c.gv,D=t.lp(Y),x=[];return xr(t,function(i){var N=t.getDataUI(i);if(N){var M=N._79o();K(M,D)&&x.push(i)}}),x},$47l:function(K){var c=this,V=c.$13l,z=c.gv.dm();c.$10l?(c.fi({kind:"endEditRect",event:K,direction:c.$10l}),z.endTransaction()):c._shape&&V>=0?(c.fi({kind:"endEditPoint",event:K,data:c._shape,index:V}),z.endTransaction()):c._edge&&V>=0?(c.fi({kind:"endEditPoint",event:K,data:c._edge,index:V}),z.endTransaction()):c.$23l&&c.$40l&&(c.fi({kind:"endEditRotation",event:K}),z.endTransaction())},handleWindowTouchEnd:function(F){this.handleWindowMouseUp(F)},handleWindowMouseUp:function(R){var Y=this,U=Y.gv,p=U.dm(),b=Y._shape,k=Y._edge,y=Y.$13l,O=Y.$40l,X=Y.$9l,f=Y.$10l,G=Y.$67l;if((b||k)&&y>=0&&X>=0){var h,m;if(b){var E=b.p(),e=b.getRotation();h=b.getPoints(),m=h.get(X),rh(b,E,e,y,m,!1)}else if(h=on(U.getDataUI(k),k.s("edge.points"),!0),m=h.get(X),0===y){var l=h.get(0);k.s("edge.source.offset.x",m.x-l.x),k.s("edge.source.offset.y",m.y-l.y)}else if(y===h.size()-1){var v=h.get(h.size()-1);k.s("edge.target.offset.x",m.x-v.x),k.s("edge.target.offset.y",m.y-v.y)}else"points"===k.s("edge.type")&&(h.set(y,m),k.s("edge.points",uf(h)))}Y.$47l(R);var c=Y.$73l;1===G?(p.beginTransaction(),c?U.sm().each(function(O){if(O.setHost&&U.isHelperEditable(O,"host")){O.setHost(c);
var z=Y.$75l,w=Y.$74l;z&&(O.s("attach.row.index",z.rowIndex),O.s("attach.column.index",z.columnIndex)),w&&(O.s("attach.index",w.attachIndex),O.s("attach.offset",w.attachOffset),O.s("attach.offset.relative",!1),O.s("attach.offset.opposite",!1))}}):U.sm().each(function(Q){Q.setHost&&U.isHelperEditable(Q,"host")&&(Q.setHost(u),Q.s("attach.row.index",M),Q.s("attach.column.index",M),Q.s("attach.index",M),Q.s("attach.offset",M),Q.s("attach.offset.relative",!1),Q.s("attach.offset.opposite",!1))}),p.endTransaction()):2===G?(p.beginTransaction(),c?U.sm().each(function(r){r.setParent&&U.isHelperEditable(r,"parent")&&r.setParent(c)}):U.sm().each(function(Y){Y.setParent&&U.isHelperEditable(Y,"parent")&&Y.setParent(u)}),p.endTransaction()):3===G?c&&(p.beginTransaction(),U.sm().each(function(A){if(U.isHelperEditable(A,"edge")&&A instanceof C&&c instanceof C){var d=new Q.Edge;p.add(d),d.setSource(A),d.setTarget(c),Y.onEdgeCreated&&Y.onEdgeCreated(R,d)}}),p.endTransaction()):5===G||6===G?c&&(p.beginTransaction(),U.sm().each(function(i){i instanceof H&&c instanceof C&&(5===G&&U.isHelperEditable(i,"source")?i.setSource(c):6===G&&U.isHelperEditable(i,"source")&&i.setTarget(c))}),p.endTransaction()):(7===G||8===G||9===G)&&p.endTransaction(),(f||O)&&Y.$43l(!0),q(R)?(Y.clear(),delete Y.$64l,Y._68I||Y.$43l()):(Y.handle_mousemove(R,!0),G&&!Y._68I&&Y.$43l())},handleWindowTouchMove:function(o){this.handleWindowMouseMove(o)},handleWindowMouseMove:function(w){this._78I(w)},handle_mousemove:function(F,k,d){if(!this._pause){if(!d){var j=q(F)?Pd(F):F;this.$61l={clientX:j.clientX,clientY:j.clientY}}if(k===!0||!A()){var z=this,O=z.gv,Y=!1,P=u;z.clear(),O.sm().size()>0&&(P=O.lp(d?z.$61l:F),Y=z._79I(F,P)),Y&&(O._editing=1),z.$12l!==z.$65l&&(z.$65l=z.$12l,z.setCursor(z.$12l)),z.$40l!==z.$64l&&(z.$64l=z.$40l,z._68I||z.$43l()),z._hoverSegmentIndex!==z.$66l&&(z.$66l=z._hoverSegmentIndex,z._68I||z.$43l())}}},_78I:function(v){this.autoScroll(v);var _=this,k=_.gv,b=k.lp(v),g=k.getZoom(),m=_.$13l;if((_._shape||_._edge)&&m>=0){var t,M,G,y=_._shape,e=_._edge,X=_.$24l,o=k.getPointSnapSpacing(),z=function(R,n){return o==u||isNaN(o)?{x:R,y:n}:{x:P(R/o)*o,y:P(n/o)*o}};if(y){t=y.getPoints();var A=y.p(),L=y.getRotation(),U=0;M=Wn(A,b.x-A.x,b.y-A.y,-L),rh(y,A,L,m,b,!0,X,z),_.fi({kind:"betweenEditPoint",event:v,data:y,index:m})}else if(e){t=on(k.getDataUI(e),e.s("edge.points"),!0),b.x-=X.x,b.y-=X.y,M=b;var K,W,q=e.s("edge.offset"),V=t.size(),B=V>2;if(0===m){var f=t.get(0);q&&(f=ao(f,t.get(1),-q,B),b=ao(b,t.get(1),-q,B)),K=b.x-f.x,W=b.y-f.y,G=z(K,W),e.s("edge.source.offset.x",G.x),e.s("edge.source.offset.y",G.y)}else if(m===V-1){var D=t.get(V-1);q&&(D=ao(D,t.get(V-2),-q,B),b=ao(b,t.get(V-2),-q,B)),K=b.x-D.x,W=b.y-D.y,G=z(K,W),e.s("edge.target.offset.x",G.x),e.s("edge.target.offset.y",G.y)}else"points"===e.s("edge.type")&&(G=z(b.x,b.y),G.e=t.get(m).e,t.set(m,G),e.s("edge.points",uf(t)));_.fi({kind:"betweenEditPoint",event:v,data:e,index:m})}if(delete _.$9l,k.isSnapPoint(y)||k.isSnapPoint(e))for(U=0;U<t.size();U++)if(U!==m){var Z=t.get(U);if($(Z,M)<k.getEditPointSize()/g){_.$9l=U;break}}}else if(_.$10l){var X=_.$24l;b.x-=X.x,b.y-=X.y;var F=k.sm().getSelection(),J=_.$1l,x=_.$7l,i=_.$10l,d=_.$4l,S=_.$2l,N=k.getEditRectPadding()/g,E=2*N,Q=k.getSnapSpacing(),j=Q!=u&&!isNaN(Q),n=yr(S,b,i,x,2*N,k.getResizeMode(),j,!0),T=_.$6l;if(j){var c=n.width-E,w=n.height-E,I=P(c/Q)*Q,jm=P(w/Q)*Q,cm=I-c,kf=jm-w;("west"===i||"northwest"===i||"southwest"===i)&&(cm=-cm),("north"===i||"northwest"===i||"northeast"===i)&&(kf=-kf),n=yr(S,b,i,x,2*N,k.getResizeMode(),j,!1,cm,kf)}_.$8l=n,T.x=n.x+N,T.y=n.y+N,T.width=n.width-E,T.height=n.height-E;var og=n.x+n.width/2,il=n.y+n.height/2,ed=T.x,dj=T.y,ch=T.width/d.width,Jb=T.height/d.height;F.each(function(o){if(o instanceof C&&k.isEditable(o)&&k.isRectEditable(o)){var n=J[o.getId()],g=_.$3l[o.getId()],t={x:n.x+n.width/2,y:n.y+n.height/2},m=0,h=0,y=i,Q=180*O(x-o.getRotation())/s;"northeast"===i?Q>=315||45>Q?(m=n.width*ch+n.x,h=n.height*(1-Jb)+n.y,y="northeast"):Q>=45&&135>Q?(m=n.width*(1-Jb)+n.x,h=n.height*(1-ch)+n.y,y="northwest"):Q>=135&&225>Q?(m=n.width*(1-ch)+n.x,h=n.height*Jb+n.y,y="southwest"):(m=n.width*Jb+n.x,h=n.height*ch+n.y,y="southeast"):"north"===i?Q>=315||45>Q?(h=n.height*(1-Jb)+n.y,y="north"):Q>=45&&135>Q?(m=n.width*(1-Jb)+n.x,y="west"):Q>=135&&225>Q?(h=n.height*Jb+n.y,y="south"):(m=n.width*Jb+n.x,y="east"):"northwest"===i?Q>=315||45>Q?(m=n.width*(1-ch)+n.x,h=n.height*(1-Jb)+n.y,y="northwest"):Q>=45&&135>Q?(m=n.width*(1-Jb)+n.x,h=n.height*ch+n.y,y="southwest"):Q>=135&&225>Q?(m=n.width*ch+n.x,h=n.height*Jb+n.y,y="southeast"):(m=n.width*Jb+n.x,h=n.height*(1-ch)+n.y,y="northeast"):"west"===i?Q>=315||45>Q?(m=n.width*(1-ch)+n.x,y="west"):Q>=45&&135>Q?(h=n.height*ch+n.y,y="south"):Q>=135&&225>Q?(m=n.width*ch+n.x,y="east"):(h=n.height*(1-ch)+n.y,y="north"):"southwest"===i?Q>=315||45>Q?(m=n.width*(1-ch)+n.x,h=n.height*Jb+n.y,y="southwest"):Q>=45&&135>Q?(m=n.width*Jb+n.x,h=n.height*ch+n.y,y="southeast"):Q>=135&&225>Q?(m=n.width*ch+n.x,h=n.height*(1-Jb)+n.y,y="northeast"):(m=n.width*(1-Jb)+n.x,h=n.height*(1-ch)+n.y,y="northwest"):"east"===i?Q>=315||45>Q?(m=n.width*ch+n.x,y="east"):Q>=45&&135>Q?(h=n.height*(1-ch)+n.y,y="north"):Q>=135&&225>Q?(m=n.width*(1-ch)+n.x,y="west"):(h=n.height*ch+n.y,y="south"):"south"===i?Q>=315||45>Q?(h=n.height*Jb+n.y,y="south"):Q>=45&&135>Q?(m=n.width*Jb+n.x,y="east"):Q>=135&&225>Q?(h=n.height*(1-Jb)+n.y,y="north"):(m=n.width*(1-Jb)+n.x,y="west"):"southeast"===i&&(Q>=315||45>Q?(m=n.width*ch+n.x,h=n.height*Jb+n.y,y="southeast"):Q>=45&&135>Q?(m=n.width*Jb+n.x,h=n.height*(1-ch)+n.y,y="northeast"):Q>=135&&225>Q?(m=n.width*(1-ch)+n.x,h=n.height*(1-Jb)+n.y,y="northwest"):(m=n.width*(1-Jb)+n.x,h=n.height*ch+n.y,y="southwest"));var I=Wn(t,m-t.x,h-t.y,o.getRotation());yg(o,n,y,{x:I.x,y:I.y});var P=ed+T.width*g.x,Y=dj+T.height*g.y,c={x:P,y:Y};c=Wn({x:og,y:il},c.x-og,c.y-il,x),o.p(c.x,c.y)}}),_.fi({kind:"betweenEditRect",event:v,direction:i})}else if(_.$23l&&_.$40l){var ej=_.$8l,rr=ej.width,_h=ej.height,A={x:ej.x+rr/2,y:ej.y+_h/2},X=_.$24l,Fq=_.$23l,Eh=Fq.x/g-A.x,nr=Fq.y/g-A.y,cg=l(Eh*Eh+nr*nr),se=Math.asin(X.x/cg),Jp=k.sm().getSelection(),ck=h+R(b.y-A.y,b.x-A.x)-se,pl=k.getSnapAngle(),ck=P(ck/pl)*pl;0>ck&&(ck+=Y);var Eg=ck-_.$7l,zb=[A.x,0,A.y];Jp.each(function(O){if(k.isEditable(O)&&k.isRotationEditable(O)&&k.isVisible(O)){var V=Dh(O.p3(),zb),q=yl();ih(q,-Eg),O.setRotation(O.getRotation()+Eg),Cm(V,q),O.p3(zb[0]+V[0],zb[1]+V[1],zb[2]+V[2])}}),_.$7l=ck,_.fi({kind:"betweenEditRotation",event:v})}else if([1,2,3,5,6].indexOf(_.$67l)>=0)_.$72l=v,_.$78l||(_.$78l=1,a(function(){p.isDragging()&&_.$43l(),delete _.$78l},12));else if(7===_.$67l){if(_.$87l instanceof r){var y=_.$87l,vn=_.$88l,Se=p.clone(y.getPoints().get(vn)),Si=b.y-Se.y;Se.e||(Se.e=0),_.$92l||(_.$92l=Se.e),Se.e=_.$92l-Si,y.setPoint(vn,Se)}else if(_.$87l instanceof H){var e=_.$87l,vn=_.$88l,t=on(k.getDataUI(e),e.s("edge.points")),Se=t.get(vn),Si=b.y-Se.y;Se.e||(Se.e=0),_.$92l||(_.$92l=Se.e),Se.e=_.$92l-Si,t.set(vn,Se),e.s("edge.points",uf(t))}}else if(8===_.$67l){var Jp=k.sm().getSelection(),$j=_.$93l;$j||($j=_.$93l={}),Jp.each(function(i){if(i.p3){var r=i.p3(),d=$j[i.getId()];d==u&&(d=$j[i.getId()]=r[1]),i.p3([r[0],d-(b.y-_.$90l.y/g),r[2]])}})}else if(9===_.$67l){var Jp=k.sm().getSelection(),am=_.$94l;am||(am=_.$94l={}),Jp.each(function($){if($.s3){var M=$.s3(),C=am[$.getId()];C==u&&(C=am[$.getId()]=M[1]);var F=C-(b.y-_.$91l.y/g);0>F&&(F=.01),$.s3([M[0],F,M[2]])}})}},$79l:function(N,s){var p=this,y=p.gv,v=y.getZoom(),t=y.getEditHelperSize(),U=N.x/v,T=N.y/v,W=t/v,Q=W/2;return K({x:U-Q,y:T-Q,width:W,height:W},s)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(e,O){for(var Q=this,f=Q.gv,S=f.getZoom(),d=f.getEditPointSize(),B=d/S,_=B/2,i=Q.$46l(e),X=0;X<i.length;X++){var x,V,J=i[X],I=f.getDataUI(J);if(I&&I._55O){var Y=I._55O;if(Y._43O&&J instanceof H){if(x=J.s("edge.points"),x=on(I,x),V=J.s("edge.segments"),V&&V.size()||(V=Ui(x)),Q.$42l(J,O,x._as,V,"edge"))return!0;if("points"===J.s("edge.type")&&Q.$41l(J,O,x._as,V,"edge"))return}if(Y._43O&&J instanceof r&&Y.$15l&&Y.$15l.length===J.getPoints().size()){if(x=Y.$15l,V=J.getSegments(),V&&V.size()||(V=Ui(x)),Q.$42l(J,O,x,V,"shape"))return!0;if(Q.$41l(J,O,x,V,"shape"))return}}}if(Q.$16l){var x,A=Q.$16l,y=A[3].x-A[7].x,F=A[3].y-A[7].y,n=l(y*y+F*F),p=A[1].x-A[5].x,t=A[1].y-A[5].y,W=l(p*p+t*t),k={x:O.x*S,y:O.y*S};if(Q._80I(k,0,A[0],"northwest",n,W)||Q._80I(k,1,A[1],"north",n,W)||Q._80I(k,2,A[2],"northeast",n,W)||Q._80I(k,7,A[7],"west",n,W)||Q._80I(k,3,A[3],"east",n,W)||Q._80I(k,6,A[6],"southwest",n,W)||Q._80I(k,5,A[5],"south",n,W)||Q._80I(k,4,A[4],"southeast",n,W))return!0}if(Q.$23l){var m=Q.$23l,Z=m.x/S,z=m.y/S;if(K({x:Z-_,y:z-_,width:B,height:B},O))return Q.$40l=1,Q.$12l=Q.getHelperCursor("rotation")||"crosshair",!0}return Q.$68l&&Q.$79l(Q.$68l,O)?(Q.$67l=1,Q.$12l=Q.getHelperCursor("host")||"crosshair",!0):Q.$69l&&Q.$79l(Q.$69l,O)?(Q.$67l=2,Q.$12l=Q.getHelperCursor("parent")||"crosshair",!0):Q.$70l&&Q.$79l(Q.$70l,O)?(Q.$67l=3,Q.$12l=Q.getHelperCursor("edge")||"crosshair",!0):Q.$71l&&Q.$79l(Q.$71l,O)?(Q.$67l=4,Q.$12l=Q.getHelperCursor("remove")||"crosshair",!0):Q.$82l&&Q.$79l(Q.$82l,O)?(Q.$67l=5,Q.$12l=Q.getHelperCursor("source")||"crosshair",!0):Q.$83l&&Q.$79l(Q.$83l,O)?(Q.$67l=6,Q.$12l=Q.getHelperCursor("target")||"crosshair",!0):Q._pointElevationHelperPoint&&Q.$79l(Q._pointElevationHelperPoint,O)?(Q.$67l=7,Q.$12l=Q.getHelperCursor("pointElevation")||"crosshair",!0):Q.$90l&&Q.$79l(Q.$90l,O)?(Q.$67l=8,Q.$12l=Q.getHelperCursor("elevation")||"crosshair",!0):Q.$91l&&Q.$79l(Q.$91l,O)?(Q.$67l=9,Q.$12l=Q.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function($,D,T,W,R,S){var j=this,Y=j.gv,x=Y.getEditPointSize(),U=x/2,r=Y.sm(),V=Y.isDirectionEditable;if(V&&1===r.size()){var m=r.ld();if(V=V.bind(Y),m instanceof C){if(!V(m,W))return!1;if("east"===W){if(V(m,"northeast")&&V(m,"southeast")&&2*x>=S)return!1}else if("west"===W){if(V(m,"northwest")&&V(m,"southwest")&&2*x>=S)return!1}else if("north"===W){if(V(m,"northwest")&&V(m,"northeast")&&2*x>=R)return!1}else if("south"===W&&V(m,"southwest")&&V(m,"southeast")&&2*x>=R)return!1}}else{if(2*x>=R&&("north"===W||"south"===W))return!1;if(2*x>=S&&("east"===W||"west"===W))return!1}if(K({x:T.x-U,y:T.y-U,width:x,height:x},$)){if(j.$10l!==W){var Z=180*j.$7l/s,q="";Z>=337.5||22.5>Z?q="north":Z>=22.5&&67.5>Z?q="northeast":Z>=67.5&&112.5>Z?q="east":Z>=112.5&&157.5>Z?q="southeast":Z>=157.5&&202.5>Z?q="south":Z>=202.5&&247.5>Z?q="southwest":Z>=247.5&&292.5>Z?q="west":Z>=292.5&&337.5>Z&&(q="northwest");var I=Vb.indexOf(q),q=Vb[D-(1-I)+8];switch(q){case"northwest":j.$12l="nwse-resize";break;case"northeast":j.$12l="nesw-resize";break;case"southwest":j.$12l="nesw-resize";break;case"southeast":j.$12l="nwse-resize";break;case"north":j.$12l="ns-resize";break;case"east":j.$12l="ew-resize";break;case"south":j.$12l="ns-resize";break;case"west":j.$12l="ew-resize"}j.$10l=W}return!0}return!1},$42l:function(c,M,T,y,w){var x,E=this,m=E.gv,s=m.getEditPointSize(),S=s/m.getZoom(),$=-1,d={x:M.x,y:M.y,width:0,height:0},L=function(l){"shape"===w?E._shape=c:E._edge=c,E._removePointIndex=l},n=function(R){"shape"===w?E._shape=c:E._edge=c,E.$13l=R,E.$12l="crosshair"};for(Z(d,S/2),$=T.length-1,x=y.size()-1;x>=0;x--){var P=y.get(x);if(1===P||2===P)$-=1;else if(3===P){var r=T[$-1];if(K(d,r))return n($-1),!0;$-=2}else if(4===P){var A=T[$-1],W=T[$-2];if(K(d,A))return n($-1),!0;if(K(d,W))return n($-2),!0;$-=3}}for($=T.length-1,x=y.size()-1;x>=0;x--){var P=y.get(x),g=T[$];if(K(d,g))return L($),n($),!0;1===P||2===P?$-=1:3===P?$-=2:4===P&&($-=3)}return!1},$41l:function(M,A,h,K,v){var J=this,Q=J.gv,q=-1,X=0,N={x:A.x,y:A.y,width:0,height:0},G=function(t,U){J._hoverSegmentIndex=U,J._lp=A,"shape"===v?J._shape=M:J._edge=M};for(Z(N,Q.getSegmentHoverWidth()/2/Q.getZoom()),M instanceof r&&M.isClosePath()&&K.indexOf(5)<0&&(K=new e(K._as),K.add(5));X<K.size();X++){var B=K.get(X);if(1===B){var T=h[q],Y=h[q+1];if(T){var w=xg(new _i(T.x,T.y),new _i(Y.x,Y.y),new _i(N.x,N.y),new _i(N.x+N.width,N.y+N.height));if(w.$62l===d&&w.points.length>0)return G(w,X),!0}q+=1}else if(2===B){var T=h[q],Y=h[q+1],w=xg(new _i(T.x,T.y),new _i(Y.x,Y.y),new _i(N.x,N.y),new _i(N.x+N.width,N.y+N.height));if(w.$62l===d&&w.points.length>0)return G(w,X),!0;q+=1}else if(3===B){var T=h[q],O=h[q+1],g=h[q+2],w=Ue(new _i(T.x,T.y),new _i(O.x,O.y),new _i(g.x,g.y),new _i(N.x,N.y),new _i(N.x+N.width,N.y+N.height));if(w.$62l===d)return G(w,X),!0;q+=2}else if(4===B){var T=h[q],u=h[q+1],I=h[q+2],g=h[q+3],w=lb(new _i(T.x,T.y),new _i(u.x,u.y),new _i(I.x,I.y),new _i(g.x,g.y),new _i(N.x,N.y),new _i(N.x+N.width,N.y+N.height));if(w.$62l===d)return G(w,X),!0;q+=3}else if(5===B){var T=h[q],Y=h[0];if(T){var w=xg(new _i(T.x,T.y),new _i(Y.x,Y.y),new _i(N.x,N.y),new _i(N.x+N.width,N.y+N.height));if(w.$62l===d&&w.points.length>0)return G(w,X),!0}}}return!1},addShapePoint:function(Q,v,Z){var P=this,K=P.gv,D=K.dm();if(D.beginTransaction(),0===arguments.length&&(Q=P._shape||P._edge,v=P._hoverSegmentIndex,Z=P._lp),Q instanceof r||Q instanceof H){var u=gl(Q,K.getDataUI(Q),v);if(!isNaN(v)&&Z&&!isNaN(u)){var t=Z;if(Q instanceof r){var M=Q.p(),d=Q.getRotation(),g=Q.toSegments();g&&g.size()||(g=Ui(Q.getPoints())),Q.isClosePath()&&g.indexOf(5)<0&&(g=new e(g._as),g.add(5));var S=g.get(v),h="addPoint",c="removePointAt";if(2===S||1===S){var G={x:t.x,y:t.y};g.add(S,v),G=Wn(M,G.x-M.x,G.y-M.y,-d),Q[h](G,u+1)}else if(3===S){var B=Q.getPoints(),i=B.get(u),b=B.get(u+2),G={x:t.x,y:t.y};G=Wn(M,G.x-M.x,G.y-M.y,-d);var n=dd(i,G),E=dd(G,b);g.removeAt(v),g.add(3,v),g.add(3,v),Q.setPoint(u+1,G),Q[h](E,u+2),Q[h](n,u+1)}else if(4===S){var B=Q.getPoints(),i=B.get(u),b=B.get(u+3),G={x:t.x,y:t.y};G=Wn(M,G.x-M.x,G.y-M.y,-d);var n=Jc(i,G),E=we(i,G),j=Jc(G,b),s=we(G,b);g.removeAt(v),g.add(4,v),g.add(4,v),Q[c](u+1),Q[c](u+1),Q[h](G,u+1),Q[h](s,u+2),Q[h](j,u+2),Q[h](E,u+1),Q[h](n,u+1)}else if(5===S){var G={x:t.x,y:t.y};g.add(2,v),G=Wn(M,G.x-M.x,G.y-M.y,-d),Q[h](G,u+1)}Q.isClosePath()&&g.remove(5),Q.setSegments(g);var F=Q.getWidth(),O=Q.getHeight(),X=Q.p().x-F/2,A=Q.p().y-O/2;X-=M.x,A-=M.y;var T=Ag(Q,{x:X,y:A,width:F,height:O},d,M);Q.p(T.x,T.y)}else if(Q instanceof H){if("points"!==Q.s("edge.type"))return D.endTransaction(),void 0;var B=Q.s("edge.points");g=Q.s("edge.segments"),B=on(K.getDataUI(Q),B),g&&g.size()||(g=Ui(B)),g=new e(g._as.slice(0)),B=new e(B._as.slice(0));var S=g.get(v);if(2===S||1===S){var G={x:t.x,y:t.y};g.add(S,v),B.add(G,u+1)}else if(3===S){var i=B.get(u),b=B.get(u+2),G={x:t.x,y:t.y},n=dd(i,G),E=dd(G,b);g.removeAt(v),g.add(3,v),g.add(3,v),B.set(u+1,G),B.add(E,u+2),B.add(n,u+1)}else if(4===S){var i=B.get(u),b=B.get(u+3),G={x:t.x,y:t.y},n=Jc(i,G),E=we(i,G),j=Jc(G,b),s=we(G,b);g.removeAt(v),g.add(4,v),g.add(4,v),B.removeAt(u+1),B.removeAt(u+1),B.add(G,u+1),B.add(s,u+2),B.add(j,u+2),B.add(E,u+1),B.add(n,u+1)}Q.s("edge.points",uf(B)),Q.s("edge.segments",g)}}}D.endTransaction()},removeShapePoint:function(k,v){var I=this,F="removeAt",$=I.gv,q=$.dm();if(q.beginTransaction(),0===arguments.length&&(k=I._shape||I._edge,v=I._removePointIndex),v>=0&&(k instanceof r||k instanceof H)){var g=rb(k,I.gv.getDataUI(k),v),z=v;if(k instanceof r){var a=k.p(),X=k.toSegments();X&&X.size()||(X=Ui(k.getPoints()));var M=X.get(g),V="removePointAt";if(1===M&&0===z)if(k.getPoints().size()>1){var S=X.get(g+1);X[F](g+1),3===S?k[V](z+1):4===S&&(k[V](z+2),k[V](z+1)),k[V](z)}else k.dm().remove(k);else 2===M||1===M?(X[F](g),k[V](z)):3===M?(X[F](g),k[V](z),k[V](z-1)):4===M&&(X[F](g),k[V](z),k[V](z-1),k[V](z-2));k.setSegments(X);var j=k.getWidth(),O=k.getHeight(),y=k.p().x-j/2,u=k.p().y-O/2;y-=a.x,u-=a.y;var w=Ag(k,{x:y,y:u,width:j,height:O},k.getRotation(),a);k.p(w.x,w.y)}else if(k instanceof H){if("points"!==k.s("edge.type"))return q.endTransaction(),void 0;var L=k.s("edge.points");if(X=k.s("edge.segments"),L&&(L=on(I.gv.getDataUI(k),L),X&&X.size()||(X=Ui(L))),0===v||v===L.size()-1)return q.endTransaction(),void 0;X=new e(X._as.slice(0)),L=new e(L._as.slice(0));var M=X.get(g);2===M||1===M?(X[F](g),L[F](z)):3===M?(X[F](g),L[F](z),L[F](z-1)):4===M&&(X[F](g),L[F](z),L[F](z-1),L[F](z-2)),k.s("edge.segments",X),k.s("edge.points",uf(L))}}q.endTransaction()},changeShapeSegment:function(y,h,L){var N=this,m=N.gv,o=m.dm();if(o.beginTransaction(),1!==arguments.length||isNaN(y)||(L=y,y=N._shape||N._edge,h=N._hoverSegmentIndex),y instanceof r||y instanceof H){var b=gl(y,N.gv.getDataUI(y),h);if(!isNaN(h)&&!isNaN(b))if(y instanceof r){var j=y.p(),D=y.toSegments();D&&D.size()||(D=Ui(y.getPoints()));var J=D.get(h),R=y.toPoints();if(1===L||2===L)1===J||2===J?D.set(h,L):3===J?(D.set(h,L),R.removeAt(b+1)):4===J&&(D.set(h,L),R.removeAt(b+1),R.removeAt(b+1));else if(3===L){var a=function(){var B=R.get(b),m=R.get(b+1),u=dd(B,m);D.set(h,3),R.add(u,b+1)};2===J||1===J?a():4===J&&(R.removeAt(b+1),R.removeAt(b+1),a())}else if(4===L){var G=function(){var X=R.get(b),x=R.get(b+1),Y=Jc(X,x),g=we(X,x);D.set(h,4),R.add(Y,b+1),R.add(g,b+2)};2===J||1===J?G():3===J&&(R.removeAt(b+1),G())}y.setSegments(D),y.setPoints(R);var V=y.getWidth(),B=y.getHeight(),d=y.p().x-V/2,p=y.p().y-B/2;d-=j.x,p-=j.y;var C=new Ag(y,{x:d,y:p,width:V,height:B},y.getRotation(),j);y.p(C.x,C.y)}else if(y instanceof H){if("points"!==y.s("edge.type"))return o.endTransaction(),void 0;var R=y.s("edge.points");D=y.s("edge.segments"),R&&(R=on(N.gv.getDataUI(y),R),D&&D.size()||(D=Ui(R))),D=new e(D._as.slice(0)),R=new e(R._as.slice(0));var J=D.get(h);if(1===L||2===L)1===J||2===J?D.set(h,L):3===J?(D.set(h,L),R.removeAt(b+1)):4===J&&(D.set(h,L),R.removeAt(b+1),R.removeAt(b+1));else if(3===L){var a=function(){var A=R.get(b),N=R.get(b+1),e=dd(A,N);D.set(h,3),R.add(e,b+1)};2===J||1===J?a():4===J&&(R.removeAt(b+1),R.removeAt(b+1),a())}else if(4===L){var G=function(){var y=R.get(b),q=R.get(b+1),N=Jc(y,q),w=we(y,q);D.set(h,4),R.add(N,b+1),R.add(w,b+2)};2===J||1===J?G():3===J&&(R.removeAt(b+1),G())}y.s("edge.points",uf(R)),y.s("edge.segments",D)}}o.endTransaction()},getDefaultSegments:function(l){var O=this.gv,T=O.getDataUI(l);if(l instanceof H){var C=l.s("edge.points");return C=on(T,C),Ui(C)}if(l instanceof r){var C=l.getPoints(),e=l.getSegments();return e&&e.size()>0?e:Ui(C)}},$43l:function(H){var t=this;H&&(t.$5l=1),t._68I=1,t._42()},_42:function(){var t=this;if(t._68I){delete t._68I;var $=t.gv,y=t.$5l,N=$.getZoom(),I=$.getEditPointSize(),j=I/2,w=new e,F=t._view,J=t._edge,s=t._shape,R=F.getContext("2d"),B=$.tx(),o=$.ty(),G=u,d=$.getEditPointBackground(),O=$.getControlPointBackground(),h=$.getControlPointBorderColor(),L=$.getEditPointBorderColor(),E=$.getEditRectBorderColor(),V=$.getDirectionLineColor(),f=$.getSegmentHoverColor(),A=$.getSnapPointBorderColor(),c=$.getJoinPointBackground(),T=$.getJoinPointBorderColor(),K=$.getSegmentHoverWidth(),n=[5,5],a=$.getEditRectBorderStyle();Ii($,function(V){$.isSelected(V)&&$.isVisible(V)&&w.add(V)}),R.clearRect(0,0,W(F.width),W(F.height)),R.save(),S.translateAndScale(R,B,o,1);var z=u,m={x:0,y:0,width:0,height:0},k=0,M=0,X=0,P=0,q=0,g=0,um=0,wi=0,Hj=0,Uh=0,Ki=[];if(y?(delete t.$6l,delete t.$8l,delete t.$7l,delete t.$16l,delete t.$23l):(z=t.$6l,G=t.$7l),delete t.$68l,delete t.$69l,delete t.$71l,delete t.$70l,delete t.$82l,delete t.$83l,delete t._pointElevationHelperPoint,delete t.$90l,delete t.$91l,delete t.$75l,delete t.$74l,w.each(function(o){var c=$.getDataUI(o);if(c){var r=c._55O;if($.isEditable(o))r._56O&&o instanceof C&&M++,Ki.push(o),r._42O&&o instanceof C&&k++,$.isHelperEditable(o,"host")&&P++,$.isHelperEditable(o,"parent")&&X++,$.isHelperEditable(o,"remove")&&q++,$.isHelperEditable(o,"edge")&&g++,$.isHelperEditable(o,"source")&&um++,$.isHelperEditable(o,"target")&&wi++,$.isHelperEditable(o,"elevation")&&Hj++,$.isHelperEditable(o,"tall")&&Uh++;else if(o instanceof v&&o.isExpanded()){var d=!0,F=$.getEditableFunc();F&&(d=F(o)),d&&($.isHelperEditable(o,"host")&&P++,$.isHelperEditable(o,"parent")&&X++,$.isHelperEditable(o,"remove")&&q++,$.isHelperEditable(o,"edge")&&g++,$.isHelperEditable(o,"source")&&um++,$.isHelperEditable(o,"target")&&wi++,$.isHelperEditable(o,"elevation")&&Hj++,$.isHelperEditable(o,"tall")&&Uh++,Ki.push(o))}}}),R.beginPath(),R.lineWidth=1,R.strokeStyle=$.getNodeBorderColor(),Ki.forEach(function(f){var Z=$.getDataUI(f),P=Z._55O;if(y)if(G==u&&(G=f instanceof H?0:f instanceof v&&f.isExpanded()?0:f.getRotation(),t.$7l=G),z==u){var s,l,Q;if(f instanceof v&&f.isExpanded()||f instanceof H){var h=$.getDataUIBounds(f);l=h.width,Q=h.height,s={x:h.x+l/2,y:h.y+Q/2}}else s=f.p(),l=f.getWidth(),Q=f.getHeight();z={x:s.x,y:s.y,width:0,height:0},m.x=s.x-l/2,m.y=s.y-Q/2,m.width=l,m.height=Q,z=U(z,m)}else{var s,l,Q,O,o=z.x+z.width/2,M=z.y+z.height/2,I={x:o,y:M};if(f instanceof v&&f.isExpanded()||f instanceof H){O=0;var h=$.getDataUIBounds(f);l=h.width,Q=h.height,s={x:h.x+l/2,y:h.y+Q/2}}else s=f.p(),l=f.getWidth(),Q=f.getHeight(),O=f.getRotation();var T={x:s.x-l/2,y:s.y-Q/2,width:l,height:Q},E={x:T.x,y:T.y},r={x:T.x+T.width,y:T.y},x={x:T.x,y:T.y+T.height},J={x:T.x+T.width,y:T.y+T.height},E=Wn(s,E.x-s.x,E.y-s.y,O),x=Wn(s,x.x-s.x,x.y-s.y,O),J=Wn(s,J.x-s.x,J.y-s.y,O),r=Wn(s,r.x-s.x,r.y-s.y,O),V=-G,B=Wn(I,E.x-I.x,E.y-I.y,V),L=Wn(I,r.x-I.x,r.y-I.y,V),F=Wn(I,x.x-I.x,x.y-I.y,V),j=Wn(I,J.x-I.x,J.y-I.y,V),c=i([B,L,F,j]);z=U(z,c),z.x-=o,z.y-=M;var X=Ag(u,z,G,I);z.x=X.x-z.width/2,z.y=X.y-z.height/2}if(k>1&&$.isEditable(f)&&$.isRectEditable(f)&&f instanceof C){var w=f.getRect(),p=P.$45l,b=ul(p[0],N),q=ul(p[2],N),g=ul(p[4],N),_=ul(p[6],N);f.getRotation()?(R.moveTo(b.x,b.y),R.lineTo(q.x,q.y),R.lineTo(g.x,g.y),R.lineTo(_.x,_.y),R.lineTo(b.x,b.y)):R.rect(w.x*N,w.y*N,w.width*N,w.height*N)}}),R.stroke(),z){t.$6l=_(z),Z(z,$.getEditRectPadding()/N);var dm={x:z.x+z.width/2,y:z.y+z.height/2},Ej=Lb(dm,z.width,z.height,G),ph=Ej[0],Pj=Ej[1],Df=Ej[2],om=Ej[3],Gb=Ej[4],zl=Ej[5],Ub=Ej[6],qg=Ej[7];if(ph=ul(Ej[0],N),Pj=ul(Ej[1],N),Df=ul(Ej[2],N),om=ul(Ej[3],N),Gb=ul(Ej[4],N),zl=ul(Ej[5],N),Ub=ul(Ej[6],N),qg=ul(Ej[7],N),t.$8l=z,k>0&&(t.$16l=[ph,Gb,Pj,zl,om,Ub,Df,qg],R.beginPath(),R.lineWidth=1,R.strokeStyle=E,"dashed"===a&&R.setLineDash&&R.setLineDash(n),R.moveTo(ph.x,ph.y),R.lineTo(Pj.x,Pj.y),R.lineTo(om.x,om.y),R.lineTo(Df.x,Df.y),R.lineTo(ph.x,ph.y),R.stroke(),"dashed"===a&&R.setLineDash&&R.setLineDash([])),R.beginPath(),R.lineWidth=1,R.fillStyle=d,R.strokeStyle=L,k>0){var Ee=zl.x-qg.x,zk=zl.y-qg.y,Er=l(Ee*Ee+zk*zk),bn=Gb.x-Ub.x,Jl=Gb.y-Ub.y,de=l(bn*bn+Jl*Jl),ri=2*I;if($.isDirectionEditable&&1===Ki.length){var _i=Ki[0],Jo=$.getDataUI(_i),rd=Jo._55O,Nh=$.isDirectionEditable.bind($);if(rd._42O){var rb,us,cb,Xm;Nh(_i,"northwest")&&(rb=!0,R.rect(ph.x-j,ph.y-j,I,I)),Nh(_i,"northeast")&&(us=!0,R.rect(Pj.x-j,Pj.y-j,I,I)),Nh(_i,"southwest")&&(cb=!0,R.rect(Df.x-j,Df.y-j,I,I)),Nh(_i,"southeast")&&(Xm=!0,R.rect(om.x-j,om.y-j,I,I)),Nh(_i,"north")&&(rb&&us?Er>ri&&R.rect(Gb.x-j,Gb.y-j,I,I):R.rect(Gb.x-j,Gb.y-j,I,I)),Nh(_i,"south")&&(Xm&&cb?Er>ri&&R.rect(Ub.x-j,Ub.y-j,I,I):R.rect(Ub.x-j,Ub.y-j,I,I)),Nh(_i,"west")&&(cb&&rb?de>ri&&R.rect(qg.x-j,qg.y-j,I,I):R.rect(qg.x-j,qg.y-j,I,I)),Nh(_i,"east")&&(Xm&&us?de>ri&&R.rect(zl.x-j,zl.y-j,I,I):R.rect(zl.x-j,zl.y-j,I,I))}}else Er>ri&&(R.rect(Gb.x-j,Gb.y-j,I,I),R.rect(Ub.x-j,Ub.y-j,I,I)),de>ri&&(R.rect(zl.x-j,zl.y-j,I,I),R.rect(qg.x-j,qg.y-j,I,I)),R.rect(ph.x-j,ph.y-j,I,I),R.rect(Pj.x-j,Pj.y-j,I,I),R.rect(Df.x-j,Df.y-j,I,I),R.rect(om.x-j,om.y-j,I,I)}if(M>0){var ej=t.$23l=Wn(Gb,0,2*-I,G);R.moveTo(ej.x+j,ej.y),R.arc(ej.x,ej.y,j,0,Y,!1)}R.fill(),R.stroke(),t.$40l&&t.$44l(R,z,G);var ko,Bc,Kc=$.getLeftTopHelpers(),xf=$.getRightTopHelpers(),Fq=$.getLeftBottomHelpers(),nf=$.getRightBottomHelpers(),hl=$.getEdgeHelpers(),gm=$.getEditHelperSize(),Vo=gm/2,ap=function(D,S,U,I){"leftTop"===S?(ko=z.x*N-gm-j-("h"===I?U*(gm+j):0)-1,Bc=z.y*N-gm-j-("v"===I?U*(gm+j):0)-1):"rightTop"===S?(ko=(z.x+z.width)*N+j+("h"===I?U*(gm+j):0)+1,Bc=z.y*N-gm-j-("v"===I?U*(gm+j):0)-1):"leftBottom"===S?(ko=z.x*N-gm-j-("h"===I?U*(gm+j):0)-1,Bc=(z.y+z.height)*N+j+("v"===I?U*(gm+j):0)+1):"rightBottom"===S&&(ko=(z.x+z.width)*N+j+("h"===I?U*(gm+j):0)+1,Bc=(z.y+z.height)*N+j+("v"===I?U*(gm+j):0)+1);var W=ko+Vo,b=Bc+Vo,Z=(z.x+z.width/2)*N,f=(z.y+z.height/2)*N,p=Wn({x:Z,y:f},W-Z,b-f,G);if("host"===D){if(P>0)return t.$77l(R,G,p),!0}else if("edge"===D){if(g>0)return t.$80l(R,G,p),!0}else if("remove"===D){if(q>0)return Ki&&1===Ki.length&&Ki[0]instanceof H?t.$81l(R,G,{x:Z+gm/2+5,y:f}):t.$81l(R,G,p),!0}else if("parent"===D){if(X>0)return Ki&&1===Ki.length&&Ki[0]instanceof H?t.$76l(R,G,{x:Z-gm/2-5,y:f}):t.$76l(R,G,p),!0}else if("elevation"===D){if(Hj>0)return t.$85l(R,G,p),!0}else if("tall"===D){if(Uh>0)return t.$86l(R,G,p),!0}else if("source"===D||"target"===D){var a=Ki[0],M=$.getDataUI(a),d=id(M,!0),l=d[0],Y=d[1];if(um&&"source"===D)return t.$84l(R,z,l,!0,a.isLooped(),S,U,I),!0;if(wi&&"target"===D)return t.$84l(R,z,Y,!1,a.isLooped(),S,U,I),!0}};if(Kc&&Kc.length>0){var Fj=0;Kc.forEach(function(X){ap(X,"leftTop",Fj,$.getLeftTopHelpersAlign()||"h")&&Fj++})}if(xf&&xf.length>0){var Fj=0;xf.forEach(function(g){ap(g,"rightTop",Fj,$.getRightTopHelpersAlign()||"h")&&Fj++})}if(Fq&&Fq.length>0){var Fj=0;Fq.forEach(function(l){ap(l,"leftBottom",Fj,$.getLeftBottomHelpersAlign()||"h")&&Fj++})}if(nf&&nf.length>0){var Fj=0;nf.forEach(function(E){ap(E,"rightBottom",Fj,$.getRightBottomHelpersAlign()||"h")&&Fj++})}if(hl&&hl.length>0&&((um||wi)&&Ki&&1===Ki.length&&Ki[0]instanceof H?!0:!1)){var Fj=0;hl.forEach(function(E){ap(E,"edge",Fj,"h")&&Fj++})}if(t.$72l){var Hp,Yd=t.$67l,Jj=t.$68l,Rl=t.$69l,rp=(t.$71l,t.$70l),Ce=t.$82l,hn=t.$83l;if(1===Yd?Hp=Jj:2===Yd?Hp=Rl:3===Yd?Hp=rp:5===Yd?Hp=Ce:6===Yd&&(Hp=hn),Hp){var Um=$.lp(t.$72l),kf=$.getDataAt(t.$72l);if(kf&&kf instanceof C){var xm,wf,$r;if(t.$73l=kf,1===Yd)if(kf instanceof Q.Grid)xm=t.$75l=Pr(kf,Um);else if(kf instanceof Q.Shape){$r=t.$74l=yo(kf,Um);var Cj=kf.getPoints();if($r){var or=$r.attachIndex,Uf=gl(kf,$.getDataUI(kf),or)+1,km=Uf+1>=Cj.size()?0:Uf+1,ni=Cj.get(Uf),El=Cj.get(km),Xi=kf.p(),eg=kf.getRotation();ni=Wn(Xi,ni.x-Xi.x,ni.y-Xi.y,eg),El=Wn(Xi,El.x-Xi.x,El.y-Xi.y,eg),R.beginPath(),R.strokeStyle=f,R.lineWidth=K,R.moveTo(ni.x*N,ni.y*N),R.lineTo(El.x*N,El.y*N),R.stroke()}}xm?wf=xm.rect:(wf=p.clone($.getDataUIBounds(kf)),p.grow(wf,2)),R.beginPath(),R.rect(wf.x*N,wf.y*N,wf.width*N,wf.height*N),R.strokeStyle=1===Yd||4===Yd||6===Yd?x:b,R.lineWidth=2,R.setLineDash&&R.setLineDash([8,8]),R.stroke()}else delete t.$73l;Um.x=Um.x*N,Um.y=Um.y*N;var vh=ki(Hp.x,Hp.y,Um.x,Um.y),eq=Wn(Hp,Um.x-Hp.x,Um.y-Hp.y,-vh),gk=eq.x-Hp.x;R.save(),R.translate(Hp.x,Hp.y),R.rotate(vh),D.width=gk,D.height=40;var re=b;(1===Yd||4===Yd||6===Yd)&&(re=x),D.comps[0].gradientColor=re,p.drawImage(R,D,0,-20,gk,40),R.restore()}}}if(w.each(function(Q){var m=$.getDataUI(Q);if(m){var I,i,x=m._55O,B=m._78o;if(x&&x._43O&&Q instanceof r?(I=x.$15l,i=Q.getSegments(),i&&i.size()||(i=Ui(I)),Q.isClosePath()&&i.indexOf(5)<0&&(i=new e(i._as),i.add(5))):x&&B&&x._43O&&(I=Q.s("edge.points"),i=Q.s("edge.segments"),I=on(m,I),i&&i.size()||(i=Ui(I)),I&&(I=I._as)),I&&i){var M=0,F=i.size(),w=t._hoverSegmentIndex;I=I.slice(0);for(var Z=0;Z<I.length;Z++)I[Z]=ul(I[Z],N);R.beginPath(),R.strokeStyle=V,R.lineWidth=1,M=0;for(var Z=0;F>Z;Z++){var C=i.get(Z);if(1===C||2===C)M++;else if(3===C){var y=I[M-1],n=I[M],b=I[M+1];R.moveTo(y.x,y.y),R.lineTo(n.x,n.y),R.lineTo(b.x,b.y),M+=2}else if(4===C){var y=I[M-1],g=I[M],W=I[M+1],b=I[M+2];R.moveTo(y.x,y.y),R.lineTo(g.x,g.y),R.moveTo(W.x,W.y),R.lineTo(b.x,b.y),M+=3}}if(R.stroke(),s===Q||J===Q&&"points"===J.s("edge.type")){R.beginPath(),M=0,R.strokeStyle=f,R.lineWidth=K;for(var Z=0;F>Z;Z++){var C=i.get(Z);if(1===C||2===C){if(w===Z){var y=I[M-1],b=I[M];R.moveTo(y.x,y.y),R.lineTo(b.x,b.y);break}M++}else if(3===C){if(w===Z){var y=I[M-1],n=I[M],b=I[M+1];R.moveTo(y.x,y.y),R.quadraticCurveTo(n.x,n.y,b.x,b.y);break}M+=2}else if(4===C){if(w===Z){var y=I[M-1],g=I[M],W=I[M+1],b=I[M+2];R.moveTo(y.x,y.y),R.bezierCurveTo(g.x,g.y,W.x,W.y,b.x,b.y);break}M+=3}else if(5===C&&w===Z){var y=I[M-1],b=I[0];R.moveTo(y.x,y.y),R.lineTo(b.x,b.y);break}}R.stroke()}R.beginPath(),M=0,R.strokeStyle=T,R.lineWidth=1,R.fillStyle=c;for(var Z=0;F>Z;Z++){var C=i.get(Z);if(1===C||2===C){var b=I[M];R.moveTo(b.x+j,b.y),R.arc(b.x,b.y,j,0,Y,!0),M++}else if(3===C){var b=I[M+1];R.moveTo(b.x+j,b.y),R.arc(b.x,b.y,j,0,Y,!0),M+=2}else if(4===C){var b=I[M+2];R.moveTo(b.x+j,b.y),R.arc(b.x,b.y,j,0,Y,!0),M+=3}}R.fill(),R.stroke(),R.beginPath(),M=0,R.strokeStyle=h,R.lineWidth=1,R.fillStyle=O;for(var Z=0;F>Z;Z++){var C=i.get(Z);if(1===C||2===C)M++;else if(3===C){var n=I[M];R.moveTo(n.x+j,n.y),R.arc(n.x,n.y,j,0,Y,!0),M+=2}else if(4===C){var g=I[M],W=I[M+1];R.moveTo(g.x+j,g.y),R.arc(g.x,g.y,j,0,Y,!0),R.moveTo(W.x+j,W.y),R.arc(W.x,W.y,j,0,Y,!0),M+=3}}if(R.fill(),R.stroke(),R.beginPath(),M=0,R.strokeStyle=A,R.lineWidth=2,(s===Q||J===Q)&&t.$9l!=u){var b=I[t.$9l];R.moveTo(b.x+j,b.y),R.arc(b.x,b.y,j,0,Y,!0),R.stroke()}}}}),t.$87l&&$.sm().contains(t.$87l)){var hm,Fn=t.$87l,hc=t.$88l,gm=$.getEditHelperSize(),Vo=gm/2;if($.isHelperEditable(Fn,"pointElevation"))if(Fn instanceof r){var $h=Fn.getPosition();hm=p.clone(Fn.getPoints().get(hc)),hm=Wn({x:$h.x,y:$h.y},hm.x-$h.x,hm.y-$h.y,Fn.getRotation()),hm.x*=N,hm.y*=N,R.translate(hm.x,hm.y),p.drawImage(R,p.getImage("xeditinteractor_elevationIcon"),Vo,-Vo,gm,gm),R.translate(-hm.x,-hm.y),t._pointElevationHelperPoint={x:hm.x+gm,y:hm.y}}else if(Fn instanceof H){var Bm=on($.getDataUI(Fn),Fn.s("edge.points")),hm=p.clone(Bm.get(hc));hm.x*=N,hm.y*=N,R.translate(hm.x,hm.y),p.drawImage(R,p.getImage("xeditinteractor_elevationIcon"),Vo,-Vo,gm,gm),R.translate(-hm.x,-hm.y),t._pointElevationHelperPoint={x:hm.x+gm,y:hm.y}}}R.restore(),t.$5l=0}},$89l:function(E,Q,V,L){E.save();var b=this,f=b.gv,D=f.getEditHelperSize(),i=D/2;E.beginPath(),E.translate(V.x,V.y),E.rotate(Q),p.drawImage(E,L,-i,-i,D,D),E.restore()},$85l:function(M,e,V){var Z=this;Z.$90l=V,Z.$89l(M,e,V,p.getImage("xeditinteractor_elevationIcon"))},$86l:function(s,r,g){var D=this;D.$91l=g,D.$89l(s,r,g,p.getImage("xeditinteractor_tallIcon"))},$77l:function(z,v,K){var h=this;h.$68l=K,h.$89l(z,v,K,p.getImage("xeditinteractor_hostIcon"))},$80l:function(t,G,c){var D=this;D.$70l=c,D.$89l(t,G,c,p.getImage("xeditinteractor_edgeIcon"))},$81l:function(_,f,c){var O=this;O.$71l=c,O.$89l(_,f,c,p.getImage("xeditinteractor_removeIcon"))},$76l:function(o,w,P){var d=this;d.$69l=P,d.$89l(o,w,P,p.getImage("xeditinteractor_parentIcon"))},$84l:function(f,y,a,E,G){var g,Z=this,r=Z.gv,N=r.getZoom(),e=r.getEditHelperSize(),z=e/2;a.x*=N,a.y*=N,G&&(E?a.x-=z+5:a.x+=z+5),a.y-=e-2,E?(Z.$82l=a,g=p.getImage("xeditinteractor_sourceIcon")):(Z.$83l=a,g=p.getImage("xeditinteractor_targetIcon")),f.beginPath(),f.translate(a.x,a.y),p.drawImage(f,g,-z,-z,e,e),f.translate(-a.x,-a.y)},$44l:function(z,S,L){z.save();var y=this.gv.getZoom(),A=l(I(S.width,2)+I(S.height,2))/2*y+10,_=A,f=_+8,d=_+18,x=L,F=S.x+S.width/2,M=S.y+S.height/2;z.translate(F*y,M*y),z.beginPath(),z.strokeStyle="rgb(150, 150, 150)";for(var t=0,B=0,J=0,u=0,p=0,Y=0;360>Y;Y++)t=Y*s/180,0===Y%5&&(B=N(t)*_,J=V(t)*_,u=N(t)*f,p=V(t)*f,z.moveTo(B,J),z.lineTo(u,p)),0===Y%45&&(B=N(t)*_,J=V(t)*_,u=N(t)*d,p=V(t)*d,z.moveTo(B,J),z.lineTo(u,p));z.stroke(),z.beginPath(),z.rotate(-h),z.beginPath(),z.fillStyle="rgba(255, 0, 0, 0.1)",z.strokeStyle="rgb(157, 157, 157)",z.moveTo(0,0),z.arc(0,0,d,0,L,!1),z.fill(),z.beginPath(),z.moveTo(0+d,0),z.arc(0,0,d,0,L,!1),z.stroke(),z.rotate(h),z.font="bold 12px Verdana, Arial";var g=20*V(x),U=20*N(x),c=P(180*x/s)+"";z.textAlign="center",z.textBaseline="middle",z.beginPath();var Q=z.measureText("365.").width;z.fillStyle="white",z.rect(g-Q/2,-U-10,Q,20),z.fill(),z.beginPath(),z.fillStyle="rgb(79,79,79)",z.fillText(c,g,-U),z.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);